var _currChatID,_viewMode,loadedImgCount,loadComplete,appendedCount,_currDateFilter,search_value,isGuest,MediaActions=function(){var e=void 0,t=void 0,i=function(e,t,i,d){MediaStorage[e]=MediaStorage[e]||{},MediaStorage[e][t]=MediaStorage[e][t]||{},MediaStorage[e][t][MediaListConstants.DATA]=MediaStorage[e][t][MediaListConstants.DATA]?a(MediaStorage[e][t][MediaListConstants.DATA],i.list):i.list,MediaStorage[e][t][MediaListConstants.NEXT_TOKEN]=i.next_token,MediaStorage[e][t][MediaListConstants.FETCHCOMPLETE]=!!$WC.Util.isEmpty(i.next_token),MediaStorage[e][t][MediaListConstants.CURR_GRID_COUNT]=d?MediaStorage[e][t][MediaListConstants.CURR_GRID_COUNT]:1,MediaListStorage.addMedia(e,MediaStorage[e],t)},a=function(e,t){for(var i in t)d(e,t[i])||e.push(t[i]);return e},d=function(e,t){return e.find((function(e){return e.message_id===t.message_id}))};return{getMessage:function(t,a,d,s,n){var r=s||MediaListConstants.IMAGE,l={limit:n?30:s===MediaListConstants.LINK?50:100};if(n&&MediaStorage[t][r][MediaListConstants.NEXT_TOKEN]){if(l[MediaListConstants.NEXT_TOKEN]=MediaStorage[t][r][MediaListConstants.NEXT_TOKEN],e&&l[MediaListConstants.NEXT_TOKEN]==e)return;e=l[MediaListConstants.NEXT_TOKEN]}s!==MediaListConstants.ALL&&(l[MediaListConstants.TYPE]=r),$ZCAjx.ajax({url:"/v2/chats/"+t+"/media",type:"GET",data:l,success:function(e){var d=l.type;i(t,d,e,n),"function"==typeof a&&a(s,e.list,0===e.list.length)},error:function(i){e=void 0,"function"==typeof d&&d(i,s),MediaStorage[t][r]||($("#ml-data-container").addClass("h100"),$("#ml-data-container").html(MediaListingUI.getApiErrorHtml()))}})},getAllMessages:function(e,t,a,d){var s=a||MediaListConstants.IMAGE,n={};d&&MediaStorage[def_id][s][MediaListConstants.NEXT_TOKEN]&&(n[MediaListConstants.NEXT_TOKEN]=MediaStorage[def_id][s][MediaListConstants.NEXT_TOKEN]),a!==MediaListConstants.ALL&&(n[MediaListConstants.TYPE]=s),$ZCAjx.ajax({url:"/v2/media",type:"GET",data:n,success:function(t){var s=n.type;i(def_id,s,t,d),"function"==typeof e&&e(a,t.list,0===t.list.length)},error:function(e){"function"==typeof t&&t(e,a),MediaStorage[def_id][s]||($("#ml-data-container").addClass("h100"),$("#ml-data-container").html(MediaListingUI.getApiErrorHtml()))}})},updateRecording:function(e,t,i,a){MediaAPI.getConferenceAjaxWrapper()({url:"/api/v2/conferences/"+e+"/recordings/"+t,type:"PUT",data:{name:i},contentType:"application/json",status:{success:"media.recordings.rename.banner"},success:function(){"function"==typeof a&&a(i,!0)}})},deleteRecording:function(e,t,i,a){MediaAPI.getConferenceAjaxWrapper()({url:"/api/v2/conferences/"+e+"/recordings/"+t,type:"DELETE",status:{loading:i,success:"media.recordings.delete.banner"},success:function(){"function"==typeof a&&a()}})},shareRecording:function(e,t,i,a){MediaAPI.getConferenceAjaxWrapper()({url:"/api/v2/conferences/"+e+"/recordings/"+t+"/share",type:"POST",data:{user_ids:i},contentType:"application/json",status:{loading:$("#share_recording_win").find("[share_btn]"),success:"media.recordings.share.banner"},success:function(){"function"==typeof a&&a()}})},revokeRecording:function(e,t,i,a,d){MediaAPI.getConferenceAjaxWrapper()({url:"/api/v2/conferences/"+e+"/recordings/"+t+"/revoke",type:"DELETE",contentType:"application/json",data:{user_ids:[i]},status:{loading:a},success:function(){"function"==typeof d&&d()}})},leaveRecording:function(e,t,i,a){MediaAPI.getConferenceAjaxWrapper()({url:"/api/v2/conferences/"+e+"/recordings/"+t+"/leave",type:"DELETE",status:{loading:i,success:"mr.leave.banner"},success:function(){"function"==typeof a&&a()}})},getRecordingLinks:function(e,t,i){MediaAPI.getConferenceAjaxWrapper()({url:"/api/v2/conferences/"+e+"/recordings/"+t+"/links",type:"GET",success:function(e){"function"==typeof i&&i(e.data)}})},createRecordingLink:function(e,t,i,a,d){MediaAPI.getConferenceAjaxWrapper()({url:"/api/v2/conferences/"+e+"/recordings/"+t+"/links",type:"POST",contentType:"application/json",data:i,status:{success:"mr.permalink.create.banner",loading:a},success:function(e){"function"==typeof d&&d(e.data)},error:function(e){UI.updateBanner(e.message,2e3,!0)}})},updateRecordingLink:function(e,t,i,a,d,s){MediaAPI.getConferenceAjaxWrapper()({url:"/api/v2/conferences/"+e+"/recordings/"+t+"/links/"+i,type:"PUT",contentType:"application/json",data:a,status:{loading:d},success:function(){"function"==typeof s&&s()},error:function(e){UI.updateBanner(e.message,2e3,!0)}})},deleteRecordingLink:function(e,t,i,a,d){MediaAPI.getConferenceAjaxWrapper()({url:"/api/v2/conferences/"+e+"/recordings/"+t+"/links/"+i,type:"DELETE",status:{loading:a,success:"mr.permalink.delete.banner"},success:function(){"function"==typeof d&&d()}})},getRecordingSharedUsers:function(e,t,i){MediaAPI.getConferenceAjaxWrapper()({url:"/api/v2/conferences/"+e+"/recordings/"+t+"/sharedusers",type:"GET",success:function(e){"function"==typeof i&&i(e.data)}})},addNewMessageAtt:function(e,t){if(t&&t.info){var i={chat:{id:e},name:t.info.fName,id:t.info.url,time:t.time,sender:{name:t.nname,id:t.sender},content_type:t.info.content,message_id:t.msguid,meta:{width:t.info.dim?t.info.dim.width:"",height:t.info.dim?t.info.dim.height:""},has_thumbnail:t.has_thumbnail,message_type:t.wmsfilesharingtype||MediaListConstants.FILE,size:t.info.dim?t.info.dim.size:""};MediaListStorage.addToTop(e,i,i.message_type)}},getFilteredMedia:function(e,i,a,d,s){var n={user_ids:i.userids?[i.userids].join():"",type:_currTypeFilter,fromtime:i.fromtime,totime:i.totime},r=isFromLHS?"/v2/media":"/v2/chats/"+e+"/media",l=_currChatID||def_id;if(s&&AppliedFilter[l][MediaListConstants.NEXT_TOKEN]){if(n[MediaListConstants.NEXT_TOKEN]=AppliedFilter[l][MediaListConstants.NEXT_TOKEN],t&&n[MediaListConstants.NEXT_TOKEN]==t)return;t=n[MediaListConstants.NEXT_TOKEN]}AppliedFilter[l][MediaListConstants.SEARCH]&&(n[MediaListConstants.SEARCH]=AppliedFilter[l][MediaListConstants.SEARCH]),$ZCAjx.ajax({url:r,type:"GET",data:n,success:function(e){var t=n.type;e.next_token?(AppliedFilter[l][MediaListConstants.NEXT_TOKEN]=e.next_token,AppliedFilter[l][MediaListConstants.FETCHCOMPLETE]=!1):(AppliedFilter[l][MediaListConstants.NEXT_TOKEN]="",AppliedFilter[l][MediaListConstants.FETCHCOMPLETE]=!0),_isFilterApplied[l]=!0,FilterStorage[l]=s?FilterStorage[l].concat(e.list):e.list,"function"==typeof a&&a(t,e.list,0===e.list.length)},error:function(e){t=void 0,"function"==typeof d&&d(e,type),$("#ml-data-container").addClass("h100"),$("#ml-data-container").html(MediaListingUI.getApiErrorHtml())}})},HandleDeleteMedia:function(e,t,i){var a=i?i.split("/")[0]:_currTypeFilter;a="application"===a?MediaListConstants.FILE:a,MediaListStorage.removeDeleted(e,t,a)}}}(),MediaListingEvents=function(){var e,t,i={closeView:function(){s(),isForwardEnabled&&l(),$WC.$Win.destroy(MediaDomIDS.WIN_ID)},selectCategory:function(e){var t=e.dataset.type;if(_currTypeFilter===t)return;var i='<div id="loadingblock">'+MediaListingUI.getLoader(_viewMode)+"</div>";$("#ml-data-container").html(i),MediaListingUI.highlightType(t),isForwardEnabled&&l(),ZCTrack.track("MEDIA_GALLERY_FEATURE",{TRIGGER:t,ACTION:"Category switch"});let a="recording"===t;$("#ml_sharedby_txt").text(I18N(a?"mr.recordedby":"ml.sharedby")),$("#ml_search_input").prop("placeholder",I18N(a?"mr.search.placeholder":"ml.search.ph")),_isFilterApplied[_currChatID||def_id]?MediaListingUI.showMediaWFilters():MediaListingUI.updateListUI(t),$(e).parents("[files_tab]").length&&MediaListingUI.putLastAccessedMediaType()},removeDateFilter:function(e,t){Clickoutside.handleClickOnChild(t),s(MediaListingFilters.DATE_FILTER),$("#dateFilterDisplay").removeClass("ml-filterdate"),$("#date-picker-dom").removeClass("date_display").removeClass("datefil-bdr")},removeUserFilter:function(e,t){Clickoutside.handleClickOnChild(t),AppliedFilter[_currChatID||def_id]&&AppliedFilter[_currChatID||def_id].userids&&s(MediaListingFilters.USER_IDS)},switchListView:function(e){if(MediaListingUI.updateView(),$("#recording_category").length>0||"recording"===_currTypeFilter)MediaListingUI.populateRecordings(MediaListingUI.getSelectedRecordingCategory(),MediaStorage.recordingsObj.getAllFromClient());else{var t=e.dataset.type;isForwardEnabled&&r(),_isFilterApplied[_currChatID||def_id]?MediaListingUI.showMediaWFilters():MediaListingUI.updateListUI(t)}},showRecordingMoreOptions:function(e,t){null!==t.target.getAttribute("recording_dropdown_menu")&&MediaListingUI.handleRecordingMoreOptions(t,e)},show_drpdwn_options:function(e,t){if(e.id===MediaDomIDS.SHAREDBYDOM)(l=$("#sharedByOptns")).removeClass("hide").addClass("active"),Clickoutside.clear("sharedByOptns"),$(e).addClass("active"),$("#"+_currSharedByFilter+"sel").removeClass("dN"),Clickoutside.bind({srcid:e.id,event:t,destid:"sharedByOptns",customShow:function(){n(_currSharedByFilter)},customHide:function(i){"remove_id_frm_filter"!==t.target.id&&(l.addClass("hide"),$(e).removeClass("active"))},closeOnClickSrc:!0});else if("date-picker-dom"===e.id){(l=$("#dateFilterOptns")).removeClass("hide").addClass("active"),Clickoutside.clear("dateFilterOptns"),$(e).addClass("active"),Clickoutside.bind({srcid:e.id,event:t,destid:"dateFilterOptns",customShow:function(){n(_currSharedByFilter)},customHide:function(t){l.addClass("hide"),$(e).removeClass("active")},closeOnClickSrc:!0})}else{$("#sharedByOptns").removeClass("active");var i=e.dataset.type,a=e.dataset.chid,d=ChatUI.exist[a];$(".ml-"+i+"-item").removeClass("active"),Clickoutside.clear("lhs-context-menu");var s=e.dataset.uid,r=$(e).attr("msguid"),l=$("#"+i+"_item_"+s),c=$("#dropdown_icon_"+s).parents("[url]"),o=m(c);l.addClass("active"),$("#lhs-context-menu").remove();var _=$WC.template.replace(MediaListingTemplates.getHtml(MediaListConstants.DROPDOWN_HTML),{forward_dropdown_html:Chat.isForwardRestricted(a)?"":MediaListingTemplates.getHtml(MediaListConstants.FORWARD_DROPDOWN_HTML)},"InSecureHTML");_=$WC.template.replace(_,{$forward_txt:"common.forward",$jump_to_chat:"goto.message",$copy:"ml.copy.link",$delete:"common.delete",$more:"common.more",$reply:"message.option.reply",uid:s,chid:a,msguid:r}),$("body").append(_),"link"===_currTypeFilter?$('[data-action="_copyLinkToClipboard"]').removeClass("dN"):$('[data-action="_copyLinkToClipboard"]').addClass("dN"),a==ChatBot.getChid()&&WmsImpl.isLocalUser(""+o.sender)?$('[documentclick="attdeletefromgallery"]').removeClass("dN"):MsgUtil.isMsgDeletable(o,c,d)&&$('[documentclick="attdeletefromgallery"]').removeClass("dN"),context_menu_dom=$("#lhs-context-menu");var p=$Util.positionTargetElemFixed(context_menu_dom,t);context_menu_dom.css(p),Clickoutside.bind({srcid:e.id,event:t,destid:"lhs-context-menu",customHide:function(e){context_menu_dom.remove(),l.removeClass("active")}})}},getMediaAftApiErr:function(){_()?MediaListingUI.showMediaWFilters():MediaListingUI.callMediaAPI(MediaListingUI.updateListUI,"")},showSearchInput:function(){Clickoutside.bind({srcid:"ml_search_icon",destid:MediaDomIDS.MEDIASEARCH,doNotClose:function(){return""!==$("#"+MediaDomIDS.MEDIASEARCHINPUT)[0].value},customShow:function(e){$("#"+MediaDomIDS.MEDIASEARCH).addClass("active"),$("#"+MediaDomIDS.MEDIASEARCHINPUT).focus()},customHide:function(e){$("#"+MediaDomIDS.MEDIASEARCH).removeClass("active")}})},hideSearch:function(){$("#"+MediaDomIDS.MEDIASEARCHINPUT).val(""),isForwardEnabled&&r(),Clickoutside.clear(MediaDomIDS.MEDIASEARCH),$("#"+MediaDomIDS.MEDIASEARCH).removeClass("active"),$WC.Util.isEmpty(AppliedFilter[_currChatID||def_id].search)||s(MediaListConstants.SEARCH)},filterMediaByUserId:function(e,t,i){user_ids=i||e.dataset.uid;var a=_currChatID||def_id;if(!AppliedFilter[a]||!AppliedFilter[a].userids||AppliedFilter[a].userids!==user_ids){AppliedFilter[a]=AppliedFilter[a]||{},AppliedFilter[a].userids="",$("#filter_txt").text(e.textContent),AppliedFilter[a].userids=user_ids,AppliedFilter[a][MediaListConstants.LMTIME]="";var d=user_ids===$zcg._ZUID?MediaListingFilters.BY_CURR_USER:MediaListingFilters.BY_SPECIFIC_USER;n(d),isForwardEnabled&&r(),Clickoutside.handleClickOnChild(t),MediaListingUI.showMediaWFilters()}},clearSearch:function(){$("#"+MediaDomIDS.MEDIASEARCHINPUT).val("").focus(),isForwardEnabled&&r(),search_value="",s(MediaListConstants.SEARCH)},fwdclose:function(e){l()},selFrwdItem:function(e){var t=e.dataset.uid,i=$(e).attr("msguid"),a=$("#dropdown_icon_"+t).parents("#att_actions"),d=$(".forward_sel").length;if(SELECTED_LEN||(SELECTED_LEN=d),a.hasClass("forward_sel")?($("#frwdmsginfo_"+t)[0].checked=!1,a.removeClass("forward_sel"),d--,SELECTED_LEN--,-1!==ForwardParamMsguids.indexOf(i)&&ForwardParamMsguids.splice(ForwardParamMsguids.indexOf(i),1)):($("#frwdmsginfo_"+t)[0].checked=!0,a.addClass("forward_sel"),d++,SELECTED_LEN++),d>=1&&d<=25)d=SELECTED_LEN,$("#msgselectcnt").text(d+"/25");else if(d>25){var s=$("#chatwindropdown");s.addClass("zcfdk_tmbzoom"),s.handleAnimationEnd((function(){s.removeClass("zcfdk_tmbzoom")})),$("#frwdmsginfo_"+t)[0].checked=!1,a.removeClass("forward_sel"),d--}else isForwardEnabled&&l();event.preventDefault()},forwarditem:function(e,t){var i=e.dataset.chid||_currChatID;MessageOperations.forward.initUI(i,"media_window")},open_attachment:function(e){(e=null!==e.getAttribute("previewelem")?e:$(e).find("[previewelem]")[0])&&ImgViewer.show(e,!1,!0)},user_details:function(e){e=$(e).find("img")[0],HoverDetails.show(e)},dateFilter:function(e,t){Clickoutside.handleClickOnChild(t);var i=_currChatID||def_id;AppliedFilter[i]=AppliedFilter[i]||{},AppliedFilter[i][MediaListConstants.LMTIME]="";if($(e).addClass("active"),Clickoutside.clear("calender"),"specific_fil"===e.id){var a=$WC.template.replace(MediaListingTemplates.getHtml(MediaListConstants.CALENDER_SPECIFIC),{$date_txt:"common.date",$apply_txt:"sticky.calender.apply"});$("#calender_container").html(a),Clickoutside.bind({srcid:"specific_fil",destid:"calender2",event:t,customShow:function(e,t){$("#calenspc").removeClass("dN"),p(_currChatID,"elemCalender3"),$('[data-name="specific_fil_cal"]').addClass("active"),$("#calender").css("width","240px"),$("#calenspc").attr("showcalendar","")},customHide:function(){var t=$("#calenspc");$(e).removeClass("active"),t.addClass("dN"),$('[data-name="specific_fil_cal"]').removeClass("active")},closeOnClickSrc:!0})}else if(e.id="custom_fil"){var d=$WC.template.replace(MediaListingTemplates.getHtml(MediaListConstants.CALENDER_RANGE),{$date_txt:"common.date",$to_txt:"common.to",$from_txt:"common.from",$apply_txt:"sticky.calender.apply",$range_err_txt:"date.error"});$("#calender_container").html(d),Clickoutside.bind({srcid:"custom_fil",destid:"calender1",event:t,customShow:function(e,t){$("#calenspc").removeClass("dN"),p(_currChatID,"elemCalender1",!0),p(_currChatID,"elemCalender2"),$("#elemCalender1").removeClass("dN"),$("#footer_custom").removeClass("dN"),$('[data-name="custom_fil_cal"]').addClass("active"),$("#calenspc").attr("showcalendar","")},customHide:function(){$("#calenspc").addClass("dN"),$(e).removeClass("active"),$('[data-name="custom_fil_cal"]').removeClass("active")},closeOnClickSrc:!0})}},Datedropfilters:function(e,t){var i=_currChatID||def_id,a=(new Date).getTime(),s=new Date;s.setHours(0,0,0,0);var n={today:s=s.getTime(),yesterday:s-864e5,last7:s-5184e5,last30:s-25056e5};AppliedFilter[i]=AppliedFilter[i]||{},AppliedFilter[i].fromtime=n[e.id],AppliedFilter[i].totime="yesterday"===e.id?s:a,Clickoutside.handleClickOnChild(t),_currDateFilter!==e.id&&(AppliedFilter[i][MediaListConstants.FETCHCOMPLETE]=!1,AppliedFilter[i][MediaListConstants.LMTIME]="",$("#"+_currDateFilter+"sel").addClass("dN"),_currDateFilter=e.id,$("#"+_currDateFilter+"sel").removeClass("dN"),d(),isForwardEnabled&&r(),MediaListingUI.showMediaWFilters())},applyCustomDateFilter:function(i,a){var s=_currChatID||def_id;Clickoutside.handleClickOnChild(a),$("#"+_currDateFilter+"sel").addClass("dN"),_currDateFilter=$(i).attr("filter"),d(!0),$("#"+_currDateFilter+"sel").removeClass("dN"),AppliedFilter[s]=AppliedFilter[s]||{},AppliedFilter[s][MediaListConstants.FETCHCOMPLETE]=!1,AppliedFilter[s][MediaListConstants.LMTIME]="",AppliedFilter[s].totime=t,AppliedFilter[s].fromtime="range"===_currDateFilter?e:t-864e5,isForwardEnabled&&r(),MediaListingUI.showMediaWFilters()},channelUserIdFilter:function(e,t,i){var d=$WC.template.replace(MediaListingTemplates.getHtml("addParticipantsHTML"),{$searchpholder:"quickchat.node.placeholder",$add:"sticky.calender.apply",search_entity:MediaDomIDS.ADD_PARTICIPANT_SEARCH,purpose:"saveAddedParticipants"}),s=$("#sharedByOptns");Clickoutside.clear(MediaDomIDS.ADD_PARTICIPANT_SEARCH),s.find("#addparticipants").html(d),SearchField.init(MediaDomIDS.ADD_PARTICIPANT_SEARCH),$("#channelFilter").addClass("active"),ZCScroll.customScroll($("#"+MediaDomIDS.ADD_PARTICIPANT_LIST),!0),Clickoutside.bind({srcid:$(e).attr("id"),destid:MediaDomIDS.ADD_PARTICIPANT_SEARCH,event:t,customShow:function(e){SearchField.clearSearchField(MediaDomIDS.ADD_PARTICIPANT_SEARCH);var t=$("#"+MediaDomIDS.ADD_PARTICIPANT_SEARCH);t.show(),a.getSelectedParticipantsAndInit(t),t.find("#"+MediaDomIDS.ADD_PARTICIPANT_SRCHFLD).focus()},customHide:function(e){var t=$("#"+MediaDomIDS.ADD_PARTICIPANT_SEARCH);$("#channelFilter").removeClass("active"),t.hide()},closeOnClickSrc:!0})},saveAddedParticipants:function(){var e=$("#"+MediaDomIDS.ADD_PARTICIPANT_SELECTION),t=[],i=_currChatID||def_id,a=e.children().length,d=[],l=[],c="";e.children().each((function(){var e=$(this),i=e.attr("uid"),a=e.attr("elemtype"),s=e.attr("username");t.push([i,a]),d.push(i),d.length>4&&l.push(s)}));var o=$("#sharedByOptns"),m=o.find("#addparticipants"),_=o.find("#selremparticipants").find("#"+MediaDomIDS.APPLY_SHAREDBY_FILTERBTN).css("visibility","visible");if(0!=a){_.show(),m.addClass("sel");for(var p=0;p<a;p++){if(params=$.extend(RemindersUtil.getUserDetails(d[p]),{remove_html:""}),p>3){c+='<div id="sharedByNames" title="" class="dIB zcricnt posl ml-selcontactcnt textC">'+(d.length-4)+"+</div>";break}c+=$WC.template.replace(MediaListingTemplates.getHtml("imgNodeHTML"),params,"InSecureHTML")}m.attr("userids",JSON.stringify(t)),AppliedFilter[i]=AppliedFilter[i]||{},AppliedFilter[i].userids=d,$("#filter_txt").text(Resource.getRealValue("common.all")).html(c),$("#sharedByNames").attr("title",$Util.getCustomToolTipForList(l,"6",!1)),$("#sharedByOptns").addClass("hide"),$("#"+MediaDomIDS.SHAREDBYDOM).removeClass("active"),$("#"+MediaDomIDS.ADD_PARTICIPANT_SEARCH).hide(),n(MediaListingFilters.BY_SPECIFIC_USER),isForwardEnabled&&r(),MediaListingUI.showMediaWFilters(),AppliedFilter[i][MediaListConstants.LMTIME]=""}else _.hide(),AppliedFilter[i]=AppliedFilter[i]||{},AppliedFilter[i].userids=[],$("#filter_txt").text(Resource.getRealValue("common.all")),$("#"+MediaDomIDS.ADD_PARTICIPANT_SEARCH).hide(),_.find("#"+MediaDomIDS.ADD_PARTICIPANT_SELECTION).empty(),o.find("#"+MediaDomIDS.ADD_PARTICIPANT_RESULT).removeClass("rempptsel"),m.removeAttr("userids").removeClass("sel"),s(MediaListingFilters.USER_IDS)},removeSelectedUser:function(e,t){if(e){var i=$("#"+MediaDomIDS.ADD_PARTICIPANT_SELECTION);$(e).parent().remove(),$(e).remove(),0===i.children().length&&AppliedFilter[_currChatID||def_id]&&AppliedFilter[_currChatID||def_id].userids&&AppliedFilter[_currChatID||def_id].userids!==$zcg._ZUID&&$("#"+MediaDomIDS.APPLY_SHAREDBY_FILTERBTN).text(Resource.getRealValue("common.remove")),t.stopImmediatePropagation();var a=t.target.getAttribute("data-uid");a=a||t.target.getAttribute("data-chid");var d=MediaListingEvents.addParticipants.getTempIgnoreList()||[];MediaListingEvents.addParticipants.setTempIgnoreList(d.filter(e=>e!==a))}$("#Mediafilter-addparticipants-list").html('<div id="imgloading" class="zcldng" style="display: block;"></div>'),SearchField.populateDefaultResult(MediaDomIDS.ADD_PARTICIPANT_SEARCH)},switchRecordingCategory:function(e,t){e=$(e),$("#recording_category").find(".sel").removeClass("sel"),e.addClass("sel"),MediaListingUI.handleRecordingFilter(AppliedFilter[0])},downloadRecording:function(e,t){Conference.handleDownloadRecording(e.getAttribute("ref_index"),e.getAttribute("nrs_id"))},playRecording:function(e,t){ZCTrack.track("RECORDING_PLAYED",{TRIGGER:"RECORDING_GALLERY"});var i={nrs_id:(e=$(e).parent()).attr("nrs_id"),host:{id:e.attr("owner_id")}};let a=MediaStorage.recordingsObj.getObject(e.attr("uid")),d=!0;a&&(d=a.video?SecurityManager.hasPermission(Modules.GroupVideoCall,MActions.DownloadRecordings):SecurityManager.hasPermission(Modules.GroupAudioCall,MActions.DownloadRecordings));var s={hidedownloadicon:void 0!==a.shared_by||!d};MediaRecordingPlayer.open(i,e.attr("ref_index"),e.attr("data-title"),void 0,"true"==e.attr("video"),s)}},a={setTempIgnoreList:function(e=[]){this.ignoreList=e},getTempIgnoreList:function(){return[].concat(this.ignoreList)},setSearchIn:function(e){this.searchIn=e},getSearchIn:function(){return this.searchIn},setTempSearchType:function(e){this.tempSearchType=e},getTempSearchType:function(){return this.tempSearchType},setSearchType:function(e){this.searchType=e},getSearchType:function(){return this.searchType},getSelectedParticipantsAndInit:function(e,t,a,d,s,n){var r;if(t){var l=CallsHistoryUI.getFilterDetails();$.isEmptyObject(l)||$.isEmptyObject(l.user_id)||(r=l.user_id.split(",")),a&&(this.setTempIgnoreList(d),this.setSearchIn(s),this.setTempSearchType(n),r=d||[])}else _currSharedByFilter!==MediaListingFilters.BY_SPECIFIC_USER?(i.removeSelectedUser(),r=e.find("#"+MediaDomIDS.ADD_PARTICIPANT_SELECTION).attr("userids")):r=e.find("#"+MediaDomIDS.ADD_PARTICIPANT_SELECTION).attr("userids")||AppliedFilter[_currChatID||def_id].userids;var c=e.find("#"+MediaDomIDS.ADD_PARTICIPANT_SELECTION);if(c.empty(),void 0!==r&&r!==$zcg._ZUID)if(r.length&&(e.find("#"+MediaDomIDS.ADD_PARTICIPANT_RESULT).addClass("rempptsel"),e.find("#selremparticipants").show()),HistoryViewUtils.isHistoryInViewPort()||StarMessagesUI.isStarMessagesinViewPort()){var o={type:this.getTempSearchType(),selectedList:d,isRemoveInSearchAgentFooter:!0},m=HistoryViewUtils.getImageOfSelectedFilters(o,!0);c.empty().append(m),$("#saveAddedParticipants").attr("data-type",o.type)}else if(a&&ConversationsHistoryUI.isSentMsgSearchInChats()){m=ConversationsHistoryUI.getImageOfFilterChats(!0);c.empty().append(m)}else r.forEach((function(e){var t=e;if(!$WC.Util.isEmpty(t)){var i=$.extend(RemindersUtil.getUserDetails(t),{remove_html:MediaListingTemplates.getHtml("removeImgNodeHTML")});a&&ConversationsHistoryUI.isSentHistoryInViewPort()&&(i.remove_html=$WC.template.replace(i.remove_html,{uid:t}));var d=$WC.template.replace(MediaListingTemplates.getHtml("imgNodeHTML"),i,"InSecureHTML");c.append(d)}}));$WC.Util.isEmpty($("#"+MediaDomIDS.ADD_PARTICIPANT_SRCHFLD).text())&&($("#Mediafilter-addparticipants-list").html('<div id="imgloading" class="zcldng" style="display: block;"></div>'),SearchField.populateDefaultResult(MediaDomIDS.ADD_PARTICIPANT_SEARCH))},search:function(e){var t=$("#"+MediaDomIDS.ADD_PARTICIPANT_RESULT),i=!1,d=CallsHistoryUI.isCallHistoryFilterIsActive(),s=(ConversationsHistoryUI.isSentMsgSearchInChats(),isFromLHS||d?SearchAgent.CONTACTS+SearchAgent.ORGCONTACTS:SearchAgent.PARTICIPANTS),n=t.next().find("#"+MediaDomIDS.ADD_PARTICIPANT_SELECTION),r=[];Config.isSentMessageHistoryEnabled(),HistoryViewUtils.isHistoryInViewPort()||StarMessagesUI.isStarMessagesinViewPort()?(r=this.getTempIgnoreList(),s=this.getSearchIn()):n.children().each((function(){r.push($(this).attr("uid"))}));var l=$("#"+MediaDomIDS.ADD_PARTICIPANT_LIST);l.empty();var c=!d;return s&&(i=SearchAgent.search({searchin:s,val:e,restricttosameorg:c,channelcategory:1,peopledata:!0,chid:_currChatID,ignorelist:r,scrlcontainer:$("#"+MediaDomIDS.ADD_PARTICIPANT_LIST).find("#participants"),listid:MediaDomIDS.ADD_PARTICIPANT_LIST,participantshtml:MediaListingTemplates.getHtml("ParticipantsSearchHTML"),contactshtml:MediaListingTemplates.getHtml("ParticipantsSearchHTML"),chatshtml:Config.isSentMessageHistoryEnabled()?HistoryTemplate.searchAgentChatHTML:ConversationTemplates.getChatTemplate(),orgcontactshtml:MediaListingTemplates.getHtml("ParticipantsSearchHTML"),replacecontentonsuccesscallback:!0,allstatuscontacts:!0,emptycallback:function(){SearchField.displayNoResultFound(MediaDomIDS.ADD_PARTICIPANT_SEARCH,e)},clearcallback:function(){SearchField.displayNoResultFound(MediaDomIDS.ADD_PARTICIPANT_SEARCH,e)},groupingmode:0})),i&&($("#"+MediaDomIDS.ADD_PARTICIPANT_LIST).removeClass("dflxjustcent").find("[purpose=search]").first().addClass("sel"),t.find("[remchat]").each((function(){$(this).children().first().addClass("list-img posl")}))),s&SearchAgent.CHATHISTORY+SearchAgent.CHANNELS&&a.addConversationDom(currentChid,l),i},handleKeyUp:function(e){if(e.which===$zcg.ESCAPE_KEYCODE){var t=$("#"+MediaDomIDS.ADD_PARTICIPANT_SRCHFLD),i=t.attr("id"),a=i.substr(0,i.indexOf("-search-field"));t.html()?(SearchField.clearSearchField(a),$("#Mediafilter-addparticipants-list").html('<div id="imgloading" class="zcldng" style="display: block;"></div>'),SearchField.populateDefaultResult(a)):(Clickoutside.clear(a),$("#"+a).hide().siblings().find("#addparticipants").removeClass("active"))}},handleAction:function(e,t){if(t.length){var i=$("#"+MediaDomIDS.ADD_PARTICIPANT_SELECTION);if(i.children().length<100){var a,d={},s=t.attr("uid");d=$.extend(RemindersUtil.getUserDetails(s),{remove_html:MediaListingTemplates.getHtml("removeImgNodeHTML")}),RemindersUtil.validateUser(t,s),$("#selremparticipants").removeClass("dN"),$("#"+MediaDomIDS.APPLY_SHAREDBY_FILTERBTN).removeClass("dN"),i.find("#selremparticipants").show(),$("#"+MediaDomIDS.ADD_PARTICIPANT_RESULT).addClass("rempptsel"),$("#"+MediaDomIDS.APPLY_SHAREDBY_FILTERBTN).show().text(Resource.getRealValue("sticky.calender.apply"));var n=this.getTempSearchType();$("#saveAddedParticipants").attr("data-type",n);if("CHATS"==n){d={};var r=t.attr("chid");this.ignoreList.push(r),d=RemindersUtil.getChatDetails(r);var l=ConversationsList.get(r),c=HistoryUI.getRecipantsPhoto(l.recipants,l.pcount,l.addinfo,l.title,l.ctype,r,l.customgroup,!1,{needZcfIcon:!0,needRoundedCorner:!0});d.footerImgHTML=c,d.removeHTML=HistoryViewUtils.getChatRemoveTemplate(r,"removeSelectedChats");l.title;a=HistoryViewUtils.getImageOfChats(r,!0)}else if("USERS"==n)this.ignoreList.push(s),d.remove_html=$WC.template.replace(d.remove_html,{uid:s}),a=$WC.template.replace(MediaListingTemplates.getHtml("imgNodeHTML"),d,"InSecureHTML");else{a=$WC.template.replace(MediaListingTemplates.getHtml("imgNodeHTML"),d,"InSecureHTML")}i.append(a),SearchField.clearSearchField(MediaDomIDS.ADD_PARTICIPANT_SEARCH)}else UI.updateBanner(Resource.getRealValue("reminders.participantcount.error","100"),1e3,!0)}},populateDefaultResult:function(){this.search("*")||this.displayNoResultFound(void 0,Resource.getRealValue("common.nomorecontacts.error"))},displayNoResultFound:function(e,t){e=$WC.$CUtil.processXSS(e);var i=$("#"+MediaDomIDS.ADD_PARTICIPANT_LIST),a='<div class="zcempty-con">{{IMGDIV}}<div class="zcempty-title font14">{{NORESULTTEXT}}</div>';void 0!==e&&"*"!==e?(a=$WC.template.replace(a,{IMGDIV:"<div class='zcempty-img no_such_user'></div>",NORESULTTEXT:Resource.getRealValue("reminders.noresults.error",[e])},"InSecureHTML"),i.html(a)):(a=$WC.template.replace(a,{IMGDIV:"",NORESULTTEXT:t}),i.html(a))}},d=function(i){var a=$("#dateFilterDisplay"),d=$("#dateFilterTxt");$("#date-picker-dom").addClass("date_display").addClass("datefil-bdr"),a.addClass("ml-filterdate");var s=new Date(e),n=new Date(t);i?"specific"===_currDateFilter?d.text(s.getDate()+" . "+(s.getMonth()+1)+" . "+s.getFullYear()%100):d.text(s.getDate()+"."+(s.getMonth()+1)+"."+s.getFullYear()%100+" - "+n.getDate()+"."+(n.getMonth()+1)+"."+n.getFullYear()%100):d.text(Resource.getRealValue("date."+_currDateFilter))},s=function(e){var t=_currChatID||def_id;AppliedFilter[t]&&AppliedFilter[t][e]&&(delete AppliedFilter[t][e],e===MediaListConstants.SEARCH?search_value="":e===MediaListingFilters.USER_IDS&&(n(MediaListConstants.ALL),$("#filter_txt").text(Resource.getRealValue("common.all")),delete AppliedFilter[t][MediaListingFilters.USER_IDS])),e===MediaListingFilters.DATE_FILTER&&($("#"+_currDateFilter+"sel").addClass("dN"),_currDateFilter="",AppliedFilter[t]&&(delete AppliedFilter[t][MediaListConstants.TOTIME],delete AppliedFilter[t][MediaListConstants.FROMTIME])),e||(AppliedFilter[t]={},_isFilterApplied[t]=!1,MediaListingUI.updateListUI()),_isFilterApplied[t]=_(),AppliedFilter[t][MediaListConstants.FETCHCOMPLETE]=!1,AppliedFilter[t][MediaListConstants.LMTIME]="",isForwardEnabled&&r(),_isFilterApplied[t]?MediaListingUI.showMediaWFilters():$("#recording_category").length>0||"recording"===_currTypeFilter?MediaListingUI.handleRecordingFilter(AppliedFilter[t]):MediaListingUI.callMediaAPI(MediaListingUI.updateListUI,_currTypeFilter)},n=function(e){$("#"+_currSharedByFilter+"sel").addClass("dN"),_currSharedByFilter=e,$("#"+_currSharedByFilter+"sel").removeClass("dN")},r=function(e){for(var t,i,a=$(".forward_sel"),d=a.length,s=0;s<d;s++)t=$(a[s]).attr("uid"),i=$(a[s]).attr("msguid"),-1===SelectedItems.indexOf(t)&&SelectedItems.unshift(t),-1!==ForwardParamMsguids.indexOf(i)||$WC.Util.isEmpty(i)||ForwardParamMsguids.unshift(i);if(e)return ForwardParamMsguids},l=function(e){$('[data-action="open_attachment"]').removeClass("curN"),$(".forward_sel").removeClass("forward_sel"),$('[data-name="frwrd_input"]').removeAttr("checked"),$('[data-name="forward_selection"]').addClass("dN"),$('[data-name="grid_options"]').removeClass("hide"),$('[data-name="icon_dom"]').removeClass("vsbH"),$('[data-name="empty_dom"]').removeClass("curN"),$('[data-name="list_item"]').attr("data-action","open_attachment"),$('[data-name="load"]').removeClass("mL25"),$("#chatwindropdown").addClass("dN"),$("[previewelem]").removeClass("curN"),SelectedItems=[],ForwardParamMsguids=[],SELECTED_LEN=0,isForwardEnabled=!1,e&&UI.updateBanner(Resource.getRealValue("chat.attachment.forward.success"),2e3)},c=function(){isForwardEnabled=!0,$("[previewelem]").addClass("curN"),$('[data-name="list_item"]').attr("data-action","selFrwdItem"),$('[data-name="load"]').addClass("mL25"),$('[data-name="empty_dom"]').addClass("curN"),$('[data-name="forward_selection"]').removeClass("dN"),$('[data-name="grid_options"]').addClass("hide"),$('[data-name="icon_dom"]').addClass("vsbH"),"link"===_currTypeFilter&&$('[data-action="open_attachment"]').addClass("curN")},o=function(e,t){Clickoutside.handleClickOnChild(e);var i=t.dataset.uid,a=t.dataset.chid||_currChatID,d=$("#dropdown_icon_"+i).parents("[fname]");if("link"===_currTypeFilter)return $("#dropdown_icon_"+i).addClass("forward_sel"),void MessageOperations.forward.initUI(a,t);$("#lhs-context-menu").remove();var s={url:d.attr("url"),previewUrl:d.attr("preview_url"),content:d.attr("contenttype"),chid:d.attr("chid"),fname:d.attr("fname"),isv1:"true"===d.attr("isv1"),msguid:d.attr("msguid")};FileForwardUI.handle(s.chid,s.content,s.url,s.fname,s.comment,s.isv1,"true"===d.attr("hasthumbnail"),{source_msguid:s.msguid,source_chid:s.chid,elemholder:d})},m=function(e){return{chid:$(e).attr("chid"),time:$(e).attr("senttime"),mtype:$(e).attr("mtype"),msguid:$(e).attr("msguid"),sender:$(e).attr("fsender"),ismymsg:WmsImpl.isLocalUser($(e).attr("fsender")),uid:$(e).attr("uid")}},_=function(){var e=_currChatID||def_id;for(filter in AppliedFilter[e])if("fetchComplete"!==filter&&"next_token"!==filter&&"lmTime"!==filter&&$WC.Util.isEmpty(AppliedFilter[e][filter]))return!0;return!1},p=function(i,a,d){var s=d?$Util.getSyncedCurrentTime()-864e5:$Util.getSyncedCurrentTime(),n=new DateTimeWidget(a,{setButtonNeeded:!1,time:!1,range:{to:s},preview:!1}),r=new Date(s);r.setHours(0,0,0,0);var l=r.getDate()+" "+$Date.getMonthString(r.getTime(),!0)+" "+r.getFullYear()%100,c=d?"fromdate":"todate";"elemCalender1"===a?(e=r.getTime(),$('[data-name="custom_fil_cal"]').addClass("active")):"elemCalender3"===a?(e=r.getTime(),t=r.getTime()+86399e3,$('[data-name="specific_fil_cal"]').addClass("active")):t=r.getTime()+86399e3,$("#"+c).text(l),$("#customapplybtn").attr("customdate",l),n.handleModify=function(){var i=this._getParentContainer();r=this.getSelection();var d=$("#range_error");"elemCalender1"===i[0].id?(c="fromdate",e=r.getTime()):"elemCalender3"===a?(e=r.getTime(),t=r.getTime()+86399e3):(c="todate",t=r.getTime()+86399e3);var s=r.getDate()+" "+$Date.getMonthString(r.getTime(),!0)+" "+r.getFullYear()%100;$("#"+c).text(s);var n=$(i).find(".datepickerSelected")[0];if(e>t)d.removeClass("dN"),d.css("animation"," animateUp 1s").addClass("p10"),$("#customapplybtn").attr("disabled",""),$(n).addClass("clr-R"),$("#"+c).addClass("clr-R");else{d.css("animation"," animateDown 1s").removeClass("p10"),d.addClass("dN"),$("#customapplybtn").removeAttr("disabled");var l=$(".datepickerSelected")[0],o=$(".datepickerSelected")[1];$(l).removeClass("clr-R"),$(o).removeClass("clr-R"),$("#todate").removeClass("clr-R"),$("#fromdate").removeClass("clr-R"),$("#"+c).removeClass("clr-R")}},n.initialize(r)},u={keyup:{renameRecording:function(e){e.which===$zcg.ENTER_KEYCODE&&MediaListingUI.handleRenameRecording($(e.target))}},focusout:{renameRecording:function(e){MediaListingUI.handleRenameRecording($(e.target))}}};return{handleClick:function(e){var t=e.target;if("file_upload"!==t.id||StorageLimitHandler.isFileUploadAllowed()){if(void 0===t.dataset.action&&(t=e.target.closest("[data-action]")),t&&t.dataset.action){var a=t.dataset.action;"function"==typeof i[a]&&i[a](t,e)}}else e.preventDefault()},handleKeyup:function(e){e.stopImmediatePropagation();var t=_currChatID||def_id,i=e.target;if(e.which!==$zcg.ESCAPE_KEYCODE||$WC.Util.isEmpty(search_value))if(search_value=i.value,$WC.Util.isEmpty(search_value)){if(!AppliedFilter[t].search||""===AppliedFilter[t].search)return;s(MediaListConstants.SEARCH)}else isForwardEnabled&&r(),AppliedFilter[t]=AppliedFilter[t]||{},AppliedFilter[t][MediaListConstants.SEARCH]=search_value,AppliedFilter[t][MediaListConstants.LMTIME]="",MediaListingUI.showMediaWFilters();else s(MediaListConstants.SEARCH)},handleContainerEvent:function(e){var t=e.target;if(t&&t.dataset.action){var i=e.type,a=t.dataset.action;u[i]&&"function"==typeof u[i][a]&&u[i][a](e)}},addParticipants:a,handleScroll:function(e){e.stopImmediatePropagation();var t=$("#lhs-context-menu")[0];if(t){var i=t.dataset.uid;$("#"+_viewMode+"_item_"+i).removeClass("active"),Clickoutside.clear("lhs-context-menu"),t.remove()}ZCScroll.isScrollDown($("#ml-data-container")[0])&&($("#recording_category").length||"recording"===_currTypeFilter?MediaListingUI.recordingListScroll():MediaListingUI.mediaListScroll(e))},jumpToMessage:function(e,t){Clickoutside.handleClickOnChild(e);t.dataset.uid;var i=t.dataset.chid,a=$(t).attr("msguid");t.dataset.type;Chat.jumpToConversation(i,!1,a),$("#main_container_dom").hide().html(""),$WC.$Win.destroy(MediaDomIDS.WIN_ID),isFromCwin&&ChannelTabsUI.switchToMessagesTab(i)},removeAllFilter:s,openMoreMediaActions:function(e,t){Clickoutside.handleClickOnChild(e);var i=t.dataset.uid,a=t.dataset.chid,d=$(t).attr("msguid"),s=ChatUI.getWin(a).getExactMessageByMsguid(d),n=$("#dropdown_icon_"+i).parents("[url]");s.then((function(t){t.message?MessageActionsUI.createWin(n,e):UI.updateBanner(Resource.getRealValue("message.replied.doesnotexist"),2e3,!0)}))},replyFromGallery:function(e,t){Clickoutside.handleClickOnChild(e);var i=t.dataset.uid,a=$("#dropdown_icon_"+i).parents("[fname]"),d=t.dataset.chid||_currChatID,s=$(t).attr("msguid");if(isFromLHS)Chat.jumpToConversation(d,!1,s),$("#main_container_dom").hide().html(""),MessageOperations.handle.reply(d,a,e),$(a).removeAttr("purpose");else{var n=ChatUI.getWin(d).getExactMessageByMsguid(s);ChannelTabsUI.switchToMessagesTab(d);n.then((function(t){if(t.message)return MessageOperations.handle.reply(d,a,e),$(a).removeAttr("purpose"),void $WC.$Win.destroy(MediaDomIDS.WIN_ID);UI.updateBanner(Resource.getRealValue("message.replied.doesnotexist"),2e3,!0)}))}$("#lhs-context-menu").remove()},enableSelection:c,clearSelection:l,forwardMultipleMedia:function(e){return{ids:r(!0),sid:WmsImpl.getSid()}},galleryAttDelete:function(e,t){Clickoutside.handleClickOnChild(e);var i=t.dataset.uid,a=t.dataset.chid||_currChatID,d=$("#dropdown_icon_"+i).parents("[mtype]");if(!$WC.Util.isEmpty(i))var s=i.split("_")[1];var n=d.attr("msguid");MessageOperations.delete.createwin(a,n,s,(function(){MediaActions.HandleDeleteMedia(a,n,_currTypeFilter)}),d)},copyLink:function(e,t){Clickoutside.handleClickOnChild(e);var i=t.dataset.uid,a=$("#dropdown_icon_"+i).parents("[url]").attr("url");$Util.copyTextToClipboard(a,(function(){UI.updateBanner(Resource.getRealValue("channel.link.copied"))}))},galleryAttForward:function(e,t){if(isFromLHS)o(e,t);else{Clickoutside.handleClickOnChild(e);var i=t.dataset.uid;$("#dropdown_icon_"+i).parents("#att_actions").addClass("forward_sel"),$("#frwdmsginfo_"+i)[0].checked=!0,c();var a=t.dataset.chid,d=t.getAttribute("msguid"),s=MsgUtil.isTheMsgForwardedWithoutSenderInfo({chid:a,msguid:d}),n='<div id="chatwindropdown" class="chateditrmn zceditrsndfile w100 bdrR5"><div class="msgoptioncontrol-v2 flex fdirC {{FORWARD_INFO_CLASS}}" {{FORWARD_INFO_ATTRIBUTE}}><div class="flexC"><div class="zcf-close zcl-icon-sm zcl-icon--default" data-action="fwdclose"></div><div class="flexG flexC mLR20 ovrflwH"><div class="fshrink font20 mR5 fontB"><span class="clr-theme" id="msgselectcnt">1/25</span></div><div class="font16">{{SELMSGINFO}}</div></div><div class="zcl-btn-xs zcl-btn--primary" data-action="forwarditem">{{FORWARDBTNMSG}}</div></div><div class="flexC zcl-hor-dash-divider mT12">{{FORWARDOPTN_CHECKBOX}}</div></div></div>';n=$WC.template.replace(n,{FORWARDOPTN_CHECKBOX:FileForwardUI.forwardOptionInstance.getFrwdTraceCheckBox("mT10",void 0,{chid:a,msguid:d}),FORWARD_INFO_CLASS:s||FileForwardUI.hasAdminForcedForwardInfo()?"forward-info-admin-forced":"",FORWARD_INFO_ATTRIBUTE:s?"hide-forward-info":""},"InSecureHTML"),n=$WC.template.replace(n,{$ALLOWFORWARDMSGINFO:"common.allowforwardmsg.info",$FORWARDBTNMSG:"common.forward.to",$SELMSGINFO:"common.forwardmsg.selected",$MORE:"message.option.appoptions"}),$("#forwardselector").html(n).css("display","block")}},handleClickEventDelegation:i,handleRecordingClickEventDelegation:{view_meeting_info:function(e){ZCTrack.track("VIEW_MEETING_INFO_FROM_RECORDING"),MediaListingUI.showMeetingInfo(e)},copy_recording_permalink:function(e){MediaListingUI.copyRecordingPermalink(e)},rename_recording:function(e){MediaListingUI.handleRenameRecording(e)},delete_recording:function(e){MediaListingUI.handleDeleteRecording(e)},leave_recording:function(e){MediaListingUI.handleLeaveRecording(e)},share_recording:function(e){MediaListingUI.handleShareRecording(e)},revoke_recording:function(e){MediaListingUI.handleRevokeRecording(e)},recording_link_dropdown:function(e){var t=e.attr("uid");Clickoutside.bind({srcid:"recordinglinkelem"+t,destid:"recordinglinkoptions"+t})},show_create_edit_recording_link_win:function(e){MediaListingUI.showCreateEditRecordingLinkWin(e)},delete_recording_link_consent:function(e){MediaListingUI.showDeleteRecordingLinkConsent(e.attr("uid"))},delete_recording_link:function(e){MediaListingUI.deleteRecordingLink(e)},show_recording_link_expiry_date_picker:function(e){var t=$("#rec-link-expiry-date-picker");t.is(":visible")?t.zdatepicker("close"):t.zdatepicker("open")},handle_recording_link:function(e){MediaListingUI.handleCreateEditRecordingLink(e)},verify_recording_link_password:function(e){Conference.verifyRecordingLinkPassword(e)},copy_recording_link:function(e){MediaListingUI.handleCopyRecordingLink(e)},toggle_password_visibility:function(e){MediaListingUI.handlePasswordVisibility(e)}}}}(),MediaListingView={openUI:function(e,t){MediaListingUI.showPopup(e,t),UI.handlePreFetch()}},MediaListingTemplates=function(){var e={header_html:'<div class="fontB font16 clr-H flexC"><div class="flexC"><div class="mL10 ml-hdr-img mR10">{{chat_img_html}}</div>{{chat_name}}</div></div>',all_header_html:'<div class="main-container-header ovrflwH fshrink"><div class="w100 justifySB flexC pTB10"><div class="font17 fontB"><div class="fontB font16 clr-H flexC"><div class="flexC"><div class="mL10 ml-hdr-img mR10 item-icn zcf-mediagallery"></div>{{chat_name}}</div></div></div><div id="win-category-header" class="fshrink flexG flexM">{{category_filter}}</div><div class="fshrink mL12 dN"><span class="ellips"> Upload New </span><form id="upload" type="html5" enctype="multipart/form-data"><input type="file" multiple name="file1" class="sendfile" id="file_upload"></form></div></div></div>',container_modal:'<div class="h100">{{body_container}}</div>',container_body_html:'<div id="list_container" class="flex fdirC h100 ovrflwA medialist-container-body">{{tab_menu}}{{actions_band_html}}<div id="ml-data-container"  zc_sticky_title_list  data-uid="{{chid}}" class="{{view_cls}} ovrflwA ml-data-container flexG">{{data_container}}</div></div><div id="forwardselector" class="dN flexC justifySB fshrink posa multipleforward"></div>',search_input_html:'<div  id="ml_search" class="zcl-search ml-search"><div id="ml_search_icon" class="zcl-seach-icon zcf-search2 zcl-icon--default" data-action="showSearchInput"></div><div class="zcl-search-input flexC"><input id="ml_search_input" type="text" type="text" placeholder="{{search_placeholder}}"><span data-action="clearSearch" class="zcl-search-clear">{{clear_txt}}</span></div><div data-action="hideSearch" class="zcl-seach-close zcf-close clr-icon font10 zcl-dropdown-divider"></div></div>',action_band_html:'<div class="flexC justifySB ml-actn-band fshrink">{{sticky_date}}{{actions_filter_html}}</div>',shared_by_html:'<div id="sharedByDrpdwn" data-action="show_drpdwn_options" class="drpdwn-input fshrink drpdwn-wrp mLR20 mlsharedby flexC posrel"><div class="flexC"><div id="ml_sharedby_txt" class="clr-lp1 font13 clr6">{{shared_txt}}:</div><div  class="mL8 flexC"><div id="filter_txt" class="selectedusers clr-H font13">{{all_txt}}</div><em class="mL8 clr-icon zcf-downArrow font10"></em><div id="sharedByOptns" class="zcl-menu-wrap posa no-pointer hide"><div class="zcl-menu-item justifySB" data-chid = "{{chid}}" data-uid = "{{uid}}" data-action="removeUserFilter">{{all_txt}} <em id="allsel" class="clrG msi-tick p5"></em></div><div class="zcl-menu-item justifySB" data-chid = "{{chid}}" data-uid = "{{sender_id}}" data-action="filterMediaByUserId">{{you_txt}} <em id="byCurrUsersel" class="clrG msi-tick dN p5"></em></div>{{option_html}}</div></div></div></div>',shared_by_channel_html:'<div class="posabs"><div></div><div>',actions_filter_html:'<div class="flexC flexG mL20 justifyE">{{search_input_html}}{{shared_by_html}}<div class="posrel flexC {{hide_filter_cls}}"><div id="date-picker-dom" data-action="show_drpdwn_options" class="flexC"><div id="dateFilterDisplay" class="date-filter-display flexC justifySB zcl-icon"><div id="dateFilterTxt" class="datefil_txt"></div><div data-action="removeDateFilter" class="zcf-close clr-icon font10  h100 flexC p5"></div></div><div class="drpdwn-wrp zcl-icon zcl-icon--default posrel ml-date"><em class="zcf-calendar p10"></em></div></div><div id="dateFilterOptns" class="zcl-menu-wrap posa no-pointer hide"><div id="today" class="zcl-menu-item justifySB" data-chid = "{{chid}}" data-uid = "{{uid}}" data-action="Datedropfilters">{{today_txt}} <em id="todaysel" class="clrG msi-tick dN p5"></em></div><div id="yesterday" class="zcl-menu-item justifySB" data-chid = "{{chid}}" data-uid = "{{sender_id}}" data-action="Datedropfilters">{{yesterday_txt}} <em id="yesterdaysel" class="clrG msi-tick dN p5"></em></div><div id="last7" class="zcl-menu-item justifySB" data-chid = "{{chid}}" data-uid = "{{sender_id}}" data-action="Datedropfilters">{{last7_txt}} <em id="last7sel" class="clrG msi-tick dN p5"></em></div><div id="last30" class="zcl-menu-item justifySB" data-chid = "{{chid}}" data-uid = "{{sender_id}}" data-action="Datedropfilters">{{last30_txt}} <em id="last30sel" class="clrG msi-tick dN p5"></em></div><div id="specific_fil" class="zcl-menu-item justifySB" data-chid = "{{chid}}" data-uid = "{{sender_id}}" data-action="dateFilter">{{specific_txt}} <em id="specificsel" class="clrG msi-tick dN p5"></em></div><div id="custom_fil" class="zcl-menu-item justifySB" data-chid = "{{chid}}" data-uid = "{{sender_id}}" data-action="dateFilter">{{custom_txt}} <em id="rangesel" class="clrG msi-tick dN p5"></em></div></div>{{calendar_html}}</div><div data-action="switchListView" data-uid="{{chat_id}}" title="{{icon_txt}}" class="zcl-icon ml-icon mL20 zcl-icon--default"><em id="view_switch_icon" class="{{icon_cls}} flexC"></em></div></div>',calender_container_html:'<div id="calenspc" class="zcl-popup daterange-popup mediarange-popup dN" purpose="calenderAreaClick"><div id="calender_container"></div><div class="daterange-aside"><div id="today" class="zcl-menu-item justifySB" data-chid = "{{chid}}" data-uid = "{{uid}}" data-action="Datedropfilters">{{today_txt}} <em id="todaysel" class="clrG msi-tick p5 dN"></em></div><div id="yesterday" class="zcl-menu-item justifySB" data-chid = "{{chid}}" data-uid = "{{sender_id}}" data-action="Datedropfilters">{{yesterday_txt}} <em id="yesterdaysel" class="clrG msi-tick dN p5"></em></div><div id="last7" class="zcl-menu-item justifySB" data-chid = "{{chid}}" data-uid = "{{sender_id}}" data-action="Datedropfilters">{{last7_txt}} <em id="last7sel" class="clrG msi-tick dN p5"></em></div><div id="last30" class="zcl-menu-item justifySB" data-chid = "{{chid}}" data-uid = "{{sender_id}}" data-action="Datedropfilters">{{last30_txt}} <em id="last30sel" class="clrG msi-tick dN p5"></em></div><div id="specific_fil" data-name="specific_fil_cal" class="zcl-menu-item justifySB" data-chid = "{{chid}}" data-uid = "{{sender_id}}" data-action="dateFilter">{{specific_txt}} <em id="specificsel" class="clrG msi-tick dN p5"></em></div><div id="custom_fil" data-name="custom_fil_cal" class="zcl-menu-item justifySB" data-chid = "{{chid}}" data-uid = "{{sender_id}}" data-action="dateFilter">{{custom_txt}} <em id="rangesel" class="clrG msi-tick dN p5"></em></div></div></div>',calender_range_html:'<div id="calender1" class="daterange-section"><div class="flexC bdr-right"><div id="cal1" class="w100"><div class="mlcalender-head bdr-right">{{from_txt}}</div><div id="elemCalender1" class="daterange-main flexG dN bdr-right"></div></div><div id="cal2" class="w100"><div class="mlcalender-head">{{to_txt}}</div><div id="elemCalender2" class="daterange-main flexG"></div></div></div><div class="daterange-footer fshrink flexC  bdr-right"><div id="range" class="flexG flexC"><div class="flexC"><em id="from_txt" class="fontB pLR5 clr-S">{{from_txt}}: </em><em id="fromdate" class="clr-S "></em><em id="to_txt" class="pLR5 clr-S fontB">{{to_txt}}:</em><em id="todate" class="clr-S"></em></div><div id="range_error" class="dN range-error clr-red flexG pLR10">({{range_err_txt}})</div></div><div class="fshrink"><div id="customapplybtn" filter="range" class="zcl-btn-sm zcl-btn--primary zcl-btn" data-action="applyCustomDateFilter">{{apply_txt}}</div></div></div></div>',calender_specific_html:'<div id="calender2" class="daterange-section datespecific-section"><div id="cal3"><div id="elemCalender3" class="daterange-main flexG"></div></div><div class="daterange-footer fshrink flexC"><div id="range" class="flexG flexC"><div id="specific_ftxt" class="mR5 clr-S fontB">{{date_txt}}:</div><em id="todate" class="clr-S"></em></div><div class="fshrink"><div id="customapplybtn" filter="specific" class="zcl-btn-sm zcl-btn--primary" data-action="applyCustomDateFilter">{{apply_txt}}</div></div></div></div>',api_failure_html:'<div class="flexM h100 w100"><div class="flexC fdirC"><div class="zcempty-img error_img"></div><div class="zcempty-title font18 mB30">{{api_error_txt}}</div><div data-action="getMediaAftApiErr" class="justifyC zcl-btn zcl-btn--primary">{{btn_txt}}</div></div></div>',type_filter_html:'<div id="type_filters" class="flexM {{tab_cls}}">{{categories_html}}</div>',type_filter_item_html:'<div data-type="{{item_type}}" {{tabSelected}} data-action="selectCategory" class=" {{tab_class}} {{selected}} font14 fontB curP">{{item_txt}}</div>',empty_state:'<div class="flexM h100 w100"><div class="flexC fdirC mB30"><div class="ml-empty-image {{image_class}}"></div><div class="mT30 line30 font18 clr-S textC flexC fdirC"><div>{{empty_txt1}}</div><div>{{empty_txt2}}</div></div></div></div>',no_search_result:'<div class="flexM h100 w100"><div class="flexC fdirC"><div class="search_empty"></div><div class="mT30 line30 font18 clr-S textC">{{no_result_txt}}</div></div></div>',no_filter_result:"<div></div>",view_by_dropdown:"<div></div>",view_by_dropdown_list:"<div></div>",selection_html:'<label id="selItem" uid={{uid}} class="w100 flexIC curP"><div class="zcl-checkbox w100"><input id="frwdmsginfo_{{uid}}" data-name="frwrd_input" type="checkbox" data-uid="{{uid}}" ><span class="zcf-tick flexM"></span></div></label>',grid_image_item_html:'<div id="grid_item_{{uid}}" data-action="open_attachment" class="ml-grid-item curP posrel"><div data-name="item_cont" class="h100 w100 posrel zhshare-src" data-zhshare-src-meta=\'{{SRC_META}}\' data-zhshare-src-fName="{{img_name}}" chid="{{chid}}" mtype="20" uid="{{uid}}" fname="{{img_name}}" fsize="{{size}}" msguid="{{msguid}}" fsender="{{fsender}}" msgtime="{{time}}" senttime="{{time}}" bytefilesize="{{file_size}}" fsendername="{{sender}}" fcomment="{{fcomment}}" isv1="{{isv1}}" hasthumbnail="{{hasthumbnail}}" contenttype="{{content}}" url="{{url}}" preview_url="{{url}}" ><div id="grid_options" data-name="grid_options" msguid="{{msguid}}" class="grid_options posabs h100 flex dN flexS justifySB p10 {{forward_hide}}"><div id="user_image" data-uid = "{{uid}}" data-chid = "{{chid}}" title="{{sender}}" data-action="user_details" class="ml-list-img flexM" >{{chat_img_url}} </div><div id="att_actions" class="flexC ml-icon_dom" msguid="{{msguid}}" uid="{{uid}}" data-chid = "{{chid}}">{{download_html}}<div id="dropdown_icon_{{uid}}" data-type="grid" data-action="show_drpdwn_options" title="{{more_txt}}" msguid="{{msguid}}" data-chid = "{{chid}}" data-uid = "{{uid}}" class="zcimg-actn-btn p5 mL8 curP  textC ml-drpdwm_menu"><em class="zcf-more"></em></div></div></div><div data-name="forward_selection" data-uid="{{uid}}" msguid="{{msguid}}" class="{{hide_selector}} posa h100 w100 mT5 " data-action="selFrwdItem">{{selection_html}}</div><div id="load" class="loadicon flexM grid_options posabs h100"><span class="{{loadIcon}}"></div><div id="img_dom"><div previewelem id="imgpreview" data-chid = "{{chid}}" data-uid = "{{uid}}" data-width="{{original_width}}" data-height="{{original_height}}" msguid="{{msguid}}" sender="{{sender}}" hasthumbnail="{{hasthumbnail}}" previewfilesrc="{{original_url}}" filetype="{{file_type}}" filesrc="{{original_url}}" isv1="{{isv1}}" contenttype="{{content}}" fname="{{img_name}}" chid="{{chid}}" tempsrc="{{img_view_url}}" originalsrc="{{img_view_url}}" class="{{item_class}} vsbH" ></div></div><span id="empty_thumb" data-name="empty_dom" class="dN ml-emptygrid-item flexM p12"><span class="{{hide_cls}} ml-file-default ellips">{{file_type}}</span></span>{{footer_html}}</div></div>',media_download_html:'<div id="download_icon"  documentclick="attdownload" data-action="download_attachment" title="{{download_txt}}" data-chid = "{{chid}}" data-uid = "{{uid}}" class="zcimg-actn-btn p5 mL8 curP "><em class="zcf-download"></em></div>',grid_image_disabled_html:'<div id="grid_item_{{uid}}" class="ml-grid-item curP posrel" style="border: 1px solid var(--color-theme);"><div data-name="item_cont" class="h100 w100 posrel " chid="{{chid}}" mtype="20" uid="{{uid}}" fname="{{img_name}}" fsize="{{size}}" msguid="{{msguid}}" fsender="{{fsender}}" msgtime="{{time}}" senttime="{{time}}" bytefilesize="{{file_size}}" fsendername="{{sender}}" isv1="{{isv1}}" hasthumbnail="{{hasthumbnail}}" contenttype="{{content}}" url="{{url}}" preview_url="{{url}}" ><div class="flexM fview-disbld" style="height: 100%; border: none;" title="'+I18N("fileview.notallowed.tip")+'"><div class="flex p20"><div class="zcf-infoC mR8 mT2"></div><div class="font12">'+I18N("fileview.noaccess")+"</div></div></div></div></div>",grid_link_item_html:'<div id="grid_item_{{uid}}" class="ml-grid-item ml-list-grid curP posrel"><div data-name="item_cont" class="h100 w100 flex fdirC " chid="{{chid}}" fsize="{{size}}" uid="{{uid}}" fname="{{img_name}}" mtype="12" msguid="{{msguid}}" fsender="{{fsender}}" senttime="{{time}}" msgtime="{{time}}" bytefilesize="{{file_size}}" fsendername="{{sender}}" isv1="{{isv1}}" contenttype="{{content}}" url="{{link}}" preview_url="{{link}}" ><div  purpose="sender" msgtime="{{time}}" sender="{{fsender}}" data-chid = "{{chid}}" title="{{sender}}" fsender="{{fsender}}" nname="{{sender}}" class="dN"></div><div id="grid_options" data-name="grid_options" msguid="{{msguid}}" msgtime="{{time}}" class="grid_options posabs flex dN flexS justifySB p10 curN"><div id="user_image" data-uid = "{{uid}}" data-chid = "{{chid}}" title="{{sender}}" data-action="user_details" class="ml-list-img flexM" >{{chat_img_url}} </div><div id="att_actions" uid="{{uid}}" msguid="{{msguid}}" class="flexC ml-icon_dom curP"><div id="preview_icon_{{uid}}"  data-name="preview_icon" {{previewelem}} data-action="open_attachment" data-chid = "{{chid}}" contenttype="{{contenttype}}" thumbnailurl="{{thumbnail_url}}" url="{{link}}" preview_url="{{link}" orgsrc="{{link}}" src="{{iframe_src}}" data-uid = "{{uid}}" class="zcimg-actn-btn pT4 pB4 pL10 pR10 mL8 curP {{hide_preview}}">{{preview_txt}}</div><div id="dropdown_icon_{{uid}}" data-type="grid" data-action="show_drpdwn_options" title="{{more_txt}}" msguid="{{msguid}}" data-chid = "{{chid}}" data-uid = "{{uid}}" class="zcimg-actn-btn p5 mL8 curP  textC ml-drpdwm_menu"><em class="zcf-more"></em></div></div></div><div data-name="forward_selection" data-uid="{{uid}}"  msguid="{{msguid}}" class="{{hide_selector}} posa h100 w100 mT5" data-action="selFrwdItem">{{selection_html}}</div><div id="img_dom" msgtime="{{time}}" data-action="open_attachment"><div previewelem data-action="open_attachment" id="imgpreview" prevcomment="{{comment}}" contenttype="{{contenttype}}" data-chid = "{{chid}}" data-uid = "{{uid}}" msguid="{{msguid}}" sender="{{sender}}" previewfilesrc="{{img_view_url}}" filetype="{{file_type}}" filesrc="{{img_view_url}}" isv1="{{isv1}}" fname="{{img_name}}" chid="{{chid}}" tempsrc="{{img_view_url}}" src="{{img_view_url}}" class="{{item_class}} {{img_cls}}" ></div></div><span id="empty_thumb" class="dN ml-emptygrid-item flexM p15 curN"><span class="{{hide_cls}} ml-file-default ellips">{{file_type}}</span></span><div class="fshrink pT10 pB10 pR12 pL12 curP zc-link" title="{{link_name}}"><a href="{{link}}" target="_blank" rel="noopener noreferrer" class="clr-Link zc-link"><div class="w100 ml-link-display" link="{{link}}">{{link_name_display}}</div></a></div></div></div>',list_link_item_html:'<div id="list_item_{{uid}}" data-name="list_item" data-uid="{{uid}}" data-action="open_attachment" class="ml-list-item p10 curP"><div data-name="item_cont"  class="h100 w100 posrel flexC" chid="{{chid}}" mtype="12" uid="{{uid}}" fname="{{img_name}}" fsize="{{size}}" msguid="{{msguid}}" fsender="{{fsender}}" msgtime="{{time}}" senttime="{{time}}" bytefilesize="{{file_size}}" fsendername="{{sender}}" isv1="{{isv1}}" contenttype="{{content}}" url="{{link}}" preview_url="{{link}}" ><div data-name="forward_selection" data-uid="{{uid}}"  msguid="{{msguid}}" class="{{hide_selector}} flexC mR15" data-action="selFrwdItem">{{selection_html}}</div><div  purpose="sender" msgtime="{{time}}" sender="{{fsender}}" data-chid = "{{chid}}" title="{{sender}}" fsender="{{fsender}}" nname="{{sender}}" class="dN"></div><div id="img_dom" msgtime="{{time}}" data-action="open_attachment" ><div previewelem data-action="open_attachment" id="imgpreview" data-chid = "{{chid}}" data-uid = "{{uid}}" msguid="{{msguid}}" sender="{{sender}}" previewfilesrc="{{img_view_url}}" filetype="{{file_type}}" filesrc="{{img_view_url}}" isv1="{{isv1}}" fname="{{img_name}}" chid="{{chid}}" tempsrc="{{img_view_url}}" src="{{img_view_url}}" class="ml-thumbnail-image vsbH {{img_cls}}" ></div></div><span id="empty_thumb" class="dN ml-emptylist-item flexM p4 font12 curN fontB line12"><span class="{{hide_cls}}  ml-file-default ellips posa">{{file_type}}</span></span><div style="max-width:80%;" class=" mL10 font14 line16 flexG ellips zc-link"><a href="{{link}}" target="_blank" rel="noopener noreferrer" class="clr-Link zc-link">{{link_name_display}}</a></div><div id="user_image" data-uid = "{{uid}}" data-chid = "{{chid}}" title="{{sender}}" style="width:120px;" class="mL10 mR10 ml-list-img flexM fshrink" data-action="user_details" documentclick="viewprofileimage" >{{chat_img_url}} </div><div id="att_actions" msgtime="{{time}}" msguid="{{msguid}}" uid="{{uid}}" style="width:160px;" class="textR fshrink"><div id="time" data-chid = "{{chid}}" data-uid = "{{uid}}"  class="msg_time ml-filesize font12">{{displaytime}}</div><div id="icon_dom" data-name="icon_dom" msgtime="{{time}}" class="ml-icon_dom dN"><div id="preview_icon_{{uid}}" data-name="preview_icon" {{previewelem}} data-action="open_attachment" data-chid = "{{chid}}" contenttype="{{contenttype}}" thumbnailurl="{{thumbnail_url}}" url="{{link}}" preview_url="{{link}" orgsrc="{{link}}" src="{{iframe_src}}" data-uid = "{{uid}}" class="zcimg-actn-btn pT6 pB4 pL10 pR10 mL8 curP {{hide_preview}}">{{preview_txt}}</div><div id="dropdown_icon_{{uid}}" data-type="list" title="{{more_txt}}" data-action="show_drpdwn_options" msguid="{{msguid}}" data-chid = "{{chid}}" data-uid = "{{uid}}" class="zcimg-actn-btn p5 mL8 curP  textC ml-drpdwm_menu"><em class="zcf-more"></em></div></div></div></div></div>',list_image_item_html:'<div id="list_item_{{uid}}" data-name="list_item" data-action="open_attachment" data-chid = "{{chid}}" data-uid = "{{uid}}" class="ml-list-item p10 curP" ><div data-name="item_cont" class="h100 w100 posrel flexC" chid="{{chid}}" uid="{{uid}}" msguid="{{msguid}}" mtype="20" fname="{{img_name}}" msgtime="{{time}}" senttime="{{time}}" fsize="{{size}}" fsender="{{fsender}}" hasthumbnail="{{hasthumbnail}}" content="{{content}}" fsendername="{{sender}}" isv1="{{isv1}}" url="{{url}}" contenttype="{{content}}"  preview_url="{{url}}"><div data-name="forward_selection" data-uid="{{uid}}"  msguid="{{msguid}}" class="{{hide_selector}} flexC mR15" data-action="selFrwdItem">{{selection_html}}</div><div id="load" data-name="load" class="loadicon ml-emptylist-item flexM posabs h100"><span class="{{loadIcon}}"></div><div id="img_dom"><div previewelem id="imgpreview" data-chid = "{{chid}}" data-uid = "{{uid}}" data-width="{{original_width}}" data-height="{{original_height}}" msguid="{{msguid}}"  contenttype="{{content}}"  hasthumbnail="{{hasthumbnail}}" previewfilesrc="{{original_url}}" filetype="{{file_type}}" filesrc="{{original_url}}" isv1="{{isv1}}" content="{{content}}" fname="{{img_name}}" chid="{{chid}}" tempsrc="{{img_view_url}}" src=""  originalsrc="{{img_view_url}}" class="ml-thumbnail-image vsbH" ></div></div><span id="empty_thumb" data-name="empty_dom" class="dN ml-emptylist-item flexM p4 font12 fontB line12 posrel"><span class="{{hide_cls}}  ml-file-default ellips posa">{{file_type}}</span></span><div id="image_det" data-chid = "{{chid}}" data-uid = "{{uid}}" class=" mL10 font14 line16 {{clr_cls}} flexG">{{img_name_display}}</div><div id="size"  data-chid = "{{chid}}" data-uid = "{{uid}}" style="width:75px;" class="fshrink line24 ml-filesize font12">{{size}}</div><div id="user_image" data-uid = "{{uid}}" data-chid = "{{chid}}" title="{{sender}}" style="width:120px;" class="mL10 mR10 ml-list-img flexM curN" data-action="user_details" documentclick="viewprofileimage" >{{chat_img_url}} </div><div id="att_actions" uid="{{uid}}"  msguid="{{msguid}}" style="width:160px;" class="textR"><div id="time" data-chid = "{{chid}}" data-uid = "{{uid}}"  class="msg_time ml-filesize font12">{{displaytime}}</div><div id="icon_dom" data-name="icon_dom" class="ml-icon_dom dN">{{download_html}}<div id="dropdown_icon_{{uid}}" data-type="list" title="{{more_txt}}" data-action="show_drpdwn_options" msguid="{{msguid}}" data-chid = "{{chid}}" data-uid = "{{uid}}" class="zcimg-actn-btn p5 mL8 curP  textC ml-drpdwm_menu"><em class="zcf-more"></em></div></div></div></div></div>',list_image_disabled_html:'<div id="list_item_{{uid}}" data-name="list_item" data-chid = "{{chid}}" data-uid = "{{uid}}" class="ml-list-item curP" ><div data-name="item_cont" class="h100 w100 posrel flexC" chid="{{chid}}" uid="{{uid}}" msguid="{{msguid}}" mtype="20" fname="{{img_name}}" msgtime="{{time}}" senttime="{{time}}" fsize="{{size}}" fsender="{{fsender}}" hasthumbnail="{{hasthumbnail}}" content="{{content}}" fsendername="{{sender}}" isv1="{{isv1}}" url="{{url}}" contenttype="{{content}}"  preview_url="{{url}}"><div class="flex fview-disbld" style="height: 100%; width:100%; border: none;" title="'+I18N("fileview.notallowed.tip")+'"><div class="flexC p10"><div class="zcf-infoC mR8 mT2"></div><div class="font12">'+I18N("fileview.noaccess")+"</div></div></div></div></div>",grid_video_item_html:'<div id="video_item_{{uid}}" class="ml-grid-item curP zchtmsgcnt" uid="{{uid}}" mtype="20" msguid="{{msguid}}" documentclick="open_attachment" chid="{{chid}}" fsender="{{fsender}}" msgtime="{{time}}" senttime="{{msgtime}}" fsize="{{fsize}}" fname="{{fname}}" fsendername="{{fsendername}}" url="{{url}}" hasthumbnail="{{hasthumbnail}}" isv1="{{isv1}}" content="{{content}}"><div data-name="item_cont" class="h100 w100 posrel flexC" draggable="true"><div data-name="forward_selection" data-uid="{{uid}}"  msguid="{{msguid}}" class="{{hide_selector}} h100 flex flexS posa w100" data-action="selFrwdItem">{{selection_html}}</div><div data-name="grid_options" msguid="{{msguid}}" class="grid_options posabs h100 flex dN flexS justifySB p10 curN"><div id="user_image" data-uid = "{{uid}}" data-chid = "{{chid}}" title="{{fsendername}}" data-action="user_details" class="ml-list-img flexM" >{{chat_img_url}} </div><div id="att_actions" uid="{{uid}}" msguid="{{msguid}}" class="flexC ml-icon_dom">{{download_html}}<div id="dropdown_icon_{{uid}}" data-type="video" data-action="show_drpdwn_options" title="{{more_txt}}" data-chid ="{{chid}}" data-uid = "{{uid}}" msguid="{{msguid}}" class="zcimg-actn-btn p5 mL8 curP  textC ml-drpdwm_menu"><em class="zcf-more"></em></div></div></div><div id="videoplayer" previewelem documentclick="viewattachment" fileid="{{FILEID}}" data-name="mediaListvideo" source="{{FILEURL}}" class="zcvideomn zcfilevw" draggable="true" poster="{{img_view_url}}" filetype="{{FILETYPE}}" contenttype="{{CONTENT}}" previewfilesrc="{{PREVIEWFILESRC}}" filesrc="{{FILEURL}}" hasthumbnail="false">{{CONTENTDIV}}</div></div></div>',appendImgHtml:'<img previewelem data-action="{{action}}" id="imgpreview" data-uid = "{{uid}}" data-width="{{original_width}}" data-height="{{original_height}}" msguid= "{{msguid}}" sender="{{sender}}" hasthumbnail="{{hasthumbnail}}" previewfilesrc="{{originalurl}}" filetype="{{filetype}}" filesrc="{{originalurl}}" isv1="{{isv1}}" chid="{{chid}}" tempsrc="{{thumbnail}}" contenttype="{{contenttype}}" fname="{{fname}}" src=""  originalsrc="{{thumbnail}}" rel="preload" class="{{type}} vsbH {{img_cls}} {{frw_hide_cls}}"/>',loading_state_html:'<div><div class="ml-items-cntr"><div class="{{grid_cls}}"><div class="{{item_class}}"></div><div class="{{item_class}}"></div><div class="{{item_class}}"></div><div class="{{item_class}}"></div><div class="{{item_class}}"></div><div class="{{item_class}}"></div></div></div><div class="ml-items-cntr"><div class="ml-hdr-ldr"></div><div class="{{grid_cls}}"><div class="{{item_class}}"></div><div class="{{item_class}}"></div><div class="{{item_class}}"></div><div class="{{item_class}}"></div><div class="{{item_class}}"></div><div class="{{item_class}}"></div><div class="{{item_class}}"></div><div class="{{item_class}}"></div></div></div></div>',date_seperater:'<div class="fshrink medialisting-sticky-title"><div id="date_seperater_{{id}}" {{sticky_title}} {{sticky_init}}="2" class="{{padding_cls}} fontB w100 ml-datesep line24 {{display_cls}}">{{date}}</div></div>',grid_footer_html:'<div id="details_footer_{{id}}" class="fshrink pT12 pB10 pR12 pL12 curP {{footer_disp}}"><div class="flexC mB5 font14"><em class="{{icon_cls}} ml-filename mR8 font13"></em><div class="ellips">{{img_name}}</div></div><div class="font12 ml-filesize">{{size}}</div></div>',dropdown_html:'<div id="lhs-context-menu" data-uid = "{{uid}}" style="position: fixed; z-index:1000"><div documentclick="context_menu_actions" class="zcl-menu-wrap no-pointer posrel">{{forward_dropdown_html}}<div class="zcl-menu-item ellips " data-chid = "{{chid}}" data-uid = "{{uid}}" msguid="{{msguid}}" data-action="jump_to_chat" documentclick="jumptomessage"><span class="ellips"><span class="zcf-gotochat zcl-menu-item-icn "></span>{{jump_to_chat}}</span></div><div class="zcl-menu-item ellips text-transC" data-chid = "{{chid}}" data-uid = "{{uid}}" msguid="{{msguid}}" data-action="replyFromGallery" documentclick="replyFromGallery"><span class="ellips"><span class="zcf-reply zcl-menu-item-icn "></span>{{reply}}</span></div><div class="zcl-menu-item ellips dN zcl-neg-menu-item" data-chid = "{{chid}}" data-uid = "{{uid}}" msguid="{{msguid}}" documentclick="attdeletefromgallery"><span class="ellips"><span class="zcf-delete zcl-menu-item-icn "></span>{{delete}}</span></div><div class="zcl-menu-item ellips dN" data-chid = "{{chid}}" data-uid = "{{uid}}" msguid="{{msguid}}" data-action="_copyLinkToClipboard" documentclick="copyLink"><span class="ellips"><span class="zcf-copy zcl-menu-item-icn "></span>{{copy}}</span></div></div></div>',forward_dropdown_html:'<div class="zcl-menu-item ellips"  data-action="forward_attachment" documentclick="attforwardfromgallery" msguid="{{msguid}}" data-chid = "{{chid}}" data-uid = "{{uid}}" ><span class="ellips"><span class="zcl-menu-item-icn zcf-forward "></span>{{forward_txt}}</span></div>',addParticipantsHTML:'<div id="{{search_entity}}" class="addparticipants zcrchmcnt"><div class="zccrin reminputbox flexC" data-action=""><em class="zcf-search mR5 clr8"></em><div id="{{search_entity}}-search-field" class="remsrchfield w100" contenteditable="true" type="text" name="" data-text="{{searchpholder}}"></div></div><div id="{{search_entity}}-results" class="rem-drpdwn-cnt"><div id="{{search_entity}}-list" class="posl zcht100"></div></div><div class="crchndcnt crchndcnt-edit dN" id="selremparticipants"><div id="usernodecnt" class="zcrchicnt"><div id="{{search_entity}}-select-field" class="floatl {{customClass}}"></div></div><div id="saveAddedParticipants" data-action="{{purpose}}" title={{add}} class="windwbtn dIB cur ellips">{{add}}</div></div></div>',imgNodeHTML:'<div uid="{{uid}}" elemtype="{{type}}" {{remchat}} title="{{name}}" username="{{name}}" nodetype="@" class="dIB zcricnt posl">{{image}}{{remove_html}}</div>',removeImgNodeHTML:'<div id="remove_id_frm_filter" data-uid = "{{uid}}" class="msi-close posa dN cur" data-action="removeSelectedUser"></div>',ParticipantsSearchHTML:'<div uid="{USERID}" elemtype="contact" purpose="search" data-val="{DNAME}" class="zcrtchtcontct remcontact flexC font13"><div class="list-img posl"><img src="{IMGURL}"><div class="{STATUSCLASS}"></div></div><div class="ellips list-cnt mrgL10"><div class="ellips dflx font14"><span class="ellips">{DNAMEVAL}</span>{USERTAG}</div><div class="ellips clr6">{EMAILID}</div></div><div class="msi-hisseld selectind" ></div></div>',remChatHistoryHTML:'<div id="{CHID}" remchat elemtype="chat" purpose="search" chid="{CHID}" username="{TITLENAME}" class="zcrtchtcontct remcontact flexC">{CHATIMAGE}<div class="ellips mrgL10"><div class="ellips chattitle">{TITLENAME}</div></div></div>',apiErrorHTML:'<div class="zcempty-con "><div class="zcempty-img error_img"></div><div class="zcempty-title font18">{{errormessage}}</div><div data-action="errorcase" class="error"></div></div>',recording_header_html:`<div class="main-container-header ovrflwH fshrink">\t\n\t\t\t\t   <div class="w100 justifySB flexC pTB10">\n\t\t\t\t      <div class="font17 fontB">\n\t\t\t\t         <div class="fontB font16 clr-H flexC">\n\t\t\t\t            <div class="flexC"><div class="item-icn mL10 mR10 ml-hdr-img zcf-meeting"></div>${I18N("media.recordings")}</div>\n\t\t\t\t         </div>\n\t\t\t\t      </div>\n\t\t\t\t   </div>\n\t\t\t\t</div>\n\t\t\t\t<div id="recording_category" class="zc-callinfo-tab zcl-hor-tab pL35">\n\t\t\t\t   <div class="zcl-hor-tab-item {{all_cls}}" data-type="all" data-action="switchRecordingCategory">${I18N("media.recordings.all")}</div>\n\t\t\t\t   <div class="zcl-hor-tab-item {{mine_cls}}" data-type="mine" data-action="switchRecordingCategory">${I18N("media.recordings.mine")}</div>\n\t\t\t\t   <div class="zcl-hor-tab-item {{shared_cls}}" data-type="shared" data-action="switchRecordingCategory">${I18N("media.recordings.shared")}</div>\n\t\t\t\t</div>`,grid_recording_item_html:`<div id="recording_item_{{uid}}" class="ml-grid-item mB30 zchtmsgcnt zc-ml-recording" uid="{{uid}}" nrs_id="{{nrs_id}}" sr_id="{{uid}}" ref_index="{{ref_index}}" owner_id="{{owner_id}}" data-title="{{recording_name}}" video={{has_video}}>\n\t\t\t\t\t<div data-name="item_cont" class="h100 w100 posrel curP flexC" data-action="playRecording">\n\t\t\t\t\t\t<div data-name="grid_options" class="grid_options posabs h100 flex dN flexS justifySB p10 curN">\n\t\t\t\t\t\t\t<div id="user_image" data-action="user_details" class="ml-list-img flexM" title="{{owner_name}}">\n\t\t\t\t\t\t\t   <div sender="{{owner_id}}" nname="{{owner_name}}" class="sender ellips floatl me">\n\t\t\t\t\t\t\t      <div class="chtimg floatl posrel"><img elemtype="user" hover="true" uid="{{owner_id}}" src="{{owner_img_url}}" class="cur"></div>\n\t\t\t\t\t\t\t      <span elemtype="user" hover="true" uid="{{owner_id}}" class="zctxtseln cur">{{owner_name}}</span>\n\t\t\t\t\t\t\t   </div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<div class="flexC ml-icon_dom">\n\t\t\t\t\t\t\t\t{{download_html}}\n\t\t\t\t\t\t\t\t<div id="recording_dropdown_{{uid}}" ref_index="{{ref_index}}" data-action="showRecordingMoreOptions" uid="{{uid}}" nrs_id="{{nrs_id}}" recording_dropdown_menu class="zcimg-actn-btn p5 mL8 curP textC ml-drpdwm_menu">\n\t\t\t\t\t\t\t\t\t<em class="zcf-more" title="${I18N("common.more")}" recording_dropdown_menu></em>\n\t\t\t\t\t\t\t\t\t<div id="recording_dropdown_menu_{{uid}}" recording_dropdown_menu data-uid="{{uid}}"></div>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div id="videoplayer" class="zcvideomn zcfilevw">{{content_div}}</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div id="recording_name_{{uid}}" class="recording-name-container ellips curP p4" title="{{recording_name}}">{{recording_name}}</div>\n\t\t\t\t\t<input id="recording_nameinput_{{uid}}" type="text" class="recording-name-container p4 width100 font15 dN" sr_id="{{uid}}" data-action="renameRecording" maxlength={{maxlen}} autocomplete="off" />\n\t\t\t\t </div>`,recording_download_html:`<div data-action="downloadRecording" title="${I18N("common.download")}" uid="{{uid}}" ref_index="{{ref_index}}" nrs_id="{{nrs_id}}" class="zcimg-actn-btn p5 mL8 curP {{hide_download}}">\n\t\t\t\t\t\t\t\t\t\t\t\t<em class="zcf-download"></em>\n\t\t\t\t\t\t\t\t\t\t\t</div>`,list_recording_item_html:`<div id="recording_item_{{uid}}" class="ml-list-item p10 curP" uid="{{uid}}" nrs_id="{{nrs_id}}" sr_id="{{uid}}" ref_index="{{ref_index}}" owner_id="{{owner_id}}" data-title="{{recording_name}}" video={{has_video}}>\n\t\t\t\t   <div data-name="item_cont" nrs_id="{{nrs_id}}" sr_id="{{uid}}" ref_index="{{ref_index}}" class="h100 w100 posrel flexC" data-action="playRecording">\n\t\t\t\t      <div data-name="list_options" class="dN flexC mR15">\n\t\t\t\t         <label class="w100 flexIC curP">\n\t\t\t\t            <div class="zcl-checkbox w100"><input type="checkbox"><span class="zcf-tick flexM"></span></div>\n\t\t\t\t         </label>\n\t\t\t\t      </div>\n\t\t\t\t      <span class="ml-emptylist-item flexM p4 font12 fontB line12 posrel {{icon_cls}}"></span>\n\t\t\t\t      <div id="recording_name_{{uid}}" class="mLR10 font14 line16 w50">{{recording_name}}</div>\n\t\t\t\t      <input id="recording_nameinput_{{uid}}" type="text" class="recording-name-container p4 mLR10 w50 font14 dN" sr_id="{{uid}}" data-action="renameRecording" maxlength={{maxlen}} autocomplete="off" />\n\t\t\t\t      <div class="fshrink line24 ml-filesize font12 flexG" style="width:10%">{{duration}}</div>\n\t\t\t\t      <div class="fshrink line24 ml-filesize font12" style="width:15%">{{file_size}}</div>\n\t\t\t\t      <div id="user_image" title="{{owner_name}}" style="width:120px;" class="ml-list-img flexM curN" data-action="user_details">\n\t\t\t\t         <div purpose="sender" sender="{{owner_id}}" nname="{{owner_name}}" class="sender ellips floatl ">\n\t\t\t\t            <div class="chtimg floatl posrel"><img elemtype="user" hover="true" uid="{{owner_id}}" src="{{owner_img_url}}" class="cur"></div>\n\t\t\t\t            <span elemtype="user" hover="true" uid="{{owner_id}}" class="zctxtseln cur">{{owner_name}}</span>\n\t\t\t\t         </div>\n\t\t\t\t      </div>\n\t\t\t\t      <div class="textR" style="width:160px;">\n\t\t\t\t         <div class="msg_time ml-filesize font12">{{display_time}}</div>\n\t\t\t\t         <div data-name="icon_dom" class="ml-icon_dom dN">\n\t\t\t\t           {{download_html}}\n\t\t\t\t            <div id="recording_dropdown_{{uid}}" ref_index="{{ref_index}}" data-action="showRecordingMoreOptions" uid="{{uid}}" nrs_id="{{nrs_id}}" recording_dropdown_menu class="zcimg-actn-btn p5 mL8 curP  textC ml-drpdwm_menu">\n\t\t\t\t            \t<em class="zcf-more" recording_dropdown_menu title="${I18N("common.more")}"></em>\n\t\t\t\t            \t<div id="recording_dropdown_menu_{{uid}}" recording_dropdown_menu data-uid="{{uid}}"></div>\n\t\t\t\t            </div>\n\t\t\t\t         </div>\n\t\t\t\t      </div>\n\t\t\t\t   </div>\n\t\t\t\t</div>`,create_recording_link_win:`<div class="zcl-win-modal1-hdr fshrink">\n\t\t\t\t   <div class="w100 justifySB flexC pTB10">\n\t\t\t\t      <div class="font17 ellips flexC" sr_id="{{sr_id}}" nrs_id="{{nrs_id}}" ref_index="{{ref_index}}">\n\t\t\t\t         <span title="{{tool_tip}}" class="ellips curP" data-action="handle_recording_link" data-type="handle_recording_link" backbutton documentclick="handleRecording">{{name}}</span><span class="fshrink"><span class="clr-S mLR5">></span>{{header_title}}</span>\n\t\t\t\t      </div>\n\t\t\t\t      <span id="winclose" class="zchat-close zcl-icon-lg zcl-icon--filled2"></span>\n\t\t\t\t   </div>\n\t\t\t\t</div>\n\t\t\t\t<div class="flexG ovrflwH">\n\t\t\t\t   <div class="h100 posl ovrflwA pLR36">\n\t\t\t\t      <div class="mT24">\n\t\t\t\t         <div class="posrel">\n\t\t\t\t            <input id="recording-link-name-text" type="text" class="zcl-input pR20 {{disabled_cls}}" maxlength="{{name_limit}}" value="{{link_name}}" autocomplete="off" placeholder="${I18N("mr.permalink.name.placeholder")}" {{read_only_attr}}>\n\t\t\t\t         </div>\n\t\t\t\t      </div>\n\t\t\t\t      <div class="flexC mT24">\n\t\t\t\t         <span class="flexG flexC line1">\n\t\t\t\t         \t<span class="font15">${I18N("mr.permalink.password")}</span>\n\t\t\t\t         \t<span class="zcf-infoC mL10 font16 clr-icon2 mT2" title="${I18N("mr.permalink.password.info")}"></span>\n\t\t\t\t         </span>\n\t\t\t\t         <label class="zcl-switch zcl-switch-sm no-icon" {{disabled_attr}}>\n\t\t\t\t            <input id="recording-link-password" type="checkbox" {{password_checked}}>\n\t\t\t\t            <span class="slider"><em class="switch"></em><div class="zcl-dot--loader"></div>\n\t\t\t\t            </span>\n\t\t\t\t         </label>\n\t\t\t\t      </div>\n\t\t\t\t      <div id="recording-link-password-input" class="mT24 {{password_cls}}">\n\t\t\t\t         <div class="posrel">\n\t\t\t\t            <input id="recording-link-password-text" type="password" class="zcl-input pR20 {{disabled_cls}}" placeholder="${I18N("formbuilder.info.password")}" value="{{password_value}}" autocomplete="off" maxlength="{{password_limit}}" {{read_only_attr}}>\n\t\t\t\t            <span class="zcf-hidden zcl-input-infoicon curP" visibility_type="hidden" title="${I18N("mr.permalink.showpassword")}" data-type="toggle_password_visibility" documentclick="handleRecording"></span>\n\t\t\t\t         </div>\n\t\t\t\t      </div>\n\t\t\t\t      <div class="flexC mT24">\n\t\t\t\t         <span class="flexG flexC line1">\n\t\t\t\t         \t<span class="font15">${I18N("mr.permalink.expiry")}</span>\n\t\t\t\t         \t<span class="zcf-infoC mL10 font16 clr-icon2 mT2" title="${I18N("mr.permalink.expiry.info")}"></span>\n\t\t\t\t         </span>\n\t\t\t\t         <label class="zcl-switch zcl-switch-sm no-icon" {{disabled_attr}}>\n\t\t\t\t            <input id="recording-link-calendar" type="checkbox" {{expiry_checked}}>\n\t\t\t\t            <span class="slider"><em class="switch"></em><div class="zcl-dot--loader"></div>\n\t\t\t\t            </span>\n\t\t\t\t         </label>\n\t\t\t\t      </div>\n\t\t\t\t      <div id="recording-link-calendar-input" class="mT24 {{expiry_cls}} {{disabled_cls}}">\n\t\t\t\t         <div class="zcl-dropdown-input">\n\t\t\t\t         \t<div id="expiry{{sr_id}}" class="zcl-dropdown-label font14 ellips" time="{{time}}" data-type="show_recording_link_expiry_date_picker" documentclick="handleRecording">{{time_text}}</div>\n\t\t\t\t         \t<em class="zcl-dropdown-icon zcl-dropdown-divider zcf-datepicker mL5 font14 {{date_icon_cls}}" title="${I18N("smiley.calendar")}"  data-type="show_recording_link_expiry_date_picker" documentclick="handleRecording"></em>\n\t\t\t\t         \t<div id="rec-link-expiry-date-picker"></div>\n\t\t\t\t         </div>\n\t\t\t\t         <div id="date_containerexpiry{{sr_id}}" class="date-picker-wrp mT10 posfix"></div>\n\t\t\t\t      </div>\n\t\t\t\t      <div class="mT24 {{link_cls}}">\n\t\t\t\t         <div class="font16">${I18N("mr.permalink.url")}</div>\n\t\t\t\t         <div class="flexC zcl-hint-box2 mT14">\n\t\t\t\t            <div class="flexC zcl-hint-box2-content wh100 ellips curP">\n\t\t\t\t               <div class="zc-no-select flexG ellips pLR8" uid="{{link_id}}" data-type="copy_recording_link" documentclick="handleRecording">{{link}}</div>\n\t\t\t\t               <div class="zcl-dropdown-divider alignselfN"></div>\n\t\t\t\t               <div class="pLR10 line1"><span class="font13 fontB zcl-theme-link" uid="{{link_id}}" data-type="copy_recording_link" documentclick="handleRecording">${I18N("mr.permalink.copyurl")}</span></div>\n\t\t\t\t            </div>\n\t\t\t\t         </div>\n\t\t\t\t         <div class="flexC flexG font13 mT12">\n\t\t\t\t            <span class="clr-S fontI">${I18N("common.recorded")} ${I18N("common.by").toLowerCase()}</span>\n\t\t\t\t            <span class="zcl-btn--link mL5 font13 clr-S">\n\t\t\t\t         \t\t<span uid="{{owner_id}}" elemtype="user" hover="true" class="zcretname bold hvrinfo">{{owner_name}}</span>\n\t\t\t\t         \t</span>\n\t\t\t\t            <span class="clr-S mL4">{{recorded_time}}</span>\n\t\t\t\t         </div>\n\t\t\t\t      </div>\n\t\t\t\t   </div>\n\t\t\t\t</div>\n\t\t\t\t<div class="fshrink flexC justifyE pLR36 mTB15" sr_id="{{sr_id}}" nrs_id="{{nrs_id}}" ref_index="{{ref_index}}">\n\t\t\t\t   <div class="zcl-btn-xs zcl-btn--secondary {{cancel_cls}}" data-action="handle_recording_link" data-type="handle_recording_link" backbutton documentclick="handleRecording">${I18N("common.cancel")}</div>\n\t\t\t\t   <div class="zcl-btn-xs zcl-btn--primary" uid="{{link_id}}" data-action="handle_recording_link" data-type="handle_recording_link" {{button_attr}} documentclick="handleRecording">{{button_label}}</div>\n\t\t\t\t</div>\n\t\t\t\t<div class="bg-warning bottom0 clr-S footr-padding fshrink textC w100 {{edit_hint_cls}}">${I18N("mr.permalink.create.note")}</div>`,share_recording_win_html:`<div id="share_recording_popup" class="flex-col wh100" nrs_id="{{nrs_id}}" sr_id="{{sr_id}}" ref_index="{{ref_index}}">\n\t\t\t\t <div class="zcl-win-modal1-hdr flexC fshrink">\n\t\t\t\t   <div class="w100 justifySB flexC pTB10" nrs_id="{{nrs_id}}" sr_id="{{sr_id}}" ref_index="{{ref_index}}">\n\t\t\t\t      <div class="font17 ellips flexC flexG">\n\t\t\t\t         <span title="{{tool_tip}}" class="ellips flexG mR8">{{name}}</span>\n\t\t\t\t      </div>\n\t\t\t\t\t  <span class="zcl-theme-link mT2 mR20 fshrink" create_win data-type="show_create_edit_recording_link_win" documentclick="handleRecording">${I18N("mr.permalink.share")}</span>\n\t\t\t\t      <span id="winclose" class="zchat-close zcl-icon-lg zcl-icon--filled2"></span>\n\t\t\t\t   </div>\n\t\t\t\t</div>\n\t\t\t\t<div id="{{id}}" class="zcl-win-modal1-srch fshrink">\n\t\t\t\t   <div class="posrel w100" purpose="showResultsDom">\n\t\t\t\t      <div class="zcl-multiselect-input-container">\n\t\t\t\t         <span class="event-users-selection" data-selections></span>\n\t\t\t\t         <input id="{{id}}-search-field" placeholder="{{place_holder}}">\n\t\t\t\t      </div>\n\t\t\t\t      <div id="{{id}}-results" class="zcl-multiselect-list-container">\n\t\t\t\t         <div id="{{id}}-list" class="zcl-multiselect-list"></div>\n\t\t\t\t      </div>\n\t\t\t\t   </div>\n\t\t\t\t   <div class="flexC mT16">\n\t\t\t\t      <div class="flexC flexG font12">\n\t\t\t\t         <span class="clr-S font13 fontI">${I18N("common.recorded")} ${I18N("common.by").toLowerCase()}</span>\n\t\t\t\t         <span class="zcl-btn--link mL5 font13 clr-S">\n\t\t\t\t         <span uid="{{owner_id}}" elemtype="user" hover="true" class="zcretname bold hvrinfo">{{owner_name}}</span>\n\t\t\t\t         </span>\n\t\t\t\t         <span class="clr-lp1 mLR10">|</span>\n\t\t\t\t         <span class="clr-S">{{size}}</span>\n\t\t\t\t      </div>\n\t\t\t\t      <div class="fshrink" nrs_id="{{nrs_id}}" sr_id="{{sr_id}}" ref_index="{{ref_index}}">\n\t\t\t\t         <div class="zcl-btn-xs zcl-btn--primary" data-type="share_recording" documentclick="handleRecording" share_btn disabled>${I18N("common.share")}</div>\n\t\t\t\t      </div>\n\t\t\t\t   </div>\n\t\t\t\t</div>\n\t\t\t\t<div id="shared_list_item_html{{sr_id}}" class="flexG ovrflwA">{{shared_list_item_html}}</div>\n\t\t\t\t<div class="bg-warning bottom0 clr-S footr-padding fshrink textC w100">${I18N("media.recordings.share.note")}</div>\n\t\t\t\t</div>`,shared_list_item_html:`<div id="shared_link_title" class="zcl-win-subcategory {{links_cls}}">${I18N("mr.sharedlinks")} (<span id="shared_link_count">{{shared_links_count}}</span>)</div>\n\t\t\t\t <div id="shared_links_list{{sr_id}}" class="posl pLR24 {{links_cls}}">{{shared_links_list}}</div>\n\t\t\t\t <div id="shared_user_title" class="zcl-win-subcategory {{members_cls}}">${I18N("media.recordings.sharedmembers.header")} (<span id="shared_user_count">{{shared_members_count}}</span>)</div>\n\t\t\t\t <div id="shared_users_list{{sr_id}}" class="posl pLR24 {{members_cls}}">{{shared_users_list}}</div>`,shared_user_item:`<div id="shareduser{{user_id}}" uid="{{user_id}}" user_name="{{user_name}}" class="zcl-list-item">\n\t\t            <div class="zcl-img">\n\t\t               <img elemtype="user" class="w100 h100 bdrR100" uid="{{user_id}}" hover="true" src="{{user_img}}">\n\t\t               <div class="{{user_status}}"></div>\n\t\t            </div>\n\t\t            <div class="mL12 flexG ellips">\n\t\t               <div elemtype="user" hover="true" uid="{{user_id}}" class="font15 clr-M curP dIB"><span class="ellips">{{user_name}}</span>{{user_tag}}</div>\n\t\t               <div class="ellips clr-lp1 font13 mT3"><span>{{user_email}}</span></div>\n\t\t            </div>\n\t\t\t\t\t<span id="revokerecordingelem{{user_id}}" uid="{{user_id}}" data-action="show_options" data-type="revoke_recording" class="rolechange-icn mL12 zcl-icon zcl-icon--plain zcf-moreV zcrleddsel recording-shared-members dN" documentclick="handleRecording">\n\t\t\t\t\t   <div id="revokerecordingdropdown{{user_id}}" align="top" class="zcl-menu-wrap clr-M rolechange-drpdwn" style="display:none;">\n\t\t\t\t\t      <div class="zcl-menu-item zcl-neg-menu-item ellips" uid="{{user_id}}" user_name="{{user_name}}" data-type="revoke_recording" documentclick="handleRecording">${I18N("media.recordings.revoke")}</div>\n\t\t\t\t\t   </div>\n\t\t\t\t\t</span>\n\t\t        </div>`,shared_link_item:`<div id="sharedlink{{link_id}}" uid="{{link_id}}" class="zcl-list-item {{new_link_cls}}" {{new_link_attr}}>\n\t\t\t\t   <div class="flexM zcl-img">\n\t\t\t\t      <span class="flexIC font18 zcf-link"></span>\n\t\t\t\t   </div>\n\t\t\t\t   <div class="mL12 flexG ellips">\n\t\t\t\t      <div class="font15 clr-M curP ellips" title="{{tool_tip}}">{{link_name}}</div>\n\t\t\t\t      <div class="ellips clr-lp1 font13 mT3"><span>{{link_desc}}</span></div>\n\t\t\t\t   </div>\n\t\t\t\t   <span id="copyrecordinglink{{link_id}}" uid="{{link_id}}" title="${I18N("mr.permalink.copyurl")}" class="dN mL12 recording-shared-members rolechange-icn zcf-copy zcl-icon zcl-icon--plain zcrleddsel" data-type="copy_recording_link" documentclick="handleRecording">\n\t\t\t\t   </span>\n\t\t\t\t   \t<span id="recordinglinkelem{{link_id}}" data-type="recording_link_dropdown" uid="{{link_id}}" class="dN mL12 recording-shared-members rolechange-icn zcf-moreV zcl-icon zcl-icon--plain zcrleddsel" documentclick="handleRecording">\n\t\t\t\t      <div id="recordinglinkoptions{{link_id}}" align="{{options_position}}" sr_id="{{sr_id}}" nrs_id="{{nrs_id}}" ref_index="{{ref_index}}" class="zcl-menu-wrap clr-M rolechange-drpdwn" style="display:none;">\n\t\t    \t\t\t <div class="zcl-menu-item ellips" edit_win data-type="show_create_edit_recording_link_win" uid="{{link_id}}" documentclick="handleRecording">${I18N("mr.editlink.button")}</div>\n\t\t\t\t         <div class="zcl-menu-item zcl-neg-menu-item ellips" data-type="delete_recording_link_consent" uid="{{link_id}}" documentclick="handleRecording">${I18N("mr.deletelink.button")}</div>\n\t\t\t\t      </div>\n\t\t\t\t   </span>\n\t\t\t\t</div>`,recording_dropdown_html:`<div class="font14 zcl-menu-wrap no-pointer ovrflwH share-recording-menu" rec_options nrs_id="{{nrs_id}}" sr_id="{{uid}}" ref_index="{{ref_index}}">\n\t\t\t\t\t\t<div class="zcl-menu-item ellips {{hide_meeting_info}}" data-type="view_meeting_info" documentclick="handleRecording">${I18N("media.meetinginfo")}</div>\n\t\t\t\t\t\t<div class="zcl-menu-item ellips {{hide_options}} {{share_restriction}}" init data-action="handle_recording_link" data-type="share_recording" documentclick="handleRecording">${I18N("common.share")}</div>\n\t\t\t\t  \t\t<div class="zcl-menu-item ellips {{hide_options}}" data-action="editname" data-type="rename_recording" documentclick="handleRecording">${I18N("common.rename")}</div>\n\t\t\t\t\t\t<div class="zcl-menu-item ellips {{hide_copy_permalink}}" data-type="copy_recording_permalink" documentclick="handleRecording">${I18N("channel.permalink")}</div>\n\t\t\t\t  \t\t<div class="zcl-menu-item zcl-neg-menu-item ellips {{hide_options}}" data-action="consent" data-type="delete_recording" documentclick="handleRecording">${I18N("common.delete")}</div>\n\t\t\t\t  \t\t<div class="zcl-menu-item zcl-neg-menu-item ellips {{hide_leave}}" data-action="consent" data-type="leave_recording" documentclick="handleRecording">${I18N("common.leave")}</div>\n\t\t\t\t </div>`,recording_consent_header:'<div class="zcl-img xl flexM mAuto zcl-warning-bg"><em class="zcf-alert2 clrW"></em></div>\n\t\t         <div class="flexM font18 fontB mT10">{{title}}</div>\n\t\t         <div class="flexM font16 textC line24 mT12">{{hint}}</div>',recording_consent_html:'<div class="modalwindow2-footer flexC justifyE" nrs_id="{{nrs_id}}" sr_id="{{sr_id}}" ref_index="{{ref_index}}">\n\t\t\t         <div id="winclose" class="zcl-btn zcl-btn--secondary">{{cancel_label}}</div>\n\t\t\t         <div documentclick="{{purpose}}" data-type="{{type}}" data-action="{{action}}" uid="{{uid}}" class="zcl-btn zcl-btn--warning mL20">{{action_label}}</div>\n\t\t\t      </div>'};return{getHtml:function(t){return e[t]||""},getFilterHtml:function(){var t="";return MediaFilterCategories.forEach((function(i){var a=i===MediaListConstants.IMAGE;t+=$WC.template.replace(e.type_filter_item_html,{item_type:i,tab_class:isFromCwin&&!isFromLHS?"cwin-mediatab-item":"zcl-tab-item",$item_txt:i===MediaListConstants.RECORDING?"media.recordings":"media."+i+"s",selected:a?"sel":"",tabSelected:a?"data-selected":""})})),$WC.template.replace(e.type_filter_html,{tab_cls:isFromCwin&&!isFromLHS?"cwin-mediatab":"zcl-tab",categories_html:t},"InSecureHTML")}}}(),MediaListConstants={ALL:"all",IMAGE:"image",VIDEO:"video",AUDIO:"audio",FILE:"file",LINK:"link",RECORDING:"recording",GRID_MODE:"grid",LIST_MODE:"list",NEXT_TOKEN:"next_token",FETCHCOMPLETE:"fetchComplete",LASTACCESS_TIME:"lastAccessTime",DATA:"data",TYPE:"type",LMTIME:"lmTime",SEARCH:"search",TOTIME:"totime",FROMTIME:"fromtime",HEADER_HTML:"header_html",ALL_HEADER_HTML:"all_header_html",CONTAINER_MODAL:"container_modal",BODY_HTML:"container_body_html",ACTION_BAND:"action_band_html",SHARED_BY:"shared_by_html",TYPE_FILTER:"type_filter_html",ACTION_FILTER:"actions_filter_html",LOADING_HTML:"loading_state_html",EMPTY_HTML:"empty_state",NO_RESULT_HTML:"no_search_result",IMAGE_GRID_HTML:"grid_image_item_html",IMAGE_GRID_DISABLED_HTML:"grid_image_disabled_html",IMAGE_LIST_HTML:"list_image_item_html",IMAGE_LIST_DISABLED_HTML:"list_image_disabled_html",IMG_DOM_HTML:"appendImgHtml",FILE_GRID_HTML:"grid_file_item_html",LINK_GRID_HTML:"grid_link_item_html",LINK_LIST_HTML:"list_link_item_html",DATE_SEPERATER:"date_seperater",VIDEO_GRID_HTML:"grid_video_item_html",VIDEO_LIST_HTML:"list_video_item_html",AUDIO_GRID_HTML:"grid_audio_item_html",GRID_FOOTER_HTML:"grid_footer_html",CALENDER_HTML:"calender_container_html",CALENDER_SPECIFIC:"calender_specific_html",CALENDER_RANGE:"calender_range_html",DROPDOWN_HTML:"dropdown_html",FORWARD_DROPDOWN_HTML:"forward_dropdown_html",ML_DEFAULT_LINK_IMAGE:"\u2068officechat\u2069/images\u2069/default\u2069/\u2068media_listing\u2069/ml-default-link.png",API_FAILURE_HTML:"api_failure_html",SELECTION_HTML:"selection_html",SEARCH_INPUT:"search_input_html",CURR_GRID_COUNT:"curr_grid_count",MEDIA_DOWNLOAD_HTML:"media_download_html",RECORDING_DOWNLOAD_HTML:"recording_download_html",RECORDING_HEADER_HTML:"recording_header_html",GRID_RECORDING_ITEM_HTML:"grid_recording_item_html",LIST_RECORDING_ITEM_HTML:"list_recording_item_html",SHARE_RECORDING_WIN_HTML:"share_recording_win_html",RECORDING_CONSENT_HTML:"recording_consent_html",RECORDING_CONSENT_HEADER:"recording_consent_header",RECORDING_DROPDOWN_HTML:"recording_dropdown_html",CREATE_RECORDING_LINK_WIN:"create_recording_link_win",SHARED_LIST_ITEM_HTML:"shared_list_item_html",SHARED_USER_ITEM:"shared_user_item",SHARED_LINK_ITEM:"shared_link_item"},MediaDomIDS={WIN_ID:"media_listing_view_modal",SHAREDBYDOM:"sharedByDrpdwn",MEDIASEARCH:"ml_search",MEDIASEARCHINPUT:"ml_search_input",ADD_PARTICIPANT_SEARCH:"Mediafilter-addparticipants",ADD_PARTICIPANT_LIST:"Mediafilter-addparticipants-list",ADD_PARTICIPANT_SRCHFLD:"Mediafilter-addparticipants-search-field",ADD_PARTICIPANT_SELECTION:"Mediafilter-addparticipants-select-field",ADD_PARTICIPANT_RESULT:"Mediafilter-addparticipants-results",APPLY_SHAREDBY_FILTERBTN:"saveAddedParticipants"},MediaListingFilters={USER_IDS:"userids",BY_CURR_USER:"byCurrUser",BY_SPECIFIC_USER:"bySpecificUser",DATE_FILTER:"dateFilter"},RecordingLinksStorage={},RecordingSharedUsersStorage={},RecordingConstants={syncing:!1,shareLimit:10,nameMaxLength:50,linkLimit:10,linkNameMaxLength:50,linkPasswordMinLength:6,linkPasswordMaxLength:30},MediaStorage={},MediaTokens={},fetchComplete={},AppliedFilter={},FilterStorage={},_currTypeFilter=MediaListConstants.IMAGE,_currSharedByFilter="All",_isFilterApplied={},SelectedItems=[],ForwardParamMsguids=[],isForwardEnabled=!1,SELECTED_LEN=0,isFromCwin=!1,isFromLHS=!1,def_id=0,MediaFilterCategories=[MediaListConstants.IMAGE,MediaListConstants.VIDEO,MediaListConstants.AUDIO,MediaListConstants.FILE],MediaListingUI=function(){var e;_viewMode=_viewMode||MediaListConstants.GRID_MODE;var t=function(){!_currChatID||!ConversationsList.isGroupChat(_currChatID)&&!ConversationsList.isCustomGroup(_currChatID)||ConversationsList.isBotChat(_currChatID)||ConversationsList.get(_currChatID).isGuestChat?-1!==MediaFilterCategories.indexOf(MediaListConstants.RECORDING)&&(MediaFilterCategories.removeElement(MediaListConstants.RECORDING),_currTypeFilter===MediaListConstants.RECORDING&&$DB.update("lastAccMediaType",MediaListConstants.IMAGE)):-1===MediaFilterCategories.indexOf(MediaListConstants.RECORDING)&&MediaFilterCategories.push(MediaListConstants.RECORDING)};let a=function(){if(LhsModules.activeTabId===LHSConstants.ModuleIds.MYFILES){let e=ZCPermalink.getActiveRoutePath().join("/"),t=new BidiMap(routingPaths.files);LhsModules.highlightModule(LHSConstants.ModuleIds.MYFILES),LhsNavigation.updateSubModuleCategory();let i=t.getKeyFromValue(e);MyFiles.showSelectedSourceData(i)}};var d=function(e){var t=_currTypeFilter===MediaListConstants.IMAGE?"ml-image-item":"ml-audio-item";t=I()?t:"ml-thumbnail-image";var i=$(e).attr("filesrc"),a=_currTypeFilter===MediaListConstants.LINK;if(!a){i=$(e).attr("filesrc");var d=$(e).attr("originalsrc")||$(e).attr("tempsrc")}var s=$WC.template.replace(MediaListingTemplates.getHtml(MediaListConstants.IMG_DOM_HTML),{action:"open_attachment",uid:e.dataset.uid,msguid:$(e).attr("msguid"),sender:$(e).attr("sender"),originalurl:i,thumbnail:a?i:d,hasthumbnail:$(e).attr("hasthumbnail"),filetype:$(e).attr("filetype"),isv1:$(e).attr("isv1"),contenttype:$(e).attr("contenttype"),fname:$(e).attr("fname"),chid:e.dataset.chid,original_width:e.dataset.width,original_height:e.dataset.height,type:t,frw_hide_cls:isForwardEnabled?"curN":"",img_cls:a?"ml-img-fit":""}),n=$(e).parents("#img_dom");n.html(s);var r=n.find("[previewelem]");return a&&(r.removeAttr("contenttype"),r.removeAttr("fname")),e.remove(),r[0]},s=function(e,t){t=t||n();for(i=0;i<t.attlen;i++)if(t.attlen!==loadedImgCount){var a=t.imgAttachments[i],s=a.getBoundingClientRect().top,l=s+a.offsetHeight;if("IMG"!==a.tagName&&(s>t.winTopY&&s<t.winBottomY||l>t.winTopY&&l<t.winBottomY||s<t.winTopY&&l>t.winBottomY)){if(e&&"videoplayer"!==$(a).attr("id")&&(a=d(a),appendedCount++),!(_currTypeFilter!=MediaListConstants.FILE&&_currTypeFilter!=MediaListConstants.AUDIO||$(a).attr("originalsrc").includes("thumbnail"))){var c=$(a);c.removeAttr("originalsrc"),c.parents("#img_dom").siblings("#load").remove(),c.removeClass("vsbH"),N(c),_currTypeFilter!==MediaListConstants.IMAGE&&_currTypeFilter!==MediaListConstants.LINK||c.removeAttr("previewelem");continue}if(r(a,t,appendedCount),loadedImgCount<5&&5===appendedCount||appendedCount===Math.ceil(loadedImgCount/2))break}}loadComplete=!0},n=function(){appendedCount=0,loadedImgCount=0;var t=(e=isFromLHS&&e&&!e[0].dataset.uid?e:$("#ml-data-container"))[0],i=t.getBoundingClientRect().top,a=i+t.offsetHeight,d=t.querySelectorAll('img[originalsrc],video[originalsrc],div[previewelem]:not([data-name="preview_icon"])');return{container:t,winTopY:i,winBottomY:a,imgAttachments:d,attlen:d.length}},r=function(e,t,i){if(void 0!==(e=$(e)).attr("originalsrc")){var a="VIDEO"===e[0].tagName,d=a?"poster":"src";a||(e.attr("tempsrc",e.attr(d)),e.attr("src")&&e.css("background","url("+e.attr("src")+")"),e.attr("src","")),e.attr(d,e.attr("originalsrc")),e.removeAttr("originalsrc"),a||(e.on("load",(function(){var e=$(this);e.css("background","transparent"),e.parents("#img_dom").siblings("#load").remove(),e.removeClass("vsbH").removeAttr("tempsrc"),e.css("animation"," fadein 1s"),ChatUI.addToImageCache(e.attr(d)),loadedImgCount=loadedImgCount||0,loadedImgCount=i,e.css("background",""),appendedCount=0,s(!0,t)})),e.on("error",(function(){var e=$(this);e.parents("#img_dom").siblings("#load").remove(),e.removeClass("vsbH"),N(e),_currTypeFilter!==MediaListConstants.IMAGE&&_currTypeFilter!==MediaListConstants.LINK||e.removeAttr("previewelem"),++loadedImgCount>4&&s(!0,t)})))}},l=function(t){e=$("#ml-data-container"),t.on("click",(function(e){MediaListingEvents.handleClick(e)})),isFromLHS&&t.find("#file_upload").on("change",(function(e){var t=this.parentNode,i=t.getAttribute("type");"iframe"===i?Chat.sendFile(t):"html5"===i&&FileUploadUI.handlePreview("CT_2242276057844053742_64396901-B1",this.files,!0,!1)})),e.on("scroll",$Util.debounce((function(e){MediaListingEvents.handleScroll(e),loadComplete&&(loadComplete=!1,s(!0))}),MediaListingUI,300)),$("#"+MediaDomIDS.MEDIASEARCH).on("keyup",$Util.debounce((function(e){MediaListingEvents.handleKeyup(e)}),MediaListingUI,300)),e.on("keyup focusout",$Util.debounce((function(e){MediaListingEvents.handleContainerEvent(e)}),MediaListingUI,300))},c=function(){var e=p(),t=MediaListingTemplates.getHtml(MediaListConstants.CONTAINER_MODAL);if(isFromCwin||isFromLHS)return e;var i=$WC.template.replace(t,{body_container:e},"InSecureHTML");$("#win-rhs-container").html(i)},o=function(e,t){if((isFromLHS=e)&&(-1!==MediaFilterCategories.indexOf(MediaListConstants.LINK)&&(MediaFilterCategories.removeElement(MediaListConstants.LINK),_currTypeFilter===MediaListConstants.LINK&&(_currTypeFilter=MediaListConstants.IMAGE,$DB.update("lastAccMediaType",MediaListConstants.IMAGE))),-1!==MediaFilterCategories.indexOf(MediaListConstants.RECORDING)&&(MediaFilterCategories.removeElement(MediaListConstants.RECORDING),_currTypeFilter===MediaListConstants.RECORDING&&(_currTypeFilter=MediaListConstants.IMAGE,$DB.update("lastAccMediaType",MediaListConstants.IMAGE)))),_currChatID&&!isFromLHS){var i,a=ConversationsList.get(_currChatID),d=Channels.getByChid(_currChatID);$WC.Util.isEmptyObject(d)||(i=d.dn)}else if(isFromLHS){if("showRecordings"===t){var s={};return s[z()+"_cls"]="sel",$WC.template.replace(MediaListingTemplates.getHtml(MediaListConstants.RECORDING_HEADER_HTML),s)}var n=MediaListingTemplates.getHtml(MediaListConstants.ALL_HEADER_HTML);return $WC.template.replace(n,{$chat_name:"showTazFiles"===t?"settings.noti.taz":"ml.sharedin.cliq",category_filter:MediaListingTemplates.getFilterHtml(MediaListConstants.TYPE_FILTER)},"InSecureHTML")}var r=MediaListingTemplates.getHtml(MediaListConstants.HEADER_HTML);if(void 0!==a){var l=HistoryUI.getRecipantsPhoto(a.recipants,a.pcount,a.addinfo,a.title,a.ctype,a.chid,a.customgroup);r=$WC.template.replace(r,{chat_name:i||a.title,$close_txt:"common.to.close"}),r=$WC.template.replace(r,{chat_img_html:l},"InSecureHTML")}return r},m=function(){var e=$DB.get("lastAccMediaType");return isFromLHS&&e===MediaListConstants.LINK&&(e=MediaListConstants.IMAGE),e},_=function(){var e=$("#type_filters").find("[data-selected]");if(e.length){var t=e[0].getAttribute("data-type");$DB.update("lastAccMediaType",t)}},p=function(){var t=$("#chatwindow_filestab").length>0||$("#media_listing_view_modal").length>0,i=u(t?_currTypeFilter:void 0),a=isFromCwin&&!isFromLHS?'<div class="flexC cwin fjustifySA">'+MediaListingTemplates.getFilterHtml(MediaListConstants.TYPE_FILTER)+"</div>":"";_currTypeFilter=m();var d,n=_currChatID||def_id;if(e=!isFromLHS&&e&&e.length?e:$("#ml-data-container"),"recording"===_currTypeFilter&&t){let e=AppliedFilter[_currChatID]||{};_currChatID&&(e.chatId=_currChatID),MediaListingUI.handleRecordingFilter(e)}else MediaListStorage.isExist(_currChatID)?(MediaStorage[n]=MediaListStorage.getMedia(_currChatID),setTimeout((function(){e.html(v(_currTypeFilter)),L(),loadComplete=!1,s(!0)}),300)):isFromLHS&&MediaListStorage.isExist("all")&&!_currChatID?(MediaStorage[def_id]=MediaListStorage.getMedia("all"),setTimeout((function(){e.html(v(_currTypeFilter)),L(),loadComplete=!1,s(!0)}),300)):(_currTypeFilter===MediaListConstants.RECORDING&&(_currTypeFilter=MediaListConstants.IMAGE,$DB.update("lastAccMediaType",MediaListConstants.IMAGE)),h(MediaListingUI.updateListUI,_currTypeFilter));return d=y(_viewMode),$("#date_seperater_sticky").text(""),$WC.template.replace(MediaListingTemplates.getHtml(MediaListConstants.BODY_HTML),{actions_band_html:i,tab_menu:a,data_container:d,chid:_currChatID,view_cls:I()?"flexG flexW":""},"InSecureHTML")},u=function(e){var t="recording"===e,i=$WC.template.replace(MediaListingTemplates.getHtml(MediaListConstants.SEARCH_INPUT),{$search_placeholder:t?"mr.search.placeholder":"ml.search.ph",$clear_txt:"common.clear"}),a=$WC.template.replace(MediaListingTemplates.getHtml(MediaListConstants.DATE_SEPERATER),{sticky_title:"zc_sticky_title",date:"",$id:"sticky",sticky_init:"zc_stick_init"}),d=MediaListingTemplates.getHtml(MediaListConstants.ACTION_BAND),s=$WC.template.replace(MediaListingTemplates.getHtml(MediaListConstants.CALENDER_HTML),{$today_txt:"date.today",$yesterday_txt:"date.yesterday",$last7_txt:"date.last7",$last30_txt:"date.last30",$specific_txt:"specific.date",$custom_txt:"sticky.expiry.custom",$date:"common.date",$to_txt:"common.to.small",$apply_txt:"sticky.calender.apply"}),n=$WC.template.replace(MediaListingTemplates.getHtml(MediaListConstants.ACTION_FILTER),{shared_by_html:T(e),search_input_html:i,calendar_html:s},"InSecureHTML");return n=$WC.template.replace(n,{chat_id:_currChatID,$today_txt:"date.today",$yesterday_txt:"date.yesterday",$last7_txt:"date.last7",$last30_txt:"date.last30",$specific_txt:"specific.date",$custom_txt:"sticky.expiry.custom",icon_cls:I()?"zcf-list-view":"zcf-media-grid",$icon_txt:I()?"media.list":"media.grid"}),$WC.template.replace(d,{sticky_date:a,actions_filter_html:n},"InSecureHTML")},g=function(t,i,a){if(t=t||_currTypeFilter,e=isFromLHS&&e.length&&!e[0].dataset.uid?e:$("#ml-data-container"),$WC.Util.isEmpty(search_value)||!a){if(a){e.addClass("h100 flexG");var d='<div class="h100 w100">'+D(t)+"</div>";return $("#date_seperater_sticky").addClass("vsbH"),void e.html(d)}0==$("#recording_category").length&&(e.html(v(t,i)),loadComplete=!1,s(!0),L(),isForwardEnabled&&H())}else{e.addClass("h100 flexG");var n=R(t);e.html(n)}},h=function(e,t,i){isFromLHS&&!_currChatID?MediaActions.getAllMessages(e,"",t,i):MediaActions.getMessage(_currChatID,e,"",t,i)},v=function(t,i){var a=_currChatID||def_id;if("recording"===t&&($("#media_listing_view_modal").length>0||$("#chatwindow_filestab").length>0)){let e=AppliedFilter[_currChatID]||{};_currChatID&&(e.chatId=_currChatID),MediaListingUI.handleRecordingFilter(e)}else{if(i||!(void 0===MediaStorage[a]||MediaStorage[a]&&$WC.Util.isEmpty(MediaStorage[a][t])))return i=i||MediaStorage[a][t].data,MediaStorage[a][t]&&0===MediaStorage[a][t].data.length?($("#date_seperater_sticky").addClass("vsbH"),e.addClass(" h100 flexG")):(e.removeClass("h100 flexG"),$("#date_seperater_sticky").removeClass("vsbH")),S(t,i);h(MediaListingUI.updateListUI,t,!1)}},f=function(e,t,i,a){$("#loadingblock").length&&$("#loadingblock").remove();var d=S(e,t,!0);e===_currTypeFilter&&C(d)},C=function(t){e.append(t),s(!0)},M=function(e){var t=$("#type_filters");_currTypeFilter=e;var i=t.find("[data-selected]"),a=t.find('[data-type="'+e+'"]');i.removeClass("sel").removeAttr("data-selected"),a.addClass("sel").attr("data-selected","")},L=function(){$Util.initializeStickyTitle($("#list_container"))},I=function(){return _viewMode===MediaListConstants.GRID_MODE},y=function(e){var t=e?"ml-"+e+"-item-ldr":"ml-grid-item-ldr",i=I()?"gridlay":"";return $WC.template.replace(MediaListingTemplates.getHtml(MediaListConstants.LOADING_HTML),{item_class:t,grid_cls:i})},T=function(e){var t="",i=ConversationsList.get(_currChatID),a=Participants.get(_currChatID);a=a.recipants;var d=ConversationsList.isOnetoOneChat(_currChatID),s=ConversationsList.isBotChat(_currChatID)&&"recording"!==e,n=i&&i.isGuestChat;if(d||s||n){var r=a[0]===$zcg._ZUID?a[1]:a[0];r=s?MyBots.getBotId(_currChatID):r;var l=Users.getName(r)||ConversationsList.get(_currChatID).title;t+='<div class="zcl-menu-item ellips justifySB" data-chid = "'+_currChatID+'" data-uid ="'+r+'" data-action="filterMediaByUserId">'+$WC.$CUtil.processXSS(l)+'<em id="bySpecificUsersel" class="clrG msi-tick dN p5"></em></div>'}else t+='<div id="channelFilter" class="zcl-menu-item jsutifySB" data-chid = "'+_currChatID+'" data-action="channelUserIdFilter">'+Resource.getRealValue("ml.specificuser")+'  <em class="zcf-rightArrow mL20"></em><div id="addparticipants" class="ml-filter"></div></div>';var c=$WC.template.replace(MediaListingTemplates.getHtml(MediaListConstants.SHARED_BY),{option_html:t},"InSecureHTML");return $WC.template.replace(c,{chid:_currChatID,sender_id:$zcg._ZUID,$shared_txt:"recording"===e?"mr.recordedby":"ml.sharedby",$all_txt:"common.all",$you_txt:"common.you"})},w=function(e,t){t=t||_currChatID;var i=ChatUI.exist[t];if(i){var a=i.win().find("#msgarea").find("[url="+e+"]");return $(a).parents("[msguid]").attr("msguid")}},D=function(e){var t="ml-image-"+(e||MediaListConstants.ALL),i=e===MediaListConstants.IMAGE||e===MediaListConstants.FILE||e===MediaListConstants.LINK?e+"s":e+" files",a=Resource.getRealValue("media.empty1"),d=Resource.getRealValue("media.empty2",i);return $WC.template.replace(MediaListingTemplates.getHtml(MediaListConstants.EMPTY_HTML),{image_class:t,empty_txt1:a,empty_txt2:d})},R=function(e){var t=Resource.getRealValue("media.noresult");return $WC.template.replace(MediaListingTemplates.getHtml(MediaListConstants.NO_RESULT_HTML),{no_result_txt:t},"InSecureHTML")},S=function(t,i,a){var d,s,n="",r="",l=_currChatID||def_id,c=i||MediaStorage[l][t][MediaListConstants.DATA],o=c.length;if(0!==c.length||!MediaStorage[l][t]||MediaStorage[l][t].data.length){var m;s=MediaListStorage.getCurrGridCount(_currChatID,t),n=I()?MediaListConstants.IMAGE_GRID_HTML:MediaListConstants.IMAGE_LIST_HTML;MediaListingTemplates.getHtml(MediaListConstants.HEADER_HTML);for(var _=a?_isFilterApplied[l]?AppliedFilter[l][MediaListConstants.LMTIME]:MediaStorage[l][t][MediaListConstants.LMTIME]:"",p=0;p<o;p++){var u=c[p].time,h=0===p&&!a,v=$WC.Util.isEmpty(_)||!$Date.isSameMonth(u,_);$Date.getMonthString(u,!1,!0);if(m="external_user_denied"===c[p].access?MediaListingTemplates.getHtml(I()?MediaListConstants.IMAGE_GRID_DISABLED_HTML:MediaListConstants.IMAGE_LIST_DISABLED_HTML):MediaListingTemplates.getHtml(n),v){var f=I();0!==p&&f&&(d=!1,r+="</div>"),$Date.isSameMonth(u,_)||(s++,MediaListStorage.setCurrGridCount(_currChatID,t,s)),r+=E(u,h),_=u,f&&!d&&(d=!0,r+='<div id="grid_layout'+s+'" class="gridlay">')}if(t===MediaListConstants.VIDEO&&I())r+=k(c[p]);else if(t===MediaListConstants.LINK){var C=I()?MediaListConstants.LINK_GRID_HTML:MediaListConstants.LINK_LIST_HTML;r+=x(c[p],C)}else r+=F(c[p],m);a&&!v&&I()&&!d&&(e.find("#grid_layout"+s).append(r),r="")}return _isFilterApplied[l]?AppliedFilter[l][MediaListConstants.LMTIME]=AppliedFilter[l].fetchComplete?"":_:MediaStorage[l][t][MediaListConstants.LMTIME]=MediaStorage[l][t].fetchComplete?"":_,r}g(t,"",!0)},E=function(e,t,i){return $WC.template.replace(MediaListingTemplates.getHtml(MediaListConstants.DATE_SEPERATER),{id:e,date:void 0!==i&&i?$Date.date(e,{withday:!0,shortmonth:!0,shortday:!0}):$Date.getMonthString(e,!1,!0),sticky_title:"zc_running_title",sticky_init:"",padding_cls:"mT20",display_cls:t?"vsbH":""})},A=function(e){return $WC.template.replace(MediaListingTemplates.getHtml(MediaListConstants.SELECTION_HTML),{uid:($WC.Util.isEmpty(e.sender.id)?"":e.sender.id.replace("$",""))+"_"+e.time,msguid:e.message_id})},k=function(e,t){var i=MsgTemplate.getFileDownloadLink("",e.id,e.name,!0),a=MsgTemplate.getCachedImageLink("",e.id,e.name,!0,e.has_thumbnail,!0),d=(new $WC.VideoPlayer).createInitialState(a),s=isFromLHS&&!_currChatID?e.chat.id:_currChatID;Chat.updateDownloadRestriction(e,s),Chat.updateForwardRestriction(e,s);var n=$WC.template.replace(MediaListingTemplates.getHtml(MediaListConstants.VIDEO_GRID_HTML),{download_html:Config.isDownloadForwardRestrictionEnabled()&&Chat.isDownloadRestricted(s)?"":MediaListingTemplates.getHtml(MediaListConstants.MEDIA_DOWNLOAD_HTML)},"InSecureHTML");return n=$WC.template.replace(n,{img_view_url:MsgTemplate.getFileDownloadLink("",e.id,e.name,!0),fname:e.name,img_name:e.name,full_url:i,url:e.id,fsize:$Util.getFileSize(e.size),uid:($WC.Util.isEmpty(e.sender.id)?"":e.sender.id.replace("$",""))+"_"+e.time,chid:s,msguid:$WC.Util.isEmpty(e.message_id)?w(e.id,s):e.message_id,$forward_txt:"common.forward",$jump_to_chat:"goto.message",isv1:!0,hasthumbnail:e.has_thumbnail,hide_selector:isForwardEnabled?"":"dN",forward_hide:isForwardEnabled?"hide":"",fsendername:e.sender.name,msguid:e.message_id,fsender:e.sender?e.sender.id:"",content:e.content_type,msgtime:e.time,displaytime:$Date.date(e.time,{withtime:!0,shorten:!0,shortmonth:!0}),FILETYPE:e.content_type.split("/")[1],CONTENT:e.content_type,PREVIEWFILESRC:i,FILEURL:i,FILEID:s+"_"+e.time+"_"+e.sender.id,$download_txt:"common.download",$more_txt:"common.more"}),$WC.template.replace(n,{CONTENTDIV:d,selection_html:A(e),chat_img_url:MsgTemplate.getSenderField({sender:e.sender.id,time:e.time},{prevmsgsender:""})},"InSecureHTML")},F=function(e,t){var i={image:"zcf-default-img",audio:"zcf-music",video:"zcf-newplay",file:I()?"zc-upldfile dIB":""},a=e.name.split(".");a=a.length-1?a[a.length-1]:e.content_type.split("/")[1];var d=isFromLHS&&!_currChatID?e.chat.id:_currChatID;let s=JSON.stringify({id:e.id,size:e.size});Chat.updateDownloadRestriction(e,d),Chat.updateForwardRestriction(e,d);var n=$WC.template.replace(t,{download_html:Config.isDownloadForwardRestrictionEnabled()&&Chat.isDownloadRestricted(d)?"":MediaListingTemplates.getHtml(MediaListConstants.MEDIA_DOWNLOAD_HTML)},"InSecureHTML");return n=$WC.template.replace(n,{img_view_url:MsgTemplate.getCachedImageLink("",e.id,e.name,!0,e.has_thumbnail,!0),img_name:e.name,original_url:MsgTemplate.getFileDownloadLink("",e.id,e.name,!0),url:e.id,msguid:$WC.Util.isEmpty(e.message_id)?w(e.id,d):e.message_id,size:$Util.getFileSize(e.size),uid:($WC.Util.isEmpty(e.sender.id)?"":e.sender.id.replace("$",""))+"_"+e.time,chid:d,original_width:e&&e.meta&&e.meta.width,original_height:e&&e.meta&&e.meta.height,$forward_txt:"common.forward",$jump_to_chat:"jump.to.chat",isv1:!0,SRC_META:s,loadIcon:i[_currTypeFilter],hasthumbnail:e.has_thumbnail,hide_selector:isForwardEnabled?"":"dN",forward_hide:isForwardEnabled?"hide":"",sender:e.sender.name,fsender:e.sender.id,fcomment:e.comment||"",file_type:a,content:e.content_type,time:e.time,displaytime:$Date.date(e.time,{withtime:!0,shorten:!0,shortmonth:!0}),item_class:_currTypeFilter===MediaListConstants.IMAGE?"ml-image-item":"ml-audio-item",file_save:e.size,empty_icon:"zcf-"+_currTypeFilter,hide_cls:_currTypeFilter===MediaListConstants.FILE?"":"dN",$download_txt:"common.download",$more_txt:"common.more"}),$WC.template.replace(n,{footer_html:b(e),selection_html:A(e),img_name_display:_highlightSearchText(e.name,search_value),chat_img_url:MsgTemplate.getSenderField({sender:e.sender.id,time:e.time},{prevmsgsender:""})},"InSecureHTML")},x=function(e,t){var i,a,d,s=isFromLHS&&!_currChatID?e.chat.id:_currChatID;if(e.unfurled_details){var n=e.unfurled_details,r=n.thumbnailurl,l=n.url,c=n.faviconlink,o=void 0!==e.unfurled_details.html?"":"dN";d=n.title;var m=n.html?$WC.Matcher.replacer($WC.Matcher.getRegexToGetAttrValueInHtmlTag("iframe","src"),null,n.html,(function(e,t,i,a,d,s){return d})):""}else{o="dN";$WC.Matcher.regexes.markdown_link.test(e.text)&&$WC.Matcher.replace("markdown_link",e.text,(function(t,i,a,d,s){e.text=d})),$WC.Matcher.replace("linkRegExp",e.text,(function(e,t,a,d,s){i=e}))}$WC.Matcher.replace("WWWlinkRegExp",e.text,(function(e,t,i,d,s){"www."===d&&(a="https://"+e)}));var _=l||i||e.text;d=d||_,Chat.updateDownloadRestriction(e,s),Chat.updateForwardRestriction(e,s);var p=$WC.template.replace(MediaListingTemplates.getHtml(t),{download_html:Config.isDownloadForwardRestrictionEnabled()&&Chat.isDownloadRestricted(s)?"":MediaListingTemplates.getHtml(MediaListConstants.MEDIA_DOWNLOAD_HTML)},"InSecureHTML");return p=$WC.template.replace(p,{link:a||_,link_name:_,link_title:d,sender:e.sender.name,fsender:e.sender.id,content:e.message_type,contenttype:e.message_type,previewelem:$WC.Util.isEmpty(o)?"previewelem":"",msguid:e.message_id,comment:$WC.Matcher.replace("markdown_link",e.text,this.getLinkHTML),iframe_src:m,$preview_txt:"common.preview",hide_preview:o,hide_selector:isForwardEnabled?"":"dN",forward_hide:isForwardEnabled?"hide":"",img_view_url:r||c,img_name:"",thumbnail_url:c,displaytime:$Date.date(e.time,{withtime:!0,shorten:!0,shortmonth:!0}),time:e.time,item_class:"ml-audio-item",loadIcon:"zcf-link",hide_cls:"dN",uid:($WC.Util.isEmpty(e.sender.id)?"":e.sender.id.replace("$",""))+"_"+e.time,chid:s,img_cls:"ml-img-fit",$download_txt:"common.download",$more_txt:"common.more"}),d=$WC.Util.isEmpty(search_value)?d:_,$WC.template.replace(p,{chat_img_url:MsgTemplate.getSenderField({sender:e.sender.id,time:e.time},{prevmsgsender:""}),selection_html:A(e),link_name_display:_highlightSearchText(d,search_value)},"InSecureHTML")},N=function(e){var t={image:"zcf-default-img",audio:"zcf-music",video:"zcf-newplay",file:I()?"zc-upldfile dIB":"",link:"zcf-link"},i=e[0].dataset.uid,a=$(e).parent().siblings("#empty_thumb");if($(a).removeClass("dN"),$("#details_footer_"+i).removeClass("dN"),$(e).addClass("dN"),"file"===_currTypeFilter&&I()){var d='<div class="zc-upldfile dIB"><span class="ml-file-default posa textC ellips fontB text-transU">.'+$(e).attr("filetype")+"</span></div>";$(a).html(d)}else $(a).addClass(t[_currTypeFilter]);"type"===_currTypeFilter&&$("#download_icon_"+i).addClass("dN")},b=function(e){return $WC.template.replace(MediaListingTemplates.getHtml(MediaListConstants.GRID_FOOTER_HTML),{size:$Util.getFileSize(e.size),img_name:e.name,id:($WC.Util.isEmpty(e.sender.id)?"":e.sender.id)+"_"+e.time,footer_disp:_currTypeFilter===MediaListConstants.IMAGE?"dN":"",icon_cls:_currTypeFilter===MediaListConstants.AUDIO?"zcf-music":_currTypeFilter===MediaListConstants.IMAGE?"zcf-default-img":"dN"})},H=function(){for(var e=SelectedItems.length,t=0;t<e;t++){var i=SelectedItems[t],a=$("#frwdmsginfo_"+i)[0];$("#dropdown_icon_"+i).parents("#att_actions").addClass("forward_sel"),a&&(a.checked=!0)}MediaListingEvents.enableSelection(),SelectedItems=$WC.Util.isEmpty(search_value)&&!_isFilterApplied[_currChatID||def_id]?[]:SelectedItems},z=function(){return $("#recording_category").find(".sel").attr("data-type")||"all"},U=function(e,t){return $zcg._URLPREFIX+"/v2/mediasessions/"+e+"/recordings/"+t+"/thumbnail"},O=function(t,i){i.length?(e.html(W(i)),L()):($("#date_seperater_sticky").addClass("vsbH"),e.addClass("h100"),e.html('<div class="h100 w100">'+function(e){return""!==$("#ml_search_input").val().trim()?R():$WC.template.replace(MediaListingTemplates.getHtml(MediaListConstants.EMPTY_HTML),{image_class:"ml-image-video",$empty_txt1:"media.recordings.noresults."+e+".title",$empty_txt2:"media.recordings.noresults."+e+".hint"})}(t)+"</div>"))},P=function(e,t){$("#recording_category").length>0&&(_currChatID=void 0);var i=e.share_type;if(!RecordingConstants.syncing){RecordingConstants.syncing=!0;var a=MediaStorage.recordingsObj=new CliqListView("recordings","/api/v2/recordings",e,void 0,40,!1,!1,!0);a.resetListView(),a.load((function(e){RecordingConstants.syncing=!1,i===z()&&O(i,e)}),(function(){RecordingConstants.syncing=!1}))}var d=$WC.template.replace(MediaListingTemplates.getHtml(MediaListConstants.BODY_HTML),{tab_menu:"",view_cls:I()?"flexG flexW":""});return $WC.template.replace(d,{actions_band_html:u("recording"),data_container:y(_viewMode)},"InSecureHTML")},W=function(t){e.removeClass("h100"),$("#date_seperater_sticky").removeClass("vsbH");for(var i,a="",d=I(),s=0;s<t.length;s++){var n=t[s],r=n.start_time;(!i||!$Date.isSameDay(r,i))&&(0!==s&&d&&(a+="</div>"),a+=E(r,0==s,!0),d&&(a+='<div id="grid_layout'+s+'" class="gridlay">')),a+=G(n),i=r}return a+="</div>"},G=function(e){var t=e.owner,i=e.shared_by,a=e.start_time,d=z(),s="shared"===d,n=ConferenceImpl.getRecordingName(e),r=!e.audio&&!e.video||void 0!==e.video&&e.video,l=I()?MediaListConstants.GRID_RECORDING_ITEM_HTML:MediaListConstants.LIST_RECORDING_ITEM_HTML,c=r?SecurityManager.hasPermission(Modules.GroupVideoCall,MActions.DownloadRecordings):SecurityManager.hasPermission(Modules.GroupAudioCall,MActions.DownloadRecordings),o=$WC.template.replace(MediaListingTemplates.getHtml(l),{download_html:Config.isDownloadForwardRestrictionEnabled()&&!c?"":MediaListingTemplates.getHtml(MediaListConstants.RECORDING_DOWNLOAD_HTML)},"InSecureHTML");return o=$WC.template.replace(o,{uid:e.id,ref_index:e.index,nrs_id:e.nrs_id,owner_id:"shared"===d?i.id:t.id,owner_name:"shared"===d?Users.getName(i.id,i.name):Users.getName(t.id,t.name),owner_img_url:Users.getImgUrlById(t.id),has_video:r,recording_name:n,maxlen:RecordingConstants.nameMaxLength,duration:CallsHistoryUI.getDurationTime(e.end_time,a),file_size:$Util.getFileSize(e.size),display_time:$Date.date(a,{withtime:!0,shorten:!0,shortmonth:!0}),icon_cls:r?"zcf-newplay":"zcf-music",hide_download:void 0!==i||s?"dN":""}),I()&&(o=$WC.template.replace(o,{content_div:(new $WC.VideoPlayer).createInitialState(U(e.nrs_id,e.index))},"InSecureHTML")),o},B=function(e,t){var i="rhs_recording_dropdown_",a="rhs_recording_dropdown_menu_";q(t)&&(i="recording_dropdown_",a="recording_dropdown_menu_"),Clickoutside.bind({srcid:i+e,destid:a+e})},j=function(e,t,i){var a=$WC.template.replace(MediaListingTemplates.getHtml(MediaListConstants.RECORDING_CONSENT_HTML),{sr_id:e,nrs_id:t,ref_index:i,type:"delete_recording",purpose:"handleRecording",$action_label:"common.yes.delete.it",$cancel_label:"common.cancel"}),d=$WC.template.replace(MediaListingTemplates.getHtml(MediaListConstants.RECORDING_CONSENT_HEADER),{$title:"media.recordings.delete.title",$hint:"media.recordings.delete.hint"});$WC.$Win.create({id:"recording_delete_consent",class:"modalwindow modalwindow2 zcalgncntr deleterecording zcbg_mask",header:d,html:a})},V=function(e,t,i){var a=$WC.template.replace(MediaListingTemplates.getHtml(MediaListConstants.RECORDING_CONSENT_HTML),{sr_id:e,nrs_id:t,ref_index:i,type:"leave_recording",purpose:"handleRecording",$action_label:"emoji.yes",$cancel_label:"emoji.no"}),d=$WC.template.replace(MediaListingTemplates.getHtml(MediaListConstants.RECORDING_CONSENT_HEADER),{$title:"mr.leave.title",$hint:"mr.leave.hint"});$WC.$Win.create({id:"recording_leave_consent",class:"modalwindow modalwindow2 zcalgncntr deleterecording zcbg_mask",header:d,html:a})},Y=function(e){var t=$Util.emptyStateHtml({imageclass:"no_guest_adhocs",title:I18N("media.recordings.nosharedmembers.title")});$("#shared_list_item_html"+e).html(t)},K=function(e,t){var i=e.parent(),a=i.attr("nrs_id"),d=i.attr("ref_index");if("handle_recording_link"===e.attr("data-action")){var s,n,r=i.attr("sr_id");void 0===e.attr("getlink_btn")&&void 0===e.attr("update_btn")&&B(r,a),X(r,a,d),SearchField.init("sharerecording-users-selection");var l=0,c=function(e,i){var s="",n="",l=e.length,c=i.length;if(void 0===RecordingLinksStorage[r]&&(RecordingLinksStorage[r]={}),void 0===RecordingSharedUsersStorage[r]&&(RecordingSharedUsersStorage[r]={}),c||l){for(var o=0;o<e.length;o++){var m,_=e[o],p=_.expiry_time;if(RecordingLinksStorage[r][_.id]=_,m=void 0===_.password?I18N("mr.permalink.nopasswordhint"):I18N("mr.permalink.passwordhint"),void 0!==p)if(p<Date.now())m+=" / "+I18N("mr.permalink.expired");else{var u=$Date.date(p,{withtime:!1,shorten:!0,shortmonth:!1});u=u!=I18N("date.yesterday")&&u!=I18N("date.today")&&u!=I18N("date.tomorrow")?I18N("common.on")+" "+u:u.toLowerCase(),m+=" / "+Resource.getRealValue("mr.permalink.expiryhint",[$WC.$CUtil.processXSS(u)])}var g=t===_.id,h=_.name;s+=$WC.template.replace(MediaListingTemplates.getHtml(MediaListConstants.SHARED_LINK_ITEM),{link_id:_.id,link_name:h,link_desc:m,sr_id:r,nrs_id:a,ref_index:d,tool_tip:h.length>30?h:"",options_position:0===o?"bottom":"top",new_link_cls:g?"unseen":"",new_link_attr:g?"documentclick=removeUnSeenTag":""})}for(var o in i){var v=i[o];RecordingSharedUsersStorage[r][v.id]=v;var f=$WC.template.replace(MediaListingTemplates.getHtml(MediaListConstants.SHARED_USER_ITEM),{user_id:v.id,user_name:Users.getName(v.id,v.name),user_email:Users.getEmailId(v.id)||v.email_id,user_img:Users.getImgUrlById(v.id),user_status:Contacts.getStatusStyle(v.id)});n+=f=$WC.template.replace(f,{user_tag:Users.getTag(v.id)},"InSecureHTML")}var C=$WC.template.replace(MediaListingTemplates.getHtml(MediaListConstants.SHARED_LIST_ITEM_HTML),{shared_links_list:s,shared_users_list:n},"InSecureHTML");C=$WC.template.replace(C,{sr_id:r,shared_links_count:l,shared_members_count:c,members_cls:c?"":"dN",links_cls:l?"":"dN"}),$("#shared_list_item_html"+r).html(C)}else Y(r)};if(void 0!==e.attr("init"))MediaActions.getRecordingLinks(a,d,(function(e){s=e,2===(l+=1)&&c(s,n)})),MediaActions.getRecordingSharedUsers(a,d,(function(e){n=e,2===(l+=1)&&c(s,n)}));else{var o=[],m=[],_=RecordingLinksStorage[r];void 0!==_&&(o=Object.values(_));var p=RecordingSharedUsersStorage[r];void 0!==p&&(m=Object.values(p)),c(o,m)}}else{MediaActions.shareRecording(a,d,Z.getSelectedListValues(),(function(){$WC.$Win.destroy("share_recording_win")}))}},X=function(e,t,i){var a=$("#recording_category").length>0||$("#media_listing_view_modal").length>0||$("#chatwindow_filestab").length>0?MediaStorage.recordingsObj.getObject(e):CallsHistoryUI.getRecordingStorage[e],d=a.owner,s=ConferenceImpl.getRecordingName(a),n=$WC.template.replace(MediaListingTemplates.getHtml(MediaListConstants.SHARE_RECORDING_WIN_HTML),{name:s,sr_id:e,nrs_id:t,owner_id:d.id,ref_index:i,id:Z.id,tool_tip:s.length>35?s:"",size:$Util.getFileSize(a.size),owner_name:Users.getName(d.id,d.name),$place_holder:"message.forward.node.placeholder"});n=$WC.template.replace(n,{shared_list_item_html:TemplateUtil.getLoaderHtml()},"InSecureHTML"),$WC.$Win.create({id:"share_recording_win",class:"zcl-win-modal1 share-record-modal zcalgncntr",html:n})},Z={id:"sharerecording-users-selection",limit:RecordingConstants.shareLimit,getResultsListID:function(){return this.id+"-list"},getResultsListContainer:function(){return $("#"+this.getResultsListID())},getResultsContainerID:function(){return this.id+"-results"},getResultsContainer:function(){return $("#"+this.getResultsContainerID())},getSearchFieldInputID:function(){return this.id+"-search-field"},getSelectedListValues:function(){var e=[];return $("#"+this.id).find("[data-selections]").children().each((function(){this.hasAttribute("key")&&e.push(this.getAttribute("key"))})),e},getSharedListValues:function(e){var t=[];return $("#shared_users_list"+e).children("[uid]").each((function(){t.push(this.getAttribute("uid"))})),t},search:function(e){this.getResultsListContainer().empty();var t=this.getSelectedListValues();if(!(t.length>=this.limit)){var i={searchin:SearchAgent.CONTACTS+SearchAgent.ORGCONTACTS,val:e,ignorelist:t.concat(this.getSharedListValues($("#share_recording_popup").attr("sr_id"))),listid:this.getResultsListID(),contactshtml:SearchHTML.user_v2,orgcontactshtml:SearchHTML.user_v2,clearcallback:function(){this.clear()}.bind(this)},a=SearchAgent.search(i);return a?this.displayResultDOM():this.clear(),a}UI.updateBanner(Resource.getRealValue("common.sel.user.limit",[this.limit]),2e3,!0)},handleAction:function(){var e=$("#"+this.id).find("[share_btn]");this.getSelectedListValues().length>0?e.removeAttr("disabled"):e.attr("disabled","")},clear:function(){this.handleAction(),this.getResultsContainer().hide(),this.getResultsListContainer().empty(),Clickoutside.clear(this.getResultsContainerID())},displayResultDOM:function(){if(!(this.getSelectedListValues().length>=this.limit)){var e=this.getResultsContainer();e.find("[purpose='search']").first().addClass("srchbn sel"),e.is(":visible")||Clickoutside.bind({srcid:this.getSearchFieldInputID(),destid:this.getResultsContainerID()}),ZCScroll.scrollTop(e,0)}}},q=function(e){return 0===$("#call_info_win"+e).length&&0===$("#callhistory_details_container").length};return{bindEvents:l,getMediaHTML:c,showPopup:function(i){if(Config.isMinimizeWindowEnabled()){let e=MediaDomIDS.WIN_ID+i+"minimised";if($("#"+MediaDomIDS.WIN_ID).length&&$WC.$Win.destroy(MediaDomIDS.WIN_ID),MinimizedWindows.isMinimisedWindow(e))return void MinimizedWindows.maximiseWindow(e)}isFromCwin=!1,isFromLHS=!1;var d=(_currChatID=i)||def_id;isGuest=ConversationsList.get(_currChatID).isGuestChat,search_value="",-1===MediaFilterCategories.indexOf(MediaListConstants.LINK)&&MediaFilterCategories.push(MediaListConstants.LINK),t();var s=o(),n=Cliq_Window_Modal.create({id:MediaDomIDS.WIN_ID,class:"zcl-fullwin-modal",header_html:s,additionalattrs:"chid="+_currChatID,minimise_btn:Config.isMinimizeWindowEnabled()?Template.getMinimizeBtn(MediaDomIDS.WIN_ID):"",category_html:MediaListingTemplates.getFilterHtml(MediaListConstants.TYPE_FILTER),closebeforecallback:function(){_()},closefn:function(){Config.isClientMemoryOptimizationEnabled()&&(e=null,n=null),Config.isMinimizeWindowEnabled()&&a()}});_currTypeFilter=m(),ZCTrack.track("MEDIA_GALLERY_FEATURE",{TRIGGER:_currTypeFilter,SOURCE:"Chat Window"}),M(_currTypeFilter),AppliedFilter[d]={},FilterStorage[d]={},_isFilterApplied[d]=!1,c(),e=$("#ml-data-container"),l(n),L(),isForwardEnabled=!1,SelectedItems=[],ForwardParamMsguids=[],SELECTED_LEN=0,_currDateFilter="",_currSharedByFilter=MediaListConstants.ALL},getApiErrorHtml:function(){return $WC.template.replace(MediaListingTemplates.getHtml(MediaListConstants.API_FAILURE_HTML),{$api_error_txt:"ml.api.error",$btn_txt:"try.again"})},updateListUI:g,highlightType:M,appendContent:f,isLink:function(e){return $WC.Matcher.check("linkRegExp",e)},setCurrChatid:function(e){_currChatID=e,isFromLHS=!1,isFromCwin=!0,SelectedItems=[],ForwardParamMsguids=[],SELECTED_LEN=0,_currDateFilter="",_currSharedByFilter=MediaListConstants.ALL},getLoader:y,mediaListScroll:function(t){t.target;var i='<div id="loadingblock">'+y(_viewMode)+"</div>",a=_currChatID||def_id;e&&"undefined"!==e[0].dataset.uid&&(isFromLHS=!1,_currChatID=e[0].dataset.uid),!$("#loadingblock").length&&(!_isFilterApplied[a]&&MediaStorage[a]&&MediaStorage[a][_currTypeFilter]&&!MediaStorage[a][_currTypeFilter].fetchComplete||_isFilterApplied[a]&&AppliedFilter[a]&&!AppliedFilter[a][MediaListConstants.FETCHCOMPLETE])&&C(i),MediaStorage[a]&&MediaStorage[a][_currTypeFilter]&&!MediaStorage[a][_currTypeFilter].fetchComplete&&!_isFilterApplied[a]?h(f,_currTypeFilter,!0):_isFilterApplied[a]&&AppliedFilter[a]&&!AppliedFilter[a][MediaListConstants.FETCHCOMPLETE]&&($("#recording_category").length>0||"recording"===_currTypeFilter?MediaListingUI.handleRecordingFilter(AppliedFilter[a]):MediaActions.getFilteredMedia(_currChatID,AppliedFilter[a],f,"",!0))},recordingListScroll:function(){var t=MediaStorage.recordingsObj;!RecordingConstants.syncing&&t.hasLoadMore()&&(RecordingConstants.syncing=!0,t.loadMore((function(t){RecordingConstants.syncing=!1,t.length&&(e.append(W(t)),$("#date_seperater_"+t[0].start_time).removeClass("vsbH"))}),(function(){RecordingConstants.syncing=!1})))},updtaeEmptyThumb:N,showMediaWFilters:function(t,i,a,d){var s=_currChatID||def_id,n='<div id="loadingblock">'+y(_viewMode)+"</div>";$("#date_seperater_sticky").text(""),e.html(n),$("#recording_category").length>0||"recording"===_currTypeFilter?MediaListingUI.handleRecordingFilter(AppliedFilter[s]):MediaActions.getFilteredMedia(_currChatID,AppliedFilter[s],MediaListingUI.updateListUI,"",!1)},appendToChatWin:function(i){isFromCwin=!0,isFromLHS=!1;var a=(_currChatID=i)||def_id,d=$("#"+_currChatID).find("[files_tab]");isGuest=ConversationsList.get(_currChatID).isGuestChat,-1===MediaFilterCategories.indexOf(MediaListConstants.LINK)&&MediaFilterCategories.push(MediaListConstants.LINK),t(),search_value="";var s=c();d.html(s),_currTypeFilter=m(),ZCTrack.track("MEDIA_GALLERY_FEATURE",{TRIGGER:_currTypeFilter,SOURCE:"Chat Window"}),AppliedFilter[a]={},FilterStorage[a]={},_isFilterApplied[a]=!1,e=$("#ml-data-container"),l(d),L(),isForwardEnabled=!1,SelectedItems=[],ForwardParamMsguids=[],SELECTED_LEN=0,_currDateFilter="",_currSharedByFilter=MediaListConstants.ALL,M(_currTypeFilter)},getAllFiles:function(t){isFromCwin=!1,isFromLHS=!0,_currChatID=t,search_value="",e=void 0;var i=c();return(_currTypeFilter=m())===MediaListConstants.RECORDING&&(_currTypeFilter=MediaListConstants.IMAGE,$DB.update("lastAccMediaType",MediaListConstants.IMAGE)),ZCTrack.track("MEDIA_GALLERY_FEATURE",{TRIGGER:_currTypeFilter,SOURCE:"LHS Files Tab",TYPE:t?"Taz":"Shared in Cliq"}),AppliedFilter[def_id]={},FilterStorage[def_id]={},_isFilterApplied[def_id]=!1,setTimeout((function(){e=$("#ml-data-container"),L(),isForwardEnabled=!1,SelectedItems=[],ForwardParamMsguids=[],SELECTED_LEN=0,_currDateFilter="",_currSharedByFilter=MediaListConstants.ALL}),100),i},getRecordings:P,getActionBandHtml:u,getSelectedRecordingCategory:z,getRecordingThumbnailUrl:U,populateRecordings:O,handleRecordingFilter:function(e){$("#ml-data-container").html(MediaListingUI.getLoader(I()?MediaListConstants.GRID_MODE:MediaListConstants.LIST_MODE));var t={share_type:z()};e.fromtime&&(t.from=e.fromtime),e.totime&&(t.to=e.totime),e.userids&&(t.user_ids=[e.userids].join()),e.chatId&&(t.chat_id=e.chatId);var i=$("#ml_search_input"),a=i.length>0?i.val().trim():"";""!==a&&(t.search=a),P(t)},handleRecordingMoreOptions:function(e,t){var i=t.getAttribute("uid"),a=t.getAttribute("nrs_id"),d=q(a),s=d?$("#recording_item_"+i):$("#rhs_recording_item_"+i),n="shared"===z(),r=$("#recording_category").length>0||$("#media_listing_view_modal").length>0||$("#chatwindow_filestab").length>0,l=r?MediaStorage.recordingsObj.getObject(i):CallsHistoryUI.getRecordingStorage[i],c=l.video?SecurityManager.hasPermission(Modules.GroupVideoCall,MActions.ForwardRecordings):SecurityManager.hasPermission(Modules.GroupAudioCall,MActions.ForwardRecordings),o=l.owner;s.addClass("active zindex1");var m=$WC.template.replace(MediaListingTemplates.getHtml(MediaListConstants.RECORDING_DROPDOWN_HTML),{uid:i,nrs_id:a,ref_index:t.getAttribute("ref_index"),hide_options:n||o.id!==getZuid()?"dN":"",hide_leave:n?"":"dN",hide_meeting_info:r&&!n&&d?"":"dN",hide_copy_permalink:n?"dN":"",share_restriction:c?"":"dN"}),_="recording_dropdown_",p="recording_dropdown_menu_";d||(_="rhs_recording_dropdown_",p="rhs_recording_dropdown_menu_");var u=$("#"+p+i);u.html(m),Clickoutside.bind({srcid:_+i,event:e,destid:p+i,customHide:function(){u.empty(),s.removeClass("active zindex1")}})},showMeetingInfo:function(e){var t=e.parent(),i=t.attr("nrs_id"),a=t.attr("sr_id");void 0!==a&&B(a,i),CallHistoryData.getSessionByNRSId(i,e=>{var t=e.data;t.session_id=t.nrs_id,HuddleWidgetHandler.store[i]={native_widget:{data:t}},HuddleWidgetHandler.showCallPreview(i,"members")})},handleRenameRecording:function(e){var t=e.parent(),i=t.attr("sr_id"),a=t.attr("nrs_id"),d=q(a),s=d?$("#recording_name_"+i):$("#rhs_recording_name_"+i),n=d?$("#recording_nameinput_"+i):$("#rhs_recording_nameinput_"+i),r=$("#recording_category").length>0||$("#media_listing_view_modal").length>0||$("#chatwindow_filestab").length>0;if("editname"===e.attr("data-action")){B(i,a);var l=r?MediaStorage.recordingsObj.getObject(i):CallsHistoryUI.getRecordingStorage[i];s.addClass("dN"),n.removeClass("dN").val(l.name).focus()}else{var c=t.attr("ref_index"),o=(l=r?MediaStorage.recordingsObj.getObject(i):CallsHistoryUI.getRecordingStorage[i],function(e,t){t&&(l.name=e,r?MediaStorage.recordingsObj.updateObject(i,l):CallsHistoryUI.getRecordingStorage[i]=l);e=ConferenceImpl.getRecordingName(l);n.addClass("dN"),I()&&s.attr("title",e),s.text(e).removeClass("dN")}),m=e.val().trim(),_=l.name.trim();$WC.Util.isEmpty(m)||m===_?o(_,!1):MediaActions.updateRecording(a,c,m,o)}},handleDeleteRecording:function(e){var t=e.parent(),i=t.attr("nrs_id"),a=t.attr("sr_id"),d=t.attr("ref_index");if("consent"===e.attr("data-action"))B(a,i),j(a,i,d);else{MediaActions.deleteRecording(i,d,e,(function(){if(q(i)){var e=MediaStorage.recordingsObj;e.deleteObject(a),O(z(),e.getAllFromClient())}else if(delete RecordingLinksStorage[a],delete RecordingSharedUsersStorage[a],delete CallsHistoryUI.getRecordingStorage[a],$("#rhs_recording_item_"+a).remove(),0===$("#recording_rhs_list").children().length){var t=`<div class="flexG wh100 flexM fdirC">\n\t\t\t    \t\t\t\t<div class="font17 clr-lp1 line22 textC m30">${I18N("media.recordings.none")}</div>\n\t\t\t    \t\t\t</div>`;$("#callhistory-preview-container").html(t)}$WC.$Win.destroy("recording_delete_consent")}))}},handleLeaveRecording:function(e){var t=e.parent(),i=t.attr("nrs_id"),a=t.attr("sr_id"),d=t.attr("ref_index");if("consent"===e.attr("data-action"))B(a,i),V(a,i,d);else{MediaActions.leaveRecording(i,d,e,(function(){var e=MediaStorage.recordingsObj;e.deleteObject(a),O(z(),e.getAllFromClient()),$WC.$Win.destroy("recording_leave_consent")}))}},handleShareRecording:K,shareRecordingUsersSuggestion:Z,handleRevokeRecording:function(e){var t=e.attr("uid");if("show_options"===e.attr("data-action"))Clickoutside.bind({srcid:"revokerecordingelem"+t,destid:"revokerecordingdropdown"+t});else{var i=$("#share_recording_popup"),a=i.attr("sr_id");MediaActions.revokeRecording(i.attr("nrs_id"),i.attr("ref_index"),t,e,(function(){var e=$("#shareduser"+t),i=$("#shared_user_count");UI.updateBanner(Resource.getRealValue("media.recordings.revoke.banner",[$WC.$CUtil.processXSS(e.attr("user_name"))])),e.remove(),delete RecordingSharedUsersStorage[a][t],i.text(parseInt(i.text())-1),0===$("#shared_users_list"+a).children().length&&(0===$("#shared_links_list"+a).children().length?$("#shared_list_item_html"+a).html(Y(a)):$("#shared_user_title").addClass("dN"))}))}},handleCopyRecordingLink:function(e){$Util.copyTextToClipboard(Conference.getRecordingLink(e.attr("uid")),(function(){UI.updateBanner(I18N("mr.permalink.copied.banner"))}))},handlePasswordVisibility:function(e){let t=$("#recording-link-password-text");"hidden"===e.attr("visibility_type")?(t.prop("type","text"),e.attr("visibility_type","visible").addClass("zcf-visible").removeClass("zcf-hidden")):(t.prop("type","password"),e.attr("visibility_type","hidden").addClass("zcf-hidden").removeClass("zcf-visible")),t.focus()},showCreateEditRecordingLinkWin:function(e){var t=$("#share_recording_popup"),i=t.attr("sr_id"),a=void 0!==e.attr("create_win");if(a&&$("#shared_links_list"+i).children().length>=RecordingConstants.linkLimit)UI.updateBanner(Resource.getRealValue("recording.link.limit.reached",[RecordingConstants.linkLimit]),2e3,!0);else{var d,s,n="",r="",l="",c=!1,o=!1,m=t.attr("nrs_id"),_=t.attr("ref_index"),p=$("#recording_category").length>0||$("#media_listing_view_modal").length>0||$("#chatwindow_filestab").length>0?MediaStorage.recordingsObj.getObject(i):CallsHistoryUI.getRecordingStorage[i],u=ConferenceImpl.getRecordingName(p),g=new Date((new Date).getTime()+864e5);if(defaultTime=$Date.append0(g.getDate())+"/"+$Date.append0(g.getMonth()+1)+"/"+$Date.append0(g.getFullYear()),!a){n=e.attr("uid");var h=RecordingLinksStorage[i][n];r=h.name,c=void 0!==(l=h.password),(o=void 0!==(s=h.expiry_time))&&(s=new Date(s),d=$Date.append0(s.getDate())+"/"+$Date.append0(s.getMonth()+1)+"/"+$Date.append0(s.getFullYear()))}var v=$WC.template.replace(MediaListingTemplates.getHtml(MediaListConstants.CREATE_RECORDING_LINK_WIN),{name:u,sr_id:i,nrs_id:m,link_id:n,link_name:r,ref_index:_,link_cls:"dN",tool_tip:u.length>35?u:"",password_value:c?l:"",name_limit:RecordingConstants.linkNameMaxLength,edit_hint_cls:a?"dN":"",time_text:o?d:defaultTime,password_limit:RecordingConstants.linkPasswordMaxLength,password_checked:c?"checked":"",expiry_checked:o?"checked":"",expiry_cls:a||!o?"dN":"",password_cls:a||!c?"dN":"",button_attr:a?"getlink_btn":"update_btn",time:o?s.getTime():g.getTime(),$header_title:a?"mr.sharevialink":"mr.editlink.header",$button_label:a?"mr.permalink.get":"common.savechanges"});t.html(v),$("#recording-link-name-text").focus(),$("#rec-link-expiry-date-picker").zdatepicker({forElement:"#expiry"+i,navigationBar:{navigationButtonsDisplayPattern:"together"},monthsPerView:1,position:"bottom",change:function(e){var t=$("#expiry"+i),a=e.detail;t.attr("time",a.value.getTime()),t.text(a.valueString)},minDate:defaultTime})}},handleCreateEditRecordingLink:function(e){var t=$("#share_recording_popup"),i=t.attr("sr_id"),a=t.attr("nrs_id"),d=t.attr("ref_index"),s=void 0!==e.attr("donebutton");if(void 0!==e.attr("backbutton")||s)$WC.$Win.destroy("share_recording_win"),K(e,s?e.attr("uid"):void 0);else{var n=$("#expiry"+i),r=$("#recording-link-name-text"),l=r.val();if($WC.Util.isEmpty(l))return r.focus(),void UI.updateBanner(I18N("mr.permalink.linkname.limit"),2e3,!0);var c={name:$("#recording-link-name-text").val()};if($("#recording-link-password").prop("checked")){var o=$("#recording-link-password-text").val();if(o.length<RecordingConstants.linkPasswordMinLength)return void UI.updateBanner(Resource.getRealValue("mr.permalink.password.limit",[RecordingConstants.linkPasswordMinLength]),2e3,!0);c.password=o}if($("#recording-link-calendar").prop("checked")&&(c.expiry_time=parseInt(n.attr("time"))),void 0!==e.attr("getlink_btn")){MediaActions.createRecordingLink(a,d,c,e,(function(e){var s=$("#recording_category").length>0||$("#media_listing_view_modal").length>0||$("#chatwindow_filestab").length>0?MediaStorage.recordingsObj.getObject(i):CallsHistoryUI.getRecordingStorage[i],n=s.owner,r=ConferenceImpl.getRecordingName(s),l=e.password,c=e.expiry_time,o=void 0!==l,m=void 0!==c;c=m?new Date(c):new Date((new Date).getTime()+864e5);var _=$Date.date(s.start_time,{withtime:!1,shorten:!0,shortmonth:!1});_=_!=I18N("date.yesterday")&&_!=I18N("date.today")&&_!=I18N("date.tomorrow")?I18N("common.on")+" "+_:_.toLowerCase(),RecordingLinksStorage[i][e.id]=e;var p=$WC.template.replace(MediaListingTemplates.getHtml(MediaListConstants.CREATE_RECORDING_LINK_WIN),{name:r,sr_id:i,nrs_id:a,owner_id:n.id,ref_index:d,link_id:e.id,time:c.getTime(),cancel_cls:"dN",recorded_time:_,link_name:e.name,edit_hint_cls:"dN",date_icon_cls:"dN",button_attr:"donebutton",disabled_attr:"disabled",read_only_attr:"readonly",$button_label:"common.done",tool_tip:r.length>25?r:"",$header_title:"mr.sharevialink",password_value:o?l:"",owner_name:Users.getName(n.id,n.name),password_cls:o?"":"dN",expiry_cls:m?"":"dN",link:Conference.getRecordingLink(e.id),disabled_cls:"zcl-input-info zcdisabled",password_checked:o?"checked":"",expiry_checked:m?"checked":"",time_text:$Date.append0(c.getDate())+"/"+$Date.append0(c.getMonth()+1)+"/"+$Date.append0(c.getFullYear())});t.html(p)}))}else if(void 0!==e.attr("update_btn")){var m=e.attr("uid");MediaActions.updateRecordingLink(a,d,m,c,e,(function(){$WC.$Win.destroy("share_recording_win"),RecordingLinksStorage[i][m]=$.extend(c,{id:m}),K(e,e.attr("uid"))}))}}},showDeleteRecordingLinkConsent:function(e){var t=$("#share_recording_popup"),i=$WC.template.replace(MediaListingTemplates.getHtml(MediaListConstants.RECORDING_CONSENT_HTML),{nrs_id:t.attr("nrs_id"),ref_index:t.attr("ref_index"),sr_id:t.attr("sr_id"),uid:e,type:"delete_recording_link",purpose:"handleRecording",$action_label:"common.delete",$cancel_label:"common.cancel"}),a=$WC.template.replace(MediaListingTemplates.getHtml(MediaListConstants.RECORDING_CONSENT_HEADER),{$title:"mr.deletelink.title",$hint:"mr.deletelink.hint"});$WC.$Win.create({id:"recording_deletelink_consent",class:"modalwindow modalwindow2 zcalgncntr deleterecording zcbg_mask",header:a,html:i})},deleteRecordingLink:function(e){var t=e.attr("uid"),i=$("#share_recording_popup"),a=i.attr("sr_id"),d=i.attr("nrs_id"),s=i.attr("ref_index");MediaActions.deleteRecordingLink(d,s,t,e,(function(){var e=$("#sharedlink"+t),i=$("#shared_link_count"),d=$("#shared_links_list"+a);e.remove(),delete RecordingLinksStorage[a][t],i.text(parseInt(i.text())-1),0===d.children().length?0===$("#shared_users_list"+a).children().length?$("#shared_list_item_html"+a).html(Y(a)):$("#shared_link_title").addClass("dN"):$("#recordinglinkoptions"+d.children().first().attr("uid")).attr("align","bottom"),$WC.$Win.destroy("recording_deletelink_consent")}))},copyRecordingPermalink:function(e){var t=e.parent(),i=t.attr("nrs_id"),a=t.attr("ref_index"),d=t.attr("sr_id");B(d,i),$Util.copyTextToClipboard($zcg._SERVERURL+"/conferences/"+i+"/recordings/"+a,(function(){UI.updateBanner(I18N("channel.link.copied"))}))},getHeaderHtml:o,callMediaAPI:h,getLastAccessedMediaType:m,putLastAccessedMediaType:_,getMetaData:function(){return _currChatID},updateView:function(){var e=$("#ml-data-container");$('[data-action="switchListView"]').attr("title",Resource.getRealValue("media."+_viewMode)),(_viewMode=I()?MediaListConstants.LIST_MODE:MediaListConstants.GRID_MODE)===MediaListConstants.GRID_MODE?(e.addClass("flexG flexW"),$("#view_switch_icon").removeClass("zcf-media-grid").addClass("zcf-list-view")):(e.removeClass("gridI flexW"),$("#view_switch_icon").removeClass("zcf-list-view").addClass("zcf-media-grid"))}}}(),MediaListStorage={};MediaListStorage=function(){var e={},t={};return{getMedia:function(t,i){return i?$.extend({},e[t][i]):$.extend({},e[t])},addMedia:function(t,i,a){if(t&&i[a].data.length){if(3==Object.keys(e).length){var d,s,n=$Util.getSyncedCurrentTime();for(s in e)if(n>(d=e[s][MediaListConstants.LASTACCESS_TIME])){n=d;var r=s}delete e[r]}e[t]=i,e[t][MediaListConstants.LASTACCESS_TIME]=$Util.getSyncedCurrentTime()}else t||(e.all=i)},removeChatMediaUsingId:function(t){e[t]&&delete e[t]},getCurrGridCount:function(i,a){return _isFilterApplied[i||"0"]?t[i||"0"]?t[i||"0"][a]:0:(i=i||MediaListConstants.ALL,e[i][a][MediaListConstants.CURR_GRID_COUNT])},setCurrGridCount:function(i,a,d){_isFilterApplied[i||"0"]?(t[i||"0"]=t[i||"0"]||{},t[i||"0"][a]=d):(i=i||MediaListConstants.ALL,e[i][a][MediaListConstants.CURR_GRID_COUNT]=d)},clearStorage:function(){e={}},isExist:function(t,i){return i&&e[t]?!$WC.Util.isEmpty(e[t][i]):!$WC.Util.isEmpty(e[t])},addToTop:function(t,i,a){e[t]&&e[t][a]&&e[t][a].data.unshift(i),e[MediaListConstants.ALL]&&e[MediaListConstants.ALL][a]&&e[MediaListConstants.ALL][a].data.unshift(i)},removeDeleted:function(t,i,a){var d=_currChatID||def_id;if(e[t]&&e[t][a]&&e[t][a].data.filter((function(d){d.message_id!==i||e[t][a].data.splice(e[t][a].data.indexOf(d),1)})),e[MediaListConstants.ALL]&&e[MediaListConstants.ALL][a]&&e[MediaListConstants.ALL][a].data.filter((function(t){t.message_id!==i||e[MediaListConstants.ALL][a].data.splice(e[MediaListConstants.ALL][a].data.indexOf(t),1)})),!$("#ml-data-container").length&&!$("#win-rhs-container").length||_isFilterApplied[d]){if(_isFilterApplied[d]){FilterStorage[d]&&FilterStorage[d].filter((function(e){e.message_id!==i||FilterStorage[d].splice(FilterStorage[d].indexOf(e),1)}));var s=FilterStorage[d].length?FilterStorage[d]:"";MediaListingUI.updateListUI("",s,0===FilterStorage[d].length)}}else MediaListingUI.updateListUI()}}}();