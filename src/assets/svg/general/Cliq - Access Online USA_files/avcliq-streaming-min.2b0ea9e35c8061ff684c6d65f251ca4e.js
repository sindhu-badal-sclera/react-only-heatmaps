var PrimeTimeUI={},PrimeTimeImpl={},PrimeTimeAPI={};PrimeTimeUI={hasUserInteracted:!1,showRequestContainerTimeout:void 0,windowCloseTimeout:void 0,bindEvents:function(){var e=$(document);e.on("click","[primetimebuttons]",(function(e){e.stopPropagation();var i=$(this),t=i.attr("purpose");PrimeTimeHandler.UIEvents[t](e,i)})),e.on("dblclick","[ptdoubleclickbuttons]",(function(e){e.stopPropagation();var i=$(this),t=i.attr("purpose");PrimeTimeHandler.UIEvents[t](e,i)})),e.on("change","[primetimeradiobuttons] [type='radio']",(function(e){var i=$(this),t=i.parents("[primetimeradiobuttons]").attr("purpose");PrimeTimeHandler.UIOnChangeEvents[t](e,i)})),e.on("change","[primetimecheckbox] [type='checkbox']",(function(e){var i=$(this),t=i.parents("[primetimecheckbox]").attr("purpose");PrimeTimeHandler.UIOnChangeEvents[t](e,i)})),e.on("focus","[primetimeinput]",(function(e){$Dom.limitInput($(this))})),e.on("keyup","[primetimeinput]",(function(e){$Dom.limitInput($(this)),PrimeTimeImpl.validateStartInputs()})),e.on("keydown","[primetimeinput]",(function(e){e.which===$zcg.ENTER_KEYCODE&&(e.preventDefault(),PrimeTimeHandler.UIEvents.showStartUIPreviewPage())})),e.on("mousemove","[primetimecontainer]",(function(e){clearTimeout(PrimeTimeImpl.windowActiveTimeout);var i=$(this).addClass("PT-win-active");PrimeTimeImpl.windowActiveTimeout=setTimeout((function(){i.removeClass("PT-win-active")}),PrimeTimeImpl.windowActiveTimoutDuration)})),e.on("transitionend","[primetimetransition]",(function(e){if(e.target===e.currentTarget){var i=$(this),t=i.attr("transition-purpose");PrimeTimeHandler.UITransitionEvents[t](e,i)}})),PrimeTimeImpl.shakaPlayer.isIncluded()&&shaka.polyfill.installAll()},isCurrentChat:function(e){return $("#primetimechatsection").find("#"+e).length>0},isChatInView:function(){return $("#primetimewindow").hasClass("show-aside")&&$("#primetimerhscnt").hasClass("huddl-chat-view")},isRequestDeniedPopupExists:function(){return $('[purpose="hideRequestCancelledNotification"]').length>0},showRequestCancelledNotification:function(){$("[speakerrequestwrapper]").append(PrimeTimeTemplates.getRequestCancellationPopupHtml())},getSelectedMode:function(e){return e.find("#pthandshakecheckbox").is(":checked")?PrimeTime.modes.HANDSHAKE:PrimeTime.modes.ASSEMBLY},showStartWin:function(e,i,t,s){Settings.isDarkModeChoosed()||Settings.loadDarkModeFiles();var r=$WC.template.replace('<div class="clr-H fontb font16">{{start_primetime}}</div><div class="clr-S font15 mT5">{{start_primetime_hint}}</div>',{$start_primetime:"media.primetime",$start_primetime_hint:"primetime.start.hint"}),n="rhsoverly PT-modal PT-initial-page ";n+=PrimeTime.isHandShakeMode(e)?"PT-handshake":"PT-assembly",PrimeTime.isAssemblyModeAllowed()||(n+=" PT-assembly-disabled ");var a=$WC.$Win.create({id:"start_primetime_win",class:n,aligncenter:!1,closeoutside:!0,header:r,html:PrimeTimeTemplates.getStartUIHtml(e,i),closebeforefn:function(){window.history.pushState({},null,$Util.getUrlPrefix()+"/index.do"),$("#start_primetime_win").attr("started")||PrimeTimeImpl.currentUpStream&&(WebRTCUserMedia.closeStream(PrimeTimeImpl.currentUpStream._getType()),PrimeTimeImpl.currentUpStream=void 0)}});if($("#pt-team-selection").length&&(PrimeTimeImpl.teamSuggestion=new TeamSuggestions("pt-team-selection",4),PrimeTimeImpl.teamSuggestion.onChange=function(){PrimeTimeImpl.validateStartInputs()},MediaManager.isTeamScope(i)&&!$WC.Util.isEmpty(t)&&s&&s.teamDetails&&t.forEach((function(e){SearchField.insertSelection("pt-team-selection","group",e,s.teamDetails[e].name)}))),SearchField.init("pt-chat-selection"),MediaManager.isChatScope(i)&&!$WC.Util.isEmpty(t[0])){var o=ConversationsList.getTitle(t[0])||ChatHistoryTitleSearch.getTitle(t[0]);s&&s.chatTitle&&$WC.Util.isEmpty(o)&&(o=s.chatTitle),SearchField.insertSelection("pt-chat-selection","chat",t[0],o),a.find("[chat_name_input]").val($WC.Util.decodeHTMLEntities(o))}a.find("#pttopic").focus()},showNotification:function(e,i){if(!this.isInMinimizedView()){var t=$("#ptnotificationcontainer");t.append(PrimeTimeTemplates.getNotificationHtml(e,i)),t.find('[notifylistitem][userId="'+i.getId()+'"]').handleAnimationEnd()}},showInfoModal:function(){var e=PrimeTimeImpl.getCurrentSession();!PrimeTimeUI.hasUserInteracted&&e&&(PrimeTimeImpl.isPrimeTimeTab()||PrimeTimeImpl.isHuddleStreamingTab())&&$("#primetimewindow").append(PrimeTimeTemplates.getInfoModalHtml())},showSessionEndInfo:function(e,i){var t=PrimeTimeImpl.getCurrentSession(),s=void 0!==t&&t.isConferenceStreaming()?"cs":"primetime",r="primetime.session.ended.header",n="";if(e===ZCMediaConstants.endCases.fullRoom)r="media.room.full",n=Resource.getRealValue("media.room.full.hint");else if(e===ZCMediaConstants.endCases.unsupportedBrowserVersion)r="",n=Resource.getRealValue(s+".browser.version.unsupported");else if(e===ZCMediaConstants.endCases.unsupportedBrowser){r="";var a='<span class="text-transC">'+$Util.Browser.getBrowserName()+"</span>";n=Resource.getRealValue(s+".browser.unsupported",a)}else if(t){var o=t.getTitle();e===ZCMediaConstants.endCases.sessionEnd?n=Resource.getRealValue(s+".session.ended",[$WC.$CUtil.processXSS(t.getHostName()),$WC.$CUtil.processXSS(o)]):e===ZCMediaConstants.endCases.leave?n=Resource.getRealValue(s+".session."+(t.isHost($zcg._ZUID)?"end":"left"),o):e===ZCMediaConstants.endCases.removedFromChat&&(r="common.access.denied",n=Resource.getRealValue("media.stop.session.remove.chat"))}void 0!==i&&(n=Resource.getRealValue(i)),$("#primetimewindow").append(PrimeTimeTemplates.getSessionEndInfoDialogHtml(Resource.getRealValue(r),n))},handleMiniContainerResize:function(e,i){PrimeTimeImpl.getCurrentSession();var t=$("#ptminimizedwindow"),s=t.find("[title_header]"),r=s.text(),n=t.find("[title_holder]"),a=e<=ZCMediaConstants.minimizedWindowRange.toggleWidth;t.toggleClass("min-size",a),s.toggleClass("dN",a),a?n.attr("title",r):n.attr("title","")},showMinimizedWindow:function(){if(PrimeTimeImpl.hasCurrentSession()&&!this.isInMinimizedView()){PrimeTimeHandler.UIEvents.exitFromFullScreen();var e=PrimeTimeImpl.getCurrentSession();$("body").append(PrimeTimeTemplates.getMinimizedUIHtml(e));var i=$("#ptminimizedwindow");this.addViewersCountInHeader(i),e.isAssemblyMode()&&this.addNetworkIndicatorInHeader(i,!0),MediaUtil.resetDarkMode(),this.setVideosInMinimizedView(),e.isChatScope()&&PrimeTimeImpl.removeChat(e.getChatId());var t=PrimeTimeUI.isChatInView();t&&PrimeTimeHandler.UIEvents.closeRHS();var s=$("#ptminimizedwindow");s.setAsDraggable(MediaUtil.getCriteriaForDrag()),s.setAsResizable(MediaUtil.getCriteriaForResize(this.handleMiniContainerResize.bind(this)));var r=e.getMiniPlayerSize(),n=e.getMiniPlayerPosition();s.css({width:r.width,height:r.height,top:n.top,left:n.left}),this.handleMiniContainerResize(r.width,r.height),PrimeTimeImpl.triggerSessionTimer("ptminviewsessiontimer"),$("#primetimewindow").attr("autoopenchat",t).hide(),Conference.hideAssociatedResourceIFrame(e.getId()),ZCTrack.track("PRIMETIME_MINIMIZED")}},showMaximizedWindow:function(){if(PrimeTimeImpl.hasCurrentSession()){MediaUtil.setDarkMode(),$WC.$Win.closeAll();var e=PrimeTimeImpl.getCurrentSession(),i=$("#primetimewindow");this.setVideosInMaximizedView();var t=$("#ptminimizedwindow"),s=t.position();e.setMiniPlayerSize({width:t.width(),height:t.height()}),e.setMiniPlayerPosition({top:s.top,left:s.left}),this.closeMinimizedWindow(),i.show();var r=0;"true"==i.attr("autoopenchat")&&(PrimeTimeHandler.UIEvents.openChatInRHS(),r=-PrimeTimeUI.getRhsWidth()),i.attr("autoopenchat",!1),this.handleResize(r)}},isInMinimizedView:function(){return $("#ptminimizedwindow").length>0},isInMaximizedView:function(){return!this.isInMinimizedView()},getRhsWidth:function(){return 401},setVideosInMinimizedView:function(){$("#ptminvideowrapperholder").append($("#ptvideowrapper")),this.autoPlayVideos()},setVideosInMaximizedView:function(){$("#ptvideowrapperholder").append($("#ptvideowrapper")),this.autoPlayVideos()},autoPlayVideos:function(){$("#ptvideowrapper").find("video").each((function(){this.play().then(function(){$(this).parent().find("[bufferloadercnt]").empty()}.bind(this))}))},updateSpeakerCount:function(){var e=PrimeTimeImpl.getCurrentSession().getRequestedSpeakers(),i=[],t=0;for(var s in e)t++,i.push(e[s].getName());$("#ptspeakercount").toggleClass("dN",t<=0).attr("title",$Util.getCustomToolTipForList(i,5,!1)).find("[count]").text(t)},updateMembersCount:function(){var e=PrimeTimeImpl.getCurrentSession().getMembersCount();$("#primetimewindow").find("[viewers_count], [primetimeviewerscount]").text(e),$("#ptminimizedwindow").find("[primetimeviewerscount]").text(e)},addAndGetMediaContainer:function(e,i,t,s){var r=$("#"+t).find("video");if(!r.length){var n=PrimeTimeTemplates.getVideoContainerHtml(e,i,t,s),a=WebRTCUserMedia.streamTypes.SCREEN===s;if(a&&e==$zcg._ZUID)return void $("#pthostscreenwrapper").append(n);var o=$("#ptvideowrapper");o.append(n);var m=o.find("#"+t),d=o.find("[videocontainer]").length;if(m.attr("position",d),o.attr("count",d),1===d){var c=a?"PT-main-screen-cnt":"PT-main-video-cnt";o.removeClass("PT-main-screen-cnt PT-main-video-cnt").addClass(c)}$Util.animateBufferLoader(m.find("[bufferloadercnt]"),9),r=m.find("video"),a&&PrimeTimeUI.swapVideoContainers(m)}return this.handleResize(),r[0]},addViewersCountInHeader:function(e){var i=e.find("[mediaheader]");0===i.find("[primetimeviewerscount]").length&&i.append(PrimeTimeTemplates.getViewersCountHtml())},addNetworkIndicatorInHeader:function(e,i){var t=e.find("[component_header]");if(0===t.find("[network_strength_indicator]").length){var s=PrimeTimeTemplates.getNetworkStrengthIndicatorHtml(i);i?t.append(s):t.find("[title_cnt]").append(s)}},removeMediaContainer:function(e){var i=$("#"+e),t=i.attr("position"),s=i.attr("streamtype");if(i.remove(),t){var r=$("#ptvideowrapper"),n=r.find("[videocontainer]"),a=n.length;r.attr("count",a),t<=a&&n.each((function(e,i){var s=$(i).attr("position");s>t&&$(i).attr("position",s-1)}));var o=PrimeTimeImpl.getCurrentSession().getHost(),m=$(o.getAVMediaContainer()).parents("[videocontainer]");if(s==WebRTCUserMedia.streamTypes.SCREEN&&"1"!=m.attr("position"))PrimeTimeUI.swapVideoContainers(m);else{var d=WebRTCUserMedia.streamTypes.SCREEN==n.filter('[position="1"]').attr("streamtype")?"PT-main-screen-cnt":"PT-main-video-cnt";r.removeClass("PT-main-screen-cnt PT-main-video-cnt").addClass(d)}this.handleResize()}},swapVideoContainers:function(e){var i=e.attr("position"),t="1"==i?"2":"1",s=$('[videocontainer][position="'+t+'"]');if(s.length>0){e.attr("position",t),s.attr("position",i);var r=parseInt($('[videocontainer][position="1"]').attr("streamType"))===WebRTCUserMedia.streamTypes.SCREEN?"PT-main-screen-cnt":"PT-main-video-cnt";$("#ptvideowrapper").removeClass("PT-main-screen-cnt PT-main-video-cnt").addClass(r)}},addUserInList:function(e){if(!e.isHost()){if(0===$("#primetimeusersection").find('[userId="'+e.getId()+'"]').length){var i=PrimeTimeTemplates.getRhsUserHtml(e.getId(),e.getName(),PrimeTimeImpl.getCurrentSession().getHostId(),e.hasRequestedToSpeak());e.hasRequestedToSpeak()?($("#ptrhsraisedhandslist").append(i),$("#ptrhsraisedhandsheader").removeClass("dN")):($("#ptrhsmemberslist").append(i),$("#ptrhsmembersheader").removeClass("dN"))}if(0===$("#primetimefooter").find('[userId="'+e.getId()+'"]').length)(e.hasRequestedToSpeak()?$("#ptbottompaneraisedhandslist"):$("#ptbottompanememberslist")).prepend(PrimeTimeTemplates.getBottomPaneUserHtml(e.getId(),e.getName(),PrimeTimeImpl.getCurrentSession().getHostId(),e.hasRequestedToSpeak(),e.isSpeaker())),PrimeTimeUI.handleFooterResize();PrimeTimeUI.updateSpeakerCount(),PrimeTimeUI.updateMembersCount()}},removeUserFromList:function(e){$("#primetimefooter").find('[userId="'+e+'"]').remove(),PrimeTimeUI.handleFooterResize(),$("#primetimeusersection").find('[userId="'+e+'"]').remove(),this.toggleListHeaders($("#ptrhsmembersheader"),$("#ptrhsmemberslist")),this.toggleListHeaders($("#ptrhsraisedhandsheader"),$("#ptrhsraisedhandslist")),PrimeTimeUI.updateSpeakerCount(),PrimeTimeUI.updateMembersCount()},toggleListHeaders:function(e,i){e.toggleClass("dN",0===i.find("[userId]").length)},toggleUserInList:function(e,i,t){if(!e.isHost()){var s=i,r=t;e.hasRequestedToSpeak()&&(s=t,r=i);var n=s.find("[userId="+e.getId()+"]");n.length>0&&r.prepend(n),PrimeTimeUI.handleFooterResize(),PrimeTimeUI.updateSpeakerCount()}},modifyList:function(e){var i=$("#ptrhsmemberslist"),t=$("#ptrhsraisedhandslist");this.toggleUserInList(e,t,i),this.toggleUserInList(e,$("#ptbottompaneraisedhandslist"),$("#ptbottompanememberslist")),this.toggleListHeaders($("#ptrhsmembersheader"),i),this.toggleListHeaders($("#ptrhsraisedhandsheader"),t),PrimeTimeUI.updateSpeakerCount()},resetSpeakerOptions:function(){var e=PrimeTimeImpl.getCurrentSession().getCurrentMember();e.isSpeaker()?($('[primetimebuttons][purpose="raiseSpeakerRequest"], [speakerrequestwrapper]').removeClass("dN"),$('[primetimebuttons][purpose="stepDownFromSpeaker"]').addClass("dN"),$('[primetimebuttons][purpose="muteAudio"], [primetimebuttons][purpose="unmuteAudio"]').addClass("zcf-mic dN").removeClass("zcf-mic-mute").attr({purpose:"muteAudio",title:Resource.getRealValue("common.micoff")}),$('[primetimebuttons][purpose="muteVideo"], [primetimebuttons][purpose="unmuteVideo"]').addClass("zcf-video dN").removeClass("zcf-video-mute").attr({purpose:"muteVideo",title:Resource.getRealValue("videochat.cameraoff")})):e.isHost()&&$('[primetimebuttons][purpose="endSpeakerSession"]').addClass("dN")},handleResize:function(e,i){PrimeTimeImpl.hasCurrentSession()&&(PrimeTimeImpl.getCurrentSession().isHandShakeMode()&&this.handleFooterResize(e))},handleFooterResize:function(e){var i=$("#primetimefooter");if(!(i.length<=0)){var t=i.width();e&&(t+=e),t=t-70-12;var s=Math.floor(t/94),r=i.find("[usercontainer]"),n=r.length;r.each((function(e,i){$(i).toggleClass("dN",e>=s)}));var a=n-s;i.find("#pthiddenuserscount").toggleClass("dN",a<=0).text("+"+a)}},setUnreadMessageCount:function(e,i){if(PrimeTimeImpl.isValidChatForCurrentSession(e)){var t=$("[primetimeunreadmsgcount]");i?t.text(i).show():t.hide().empty()}},handleGetMeFront:function(e){var i=ChatUI.exist[e];i&&this.handleChatWindowCreated(i)},handleChatWindowCreated:function(e){var i=e.chid;if(PrimeTimeImpl.isValidChatForCurrentSession(i)&&!this.isInMinimizedView())if($("#primetimechatsection").find("#"+i).length)e.focus();else{MainUI.handleIframes(i),ChannelTabsUI.switchToMessagesTab(i);var t=e.win();$("#primetimechatsection").html(t),t.show(),CodeSnippet.handleThemeForAVChat(!0),ZCScroll.customScroll(t.find("#chatbody"),!0),e.getScrollDown(),e.focus()}},handleChatWindowClosed:function(e){PrimeTimeImpl.isValidChatForCurrentSession(e)&&($("#primetimechatsection").empty(),PrimeTimeHandler.UIEvents.closeRHS())},handleChatWindowScrollPosition:function(){var e=PrimeTimeImpl.getCurrentSession();if(e&&e.isChatScope()&&PrimeTimeUI.isChatInView()){var i=ChatUI.exist[e.getChatId()];i&&i.retainScrollPosition()}},handleOpenFullScreen:function(e){$(e.attr("targetElemSelector")).addClass("PT-fullscrn"),e.hasClass("zcf-maximize")?e.removeClass("zcf-maximize").addClass("zcf-shrink"):e.hasClass("zcf-fullscrn")&&e.removeClass("zcf-fullscrn").addClass("zcf-exit-fullscrn"),e.attr({purpose:"exitFromFullScreen",title:Resource.getRealValue("media.exit.fullscreen")}),this.handleChatWindowScrollPosition()},handleExitFullScreen:function(e){$(e.attr("targetElemSelector")).removeClass("PT-fullscrn"),e.hasClass("zcf-shrink")?e.removeClass("zcf-shrink").addClass("zcf-maximize"):e.hasClass("zcf-exit-fullscrn")&&e.removeClass("zcf-exit-fullscrn").addClass("zcf-fullscrn"),e.attr({purpose:"openInFullScreen",title:Resource.getRealValue("media.open.fullscreen")}),this.handleChatWindowScrollPosition()},setChatWindowFocus:function(){var e=PrimeTimeImpl.getCurrentSession();if(e.isChatScope()&&PrimeTimeUI.isChatInView()){var i=ChatUI.exist[e.getChatId()];i&&(i.getScrollDown(),i.focus())}},openRoom:function(e,i,t,s,r,n,a,o,m){MediaUtil.setDarkMode(),$WC.$Win.closeAll(),$("body").append(PrimeTimeTemplates.getMainUIHtml(e,i,t,s,r,n,a,o,m)),MediaManager.isChatScope(r)&&n&&MediaManager.updateGroupCallOptionsInChatHeader(n);var d=$("#primetimewindow");this.addViewersCountInHeader(d),PrimeTime.isAssemblyMode(s)&&this.addNetworkIndicatorInHeader(d),$Util.animateBufferLoader($("#ptvideowrapper").find("[bufferloadercnt]"),9)},setSessionActive:function(){$("#primetimewindow").addClass("PT-session-active"),$("#ptvideowrapper").find("[bufferloadercnt]").empty()},closeRoom:function(){(PrimeTimeImpl.isPrimeTimeTab()||PrimeTimeImpl.isHuddleStreamingTab())&&window.history.pushState({},null,$Util.getUrlPrefix()+"/index.do"),MediaUtil.resetDarkMode();var e=$("#primetimewindow");MediaUtil.removeVideoElemsStreamInContainer(e),e.remove(),ZCMediaDomUtil.exitFullScreen(),Conference.removeAssociatedResourceIFrame()},closeMinimizedWindow:function(){SessionTimers.clearTimer("ptminviewsessiontimer"),$("body").find("#ptminimizedwindow").remove()},showGuestLinkGenerateDlg:function(){$WC.$Dlg.create({id:"ptguesturlconsent",version:2,class:"zcdalogbx zcbg_mask alert_dialog",headerhtml:$WC.$Dlg.frameHeaderHTML({imagehtml:'<div class="mheader_icn zcf-primetime clr-red f40"></div>',header:Resource.getRealValue("primetime.guestlink.copyconsent.heading")}),bodyhtml:$WC.$Dlg.frameBodyInfoHTML({info:[Resource.getRealValue("primetime.guestlink.copyconsent.info")]}),buttons:[{text:Resource.getRealValue("primetime.guestlink.generate"),colour:$WC.$Dlg.GREEN_BUTTON,action:function(){var e=PrimeTimeImpl.getCurrentSession();e&&e.isHost($zcg._ZUID)&&e.generateGuestLink()}}]})}},(PrimeTimeImpl={init:function(){PrimeTimeUI.bindEvents()},isPrimeTimeTab:function(){return window.location.href.indexOf("/primetimes/")>0},isHuddleStreamingTab:function(){return window.location.href.indexOf("/huddlestream/")>0},windowActiveTimeout:void 0,windowActiveTimoutDuration:4e3,_runningSession:void 0,previousSessionId:void 0,currentUpStream:void 0,currentScreenUpStream:void 0,notificationTypes:{joined:1,requestedToSpeak:2},isRequestToSpeakNotification:function(e){return e===this.notificationTypes.requestedToSpeak},playerModes:{SHAKA:1,HLS:2,RTCP:3},isShakaPlayer:function(e){return this.playerModes.SHAKA===e},isHLSPlayer:function(e){return this.playerModes.HLS===e},isRTCPPlayer:function(e){return this.playerModes.RTCP===e},hasCurrentSession:function(){return null!=this._runningSession},getCurrentSession:function(){return this._runningSession},clearRunningSession:function(){this.previousSessionId=this._runningSession.getId(),this._runningSession=void 0},setCurrentSession:function(e){this.hasCurrentSession()&&this.getCurrentSession().terminate();PrimeTimeUI.setSessionActive(),this._runningSession=e},getHandShakeParticipantsLimit:function(){return $zcg._PT_HANDSHAKE_PARTICIPANTS_LIMIT},getAssemblyParticipantsLimit:function(){return $zcg._PT_ASSEMBLY_PARTICIPANTS_LIMIT},getWSSServerUrl:function(){var e=$zcg._VIDEOCHATPROPS.WSS_SERVER_URL;if(PrimeTimeImpl.hasCurrentSession()){var i=PrimeTimeImpl.getCurrentSession(),t=i.getWSSMainServerUrl(),s=i.getWSSBackupServerUrl();void 0!==t?e=t:void 0!==s&&(e=s)}return e},getAnonWSSServerUrl:function(){var e=$zcg._VIDEOCHATPROPS.WSS_SERVER_URL;if(PrimeTimeImpl.hasCurrentSession()){var i=PrimeTimeImpl.getCurrentSession(),t=i.getAnonWSSMainServerUrl(),s=i.getAnonWSSBackupServerUrl();void 0!==t?e=t:void 0!==s&&(e=s)}return e},getGuestRegisterUrl:function(e,i){let t=void 0,s="zuid="+$zcg._ANONID;s+="&callid="+$zcg._PRD+"_"+e,s+="&ver=1";let r={user_id:$zcg._ANONID};return void 0!==i&&(r.streaming_id=i),s+="&serviceinfo="+encodeURIComponent(JSON.stringify(r)),t=PrimeTimeImpl.getAnonWSSServerUrl()+"/guest?"+s},getPlayerManifestUrl:function(e){var i="sid="+WmsImpl.getSid();i+="&callid="+$zcg._PRD+"_"+PrimeTimeImpl.getCurrentSession().getId();let t={user_id:$zcg._ZUID};return void 0!==e&&(t.streaming_id=e),i+="&serviceinfo="+encodeURIComponent(JSON.stringify(t)),PrimeTimeImpl.getWSSServerUrl()+"/master?"+i},getAndSetPeopleInfo:function(e){},validateStartInputs:function(){var e=!1,i=$("#start_primetime_win"),t=i.find("#ptstartscopes").find("input:checked").val();if(MediaManager.isOrgScope(t))e=_isAppAccountAdmin();else if(MediaManager.isTeamScope(t)){var s=this.teamSuggestion.getSelectedListValues();e=s.length>0&&s.length<=this.teamSuggestion.limit}else{var r=this.chatSuggestion.getSelectedValue();e=!$WC.Util.isEmpty(r)}return e=e&&MediaUtil.isValidTitle(i.find("#pttopic").val()),i.find('[purpose="showStartUIPreviewPage"]').toggleClass("buttn_disbl",!e),e},isValidChatForCurrentSession:function(e){if(!this.hasCurrentSession())return!1;var i=this.getCurrentSession();return i.isChatScope()&&e===i.getChatId()},startSession:function(e){var i=new PrimeTimeSession(e);return this.setCurrentSession(i),i.initUpStream(e.turnUserName,e.turnCredential,WebRTCUserMedia.getStreamTypesInInt(e.connectionDataMode)),PrimeTimeImpl.startMainViewTimers(),i},startSpeakerSession:function(e){var i=PrimeTimeImpl.getCurrentSession();i.initSpeakerUpStream(e.speakerConnectionId,e.turnUserName,e.turnCredential,PrimeTimeImpl.currentUpStream._getType());var t=i.getCurrentMember();t.resetSpeakerRequest(),PrimeTimeUI.modifyList(t),$('[primetimebuttons][purpose="dropSpeakerRequest"],[speakerrequestwrapper]').addClass("dN"),$('[primetimebuttons][purpose="stepDownFromSpeaker"],[primetimebuttons][purpose="muteAudio"]').removeClass("dN"),PrimeTimeImpl.currentUpStream._hasVideoTrack()&&$('[primetimebuttons][purpose="muteVideo"]').removeClass("dN")},setAndStartScreenShareSession:function(e){PrimeTimeImpl.getCurrentSession().initScreenUpStream(e.screenShareId,e.turnUserName,e.turnCredential,WebRTCUserMedia.streamTypes.SCREEN)},startMainViewTimers:function(){PrimeTimeImpl.triggerSessionTimer("primetimesessiontimer"),PrimeTimeImpl.triggerSessionTimer("ptsessionsubtimer")},triggerSessionTimer:function(e){var i=this.getCurrentSession();if(i){var t={startTime:i.getStartTime()};if(i.isAssemblyMode()&&!i.isHost($zcg._ZUID)){var s=i.isShakaPlayer()?PrimeTimeImpl.shakaPlayer:PrimeTimeImpl.hlsPlayer;t.getSessionCurrentTime=s.getSessionCurrentTime.bind(s)}SessionTimers.setTimer(e,t)}},checkAndJoin:function(e,i){var t=function(){MediaManager.setRequestCompleted(),PrimeTimeImpl.isPrimeTimeTab()&&($("#ptloadingcontainer").remove(),window.history.pushState({},null,$Util.getUrlPrefix()+"/index.do"))},s=function(s){if(MediaManager.setRequestCompleted(),s.is_active&&s.host&&s.host.id!=$zcg._ZUID){PrimeTimeImpl.hasCurrentSession()&&PrimeTimeImpl.getCurrentSession().getId()==e?UI.updateBanner(Resource.getRealValue("primetime.existing.join"),2e3,!0):MediaManager.handleExistingSessions((function(){if(Settings.isDarkModeChoosed()||Settings.loadDarkModeFiles(),PrimeTimeUI.openRoom(s.title,s.host.id,s.host.name,s.mode,s.scope.type,s.scope.ids,void 0,void 0,s.chat_permission),PrimeTime.isHandShakeMode(s.mode))MediaManager.setRequestPending({module:ZCMediaConstants.sessionTypes.PRIMETIME,request_type:ZCMediaConstants.requestTypes.JOIN,id:e}),PrimeTimeAPI.join(e,s.host.id,(function(){MediaManager.setRequestCompleted(),"function"==typeof i&&i()}),MediaManager.setRequestCompleted);else{"function"==typeof i&&i();let t=void 0,r=void 0!==$zcg._mediaSessionDetails&&"streaming"===$zcg._mediaSessionDetails.wss_type;r&&(t=window.location.pathname.split("/huddlestream/")[1]),PrimeTimeImpl.joinAssembly(e,s,r,t)}}))}else if(WmsImpl.isGuestUser()){var r=$WC.template.replace('<div id="primetimewindow" style="background-image: url({{background_image}})" class="PT-wrp flex"></div>',{background_image:$zcg._IMGDEFAULTSTATICURL+"/videochat-bg.jpg"});$("body").html(r),PrimeTimeUI.showSessionEndInfo(void 0,s.code)}else{var n=s.is_active?"primetime.host.join":"primetime.expired.join";UI.updateBanner(Resource.getRealValue(n),2e3,!0),t()}};if(!PrimeTime.isAllowed())return UI.updateBanner(Resource.getRealValue("primetime.module.disabled"),2e3,!0),void t();if(!MediaManager.isRequestPending()){MediaManager.setRequestPending({module:ZCMediaConstants.sessionTypes.PRIMETIME,request_type:ZCMediaConstants.requestTypes.GET,id:e});var r=$zcg._mediaSessionDetails;if(void 0!==r){("streaming"===r.wss_type?r.conferenceId:r.id)===e&&(s(r),delete $zcg._mediaSessionDetails)}else PrimeTimeAPI.get(e,s,t)}},joinAssembly:function(e,i,t,s){var r=new PrimeTimeSession({primeTimeId:e,primeTimeMode:i.mode,primeTimeHostId:i.host.id,primeTimeHostName:i.host.name,title:i.title,startTime:i.start_time,scopeType:i.scope.type,scopeIds:i.scope.ids,viewersCount:i.participant_count,associated_resource:i.associated_resource,streaming_id:s});t&&r.setAsConferenceStreaming(),void 0!==i.wss_details&&(void 0!==i.wss_details.main_server_url&&r.setWSSMainServerUrl(i.wss_details.main_server_url),void 0!==i.wss_details.anon_main_server_url&&r.setAnonWSSMainServerUrl(i.wss_details.anon_main_server_url),void 0!==i.wss_details.backup_server_url&&r.setWSSBackupServerUrl(i.wss_details.backup_server_url),void 0!==i.wss_details.anon_backup_server_url&&r.setAnonWSSBackupServerUrl(i.wss_details.anon_backup_server_url)),this.setCurrentSession(r),r.initiateAssemblyPlayer()},attachChat:function(){var e=PrimeTimeImpl.getCurrentSession();if(e&&e.isChatScope()){var i=e.getChatId(),t=ChatUI.exist[i];t?PrimeTimeUI.handleChatWindowCreated(t):ConversationsList.attachContinueActiveChat(i)}},removeChat:function(e){$("#primetimechatsection").find("#"+e).length&&MainUI.revertToViewPort(e)},muteAudio:function(e){$('[primetimebuttons][purpose="muteAudio"]').addClass("zcf-mic-mute").removeClass("zcf-mic").attr({purpose:"unmuteAudio",title:Resource.getRealValue("common.micon")}),PrimeTimeImpl.handleAVStatusChange("audio",!0,e)},muteVideo:function(e){$('[primetimebuttons][purpose="muteVideo"]').addClass("zcf-video-mute").removeClass("zcf-video").attr({purpose:"unmuteVideo",title:Resource.getRealValue("videochat.cameraon")}),PrimeTimeImpl.handleAVStatusChange("video",!0,e)},handleAVStatusChange:function(e,i,t){if(this.hasCurrentSession()){var s=$Util.getSyncedCurrentTime(),r=this.getCurrentSession(),n=r.getCurrentMember();if(n.handleAVStreamStatus(e,i,s),t){var a={time:s};a[e]={muted:i};var o=n.isSpeaker()?r.getSpeakerConnectionId():r.getId();PrimeTimeAPI.updateConnectionStatus(o,a)}}},handleChatRemoved:function(e){var i=PrimeTimeImpl.getCurrentSession();void 0!==i&&i.isChatScope()&&i.getChatId()===e&&this.handleEnd(!0)},handleEnd:function(e,i){SessionTimers.clearTimer("primetimesessiontimer"),SessionTimers.clearTimer("ptsessionsubtimer"),PrimeTimeUI.closeMinimizedWindow(),$("#primetimewindow").removeClass("PT-session-active"),$("#ptvideowrapper").hide();var t=!1;if(void 0!==i&&(PrimeTimeUI.showSessionEndInfo(i),t=!0),this.hasCurrentSession()){var s=this.getCurrentSession(),r=s.getId();if(!e||s.isConferenceStreaming()||WmsImpl.isGuestUser()||(s.isHost($zcg._ZUID)?PrimeTimeAPI.stop(r):PrimeTimeAPI.leave(r)),s.terminate(),this.clearRunningSession(),s.isChatScope()){var n=s.getChatId();PrimeTimeImpl.removeChat(n),MediaManager.updateGroupCallOptionsInChatHeader(n)}}this.currentUpStream&&(WebRTCUserMedia.closeStream(this.currentUpStream._getType()),this.currentUpStream=void 0),WmsImpl.isGuestUser()||(t?(clearTimeout(PrimeTimeUI.windowCloseTimeout),PrimeTimeUI.windowCloseTimeout=setTimeout((function(){PrimeTimeUI.closeRoom(),PrimeTimeUI.windowCloseTimeout=void 0}),2e3)):PrimeTimeUI.closeRoom())},copyGuestLink:function(){var e=this.getCurrentSession().getGuestLink();$WC.Util.isEmpty(e)||$Util.copyTextToClipboard(e,(function(){UI.updateBanner(Resource.getRealValue("channel.link.copied"))}))}}).shakaPlayer={_playerInstance:void 0,_restartPlayerTimer:void 0,_lastChunkPlayTimeout:void 0,_mpdRequestCounter:0,_maxAllowedMpdRequestAfterEnd:5,_requestSessionIds:{},_customWSSServerUrl:void 0,_customWSSServerUrlKey:"x-url",_customWSSServerToken:void 0,_customWSSServerTokenKey:"x-zwsspoptoken",_wssServerSwitchKey:"x-switchurl",_wssOnpremiseServerRegisterUrlKey:"x-zvparegisterurl",_wssOnpremiseServerUrlKey:"x-zvpapopurl",_wssOnpremiseServerTokenKey:"x-zvpapoptoken",_wssOnpremiseServerUrl:void 0,_wssOnpremiseServerToken:void 0,_wssGuestSid:void 0,_wssStatelessHeaderKey:"x-stateless-auth",_wssStatelessHeader:void 0,_wssStatelessRequestHeaderKey:"stateless_auth",_wssViewerCountKey:"x-viewer-count",_wssSessionsCountKey:"x-sessions-count",_wssSessionIdKeyInHeader:"x-session-id",isIncluded:function(){return"undefined"!=typeof shaka},isSupported:function(){return this.isIncluded()&&shaka.Player.isBrowserSupported()},isSegmentRequest:function(e){return e===shaka.net.NetworkingEngine.RequestType.SEGMENT},isManifestRequest:function(e){return e===shaka.net.NetworkingEngine.RequestType.MANIFEST},isChunkHeaderRequest:function(e){return e.split("_").length<3},hasRequestSessionId:function(){return void 0!==this.getRequestSessionId()},getRequestSessionId:function(){var e=void 0;if(PrimeTimeImpl.hasCurrentSession()){var i=this._requestSessionIds[PrimeTimeImpl.getCurrentSession().getId()];i&&(e=i[WmsImpl.getSid()])}return e},getGetWSSSessionId:function(){return this._wssGuestSid},getSessionCurrentTime:function(){if(this._playerInstance){var e=this._playerInstance.getPlayheadTimeAsDate();if(e)return $Util.getSyncedTime(e.getTime())}},registerAndInitializeGuest:function(e){void 0===this._wssGuestSid?PrimeTimeAPI.registerGuestInWSS(PrimeTimeImpl.getGuestRegisterUrl(PrimeTimeImpl.getCurrentSession().getId(),e),function(i,t){this._wssGuestSid=i,this._wssStatelessHeader=t.get(this._wssStatelessHeaderKey);var s={};s[this._wssStatelessRequestHeaderKey]=this._wssStatelessHeader;let r=this.getPlayerManifestUrlForGuest(e);PrimeTimeAPI.preflightUrl(r,s),this.initialize(r)}.bind(this)):this.initialize(this.getPlayerManifestUrlForGuest(e))},getPlayerManifestUrlForGuest:function(e){var i="sid="+this.getGetWSSSessionId();i+="&ver=1";let t={user_id:$zcg._ZUID};return void 0!==e&&(t.streaming_id=e),i+="&serviceinfo="+encodeURIComponent(JSON.stringify(t)),PrimeTimeImpl.getAnonWSSServerUrl()+"/refreshmpd?"+i},registerAndInitialize:function(e){var i=this.getPlayerManifestUrl(e);PrimeTimeAPI.registerUserInWSS(i,function(i,t){var s=PrimeTimeImpl.shakaPlayer._requestSessionIds[PrimeTimeImpl.getCurrentSession().getId()]||{};s[WmsImpl.getSid()]=t.get(PrimeTimeImpl.shakaPlayer._wssSessionIdKeyInHeader),PrimeTimeImpl.shakaPlayer._requestSessionIds[PrimeTimeImpl.getCurrentSession().getId()]=s,PrimeTimeImpl.shakaPlayer.initialize(PrimeTimeImpl.shakaPlayer.getPlayerRefreshManifestUrl(e))}.bind(this))},getPlayerManifestUrl:function(e){if(WmsImpl.isGuestUser())return this.getPlayerManifestUrlForGuest(e);var i="sid="+WmsImpl.getSid();i+="&callid="+$zcg._PRD+"_"+PrimeTimeImpl.getCurrentSession().getId(),PrimeTime.isAssemblyInterDCEnabled()&&(PrimeTime.isAssemblyOnpremiseEnabled()?i+="&ver=3":i+="&ver=2");let t={user_id:$zcg._ZUID};return void 0!==e&&(t.streaming_id=e),i+="&serviceinfo="+encodeURIComponent(JSON.stringify(t)),PrimeTimeImpl.getWSSServerUrl()+"/mpd?"+i},getPlayerRefreshManifestUrl:function(e){if(WmsImpl.isGuestUser())return this.getPlayerManifestUrlForGuest(e);var i="sid="+this.getRequestSessionId();PrimeTime.isAssemblyInterDCEnabled()&&(PrimeTime.isAssemblyOnpremiseEnabled()?i+="&ver=3":i+="&ver=2");let t={user_id:$zcg._ZUID};return void 0!==e&&(t.streaming_id=e),i+="&serviceinfo="+encodeURIComponent(JSON.stringify(t)),PrimeTimeImpl.getWSSServerUrl()+"/refreshmpd?"+i},getPlayerConfiguration:function(){return{abr:{enabled:!1},streaming:{bufferingGoal:10,jumpLargeGaps:!0},preferredAudioLanguage:"en"}},setPlayerRestartTimer:function(){this._restartPlayerTimer||(this._restartPlayerTimer=setTimeout(function(){var e=PrimeTimeImpl.getCurrentSession();void 0!==e&&(WmsImpl.isGuestUser()?this.registerAndInitializeGuest(e.getStreamingId()):this.registerAndInitialize(e.getStreamingId()))}.bind(this),3e4))},resetPlayerRestartTimer:function(){clearTimeout(this._restartPlayerTimer),this._restartPlayerTimer=void 0},bindPlayerEvents:function(){var e=function(e){e.buffering?this.setPlayerRestartTimer():this.resetPlayerRestartTimer()}.bind(this),i=function(e,i){if(this.isSegmentRequest(e)){var t=PrimeTimeImpl.getCurrentSession().getHost(),s=i.uris[0].split("f=")[1];if((PrimeTime.isAssemblyInterDCEnabled()&&this._customWSSServerUrl||PrimeTime.isAssemblyOnpremiseEnabled()&&this._wssOnpremiseServerUrl)&&-1!==i.uris[0].indexOf("live?token")){var r=this._customWSSServerUrl,n=this._customWSSServerToken;if(PrimeTime.isAssemblyOnpremiseEnabled()&&(r=this._wssOnpremiseServerUrl,n=this._wssOnpremiseServerToken),this.isChunkHeaderRequest(s)){if(this.hasRequestSessionId()){var a,o;(o=(a=i.uris[0].split("?token="))[1].split("&")).shift();var m=(a[0]+"?sid="+this.getRequestSessionId()+"&ver=2&"+o.join("&")).split("&cc="),d=m[1].split("&");d.shift(),i.uris[0]=m[0]+"&"+d.join("&")}}else(o=(a=i.uris[0].split("live?token"))[1].split("&")).shift(),i.uris[0]="https://"+r+"/live?token="+n+"&"+o.join("&")}var c=t.getLastAudioChunkId(),l=t.getLastVideoChunkId();if(c||l){var p=s.startsWith("wmslive_media1"),u=s.startsWith("wmslive_media0");if(!this.isChunkHeaderRequest(s)&&(p||u)){this._mpdRequestCounter=0;var h=s.split("_");h[h.length-1].split(".m4s")[0]>=(p?c:l)&&(this._lastChunkPlayTimeout||(this._lastChunkPlayTimeout=setTimeout((function(){PrimeTimeImpl.handleEnd(!0,ZCMediaConstants.endCases.sessionEnd)}),5e3)))}}if(!this.hasRequestSessionId()){var v=WmsImpl.getSid();if(PrimeTimeImpl.hasCurrentSession()&&void 0!==v){var f=this._requestSessionIds[PrimeTimeImpl.getCurrentSession().getId()]||{};f[v]=i.uris[0].split("&")[0].split("sid=")[1],this._requestSessionIds[PrimeTimeImpl.getCurrentSession().getId()]=f}}}else if(this.isManifestRequest(e)&&this.hasRequestSessionId()){let e=PrimeTimeImpl.getCurrentSession();if(!i.uris[0].split("/").includes("time")){let t=e.getStreamingId();i.uris[0]=this.getPlayerRefreshManifestUrl(t)}((t=e.getHost()).getLastAudioChunkId()||t.getLastVideoChunkId())&&(this._mpdRequestCounter++,this._mpdRequestCounter>this._maxAllowedMpdRequestAfterEnd&&PrimeTimeImpl.handleEnd(!0,ZCMediaConstants.endCases.sessionEnd))}i.allowCrossSiteCredentials=!0,void 0!==this._wssStatelessHeader&&(i.headers[this._wssStatelessRequestHeaderKey]=this._wssStatelessHeader)}.bind(this),t=function(e,i){if(this.isManifestRequest(e)&&PrimeTime.isAssemblyInterDCEnabled()){var t=i.headers[this._customWSSServerTokenKey];if(void 0!==t&&(this._customWSSServerToken=t),void 0===this._customWSSServerUrl&&(this._customWSSServerUrl=i.headers[this._customWSSServerUrlKey]),PrimeTime.isAssemblyOnpremiseEnabled()){var s=i.headers[this._wssOnpremiseServerRegisterUrlKey];void 0!==s&&PrimeTimeAPI.registerOnpremiseAgent(s);var r=i.headers[this._wssOnpremiseServerUrlKey];void 0!==r&&(this._wssOnpremiseServerUrl=r);var n=i.headers[this._wssOnpremiseServerTokenKey];void 0!==n&&(this._wssOnpremiseServerToken=n)}}if(PrimeTimeImpl.hasCurrentSession()){var a=PrimeTimeImpl.getCurrentSession();void 0!==i.headers[this._wssServerSwitchKey]&&(a.setWSSMainServerUrl(i.headers[this._wssServerSwitchKey]),delete this._requestSessionIds[a.getId()],WmsImpl.isGuestUser()?this.registerAndInitializeGuest(a.getStreamingId()):this.registerAndInitialize(a.getStreamingId())),void 0!==i.headers[this._wssViewerCountKey]&&void 0!==a&&(a.updateMembersCount(parseInt(i.headers[this._wssViewerCountKey])),PrimeTimeUI.updateMembersCount())}}.bind(this);this._playerInstance.getNetworkingEngine().registerResponseFilter(t),this._playerInstance.addEventListener("buffering",e),this._playerInstance.getNetworkingEngine().registerRequestFilter(i),this._playerInstance.configure(this.getPlayerConfiguration())},initialize:function(e){if(PrimeTimeImpl.hasCurrentSession()){this.destroyPlayer();var i=PrimeTimeImpl.getCurrentSession().getHost().getAVMediaContainer();this._playerInstance=new shaka.Player(i),this.bindPlayerEvents();var t=function(){i.play().then((function(){$(i).parents("[videocontainer]").find("[bufferloadercnt]").empty(),PrimeTimeImpl.startMainViewTimers()})).catch((function(e){PrimeTimeImpl.startMainViewTimers(),PrimeTimeUI.showInfoModal()}))}.bind(this);this._playerInstance.load(e).then(t)}},destroyPlayer:function(){this._mpdRequestCounter=0,this.resetPlayerRestartTimer(),this._playerInstance&&(this._playerInstance.destroy(),this._playerInstance=void 0)},destroy:function(){this._customWSSServerUrl=void 0,this._customWSSServerToken=void 0,this._wssOnpremiseServerUrl=void 0,this._wssOnpremiseServerToken=void 0,this.destroyPlayer()}},PrimeTimeImpl.hlsPlayer={_playerInstance:void 0,_playingFragmentNumber:0,_playingFragmentTimeInSecs:0,_playingFragmentStartTime:0,_wssGuestSid:void 0,_wssStatelessHeaderKey:"x-stateless-auth",_wssStatelessHeader:void 0,_wssStatelessRequestHeaderKey:"stateless_auth",_viewerCountTaglistKey:"EXT-X-CUSTOM-VIEWER-COUNT",_wssViewerCountKey:"X-VIEWER-COUNT",_programDateTimeTaglistKey:"PROGRAM-DATE-TIME",isIncluded:function(){return"undefined"!=typeof Hls},isSupported:function(){return this.isIncluded()&&Hls.isSupported()},getGetWSSSessionId:function(){return this._wssGuestSid},getPlayerManifestUrlForGuest:function(e){let i="sid="+this.getGetWSSSessionId(),t={user_id:$zcg._ZUID};return void 0!==e&&(t.streaming_id=e),i+="&serviceinfo="+encodeURIComponent(JSON.stringify(t)),PrimeTimeImpl.getAnonWSSServerUrl()+"/master?"+i},getPlayerConfiguration:function(){return{xhrSetup:function(e,i){e.withCredentials=!0,void 0!==PrimeTimeImpl.hlsPlayer._wssStatelessHeader&&(e.open("GET",i,!0),e.setRequestHeader(PrimeTimeImpl.hlsPlayer._wssStatelessRequestHeaderKey,PrimeTimeImpl.hlsPlayer._wssStatelessHeader))}}},getSessionCurrentTime:function(){if(this._playerInstance){var e=this._playerInstance.streamController.fragPlaying;if(void 0===e)return;var i=e.sn;i!==this._playingFragmentNumber&&(this._playingFragmentTimeInSecs=0,this._playingFragmentStartTime=0,this._playingFragmentNumber=i);var t=$Util.getSyncedCurrentTime();(0===this._playingFragmentStartTime||t-this._playingFragmentStartTime>=1e3)&&(this._playingFragmentStartTime=t,this._playingFragmentTimeInSecs++);for(var s=e.tagList,r=void 0,n=0;n<=s.length;n++){var a=s[n];if(a[0]===PrimeTimeImpl.hlsPlayer._programDateTimeTaglistKey){r=a[1];break}}var o=-1!==r.indexOf("+")?"+":"-",m=r.lastIndexOf(o),d=r.slice(0,m+3)+":"+r.slice(m+3);return $Util.getSyncedTime(new Date(d).getTime())+1e3*this._playingFragmentTimeInSecs}},bindPlayerEvents:function(){this._playerInstance.on(Hls.Events.ERROR,function(e,i){if(PrimeTimeImpl.hasCurrentSession()){var t=i.type;if(i.fatal)PrimeTimeImpl.handleEnd(!0,ZCMediaConstants.endCases.sessionEnd);else if(t===Hls.ErrorTypes.NETWORK_ERROR){if(void 0!==i.response)if(404===i.response.code){var s=PrimeTimeImpl.getCurrentSession().getHost(),r=s.getLastAudioChunkId(),n=s.getLastVideoChunkId();(r||n)&&PrimeTimeImpl.handleEnd(!0,ZCMediaConstants.endCases.sessionEnd)}}}else this.destroy()}.bind(this)),this._playerInstance.on(Hls.Events.LEVEL_LOADED,function(e,i){var t=PrimeTimeImpl.getCurrentSession();if(void 0!==t){var s=i.details.fragments[0].tagList;if($zcg._HLS_VIEWERS_COUNT_NEW_FLOW){for(var r=s[1][1].split(","),n={},a=0;a<r.length;a++){var o=r[a];n[o.split("=")[0]]=o.split("=")[1].slice(1).slice(0,-1)}var m=PrimeTimeImpl.hlsPlayer._wssViewerCountKey;n[m]&&"$viewer_count$"!=n[m]&&(t.updateMembersCount(parseInt(n[m])),PrimeTimeUI.updateMembersCount())}else for(var d=0;d<=s.length;d++){var c=s[d];if(c[0]===PrimeTimeImpl.hlsPlayer._viewerCountTaglistKey){t.updateMembersCount(parseInt(c[1])),PrimeTimeUI.updateMembersCount();break}}}}.bind(this))},registerAndInitializeGuest:function(e){void 0===this._wssGuestSid?PrimeTimeAPI.registerGuestInWSS(PrimeTimeImpl.getGuestRegisterUrl(PrimeTimeImpl.getCurrentSession().getId(),e),function(i,t){this._wssGuestSid=i,this._wssStatelessHeader=t.get(this._wssStatelessHeaderKey),this.initialize(this.getPlayerManifestUrlForGuest(e))}.bind(this)):this.initialize(this.getPlayerManifestUrlForGuest(e))},initialize:function(e){if(PrimeTimeImpl.hasCurrentSession()){this.destroy();var i=PrimeTimeImpl.getCurrentSession().getHost().getAVMediaContainer();this._playerInstance=new Hls(this.getPlayerConfiguration());var t=function(e,t){i.play().then((function(){$(i).parents("[videocontainer]").find("[bufferloadercnt]").empty(),PrimeTimeImpl.startMainViewTimers()})).catch((function(e){PrimeTimeImpl.startMainViewTimers(),PrimeTimeUI.showInfoModal()}))}.bind(this),s=function(){this._playerInstance.loadSource(e)}.bind(this);this._playerInstance.on(Hls.Events.MEDIA_ATTACHED,s),this._playerInstance.on(Hls.Events.MANIFEST_PARSED,t),this.bindPlayerEvents(),this._playerInstance.attachMedia(i)}},destroy:function(){this._playingFragmentNumber=0,this._playingFragmentTimeInSecs=0,this._playingFragmentStartTime=0,this._playerInstance&&(this._playerInstance.destroy(),this._playerInstance=void 0)}},PrimeTimeImpl.chatSuggestion={search:function(e){$("#pt-chat-selection-list").empty();var i={searchin:SearchAgent.CHATHISTORY,chathistoryhtml:SearchHTML.chat,channelshtml:SearchHTML.channel,ignore121chat:!0,ignorebot:!0,channelcategory:1,val:e,listid:"pt-chat-selection-list",emptycallback:function(){this.displayNoResultFound()}.bind(this),clearcallback:function(){this.displayNoResultFound()}.bind(this)},t=SearchAgent.search(i);return t&&this.displayResultDOM(),t},handleAction:function(){PrimeTimeImpl.validateStartInputs()},handleInputValueChange:function(){PrimeTimeImpl.validateStartInputs()},getSelectedValue:function(){return $("#pt-chat-selection").find("[input_value]").attr("input_value")},displayNoResultFound:function(){$("#pt-chat-selection-list").html('<div class="p10 textcent">'+Resource.getRealValue("common.search.result.none")+"</div>"),this.displayResultDOM()},displayResultDOM:function(){var e=$("#pt-chat-selection-results");e.find("[purpose='search']").first().addClass("sel"),e.is(":visible")||Clickoutside.bind({srcid:"pt-chat-selection-search-field",destid:"pt-chat-selection-results"}),ZCScroll.scrollTop(e,0)},clear:function(){$("#pt-chat-selection-results").hide(),Clickoutside.clear("pt-chat-selection-results")}},PrimeTimeAPI={get:function(e,i,t){$ZCAjx.ajax({url:"/v2/primetimes/"+e,type:"GET",success:function(e){"function"==typeof i&&i(e)},error:function(){"function"==typeof t&&t()}})},start:function(e,i,t,s,r,n,a,o){var m={title:e,mode:i,data_mode:r,scope:{type:t}};MediaManager.isChatScope(t)?m.scope.chat_id=s[0]:MediaManager.isTeamScope(t)&&(m.scope.team_ids=s),o&&(m.recording_index=o),$ZCAjx.ajax({url:"/v2/primetimes",type:"POST",data:m,headers:{session_id:WmsImpl.getSid()},contentType:"application/json",success:function(){"function"==typeof n&&n()},error:function(e){"function"==typeof a&&a(e)}})},join:function(e,i,t,s){$ZCAjx.ajax({url:"/v2/primetimes/"+e+"/join",type:"PUT",headers:{session_id:WmsImpl.getSid()},data:{host_id:i},contentType:"application/json",success:function(){"function"==typeof t&&t()},error:function(){"function"==typeof s&&s()}})},sendSDP:function(e,i,t,s,r,n,a){var o="";"answer"===r&&(o="/peers/"+n);var m={description:i,ice_candidate:t,type:s};a&&(m.data_mode=a),$ZCAjx.ajax({url:"/v2/primetimes/"+e+o+"/"+r,type:"PUT",data:m,contentType:"application/json"})},updateIceCandidates:function(e,i,t,s){t.length&&$ZCAjx.ajax({url:"/v2/primetimes/"+e+"/peers/"+i+"/icecandidate",type:"PUT",data:{ice_candidates:t,type:s},contentType:"application/json"})},updateConnectionStatus:function(e,i){$ZCAjx.ajax({url:"/v2/primetimes/"+e+"/updateconnectionstatus",type:"POST",contentType:"application/json",data:i})},generateGuestLink:function(e,i,t){$ZCAjx.ajax({url:"/v2/primetimes/"+e+"/generateguesturl",type:"POST",contentType:"application/json",success:function(e){"function"==typeof i&&i(e)},error:function(){"function"==typeof t&&t()}})},updateLivePicture:function(e,i){$ZCAjx.ajax({url:"/v2/primetimes/"+e+"/updatelivepicture",type:"POST",contentType:"application/json",data:{image_data:i}})},removeLivePicture:function(e){$ZCAjx.ajax({url:"/v2/primetimes/"+e+"/removelivepicture",type:"POST",contentType:"application/json"})},notifyStart:function(e,i,t){$ZCAjx.ajax({url:"/v2/primetimes/"+e+"/invitation",type:"POST",contentType:"application/json",success:function(){"function"==typeof i&&i()},error:function(){"function"==typeof t&&t()}})},startScreenShare:function(e){$ZCAjx.ajax({url:"/v2/primetimes/"+e+"/startscreenshare",type:"POST"})},stopScreenShare:function(e){$ZCAjx.ajax({url:"/v2/primetimes/"+e+"/stopscreenshare",type:"POST"})},raiseSpeakerRequest:function(e){$ZCAjx.ajax({url:"/v2/primetimes/"+e+"/raisespeakerrequest",type:"POST",headers:{session_id:WmsImpl.getSid()}})},dropSpeakerRequest:function(e){$ZCAjx.ajax({url:"/v2/primetimes/"+e+"/dropspeakerrequest",type:"POST"})},approveSpeakerRequest:function(e,i,t){$ZCAjx.ajax({url:"/v2/primetimes/"+e+"/peers/"+i+"/approvespeakerrequest",type:"POST",contentType:"application/json",data:{session_id:t}})},denySpeakerRequest:function(e,i){$ZCAjx.ajax({url:"/v2/primetimes/"+e+"/peers/"+i+"/denyspeakerrequest",type:"POST"})},endSpeakerRole:function(e){$ZCAjx.ajax({url:"/v2/primetimes/"+e+"/endspeakersession",type:"POST"})},terminateSpeaker:function(e,i){$ZCAjx.ajax({url:"/v2/primetimes/"+e+"/peers/"+i+"/endspeakersession",type:"POST"})},leave:function(e){$ZCAjx.ajax({url:"/v2/primetimes/"+e+"/leave",type:"POST"})},stop:function(e){$ZCAjx.ajax({url:"/v2/primetimes/"+e,type:"DELETE"})},preflightUrl:function(e,i){fetch(e,{mode:"cors",headers:i,method:"OPTIONS"})},registerGuestInWSS:function(e,i){fetch(e,{mode:"cors"}).then((function(e){200===e.status&&e.text().then((function(t){i(t,e.headers)}))}))},registerUserInWSS:function(e,i){fetch(e,{mode:"cors",credentials:"include"}).then((function(e){200===e.status&&e.text().then((function(t){i(t,e.headers)}))}))},registerOnpremiseAgent:function(e){fetch(e,{mode:"cors"})}};var PrimeTimeTemplates={};PrimeTimeTemplates=function(){var e='<div class="PT-infobx" primetimecheckbox purpose="switchModeInStartUI"><label class="flexIC curP mL3"><div class="zcl-checkbox"><input id="pthandshakecheckbox" type="checkbox" {{checked}}><span class="zcf-tick flexM"></span></div><div class="font14 line20">{{content}}<span class="mL3 clr-S">({{limit_content}})</span></div></label></div>',i='<div class="{{custom_class}}"><div class="PT-frontImg"><img class="wh100" src="{{img_src}}"/></div><div class="PT-info">{{hint}}</div></div>',t='<div class="{{display_class}} mT16" scope_input="{{scope_value}}"><div id="{{id}}" class="zc-native-sel-con"><input class="zc-form-input textL cur" selected-input placeholder="{{place_holder}}" input_buttons purpose="showResultsDom"><span class="zc-form-icons"><span class="msi-darrw zcclr" purpose="showResultsDom"></span><span class="msi-close zcclr cur" purpose="clearSelectedValue"></span></span><div id="{{id}}-results" class="zc-native-sel-cntr"><div class="ellips drsrchholder"><div class="srchin"><span class="msi-srchicon"></span><input id="{{id}}-search-field" class="bornone w100" placeholder="{{search_place_holder}}"/></div></div><div id="{{id}}-list" class="zc-native-sel-list macscroll"></div></div></div></div>',s='<div class="{{display_class}} mT16" scope_input="{{scope_value}}"><div id="{{id}}" class="cur zc-form-multi-sel"><span class="zc-form-icons"><span class="msi-darrw zcclr" purpose="showResultsDom"></span></span><div class="zc-form-input" purpose="showResultsDom"><span data-selections></span><input id="{{id}}-search-field" placeholder="{{place_holder}}"/></div><div id="{{id}}-results" class="zc-native-sel-cntr"><div id="{{id}}-list" class="zc-native-sel-list macscroll"></div></div></div></div>',r='<div class="PT-scope-con"><div class="flexC"><div class="font15 mR40 PT-rdo-title">{{scope_title}}</div><div id="ptstartscopes" primetimeradiobuttons purpose="switchScopeInStartUI">{{scope_levels}}</div></div>{{org_input_html}}{{team_input_html}}{{chat_input_html}}</div>',n='<div class="PT-formcon"><div class="flxG flex-col">{{help_info_html}}{{handshake_checkbox}}{{scope_html}}<div class="PT-topic-input mT30"><div class="font15">{{topic}}<span class="zcl-required"></span></div><div class="PT-input mT16"><input id="pttopic" type="text" class="zcl-input" primetimeinput placeholder="{{topic_placeholder}}"/><div id="pttopiccount" class="limit-txt" category="charcount" limit="{{topic_limit}}"></div></div></div>{{recording_html}}</div></div>',a='<div class="PT-vdocon flex-col"><div id="pttopicpreview" class="PT-vdo-title fshrink"></div><div id="ptvideopreviewwrapper" class="flexG flexM mB25"><div id="ptvideopreviewcnt" class="PT-video"><img class="posabs w100 h100" src="{{bg_img_src}}">{{buffer_loader}}{{user_image_cnt}}<video id="ptpreviewvideo"></video><div class="flexM PT-media-btns"><span class="PT-start-box PT-hover {{video_mute_icon}}" title="{{video_status_title}}" primetimebuttons purpose="{{video_purpose}}" videostatus></span><span class="PT-start-box PT-hover zcf-mic" title="{{audio_status_title}}" primetimebuttons purpose="muteAudioInStartWin"></span></div></div></div><div class="PT-device-cnt fshrink" id="device_picker_cnt"></div></div>',o='<div class="PT-start-cnt ovrflwA">{{initial_page}}{{preview_page}}<div class="PT-premium-tag-cnt dN"><div class="posabs PT-premium-tag"><div class="flexC pR10"><div class="PT-staricon flexM msi-staricon"></div><div>{{premium_tag}}</div></div></div></div></div><div class="PT-initial-footer fshrink"><div class="zcl-btn zcl-btn--secondary mR20" primetimebuttons purpose="closeStartUI">{{cancel}}</div><div class="zcl-btn zcl-btn--primary buttn_disbl" primetimebuttons purpose="showStartUIPreviewPage">{{next}}</div></div><div class="PT-preview-footer fshrink"><div class="zcl-btn zcl-btn--secondary mR20" primetimebuttons purpose="showStartUIInitialPage">{{back}}</div><div class="zcl-btn zcl-btn--primary" primetimebuttons purpose="start">{{start}}</div></div><div class="PT-disabled-footer fshrink"><div class="flexM PT-assembly-disabled-txt textC">{{disabled_content}}</div></div>',m='<div id="ptminimizedwindow" class="PT-minimz-con {{new_footer_class}} {{host_parent_class}} {{rtcp_class}}" primetimecontainer>{{header_html}}<div id="ptminvideowrapperholder" class="PT-min-video-holder"></div><div class="PT-minimz-ftr flexM"><div class="PT-bts-con posrel">{{v2_audio_mute_option}}{{v2_video_mute_option}}{{end_opt}}{{device_settings}}{{v2_screen_share_opt}}{{audio_mute_option}}{{stepdown_speaker_opt}}{{screen_share_opt}}{{video_mute_option}}{{raise_speaker_request}}{{waiting_for_approval}}</div><div class="PT-host-actn"><div id="ptspeakercount" title={{speaker_title}} class="PT-box-40 zcf-raisehand PT-spkr-info {{speaker_display_class}}"><span class="PT-count" count>{{speaker_count}}</span></div>{{end_speaker_opt}}</div></div></div>',d='<div id="primetimewindow" style="background-image: url({{background_image}})" class="PT-wrp {{new_rhs_class}} {{footer_class}} {{host_parent_class}} {{rtcp_class}} flex" primetimecontainer><section class="PT-section flexG ovrflwH"><main class="PT-main">{{v2_header_html}}<section id="pt_section" class="PT-vdo-wrp {{safari_fix_class}}">{{header_html}}<div id="ptvideowrapperholder" class="PT-hoverlay"><div id="ptvideowrapper" class="PT-video-con h100">{{buffer_loader}}</div><div id="pthostscreenwrapper" class="dN"></div><div id="ptnotificationcontainer" class="PT-notification-box PT-list flex-col"></div><div class="PT-vdo-bts flexM"><div class="PT-action-icons posrel"><div class="flexC PT-main-icons">{{v2_audio_mute_option}}{{v2_video_mute_option}}{{end_opt}}{{device_settings}}{{v2_screen_share_opt}}{{raise_speaker_request}}{{waiting_for_approval}}{{end_speaker_opt}}</div>{{audio_mute_option}}{{screen_share_opt}}{{video_mute_option}}{{guest_link_option}}</div><div class="PT-toggle-btns flexC">{{minimize_opt}}{{fullscreen_rhs}}{{rhs_option}}</div></div></div></section>{{footer_section}}</main></section>{{rhs_section}}</div>',c='<div class="PT-footer-pin zcf-downArrow dN" title="{{hide_participants}}" primetimebuttons purpose="hideBottomPane"></div><footer id="primetimefooter" class="PT-footer flexC">{{user_list}}</footer>',l='<div class="PT-list-item flexC fadePTNotification ellips" notifylistitem userId="{{user_id}}"><div class="PT-userImg fshrink mR10"><img class="wh100 bdrR100" src="{{user_img}}">{{raise_hand}}</div><div class="ellips flexG font14 flexC"><div class="PT-list-name fontB ellips">{{user_name}}</div><div class="ellips font16">{{notify_content}}</div></div></div>',p='<aside id="primetimerhscnt" primetimetransition transition-purpose="animateRhs" class="hudl-aside dflx flx-dirC huddl-participant-view broadcast-chat {{associated_resource_parent_class}}"><header class="hudl-aside-hdr fshrink">{{chat_icon}}{{participants_icon}}{{associatedresource_icon}}<div class="zcf-close clr-icon font16 hudl-hdr-close" title="{{close_rhs}}" primetimebuttons purpose="closeRHS"></div></header><section class="hudl-aside-sec flexG"><div class="huddl-aside-wrp" primetimetransition transition-purpose="switchRhsView"><div id="primetimeusersection" class="flx1 w50 ovrflwA rhs-dN">{{participants_section}}</div><div id="primetimechatsection" class="flx1 zcmcembd chtwndws zcsmallchat zcmsgbothside rhs-dN"></div></div></section></aside>',u='<div id="{{header_id}}" class="PT-list-wrp posrel {{header_class}}"><div class="PT-list-title title-underline">{{header}}</div><div id="{{list_id}}" class="PT-list">{{list}}</div></div>',h='<div class="PT-list-item flexC pLR20" userId="{{user_id}}"><div class="PT-userImg fshrink curP mR10"><img class="wh100 bdrR100" src="{{user_img}}"/>{{raise_hand}}</div><div class="ellips flexG font14"><div class="PT-list-name">{{user_name}}</div><div class="clr-S" people_user_info>{{user_info}}</div></div>{{action_cnt}}</div>',v='<div class="PT-userImg-wrp {{host_class}} {{speaker_class}} {{raise_hand_class}} {{my_cnt_class}}" usercontainer userId="{{user_id}}"><div class="PT-userImg"><img class="wh100 bdrR100 objFitCover ovrflwH" userimage src="{{user_img}}"/><video class="wh100 bdrR100 dN"/>{{raise_hand}}</div>{{request_cnt}}{{live_picture_cnt}}<div class="PT-user-info"><div class="fontb ellips">{{user_name}}</div><div class="clrD2 mT5 ellips">{{user_info}}</div></div></div>',f='<div class="PT-req-con"><img src="{{user_img}}"/><div class="PT-req-inner"><span class="zcf-mic-fill"></span><div class="mT10">{{request_content}}</div><div class="flexM pLR10 mT25"><div class="PT-btn mT20" primetimebuttons purpose="approveSpeakerRequest">{{approve}}</div><div class="PT-btn mT20 PT-deny-btn" primetimebuttons purpose="denySpeakerRequest">{{decline}}</div></div></div></div>',S='<div class="PT-livephoto-wrap" livePictureRequestContainer><div class="PT-livephoto"><div class="font16 line20 fontB">{{header}}</div><div class="mT10 desc">{{description}}</div><div class="flexC"><label class="switch-btn"><input primetimebuttons purpose="toggleLivePicture" type="checkbox"><span class="slider"><em></em></span></label><span class="mL15 pt-live-enabled-lbl">{{enable_label}}</span><span class="mL15 pt-live-disabled-lbl dN">{{disable_label}}</span></div></div></div>',T='<div id="{{id}}" videocontainer uid="{{uid}}" ptdoubleclickbuttons purpose="swapVideoContainers" streamtype="{{stream_type}}" class="PT-video-box {{display_class}} {{container_class}}"><div class="{{full_screen_icon}} PT-video-fullscrn dN" targetElemSelector="#{{id}}" title="{{open_full_screen}}" primetimebuttons purpose="openInFullScreen"></div>{{buffer_loader}}{{user_image_cnt}}{{end_speaker}}<video class="wh100"></video><div class="PT-usr-info dN flexC ellips">{{host_identifier}}<span class="flexG ellips">{{user_name}}</span><span class="mute-info-btn zcf-mic-mute dN" title="{{audio_mute_title}}" audioMutedStatus></span><span class="mute-info-btn zcf-video-mute dN" title="{{video_mute_title}}" videoMutedStatus></span></div></div>',_='<div class="PT-end-bg-mask"><div><div class="PT-ended-dlg flexM"><div class="textC"><div class="posrel PT-icn-svg"><img src="{{img_src}}"/></div><div class="font22 fontB">{{header}}</div><div class="PT-end-desc">{{info}}</div></div></div></div></div>',I='<div id="ptinfomodal" class="PT-info-modal flexM" primetimebuttons purpose="hideInfoModal"><img src="{{img_src}}" class="bdrR100 PT-info-img"><div class="mT15">{{info}}</div><div class="PT-info-btn mT40">{{button_text}}</div></div>',g='<div class="PT-popup PT-popup-cancel-req" ptReqCancellationInfo><div class="PT-box-30 zcf-raisehand raisehand-color curN"></div><div class="mT10 line20 font14">{{request_cancel}}</div><div class="PT-link mT10 font15" primetimebuttons purpose="hideRequestCancelledNotification">{{ok}}</div></div>',C='<div network_strength_indicator class="network-indicator posrel mL10 {{tooltip_position}} dN" {{tooltip_type}}="{{network_strength}}"><svg width="25" height="22" viewBox="0 0 25 22" fill="none" version="1.1"><path class="bar-1" d="M4.42062 21.4991L6.99295 18.4297C5.33582 16.8738 4.28336 14.7086 4.16002 12.3428L0.147461 11.8828C0.148418 15.639 1.77393 19.0976 4.42062 21.4991Z"/><path class="bar-2" d="M0.273647 10.7814L4.25476 11.2156C4.62813 8.97333 5.84396 6.89554 7.74278 5.47884L5.89648 1.88672C2.77356 3.9739 0.800438 7.24669 0.273647 10.7814Z"/><path class="bar-3" d="M6.99529 1.19771L8.79503 4.77524C10.88 3.86974 13.2849 3.76074 15.5062 4.58439L17.5176 1.08203C14.0681 -0.404583 10.2485 -0.281611 6.99529 1.19771Z"/><path class="bar-4" d="M18.5631 1.59419L16.5524 5.05759C18.4509 6.30781 19.8575 8.2615 20.3829 10.5716L24.415 10.3398C23.7729 6.63894 21.5808 3.50857 18.5631 1.59419Z"/><path class="bar-5" d="M24.6044 11.6112L20.6128 11.9352C20.6687 14.2076 19.8663 16.4773 18.2685 18.2265L20.7588 21.4062C23.4323 18.7679 24.7532 15.1818 24.6044 11.6112Z"/></svg></div>',P='<div class="media-user-count flexC"><em class="zcf-visible font14"></em><span primetimeviewerscount class="mL5">{{participants_count}}</span></div>',b=function(){var e="";if(PrimeTime.isRecordingEnabled()){var i=PrimeTime.isAssemblyModeAllowed(),t=ZCMediaConstants.callRecordingConfig[SecurityManager.getModuleConfig("primetime_recording","allowed_primetime_recording")];e=$WC.template.replace('<div class="PT-recording"><div class="font15 bcast-premium-icon">{{label}}{{label_icon}}</div><div class="flexG mT16 {{checkbox_disabled_cls}}">{{checkbox_html}}</div></div>',{checkbox_html:CHECK_BOX.getHTML({align:"HR",options:[{label_id:"enable_recording",id:"enable_recording",label:"conference.recording.label.0",type:"toggle",custom_attr:"ptrecordingcheckbox",disabled:t!=ZCMediaConstants.callRecordingConfig.user_choice,checked:t==ZCMediaConstants.callRecordingConfig.enabled}]}),label_icon:i?"":`<span class="huddle-premium-icon mL10 mT2" title="${I18N("conference.recording.paid.hint")}"></span>`},"InSecureHTML"),e=$WC.template.replace(e,{custom_attribute:"recording_container",custom_class:"",checkbox_disabled_cls:i?"":"zcdisabled",$label:"avcliq.media.recording"})}return e},w=function(e){var i="",n="",a="",o=!1,m=MediaManager.isOrgScope(e),d=MediaManager.isChatScope(e),c=[];if(_isAppAccountAdmin()&&(o=m,c.push({id:"primetimeorgscope",value:ZCMediaConstants.scopeTypes.ORG,label:Resource.getRealValue("integration.scope1"),checked:o}),a=$WC.template.replace('<div id="pt-org-scope" class="PT-input PT-dashed {{display_class}}" scope_input="{{scope_value}}"><input type="text" value="{{org_name}}" disabled /></div>',{org_name:_getAppAccountName(),display_class:o?"":"dN",scope_value:ZCMediaConstants.scopeTypes.ORG})),!$WC.Util.isEmptyObject(Groups.getAllOrgGroups())){var l=MediaManager.isTeamScope(e)||m&&!o;c.push({id:"primetimeteamscope",value:ZCMediaConstants.scopeTypes.TEAM,label:Resource.getRealValue("media.scope.team"),checked:l}),n=$WC.template.replace(s,{id:"pt-team-selection",$place_holder:"primetime.team.placeholder",display_class:l?"":"dN",scope_value:ZCMediaConstants.scopeTypes.TEAM}),o=l||o}c.length>0&&!d&&(c.push({id:"primetimechatscope",value:ZCMediaConstants.scopeTypes.CHAT,label:Resource.getRealValue("common.chat"),checked:!o}),i=$Dom.radio.construct("primeTimeScope",c));var p=$WC.template.replace(t,{id:"pt-chat-selection",$place_holder:"primetime.chat.placeholder",$search_place_holder:"smiley.search",display_class:o||d?"dN":"",scope_value:ZCMediaConstants.scopeTypes.CHAT});d&&(p+='<div class="PT-input PT-dashed"><input type="text" chat_name_input disabled /></div>');var u=$WC.template.replace(r,{$scope_title:"media.stream.in"});return $WC.template.replace(u,{scope_levels:i,org_input_html:a,team_input_html:n,chat_input_html:p},"InSecureHTML")},M=function(e,i,t){return $WC.template.replace(e,{user_id:i,user_name:Users.getName(i,t),user_img:Users.getImgUrlById(i),user_info:""})},y=function(e,i,t,s){var r=M(h,e,i),n="",a="";return e!==t&&($zcg._ZUID===t&&(n=$WC.template.replace('<div class="PT-list-action flexC"><span class="PT-btn" primetimebuttons purpose="approveSpeakerRequest">{{approve}}</span><span class="PT-btn PT-deny-btn" primetimebuttons purpose="denySpeakerRequest">{{decline}}</span></div>',{$approve:"common.approve",$decline:"common.decline"})),a='<span class="PT-box-20 zcf-raisehand"></span>'),$WC.template.replace(r,{action_cnt:n,raise_hand:a},"InSecureHTML")},U=function(e,i,t,s,r){var n="",a="",o="",m=e===$zcg._ZUID,d=t===$zcg._ZUID;d&&!m&&(n=$WC.template.replace(f,{$request_content:["primetime.speaker.requested.info",Users.getName(e,i)],$approve:"common.approve",$decline:"common.decline"})),m&&!d&&(a=$WC.template.replace(S,{$header:"primetime.live.picture.header",$description:"primetime.live.picture.description",$enable_label:"common.enable",$disable_label:"common.disable"})),e!==t&&(o='<span class="PT-box-30 font16 zcf-raisehand"></span>');var c=$WC.template.replace(v,{request_cnt:n,live_picture_cnt:a,raise_hand:o,host_class:e===t?"PT-host-cnt":"",my_cnt_class:m?"PT-mine-cnt":"",speaker_class:r?"PT-speaker-cnt":"",raise_hand_class:s?"PT-raised-hands":""},"InSecureHTML");return M(c,e,i)},k=function(e,i,t,s,r){var n=$WC.template.replace(u,{$header:e,header_id:i,list_id:s,header_class:$WC.Util.isEmpty(r)?t+" dN":t});return $WC.template.replace(n,{list:r},"InSecureHTML")},R=function(e,i){return k("media.host","ptrhshostheader","pt-host-list","ptrhshostlist",y(e,i,e))+k("primetime.header.speaker.requests","ptrhsraisedhandsheader","pt-spk-req-list","ptrhsraisedhandslist","")+k("common.participants","ptrhsmembersheader","pt-mem-list","ptrhsmemberslist","")},$=function(e,i){return $WC.template.replace('<div id="ptbottompanehostlist flexC">{{list}}</div><div id="ptbottompaneraisedhandslist" class="pt-spk-req-list flexC"></div><div id="ptbottompanememberslist" class="pt-mem-list flexC"></div><div id="pthiddenuserscount" class="PT-box-70 mL12 dN" primetimebuttons purpose="openParticipantsInRHS"></div>',{list:U(e,i,e,!1,!1)},"InSecureHTML")};return{getStartUIHtml:function(t,s){var r,m=$WC.template.replace(n,{help_info_html:$WC.template.replace(i,{custom_class:"PT-handshake-helpinfo",$hint:["primetime.handshake.hint",PrimeTimeImpl.getHandShakeParticipantsLimit()],img_src:MediaManager.getImgUrl(ZCMediaConstants.defaultImageNames.PT_HANDSHAKE)})+$WC.template.replace(i,{custom_class:"PT-assembly-helpinfo",$hint:["primetime.assembly.hint",PrimeTimeImpl.getAssemblyParticipantsLimit()],img_src:MediaManager.getImgUrl(ZCMediaConstants.defaultImageNames.PT_ASSEMBLY)}),scope_html:w(s),handshake_checkbox:(r=t,PrimeTime.isHandShakeModeAllowed()?$WC.template.replace(e,{$content:"primetime.handshake.desc",$limit_content:["primetime.handshake.limit",PrimeTimeImpl.getHandShakeParticipantsLimit()],checked:PrimeTime.isHandShakeMode(r)?"checked":""}):""),recording_html:b()},"InSecureHTML");m=$WC.template.replace(m,{$topic:"media.topic",$topic_placeholder:"primetime.topic.placeholder",topic_limit:ZCMediaConstants.MAX_TITLE_LENGTH});var d=$WC.template.replace(a,{buffer_loader:MediaTemplates.getBufferLoader(),user_image_cnt:MediaTemplates.userImageContainer},"InSecureHTML");d=$WC.template.replace(d,{video_mute_icon:"zcf-video-mute",$audio_status_title:"common.micoff",$video_status_title:"videochat.cameraon",video_purpose:"enableVideoInStartWin",user_img:Users.getImgUrlById($zcg._ZUID),user_image_display_class:"",user_image_onload:"",bg_img_src:$zcg._IMGDEFAULTSTATICURL+"/videochat-bg.jpg"});var c=$WC.template.replace(o,{initial_page:m,preview_page:d},"InSecureHTML");return $WC.template.replace(c,{$cancel:"common.cancel",$next:"common.next",$back:"common.back",$start:"primetime.start.session",$disabled_content:"primetime.assembly.paid",$premium_tag:"common.premium"})},getMainUIHtml:function(e,i,t,s,r,n,a,o,m){var l=$zcg._ZUID===i,u=PrimeTime.isHandShakeMode(s),h="",v="",f="",S="",T="",_="",I="",g="",C="",P="",b="",w=WmsImpl.isGuestUser(),M=w?"":'<div class="PT-box PT-hover zcf-mini-player" title="{{minimize_title}}" primetimebuttons purpose="minimizeWindow"></div>';(u||l)&&(I=_=$WC.template.replace('<div class="PT-box PT-hover zcf-mic {{display_class}}" title="{{title}}" primetimebuttons purpose="muteAudio"></div>',{$title:"common.micoff",display_class:l?"":"dN"}),C=g=$WC.template.replace('<div class="PT-box PT-hover zcf-video {{display_class}}" title="{{title}}" primetimebuttons purpose="muteVideo"></div>',{$title:"videochat.cameraoff",display_class:l&&PrimeTimeImpl.currentUpStream&&PrimeTimeImpl.currentUpStream._hasVideoTrack()?"":"dN"}),_=g=""),l?(PrimeTime.isScreenShareAllowed()&&(u||PrimeTime.isAssemblySSEnabled())&&(T=S=$WC.template.replace('<div class="PT-box PT-hover zcf-sharescrn" title="{{title}}" primetimebuttons purpose="startScreenShare"></div>',{$title:"common.screenshare"}),S=""),P=$WC.template.replace('<div class="PT-box PT-hover zcf-setting" title="{{title}}" primetimebuttons purpose="showDeviceSettings"></div>',{$title:"common.settings"}),u||(b=$WC.template.replace('<div class="PT-box PT-hover zcf-link2" title="{{title}}" primetimebuttons purpose="copyGuestLink"></div>',{$title:"primetime.guestlink.copy"}))):u&&(h=$WC.template.replace('<div class="posrel mL20" speakerrequestwrapper><div class="PT-btn mL20" primetimebuttons purpose="raiseSpeakerRequest"><span class="zcf-raisehand mR5 raisehand-color font18"></span>{{title}}</div></div>',{$title:"primetime.speaker.request"}),v=$WC.template.replace('<div class="PT-btn mL20 dN" primetimebuttons purpose="stepDownFromSpeaker" title="{{title}}"><span class="zcf-audio font8 mR5"></span>{{title}}</div>',{$title:"primetime.speaker.leave"}),f=$WC.template.replace('<div class="PT-btn mL20 dN PT-hover PT-rqst-btn" primetimebuttons purpose="dropSpeakerRequest"><span class="PT-rqst flexC">{{waiting_title}}<span class="mL10"><span class="zcf-waiting font12"></span></span></span><span class="PT-rqst-cancel">{{cancel}}</span></div>',{$waiting_title:"primetime.approval.waiting",$cancel:"common.cancel"}));var y=$WC.template.replace(p,{chat_icon:MediaManager.isChatScope(r)&&!w?'<div class="flexG font18 ellips huddl-aside-chat-hdr hudl-hdr-item" primetimebuttons purpose="openChatInRHS"><span class="zcf-chat hudl-hdr-item-icon"><span class="msgnotify" primetimeunreadmsgcount></span></span>{{chat_section_header}}</div>':"",participants_icon:u?'<div class="flexG font18 ellips huddl-aside-part-hdr hudl-hdr-item" primetimebuttons purpose="openParticipantsInRHS"><span class="hudl-hdr-item-icon zcf-users"></span>{{participant_section_header}}</div>':"",associatedresource_icon:void 0!==a?'<div class="flexG font18 ellips huddle-aside-res-hdr hudl-hdr-item" primetimebuttons purpose="openAssociatedResource"><span class="hudl-hdr-item-icon zcf-townhall"></span>{{associated_section_header}}</div>':"",participants_section:u?R(i,t):""},"InSecureHTML");y=$WC.template.replace(y,{$participant_section_header:"common.participants",$chat_section_header:"common.chat",$close_rhs_title:"common.hide",$close_rhs:"common.close",$associated_section_header:"conference.associatedresource.townhall.title",associated_resource_parent_class:void 0!==a?"conference-associated-resource-parent":""});var U="";u&&(U=$WC.template.replace(c,{$hide_participants:"primetime.hide.participants"}),U=$WC.template.replace(U,{user_list:$(i,t)},"InSecureHTML"));var k,A='<div class="PT-btn-neg" primetimebuttons purpose="leave">{{end_title}}</div>',W={id:"ptv2header",customClass:"",customAttribute:"component_header",titleParams:{id:"pt_header_title",iconClass:"zcf-primetime",content:e,allowEdit:!1},timerParams:{id:"ptsessionsubtimer"},recorderParams:{recordingIndex:o,allowAction:l,customAttribute:"primetimebuttons"},screenShareIndicatorParams:{displayClass:"zc-av-hide",customAttribute:"primetimebuttons",purpose:"stopScreenShareFromBottomBand"},viewerCountParams:{count:0},options:{}};w||(W.backButtonParams={iconClass:"zcf-leftArrow",titleResourceParams:"media.back.minimize.view",customAttribute:"primetimebuttons",purpose:"minimizeWindow"},MediaManager.isChatScope(r)&&m&&(W.options.chatParams={displayClass:"",iconClass:"zcf-chat",customAttribute:"primetimebuttons openchatrhsbutton",purpose:"openChatInRHS",unreadCountAttribute:"primetimeunreadmsgcount"})),l&&(A='<div class="PT-end-ftr-btn PT-box zcf-audio" primetimebuttons purpose="leave" title="{{end_title}}"></div>'),k=MediaTemplates.getV2HeaderComponentHtml(W);var z=MediaTemplates.getHeaderComponentHtml({customClass:"",customAttribute:"",module:"primetimebuttons",backBtnClass:"zcf-leftArrow",backBtnPurpose:"minimizeWindow",componentIconClass:"zcf-primetime",timerId:"primetimesessiontimer",title:e,header:e,backBtnTitle:"media.back.minimize.view",ignoreBackOption:w,isPreviewRoom:!1}),V=$WC.template.replace(d,{background_image:$zcg._IMGDEFAULTSTATICURL+"/videochat-bg.jpg",raise_speaker_request:h,waiting_for_approval:f,end_speaker_opt:v,screen_share_opt:S,audio_mute_option:_,video_mute_option:g,v2_screen_share_opt:T,v2_audio_mute_option:I,v2_video_mute_option:C,guest_link_option:b,buffer_loader:MediaTemplates.getBufferLoader(),minimize_opt:M,rhs_option:"",rhs_section:y,footer_section:U,header_html:z,v2_header_html:k,end_opt:A,device_settings:P,safari_fix_class:$Util.Browser.isSafari()?"h100":"",rtcp_class:RTCPMediaPlayer.isEnabled()&&!l?"PT-rtcp-mode":"",fullscreen_rhs:void 0!==a?"":'<div class="PT-box PT-hover zcf-fullscrn" title="{{open_full_screen}}" targetElemSelector="body" primetimebuttons purpose="openInFullScreen"></div>'},"InSecureHTML");return $WC.template.replace(V,{new_rhs_class:"smartconf-aside-v2",footer_class:"PT-new-ftr",host_parent_class:l?"PT-host-view":"PT-member-view",$open_full_screen:"media.open.fullscreen",$minimize_title:"videochat.minimize",$end_title:l?"avcliq.media.stop":"common.leave"})},getMinimizedUIHtml:function(e){var i=e.getCurrentMember(),t=i.isHost(),s=i.isSpeaker(),r="",n="",a="",o="",d="",c="",l="",p="",u="",h="",v=t?"PT-new-ftr":"",f=$WC.template.replace('<div class="PT-box-40 PT-close-btn {{icon_class}}" primetimebuttons purpose="leave" title={{end_session}}></div>',{icon_class:"zcf-audio"}),S=e.isHandShakeMode();if(t&&PrimeTime.isScreenShareAllowed()&&(S||PrimeTime.isAssemblySSEnabled())){var T=e.hasScreenShareSession();h=u=$WC.template.replace('<div class="PT-box-40 PT-hover {{icon_class}}" title="{{title}}" primetimebuttons purpose="{{purpose}}"></div>',{$title:T?"avcliq.media.screenshare.stop":"avcliq.media.screenshare.start",icon_class:T?"zcf-scrn-shr-stop":"zcf-sharescrn",purpose:T?"stopScreenShare":"startScreenShare"}),u=""}if(S&&(t||(c=$WC.template.replace('<div class="PT-box-40 {{display_wrapper_class}}" speakerrequestwrapper>{{request_popup_denied}}<div class="font17 {{display_class}}" primetimebuttons purpose="raiseSpeakerRequest"><div class="zcf-raisehand" title="{{title}}"></div></div>',{purpose:"endSpeakerSession",$title:"primetime.speaker.request",display_class:s||i.hasRequestedToSpeak()?"dN":"",display_wrapper_class:s?"dN":""}),c=$WC.template.replace(c,{request_popup_denied:PrimeTimeUI.isRequestDeniedPopupExists()?PrimeTimeTemplates.getRequestCancellationPopupHtml():""},"InSecureHTML"),p=$WC.template.replace('<div class="PT-box-40 PT-end-btn {{display_class}}" primetimebuttons purpose="stepDownFromSpeaker" title="{{title}}"><span class="zcf-audio"></span></div>',{$title:"primetime.speaker.leave",display_class:s?"":"dN"}),l=$WC.template.replace('<div class="{{display_class}} PT-rqst-btn flexM posrel" primetimebuttons purpose="dropSpeakerRequest"><span class="PT-raisehand-anim zcf-raisehand"></span><span class="PT-rqst" title="{{waiting_title}}"><span class="zcf-waiting"></span></span><span class="PT-rqst-cancel zcf-raisehand font17" title="{{cancel}}"></span></div></div>',{$waiting_title:"primetime.approval.waiting",$cancel:"common.cancel",display_class:i.hasRequestedToSpeak()?"":"dN"}))),S||t){var _='<div class="PT-box-40 PT-hover {{icon_class}} {{display_class}}" title="{{title}}" primetimebuttons purpose="{{purpose}}"></div>',I=t||s?"":"dN",g={audio:{true:{icon_class:"zcf-mic-mute",display_class:I,$title:"common.micon",purpose:"unmuteAudio"},false:{icon_class:"zcf-mic",display_class:I,$title:"common.micoff",purpose:"muteAudio"}},video:{true:{icon_class:"zcf-video-mute",display_class:I,$title:"videochat.cameraon",purpose:"unmuteVideo"},false:{icon_class:"zcf-video",display_class:I,$title:"videochat.cameraoff",purpose:"muteVideo"}}};a=r=$WC.template.replace(_,g.audio[i.isAudioMuted()]),o=n=$WC.template.replace(_,g.video[i.isVideoMuted()]),r=n="",d=$WC.template.replace('<div class="PT-box-40 PT-hover zcf-setting" title="{{title}}" primetimebuttons purpose="showDeviceSettings"></div>',{$title:"common.settings"})}var C=e.getRequestedSpeakers(),P=[],b=0;for(var w in C)b++,P.push(C[w].getName());var M=e.getTitle(),y=MediaTemplates.getHeaderComponentHtml({customClass:"media-hdr-minimz",customAttribute:"",module:"primetimebuttons",backBtnClass:"zcf-maximize2",backBtnPurpose:"maximizeWindow",componentIconClass:"zcf-primetime",timerId:"ptminviewsessiontimer",title:M,header:M,backBtnTitle:"videochat.fullscreen",isPreviewRoom:!1}),U=$WC.template.replace(m,{header_html:y,end_opt:f},"InSecureHTML");return U=$WC.template.replace(U,{speaker_display_class:b>0?"":"dN",speaker_count:b,new_footer_class:v,host_parent_class:t?"PT-host-view":"PT-member-view",rtcp_class:RTCPMediaPlayer.isEnabled()&&!t?"PT-rtcp-mode":"",$end_session:t?"avcliq.media.stop":"common.leave"}),$WC.template.replace(U,{speaker_title:$Util.getCustomToolTipForList(P,5),end_speaker_opt:"",raise_speaker_request:c,waiting_for_approval:l,stepdown_speaker_opt:p,screen_share_opt:u,audio_mute_option:r,video_mute_option:n,device_settings:d,v2_screen_share_opt:h,v2_audio_mute_option:a,v2_video_mute_option:o},"InSecureHTML")},getVideoContainerHtml:function(e,i,t,s){var r=$WC.template.replace(T,{buffer_loader:MediaTemplates.getBufferLoader(),user_image_cnt:MediaTemplates.userImageContainer},"InSecureHTML");r=$WC.template.replace(r,{id:t,uid:e,$audio_mute_title:"media.mic.muted",$video_mute_title:"media.camera.muted",$open_full_screen:"media.open.fullscreen",user_name:Users.getName(e,i),user_img:Users.getImgUrlById(e),user_image_display_class:s===WebRTCUserMedia.streamTypes.AUDIO_ONLY?"":"dN",user_image_onload:"",stream_type:s,full_screen_icon:"zcf-fullscrn",container_class:s===WebRTCUserMedia.streamTypes.SCREEN?"PT-screen-cnt":"PT-video-cnt",display_class:$zcg._ZUID===e&&s===WebRTCUserMedia.streamTypes.SCREEN?"dN":""});var n="",a="",o=PrimeTimeImpl.getCurrentSession();return o&&(o.isHost(e)?n='<span class="zcf-owner mrgR5 fshrink"></span>':o.isHost($zcg._ZUID)&&(a=$WC.template.replace('<div class="PT-opt-ovrly fdirC flexM"><div class="zcf-close PT-box-65 PT-end-co-hosting clrR" primetimebuttons purpose="endSpeakerSession"></div><div class="font15 mT10 textC fontB">{{content}}</div></div>',{$content:["primetime.end.speaker",Users.getName(e,i)]}))),r=$WC.template.replace(r,{host_identifier:n,end_speaker:a},"InSecureHTML")},getRhsUserHtml:y,getBottomPaneUserHtml:U,getNotificationHtml:function(e,i){var t=M(l,i.getId(),i.getName()),s="primetime.joined.notify",r="";return PrimeTimeImpl.isRequestToSpeakNotification(e)&&(s="primetime.speakerrequest.notify",r='<span class="zcf-raisehand PT-box-20 PT-raisehand"></span>'),t=$WC.template.replace(t,{$notify_content:s}),$WC.template.replace(t,{raise_hand:r},"InSecureHTML")},getInfoModalHtml:function(){return $WC.template.replace(I,{img_src:MediaManager.getImgUrl(ZCMediaConstants.defaultImageNames.PT_ICON),$info:"primetime.connected.info",$button_text:"primetime.start.now"})},getSessionEndInfoDialogHtml:function(e,i){var t=$WC.template.replace(_,{header:e,img_src:MediaManager.getImgUrl(ZCMediaConstants.defaultImageNames.PT_ICON)});return $WC.template.replace(t,{info:i},"InSecureHTML")},getRequestCancellationPopupHtml:function(){return $WC.template.replace(g,{$request_cancel:"videobroadcast.request.rejected",$ok:"common.ok"})},getViewersCountHtml:function(){return $WC.template.replace(P,{participants_count:PrimeTimeImpl.hasCurrentSession()?PrimeTimeImpl.getCurrentSession().getMembersCount():0})},getNetworkStrengthIndicatorHtml:function(e){return $WC.template.replace(C,{$network_strength:"media.network.strength",tooltip_type:e?"tooltip-title":"title",tooltip_position:e?"tooltip-up":""})}}}();var PrimeTimeSession=function(e){this._id=e.primeTimeId,this._mode=e.primeTimeMode,this._assemblyViewerCount=e.viewersCount||0,this._sessionId=e.sessionId,this._speakerConnectionId,this._speakerUserId,this._screenShareId,this._screenShareUserId,this._hostId=e.primeTimeHostId,this._hostName=e.primeTimeHostName,this._title=e.title,this._startTime=e.startTime,this._scopeType=e.scopeType,this._scopeIds=void 0,void 0!==e.scopeIds&&(this._scopeIds=e.scopeIds instanceof Array?e.scopeIds:e.scopeIds.split()),this._turnServers=e.turnServers,this._wssDetails={mainServerUrl:void 0,backupServerUrl:void 0,anonMainServerUrl:void 0,anonBackupServerUrl:void 0},this._members={},this._hasNotifiedStart=!1,this._isBottomPaneHidden=!1,this._miniPlayerProperty={prevSize:{width:"540px",height:"338px"},prevPosition:{top:"",left:""}},this._isConferenceStreaming=!1,this._associatedResourceData=e.associated_resource,this._streamingId=e.streaming_id,this._playerMode=void 0};PrimeTimeSession.prototype={initUpStream:function(e,i,t){var s=new PrimeTimeMember(this._id,$zcg._ZUID,Users.getName($zcg._ZUID));s.setTurnCredentials(e,i),this._members[$zcg._ZUID]=s,PrimeTimeImpl.getAndSetPeopleInfo([$zcg._ZUID]),s.initAVUpStream(this._turnServers,t)},initSpeakerUpStream:function(e,i,t,s){this._speakerConnectionId=e,this._speakerUserId=$zcg._ZUID;var r=this.getCurrentMember();r.setAVConnectionId(e),r.setTurnCredentials(i,t),r.initAVUpStream(this._turnServers,s),r.setAsSpeaker()},initScreenUpStream:function(e,i,t,s){this._screenShareId=e,this._screenShareUserId=$zcg._ZUID,this.getCurrentMember().initScreenUpStream(this._screenShareId,this._turnServers,i,t,s)},initiateAssemblyPlayer:function(){var e=this.getHostId(),i=new PrimeTimeMember(this._id,e,Users.getName(e,this.getHostName()));this._members[e]=i;var t=new PrimeTimeMember(this._id,$zcg._ZUID,Users.getName($zcg._ZUID));this._members[$zcg._ZUID]=t,i.initiateAssemblyPlayer()},connectDownStream:function(e){var i=this.getMember(e.hostId);if(i){var t=i.getAVPeerConnection();t&&t.close()}else i=new PrimeTimeMember(this._id,e.hostId,e.hostName),this._members[e.hostId]=i,PrimeTimeImpl.getAndSetPeopleInfo([e.hostId]);i.setTurnCredentials(e.turnUserName,e.turnCredential),i.connectAVDownStream(this._turnServers,WebRTCUserMedia.getStreamTypesInInt(e.connectionDataMode),e.offerSdp,e.remoteIceCandidates),i.updateAVStreamStatus(e),PrimeTimeUI.updateMembersCount()},connectSpeakerDownStream:function(e){this._speakerConnectionId=e.speakerConnectionId,this._speakerUserId=e.hostId;var i=this.getMember(e.hostId);if(i){var t=i.getAVPeerConnection();t&&t.close()}else i=new PrimeTimeMember(this._id,e.hostId,e.hostName),this._members[e.hostId]=i,PrimeTimeImpl.getAndSetPeopleInfo([e.hostId]);i.setTurnCredentials(e.turnUserName,e.turnCredential),i.setAVConnectionId(this._speakerConnectionId),i.connectAVDownStream(this._turnServers,WebRTCUserMedia.getStreamTypesInInt(e.connectionDataMode),e.offerSdp,e.remoteIceCandidates),i.resetSpeakerRequest(),i.setAsSpeaker(),PrimeTimeUI.modifyList(i),PrimeTimeUI.updateMembersCount()},connectScreenDownStream:function(e){var i=this.getMember(e.hostId);if(i){var t=i.getScreenPeerConnection();t&&t.close(),this._screenShareId=e.screenShareId,this._screenShareUserId=e.hostId,i.connectScreenDownStream(this._screenShareId,this._turnServers,WebRTCUserMedia.streamTypes.SCREEN,e.offerSdp,e.remoteIceCandidates)}},disconnectSpeakerConnection:function(){PrimeTimeUI.resetSpeakerOptions();var e=this.getMember(this.getSpeakerUserId());e&&(e.disconnectAVConnection(),e.removeAsSpeaker(),this._speakerUserId=void 0,this._speakerConnectionId=void 0)},disconnectScreenDownStream:function(){var e=this.getMember(this._screenShareUserId);e&&(e.disconnectScreenDownStream(),this._screenShareId=void 0,this._screenShareUserId=void 0)},addMember:function(e,i,t,s,r){if(!this.getMember(e)){var n=new PrimeTimeMember(this._id,e,i);n.setJoinedTime(t),s&&n.setSpeakerRequest(r),this._members[e]=n,PrimeTimeUI.addUserInList(this._members[e])}},removeMember:function(e){var i=this._members[e];i&&i.closeConnections(),delete this._members[e]},terminate:function(){var e=this.getMembers();for(zuid in e){e[zuid].closeConnections()}this.isShakaPlayer()?PrimeTimeImpl.shakaPlayer.destroy():this.isHLSPlayer()?PrimeTimeImpl.hlsPlayer.destroy():this.isRTCPPlayer()&&RTCPMediaPlayerImpl.destroy()},enableLivePicture:function(){this.isHandShakeMode()&&this.getCurrentMember()._enableLivePicture()},disableLivePicture:function(){this.getCurrentMember()._disableLivePicture()},isAssemblyMode:function(){return PrimeTime.isAssemblyMode(this._mode)},isHandShakeMode:function(){return PrimeTime.isHandShakeMode(this._mode)},isHost:function(e){return this._hostId===e},isSpeaker:function(e){return e===this.getSpeakerUserId()},isChatScope:function(){return MediaManager.isChatScope(this._scopeType)},setWSSMainServerUrl:function(e){this._wssDetails.mainServerUrl=e},getWSSMainServerUrl:function(){return this._wssDetails.mainServerUrl},setWSSBackupServerUrl:function(e){this._wssDetails.backupServerUrl=e},getWSSBackupServerUrl:function(){return this._wssDetails.backupServerUrl},setAnonWSSMainServerUrl:function(e){this._wssDetails.anonMainServerUrl=e},getAnonWSSMainServerUrl:function(){return this._wssDetails.anonMainServerUrl},setAnonWSSBackupServerUrl:function(e){this._wssDetails.anonBackupServerUrl=e},getAnonWSSBackupServerUrl:function(){return this._wssDetails.anonBackupServerUrl},hasSpeakerSession:function(){return void 0!==this.getSpeakerUserId()},hasScreenShareSession:function(){return void 0!==this.getScreenShareUserId()},hasNotifiedStart:function(){return this._hasNotifiedStart},setAsNotified:function(){this._hasNotifiedStart=!0},resetNotified:function(){this._hasNotifiedStart=!1},isConferenceStreaming:function(){return this._isConferenceStreaming},setAsConferenceStreaming:function(){this._isConferenceStreaming=!0},setMiniPlayerSize:function(e){this._miniPlayerProperty.prevSize=e},setMiniPlayerPosition:function(e){this._miniPlayerProperty.prevPosition=e},getMiniPlayerSize:function(){return this._miniPlayerProperty.prevSize},getMiniPlayerPosition:function(){return this._miniPlayerProperty.prevPosition},setBottomPaneAsHidden:function(){this._isBottomPaneHidden=!0},setBottomPaneAsVisible:function(){this._isBottomPaneHidden=!1},isBottomPaneHidden:function(){return this._isBottomPaneHidden},getGuestLink:function(){return this._guestLink},generateGuestLink:function(){if(void 0===this._guestLink){var e=function(e){this._guestLink=e.url,PrimeTimeImpl.copyGuestLink()}.bind(this);PrimeTimeAPI.generateGuestLink(this._id,e)}},hasGuestLink:function(){return void 0!==this._guestLink},getChatId:function(){var e;return this.isChatScope()&&(e=this._scopeIds[0]),e},getId:function(){return this._id},getScreenShareId:function(){return this._screenShareId},getScreenShareUserId:function(){return this._screenShareUserId},getSpeakerUserId:function(){return this._speakerUserId},getSpeakerConnectionId:function(){return this._speakerConnectionId},getAssociatedResourceData:function(){return this._associatedResourceData},hasAssociatedResourceData:function(){return void 0!==this._associatedResourceData},getTitle:function(){return this._title},getStartTime:function(){return this._startTime},getHostId:function(){return this._hostId},getHostName:function(){return this._hostName},getMember:function(e){return this._members[e]},getHost:function(){return this.getMember(this.getHostId())},getSpeaker:function(){return this.getMember(this.getSpeakerUserId())},getCurrentMember:function(){return this._members[$zcg._ZUID]},getMembersCount:function(){return this.isHandShakeMode()?Object.keys(this.getMembers()).length-1:this._assemblyViewerCount},updateMembersCount:function(e){this._assemblyViewerCount=e},getRequestedSpeakersCount:function(){return Object.keys(this.getRequestedSpeakers()).length},getRequestedSpeakers:function(){var e={},i=this.getMembers();for(var t in i){var s=i[t];s.hasRequestedToSpeak()&&(e[t]=s)}return e},getMembers:function(){return this._members},getStreamingId:function(){return this._streamingId},setPlayerMode:function(e){this._playerMode=e},getPlayerMode:function(){return this._playerMode},isShakaPlayer:function(){return PrimeTimeImpl.isShakaPlayer(this.getPlayerMode())},isHLSPlayer:function(){return PrimeTimeImpl.isHLSPlayer(this.getPlayerMode())},isRTCPPlayer:function(){return PrimeTimeImpl.isRTCPPlayer(this.getPlayerMode())}};var PrimeTimeMember=function(e,i,t){this._primeTimeId=e,this._avConnectionId=e,this._screenShareId,this._id=i,this._name=t,this._joinedTime=0,this._hasRequestedToSpeak=!1,this._sessionId,this._emailId=void 0,this._designation=void 0,this._department=void 0,this._avMediaContainer,this._screenMediaContainer,this._isLivePictureEnabled=!1,this._liveVideoMediaContainer=void 0,this._livePictureCaptureTimeout=void 0,this._videoStream=void 0,this._isReconnectingAVStream=!1,this._isReconnectingScreenStream=!1,this._avReconnectionAttempts=0,this._screenReconnectionAttempts=0,this._avPeerConnection,this._screenPeerConnection,this._lastAudioChunkId=0,this._lastVideoChunkId=0,this._audioStatus={muted:!1,time:-1},this._videoStatus={muted:!1,time:-1},this._hasUpdatedInitialMuteStatus=!1};PrimeTimeMember.prototype={setTurnCredentials:function(e,i){this._turnUserName=e,this._turnCredential=i},setAVConnectionId:function(e){this._avConnectionId=e},setJoinedTime:function(e){this._joinedTime=e},setPeopleDetails:function(e){this._emailId=e.emailid,this._designation=e.designation,this._department=e.departmentname},getId:function(){return this._id},getEmailId:function(){return this._emailId},getDesignation:function(){return this._designation},getDepartmentName:function(){return this._department},getName:function(){return this._name},getAVMediaContainer:function(){return this._avMediaContainer},getAVStream:function(){return this.getAVMediaContainer().getStream()},getAVPeerConnection:function(){return this._avPeerConnection},getScreenPeerConnection:function(){return this._screenPeerConnection},getSessionId:function(){return this._sessionId},setAsSpeaker:function(){$("#primetimefooter").find('[usercontainer][userId="'+this.getId()+'"]').addClass("PT-speaker-cnt")},removeAsSpeaker:function(){$("#primetimefooter").find('[usercontainer][userId="'+this.getId()+'"]').removeClass("PT-speaker-cnt")},setLastAudioChunkId:function(e){this._lastAudioChunkId=e},setLastVideoChunkId:function(e){this._lastVideoChunkId=e},getLastAudioChunkId:function(){return this._lastAudioChunkId},getLastVideoChunkId:function(){return this._lastVideoChunkId},hasRequestedToSpeak:function(){return this._hasRequestedToSpeak},_generateConnectionId:function(e){return this._primeTimeId+"_"+this._id+"_"+e},isHost:function(){return PrimeTimeImpl.getCurrentSession().isHost(this._id)},isSpeaker:function(){return PrimeTimeImpl.getCurrentSession().isSpeaker(this._id)},isAudioMuted:function(){return this._audioStatus.muted},isVideoMuted:function(){return this._videoStatus.muted},isLivePictureEnabled:function(){return this._isLivePictureEnabled},setSpeakerRequest:function(e){this._sessionId=e,this._hasRequestedToSpeak=!0,$("#primetimefooter").find('[usercontainer][userId="'+this.getId()+'"]').addClass("PT-raised-hands")},resetSpeakerRequest:function(){this._hasRequestedToSpeak=!1,$("#primetimefooter").find('[usercontainer][userId="'+this.getId()+'"]').removeClass("PT-raised-hands")},initAVUpStream:function(e,i){this._avMediaContainer=PrimeTimeUI.addAndGetMediaContainer(this._id,this._name,this._generateConnectionId(i),i),this._avPeerConnection=new WebRTCPeerConnection(this._avConnectionId,this._id,WebRTCPeerConnectionConstants.connectionTypes.AUDIO_VIDEO,PrimeTimeHandler.peerConnectionEvents,this._avMediaContainer,e,this._turnUserName,this._turnCredential,i,!0),MediaUtil.setStreamInContainer(this._id,$(this._avMediaContainer).parent("[videocontainer]"),PrimeTimeImpl.currentUpStream),PrimeTimeImpl.currentUpStream._isAudioTrackEnabled()||PrimeTimeImpl.muteAudio(!1),PrimeTimeImpl.currentUpStream._isVideoTrackEnabled()||PrimeTimeImpl.muteVideo(!1)},replaceTracksInStream:function(e,i){this._avMediaContainer.setStream(e),this._avMediaContainer.playStream(),this._avMediaContainer.muted=!0,WebRTCUserMedia.isAudioVideoStreamType(i)?this._avPeerConnection.replaceTracks(e,WebRTCUserMedia.streamTypes.AUDIO_VIDEO):WebRTCUserMedia.isAudioStreamType(i)?this._avPeerConnection.replaceTracks(e,WebRTCUserMedia.streamTypes.AUDIO_ONLY):this._avPeerConnection.replaceTracks(e,WebRTCUserMedia.streamTypes.VIDEO_ONLY)},initScreenUpStream:function(e,i,t,s,r){this._screenShareId=e,this._screenMediaContainer=PrimeTimeUI.addAndGetMediaContainer(this._id,this._name,this._generateConnectionId(r),r),this._screenPeerConnection=new WebRTCPeerConnection(this._screenShareId,this._id,WebRTCPeerConnectionConstants.connectionTypes.SCREEN,PrimeTimeHandler.peerConnectionEvents,this._screenMediaContainer,i,t,s,r,!0),MediaUtil.setStreamInContainer(this._id,$(this._screenMediaContainer).parent("[videocontainer]"),PrimeTimeImpl.currentScreenUpStream)},initiateAssemblyPlayer:function(){let e=void 0,i=PrimeTimeImpl.getCurrentSession();void 0!==i&&(e=i.getStreamingId()),this._avMediaContainer=PrimeTimeUI.addAndGetMediaContainer(this._id,this._name,this._generateConnectionId(WebRTCUserMedia.streamTypes.AUDIO_VIDEO),WebRTCUserMedia.streamTypes.AUDIO_VIDEO),RTCPMediaPlayerImpl.isSupported()?(i.setPlayerMode(PrimeTimeImpl.playerModes.RTCP),WmsImpl.isGuestUser()?RTCPMediaPlayerImpl.registerAndInitializeGuest(e):RTCPMediaPlayerImpl.registerAndInitialize(e)):PrimeTimeImpl.shakaPlayer.isSupported()&&!PrimeTime.isHlsOnlyEnabled()?(i.setPlayerMode(PrimeTimeImpl.playerModes.SHAKA),WmsImpl.isGuestUser()?PrimeTimeImpl.shakaPlayer.registerAndInitializeGuest(e):PrimeTimeImpl.shakaPlayer.registerAndInitialize(e)):PrimeTimeImpl.hlsPlayer.isSupported()&&(i.setPlayerMode(PrimeTimeImpl.playerModes.HLS),WmsImpl.isGuestUser()?PrimeTimeImpl.hlsPlayer.registerAndInitializeGuest(e):PrimeTimeImpl.hlsPlayer.initialize(PrimeTimeImpl.getPlayerManifestUrl(e)))},connectAVDownStream:function(e,i,t,s){this._avPeerConnection&&this._avPeerConnection.close(),this._avMediaContainer=PrimeTimeUI.addAndGetMediaContainer(this._id,this._name,this._generateConnectionId(i),i),this._avPeerConnection=new WebRTCPeerConnection(this._avConnectionId,this._id,WebRTCPeerConnectionConstants.connectionTypes.AUDIO_VIDEO,PrimeTimeHandler.peerConnectionEvents,this._avMediaContainer,e,this._turnUserName,this._turnCredential,i,!1,t,s)},disconnectAVConnection:function(){PrimeTimeUI.removeMediaContainer($(this._avMediaContainer).parents("[videocontainer]").attr("id")),this._avMediaContainer=void 0,this._avConnectionId=void 0,this._audioStatus={muted:!1,time:-1},this._videoStatus={muted:!1,time:-1},this._avPeerConnection&&(this._avPeerConnection.close(),this._avPeerConnection=void 0)},connectScreenDownStream:function(e,i,t,s,r){this._screenShareId=e,this._screenPeerConnection&&this._screenPeerConnection.close(),this._screenMediaContainer=PrimeTimeUI.addAndGetMediaContainer(this._id,this._name,this._generateConnectionId(t),t),this._screenPeerConnection=new WebRTCPeerConnection(this._screenShareId,this._id,WebRTCPeerConnectionConstants.connectionTypes.SCREEN,PrimeTimeHandler.peerConnectionEvents,this._screenMediaContainer,i,this._turnUserName,this._turnCredential,t,!1,s,r)},disconnectScreenDownStream:function(){PrimeTimeUI.removeMediaContainer($(this._screenMediaContainer).parents("[videocontainer]").attr("id")),this._screenMediaContainer=void 0,this._screenShareId=void 0,this._screenPeerConnection&&(this._screenPeerConnection.close(),this._screenPeerConnection=void 0)},_enableLivePicture:function(){this.isHost()||this.isSpeaker()||this.isLivePictureEnabled()?$('[primetimebuttons][purpose="toggleLivePicture"]').prop("checked",!1).parents("[livePictureRequestContainer]").removeClass("PT-livephoto-enabled"):WebRTCUserMedia.requestVideoStream(function(e){$('[primetimebuttons][purpose="toggleLivePicture"]').prop("checked",!0).parents("[livePictureRequestContainer]").addClass("PT-livephoto-enabled"),this._isLivePictureEnabled=!0,this._videoStream=e,this._liveVideoMediaContainer=$("#primetimefooter").find('[usercontainer][userId="'+this.getId()+'"]').find("video")[0],this._liveVideoMediaContainer.setStream(e),this._liveVideoMediaContainer.muted=!0;var i=e._getVideoSize();this._livePictureCanvasElem=document.createElement("canvas"),this._livePictureCanvasElem.width=i.width,this._livePictureCanvasElem.height=i.height,this._liveVideoMediaContainer.playStream(function(){this.captureAndSendLivePicture()}.bind(this))}.bind(this),(function(){$('[primetimebuttons][purpose="toggleLivePicture"]').prop("checked",!1).parents("[livePictureRequestContainer]").removeClass("PT-livephoto-enabled")}))},_disableLivePicture:function(){$('[primetimebuttons][purpose="toggleLivePicture"]').prop("checked",!1).parents("[livePictureRequestContainer]").removeClass("PT-livephoto-enabled"),clearTimeout(this._livePictureCaptureTimeout),this.isLivePictureEnabled()&&PrimeTimeAPI.removeLivePicture(this._primeTimeId),this._livePictureCaptureTimeout=void 0,$(this._livePictureCanvasElem).remove(),this._livePictureCanvasElem=void 0,this._liveVideoMediaContainer=void 0,this._isLivePictureEnabled=!1,this._videoStream&&(WebRTCUserMedia.closeStream(this._videoStream._getType()),this._videoStream=void 0)},captureAndSendLivePicture:function(){this._livePictureCanvasElem.getContext("2d").drawImage(this._liveVideoMediaContainer,0,0,this._livePictureCanvasElem.width,this._livePictureCanvasElem.height);var e=this._livePictureCanvasElem.toDataURL("image/jpeg",.5);clearTimeout(this._livePictureCaptureTimeout),this._livePictureCaptureTimeout=setTimeout(function(){PrimeTimeAPI.updateLivePicture(this._primeTimeId,e),this.isLivePictureEnabled()&&this.captureAndSendLivePicture()}.bind(this),1e4)},setAVConnectionRemoteDescription:function(e,i,t){this._avPeerConnection.setRemoteDescription(e,i,t)},setScreenConnectionRemoteDescription:function(e,i,t){this._screenPeerConnection.setRemoteDescription(e,i,t)},setAVConnectionRemoteIceCandidates:function(){this._avPeerConnection.addRemoteIceCandidates()},updateAVConnectionLocalIceCandidates:function(){this._avPeerConnection.updateLocalIceCandidates()},setScreenConnectionRemoteIceCandidates:function(){this._screenPeerConnection.addRemoteIceCandidates()},updateScreenConnectionLocalIceCandidates:function(){this._screenPeerConnection.updateLocalIceCandidates()},updateAVStreamStatus:function(e){e.audio&&(this._audioStatus.time=e.audio.time,this._audioStatus.muted=e.audio.muted),e.video&&(this._videoStatus.time=e.video.time,this._videoStatus.muted=e.video.muted)},setUpdatedAVStatus:function(){this.handleAVStreamStatus("audio",this._audioStatus.muted,this._audioStatus.time),this.handleAVStreamStatus("video",this._videoStatus.muted,this._videoStatus.time)},handleAVStreamStatus:function(e,i,t){if(this._avMediaContainer){var s=this.getAVStream(),r=$(this._avMediaContainer).parent();if("video"===e){if(this._videoStatus.time>t)return;return MediaUtil.updateAVStatusInContainer(r,e,i,s),this._videoStatus.time=t,this._videoStatus.muted=i,i?s._disableVideoTrack():s._enableVideoTrack()}if(!(this._audioStatus.time>t))return MediaUtil.updateAVStatusInContainer(r,e,i,s),this._audioStatus.time=t,this._audioStatus.muted=i,i?s._disableAudioTrack():s._enableAudioTrack()}},updateInitialMuteStatus:function(){if(!this._hasUpdatedInitialMuteStatus){var e=!1,i={};this._audioStatus.muted&&(i.audio={muted:!0},i.time=this._audioStatus.time,e=!0),this._videoStatus.muted&&(i.video={muted:!0},i.time=this._videoStatus.time,e=!0),e&&PrimeTimeAPI.updateConnectionStatus(this._primeTimeId,i),this._hasUpdatedInitialMuteStatus=!0}},setAVReconnectionStatus:function(e){this._isReconnectingAVStream=e,this._avReconnectionAttempts=e?0:this._avReconnectionAttempts+1;var i=$(this._avMediaContainer).siblings("[bufferloadercnt]");i.empty(),e||$Util.animateBufferLoader(i,9)},setScreenReconnectionStatus:function(e){this._isReconnectingScreenStream=e,this._screenReconnectionAttempts=e?0:this._screenReconnectionAttempts+1;var i=$(this._screenMediaContainer).siblings("[bufferloadercnt]");i.empty(),e||$Util.animateBufferLoader(i,9)},initiateAudioFrequencyAnalyser:function(){var e=$(this.getAVMediaContainer()).parents("[videocontainer]").find("[audiowaves]"),i=this.getAVStream();i._stopAudioFrequencyAnalyser(),i._startAudioFrequencyAnalyser(function(i){return MediaUtil.adjustAudioPulsesCnt(e,i),!0}.bind(this))},closeConnections:function(){this._avPeerConnection&&this._avPeerConnection.close(),this._screenPeerConnection&&this._screenPeerConnection.close(),this.getId()===$zcg._ZUID&&this.isLivePictureEnabled()&&this._disableLivePicture()}};var PrimeTimeHandler={};PrimeTimeHandler={peerConnectionEvents:{sendOffer:function(e,i,t,s,r,n){PrimeTimeAPI.sendSDP(e,t,s,r,"offer",void 0,WebRTCUserMedia.getStreamTypeInString(n))},sendAnswer:function(e,i,t,s,r,n){PrimeTimeAPI.sendSDP(e,t,s,r,"answer",n)},updateIceCandidates:function(e,i,t,s,r){PrimeTimeAPI.updateIceCandidates(e,t,s,r)},handleConnected:function(e,i,t,s,r,n,a){var o=PrimeTimeImpl.getCurrentSession(),m=WebRTCPeerConnectionConstants.isRestart(a)||WebRTCPeerConnectionConstants.isReInit(a),d=WebRTCPeerConnectionConstants.isScreenConnection(i),c=void 0;if(!d&&n&&o&&o.isHost($zcg._ZUID)&&(o.isAssemblyMode()&&$Util.Browser.isChrome()&&(c=function(e,i){var t=(PrimeTimeUI.isInMinimizedView()?$("#ptminimizedwindow"):$("#primetimewindow")).find("[network_strength_indicator]");t.removeClass("dN");var s=1e3*i.rtt,r="terrible";switch(!0){case s<100:r="excellent";break;case s<200:r="good";break;case s<300:r="average";break;case s<350:r="poor"}t.attr("strength",r)}),o.hasNotifiedStart()||(o.setAsNotified(),PrimeTimeAPI.notifyStart(o.getId(),void 0,(function(){o.resetNotified()})))),n){var l=o.getMember(s);d?l.setScreenReconnectionStatus(!0):(l.setAVReconnectionStatus(!0),m||l.initiateAudioFrequencyAnalyser())}WebRTCPeerConnectionStats.initiateGathering(e,"primetimes",t,void 0,{networkInfoCallBack:MediaAPI.pushConnectionNetworkDetails,updateStatsCallBack:MediaAPI.pushConnectionStats,statsCallBack:c})},handlePlay:function(e,i,t,s,r){$(r).parent().find("[bufferloadercnt]").empty();var n=PrimeTimeImpl.getCurrentSession().getMember(i);WebRTCPeerConnectionConstants.isScreenConnection(e)?n.setScreenReconnectionStatus(!0):(n.setAVReconnectionStatus(!0),n.setUpdatedAVStatus(),n.initiateAudioFrequencyAnalyser())},handlePlayError:function(e){PrimeTimeUI.showInfoModal()},getUpStreamReconnectProcessType:function(){return PrimeTimeImpl.getCurrentSession().isAssemblyMode()?WebRTCPeerConnectionConstants.processTypes.REINIT:WebRTCPeerConnectionConstants.processTypes.RESTART},reconnectStream:function(e,i,t,s,r){r||PrimeTimeAPI.join(e,t);var n=PrimeTimeImpl.getCurrentSession().getMember(t);WebRTCPeerConnectionConstants.isScreenConnection(i)?n.setScreenReconnectionStatus(!1):n.setAVReconnectionStatus(!1)}},wmsEvents:{handlePrimeTimeStart:function(e){e.sessionId===WmsImpl.getSid()&&PrimeTimeImpl.startSession(e)},handleNewSpeakerRequest:function(e){var i=PrimeTimeImpl.getCurrentSession();if(i&&i.getId()===e.primeTimeId){var t=i.getMember(e.requesterId);if(t){if(t.setSpeakerRequest(e.requesterSessionId),PrimeTimeUI.modifyList(t),i.isHost($zcg._ZUID)){var s=$("#primetimefooter");s.find(".PT-show-req-con").removeClass("PT-show-req-con");var r=s.find('[userid="'+t.getId()+'"][usercontainer]').addClass("PT-show-req-con");clearTimeout(PrimeTimeUI.showRequestContainerTimeout),PrimeTimeUI.showRequestContainerTimeout=setTimeout((function(){r.removeClass("PT-show-req-con")}),2e3)}PrimeTimeUI.showNotification(PrimeTimeImpl.notificationTypes.requestedToSpeak,t)}}},handleCancelledSpeakerRequest:function(e){var i=PrimeTimeImpl.getCurrentSession();if(i&&i.getId()===e.primeTimeId){var t=i.getMember(e.cancelledUserId);t&&(t.resetSpeakerRequest(),PrimeTimeUI.modifyList(t))}},handleDeniedSpeakerRequest:function(e){var i=PrimeTimeImpl.getCurrentSession();if(i&&i.getId()===e.primeTimeId){var t=i.getMember(e.deniedUserId);t&&(t.resetSpeakerRequest(),PrimeTimeUI.modifyList(t),e.deniedUserId===$zcg._ZUID&&($('[primetimebuttons][purpose="dropSpeakerRequest"]').addClass("dN"),$('[primetimebuttons][purpose="raiseSpeakerRequest"]').removeClass("dN"),PrimeTimeUI.showRequestCancelledNotification()))}},handleSpeakerParticipation:function(e){if(e.sessionId===WmsImpl.getSid()){var i=PrimeTimeImpl.getCurrentSession();if(i&&i.getId()===e.primeTimeId){var t=i.getSpeakerConnectionId();void 0!==t&&t!==e.speakerConnectionId&&i.disconnectSpeakerConnection(),PrimeTimeImpl.startSpeakerSession(e)}}},handleSpeakerSessionEnd:function(e){var i=PrimeTimeImpl.getCurrentSession();i&&i.getId()===e.primeTimeId&&i.getSpeakerConnectionId()===e.speakerConnectionId&&i.disconnectSpeakerConnection()},handleScreenSharingStart:function(e){if(e.sessionId===WmsImpl.getSid()){var i=PrimeTimeImpl.getCurrentSession();i&&i.getId()===e.primeTimeId&&PrimeTimeImpl.setAndStartScreenShareSession(e)}},handleScreenShareEnd:function(e){var i=PrimeTimeImpl.getCurrentSession();i&&i.getScreenShareId()===e.screenShareId&&i.disconnectScreenDownStream(e)},handleOfferSDP:function(e){if(e.sessionId===WmsImpl.getSid()){var i=PrimeTimeImpl.getCurrentSession();if(i){if(i.getId()!=e.primeTimeId)return}else{i=new PrimeTimeSession(e),PrimeTimeImpl.setCurrentSession(i),PrimeTimeImpl.startMainViewTimers();var t=e.participants;if(t){var s=[];for(var r in t){var n=t[r];s.push(r),i.addMember(n.id,Users.getName(n.id,n.name),n.joinedTime,n.hasRequestedToSpeak,n.sessionId)}PrimeTimeImpl.getAndSetPeopleInfo(s)}}if(e.screenShareId)i.connectScreenDownStream(e);else if(e.speakerConnectionId)i.connectSpeakerDownStream(e);else{if(i.connectDownStream(e),e.speakerDetails){var a=i.getSpeakerConnectionId();void 0!==a&&a!==e.speakerDetails.speakerConnectionId&&i.disconnectSpeakerConnection(),e.speakerDetails.speakerUserId!==$zcg._ZUID&&PrimeTimeAPI.join(e.speakerDetails.speakerConnectionId,e.speakerDetails.speakerUserId)}e.screenShareDetails&&PrimeTimeAPI.join(e.screenShareDetails.screenShareId,e.screenShareDetails.screenShareHostId)}}},handleAnswerSDP:function(e){var i=PrimeTimeImpl.getCurrentSession();if(i&&i.getId()==e.primeTimeId){var t=i.getCurrentMember();e.screenShareId?(t.updateScreenConnectionLocalIceCandidates(),t.setScreenConnectionRemoteDescription("answer",e.answerSdp,e.remoteIceCandidates)):(t.updateAVConnectionLocalIceCandidates(),t.setAVConnectionRemoteDescription("answer",e.answerSdp,e.remoteIceCandidates))}},handleAnswerCallback:function(e){var i=PrimeTimeImpl.getCurrentSession();if(i&&i.getId()===e.primeTimeId){var t=i.getMember(e.connectionHostId);e.screenShareId?(t.setScreenConnectionRemoteIceCandidates(),t.updateScreenConnectionLocalIceCandidates()):(t.setAVConnectionRemoteIceCandidates(),t.updateAVConnectionLocalIceCandidates())}},handleStreamCreatedCallback:function(e){var i=PrimeTimeImpl.getCurrentSession();i&&i.getId()===e.primeTimeId&&i.getCurrentMember().updateInitialMuteStatus()},handleNewScreenShare:function(e){var i=PrimeTimeImpl.getCurrentSession();i&&i.getId()===e.primeTimeId&&e.screenShareHostId!==i.getScreenShareUserId()&&PrimeTimeAPI.join(e.screenShareId,e.screenShareHostId)},handleNewSpeakerParticipation:function(e){var i=PrimeTimeImpl.getCurrentSession();if(i&&i.getId()===e.primeTimeId){var t=i.getSpeakerConnectionId();void 0!==t&&t!==e.speakerConnectionId&&i.disconnectSpeakerConnection(),e.speakerUserId!==i.getSpeakerUserId()&&PrimeTimeAPI.join(e.speakerConnectionId,e.speakerUserId)}},handleUserIn:function(e){var i=PrimeTimeImpl.getCurrentSession();i&&i.getId()==e.primeTimeId&&(i.addMember(e.joinedUserId,e.joinedUserName,e.joinedTime,!1,void 0),PrimeTimeImpl.getAndSetPeopleInfo([e.joinedUserId]),PrimeTimeUI.showNotification(PrimeTimeImpl.notificationTypes.joined,i.getMember(e.joinedUserId)))},handleUserOut:function(e){var i=PrimeTimeImpl.getCurrentSession();i&&i.getId()==e.primeTimeId&&(i.isSpeaker(e.leftUserId)&&i.disconnectSpeakerConnection(),i.removeMember(e.leftUserId),PrimeTimeUI.removeUserFromList(e.leftUserId))},handleAVStatus:function(e){var i=PrimeTimeImpl.getCurrentSession();if(i&&i.getId()==e.primeTimeId&&($WC.Util.isEmpty(e.speakerConnectionId)||i.getSpeakerConnectionId()==e.speakerConnectionId)){var t=i.getMember(e.userId);e.audio&&t.handleAVStreamStatus("audio",e.audio.muted,e.audio.time),e.video&&t.handleAVStreamStatus("video",e.video.muted,e.video.time)}},updateLivePicture:function(e){var i=PrimeTimeImpl.getCurrentSession();i&&i.getId()==e.primeTimeId&&$("#primetimefooter").find('[usercontainer][userId="'+e.userId+'"]').find("[userimage]").attr("src",e.imageData)},removeLivePicture:function(e){var i=PrimeTimeImpl.getCurrentSession();i&&i.getId()==e.primeTimeId&&$("#primetimefooter").find('[usercontainer][userId="'+e.userId+'"]').find("[userimage]").attr("src",Users.getImgUrlById(e.userId))},handleLastChunk:function(e){var i=PrimeTimeImpl.getCurrentSession();if(i&&i.getId()==e.primeTimeId){var t=i.getHost();e.lastAudioChunk||e.lastVideoChunk?e.lastAudioChunk?t.setLastAudioChunkId(e.lastAudioChunk):t.setLastVideoChunkId(e.lastVideoChunk):PrimeTimeImpl.handleEnd(!0,ZCMediaConstants.endCases.sessionEnd)}},handleRefreshMpd:function(e){var i=PrimeTimeImpl.getCurrentSession();if(i&&i.getId()==e.primeTimeId&&(!i.isHost($zcg._ZUID)||i.isConferenceStreaming())&&(i.getHost()&&PrimeTimeImpl.shakaPlayer.isSupported()&&i.isShakaPlayer()&&PrimeTimeImpl.shakaPlayer.hasRequestSessionId())){let e=i.getStreamingId();PrimeTimeImpl.shakaPlayer.initialize(PrimeTimeImpl.shakaPlayer.getPlayerRefreshManifestUrl(e))}},handlePrimeTimeEnd:function(e){var i=PrimeTimeImpl.getCurrentSession();i&&i.getId()==e.primeTimeId&&PrimeTimeImpl.handleEnd(!1,ZCMediaConstants.endCases.sessionEnd)},handleParticipantLimitExceeded:function(e){WmsImpl.getSid()===e.sessionId&&(PrimeTimeImpl.handleEnd(!1,ZCMediaConstants.endCases.fullRoom),UI.updateBanner(Resource.getRealValue("media.room.full"),2e3,!0))},handleInvalidParticipant:function(e){WmsImpl.getSid()===e.sessionId&&PrimeTimeImpl.handleEnd(!1)}},UIEvents:{start:function(){if(PrimeTimeImpl.validateStartInputs()){var e,i=$("#start_primetime_win"),t=i.find("#pttopic").val(),s=PrimeTimeUI.getSelectedMode(i),r=i.find("#ptstartscopes").find("input:checked").val();$WC.Util.isEmpty(r)&&(r=ZCMediaConstants.scopeTypes.CHAT);var n={scope:r,mic_muted:!PrimeTimeImpl.currentUpStream._isAudioTrackEnabled()};if(MediaManager.isChatScope(r)){e=[PrimeTimeImpl.chatSuggestion.getSelectedValue()];var a=new $CliqChatId(e[0]);n.chatType=a.isChannel()?"channel":"chat"}else MediaManager.isTeamScope(r)&&(e=PrimeTimeImpl.teamSuggestion.getSelectedListValues());var o=void 0;PrimeTime.isRecordingEnabled()&&i.find("[ptrecordingcheckbox]").is(":checked")&&(o=(new Date).getTime()),PrimeTimeAPI.start(t,s,r,e,WebRTCUserMedia.getStreamTypeInString(PrimeTimeImpl.currentUpStream._getType()),void 0,(function(e){PrimeTimeImpl.handleEnd(!1),e.message&&UI.updateBanner(e.message,2e3,!0)}),o),i.attr("started",!0),$WC.$Win.destroy("start_primetime_win"),PrimeTimeUI.openRoom(t,$zcg._ZUID,Users.getName($zcg._ZUID),s,r,e,void 0,o,!0);var m=PrimeTime.isHandShakeMode(s);PrimeTimeImpl.currentUpStream._hasVideoTrack()&&(n.camera_muted=!PrimeTimeImpl.currentUpStream._isVideoTrackEnabled(),m||PrimeTimeImpl.currentUpStream._getPrimaryVideoTrack().applyConstraints({width:{min:640,max:640},height:{min:360,max:360}}).catch());var d=m?"PRIMETIME_HANDSHAKE_STARTED":"PRIMETIME_ASSEMBLY_STARTED";ZCTrack.track(d,n)}},showStartUIInitialPage:function(){$("#start_primetime_win").addClass("PT-initial-page").removeClass("PT-preview-page"),PrimeTimeImpl.currentUpStream&&(WebRTCUserMedia.closeStream(PrimeTimeImpl.currentUpStream._getType()),PrimeTimeImpl.currentUpStream=void 0)},showStartUIPreviewPage:function(){if(PrimeTimeImpl.validateStartInputs()){var e=$("#start_primetime_win"),i=e.find('[primetimebuttons][purpose="showStartUIPreviewPage"]'),t=PrimeTimeUI.getSelectedMode(e);if(PrimeTime.isAssemblyMode(t)&&!PrimeTimeImpl.currentUpStream){if(MediaManager.isStreamRequested())return;$Util.Button.addLoadIconForAjax(i),MediaManager.setAsStreamRequested(WebRTCUserMedia.streamTypes.AUDIO_VIDEO,ZCMediaConstants.mediaModules.PRIMETIME),WebRTCUserMedia.requestAudioVideoOrAudioStream((function(t){var s=function(){MediaManager.resetStreamRequested(),PrimeTimeImpl.currentUpStream=t;var s=e.find("#device_picker_cnt"),r=t._hasVideoTrack(),n=MediaUtil.getDeviceDropDownHtml(ZCMediaDevices.kinds.AUDIO_INPUT,t,void 0)+(r?MediaUtil.getDeviceDropDownHtml(ZCMediaDevices.kinds.VIDEO_INPUT,t,void 0):"");n=$WC.template.replace(n,{open_callback:'primetimebuttons purpose="openDevicesDropDown"',select_callback:'primetimebuttons purpose="setDevice"'},"InSecureHTML"),s.html(n);var a=e.find("[primetimebuttons][videostatus]");r?(a.addClass("zcf-video").removeClass("zcf-video-mute"),a.attr({purpose:"muteVideoInStartWin",title:Resource.getRealValue("videochat.cameraoff")})):(a.addClass("zcf-video-mute").removeClass("zcf-video"),a.attr({purpose:"enableVideoInStartWin",title:Resource.getRealValue("videochat.cameraon")}));var o=e.find("#ptvideopreviewcnt");MediaUtil.setStreamInContainer($zcg._ZUID,o,t),MediaUtil.fitVideoContainer(e.find("#ptvideopreviewwrapper"),o);var m=o.find("[audiowaves]");t._startAudioFrequencyAnalyser((function(e){return MediaUtil.adjustAudioPulsesCnt(m,e),!0})),$Util.Button.showCompletionAndResetContent(i,!0),e.find("#pttopicpreview").text(e.find("#pttopic").val()),e.removeClass("PT-initial-page").addClass("PT-preview-page")};WebRTCUserMedia.getMediaDevices(s,s)}),(function(e,t){MediaManager.handleMediaError(e,t),MediaManager.resetStreamRequested(),$Util.Button.showCompletionAndResetContent(i,!0)}))}}},closeStartUI:function(){$WC.$Win.destroy("start_primetime_win")},startScreenShare:function(e,i){if(!$Util.Browser.isChrome()||WebRTCUserMedia.isScreenShareSupportedInNative()||ScreenShare.Extension.isInstalled()){MediaManager.setAsStreamRequested(WebRTCUserMedia.streamTypes.SCREEN,ZCMediaConstants.mediaModules.PRIMETIME),WebRTCUserMedia.requestScreenStream((function(e){MediaManager.resetStreamRequested(),$('[primetimebuttons][purpose="startScreenShare"]').attr({purpose:"stopScreenShare",title:Resource.getRealValue("avcliq.media.screenshare.stop")}).removeClass("zcf-sharescrn").addClass("zcf-scrn-shr-stop"),PrimeTimeImpl.currentScreenUpStream=e,PrimeTimeAPI.startScreenShare(PrimeTimeImpl.getCurrentSession().getId())}),(function(e,i){MediaManager.resetStreamRequested(),void 0!==e&&MediaManager.handleMediaError(e,i)}),(function(){PrimeTimeHandler.UIEvents.stopScreenShare()}))}else MediaManager.showExtensionInstallPreview("primetimebuttons")},stopScreenShare:function(e,i){$('[primetimebuttons][purpose="stopScreenShare"]').attr({purpose:"startScreenShare",title:Resource.getRealValue("avcliq.media.screenshare.start")}).removeClass("zcf-scrn-shr-stop").addClass("zcf-sharescrn"),PrimeTimeAPI.stopScreenShare(PrimeTimeImpl.getCurrentSession().getId()),WebRTCUserMedia.closeStream(PrimeTimeImpl.currentScreenUpStream._getType()),PrimeTimeImpl.currentScreenUpStream=void 0},goToStore:function(){$WC.$Win.destroy("extension_install_preview"),ScreenShare.Extension.openStore()},openChatInRHS:function(){PrimeTimeImpl.attachChat();var e=$("#primetimewindow"),i=e.find("#primetimerhscnt");Conference.hideAssociatedResourceIFrame(PrimeTimeImpl.getCurrentSession().getId()),i.hasClass("huddl-chat-view")?$("#primetimeusersection, #primetimechatsection").removeClass("rhs-dN"):(i.addClass("huddl-chat-view").removeClass("huddl-participant-view huddl-associatedresource-view"),$("#primetimeusersection, #primetimechatsection").removeClass("rhs-dN"),PrimeTimeUI.setChatWindowFocus()),e.hasClass("show-aside")||(PrimeTimeUI.handleResize(-PrimeTimeUI.getRhsWidth()),e.addClass("show-aside"),e.find("[openchatrhsbutton]").attr({purpose:"closeRHS","tooltip-title":Resource.getRealValue("common.hide")}).addClass("active"),ZCTrack.track("PRIMETIME_CHAT_OPENED"),PrimeTimeUI.setChatWindowFocus())},openAssociatedResource:function(){var e=$("#primetimewindow").find("#primetimerhscnt");e.hasClass("huddl-associatedresource-view")||e.addClass("huddl-associatedresource-view").removeClass("huddl-chat-view huddl-participant-view");var i=PrimeTimeImpl.getCurrentSession(),t=i.getAssociatedResourceData(),s=$("#conference-associatedresource-iframe");s.length<1?"townhall"===t.type&&$("body").prepend(ZCSmartConferenceTemplates.getAssociatedResourceIframeHtml(i)):s.show()},showAssociatedResourceTabOptions:function(e,i){ZCSmartConferenceUI.showAssociatedResourceTabOptions(e,i)},reloadAssociatedResource:function(){var e=$("#conference-associatedresource-iframe");if($("#associatedResourceTabOptions").hide(),e.length<1)this.openAssociatedResource();else{var i=PrimeTimeImpl.getCurrentSession().getAssociatedResourceData(),t=i.url.includes("?")?"&":"?";e.find("iframe")[0].src=i.url+t+"frameorigin="+$Util.getFrameOrigin()}},openParticipantsInRHS:function(){var e=$("#primetimewindow"),i=e.find("#primetimerhscnt");Conference.hideAssociatedResourceIFrame(PrimeTimeImpl.getCurrentSession().getId()),i.hasClass("huddl-participant-view")?$("#primetimeusersection, #primetimechatsection").removeClass("rhs-dN"):i.addClass("huddl-participant-view").removeClass("huddl-chat-view huddl-associatedresource-view"),e.hasClass("show-aside")||(PrimeTimeUI.handleResize(-PrimeTimeUI.getRhsWidth()),e.addClass("show-aside"),e.find("[openchatrhsbutton], [openuserrhsbutton]").attr({purpose:"closeRHS",title:Resource.getRealValue("common.hide")}).addClass("PT-active"))},closeRHS:function(){$("#primetimeusersection, #primetimechatsection").addClass("rhs-dN");var e=$("#primetimewindow");e.removeClass("show-aside"),e.find("[openuserrhsbutton]").attr({purpose:"openParticipantsInRHS",title:Resource.getRealValue("common.participants")}).removeClass("PT-active"),e.find("[openchatrhsbutton]").attr({purpose:"openChatInRHS","tooltip-title":Resource.getRealValue("common.chat")}).removeClass("active"),Conference.hideAssociatedResourceIFrame(PrimeTimeImpl.getCurrentSession().getId())},toggleLivePicture:function(e,i){i.is(":checked")?PrimeTimeImpl.getCurrentSession().enableLivePicture():PrimeTimeImpl.getCurrentSession().disableLivePicture()},muteAudioInStartWin:function(e,i){$('[primetimebuttons][purpose="muteAudioInStartWin"]').addClass("zcf-mic-mute").removeClass("zcf-mic").attr({purpose:"unMuteAudioInStartWin",title:Resource.getRealValue("common.micon")}),MediaUtil.updateAVStatusInContainer($("#start_primetime_win").find("#ptvideopreviewcnt"),"audio",!0,PrimeTimeImpl.currentUpStream),PrimeTimeImpl.currentUpStream._disableAudioTrack()},unMuteAudioInStartWin:function(e,i){$('[primetimebuttons][purpose="unMuteAudioInStartWin"]').addClass("zcf-mic").removeClass("zcf-mic-mute").attr({purpose:"muteAudioInStartWin",title:Resource.getRealValue("common.micoff")}),MediaUtil.updateAVStatusInContainer($("#start_primetime_win").find("#ptvideopreviewcnt"),"audio",!1,PrimeTimeImpl.currentUpStream),PrimeTimeImpl.currentUpStream._enableAudioTrack()},muteVideoInStartWin:function(e,i){$('[primetimebuttons][purpose="muteVideoInStartWin"]').addClass("zcf-video-mute").removeClass("zcf-video").attr({purpose:"unMuteVideoInStartWin",title:Resource.getRealValue("videochat.cameraon")}),MediaUtil.updateAVStatusInContainer($("#start_primetime_win").find("#ptvideopreviewcnt"),"video",!0,PrimeTimeImpl.currentUpStream),PrimeTimeImpl.currentUpStream._disableVideoTrack()},unMuteVideoInStartWin:function(e,i){$('[primetimebuttons][purpose="unMuteVideoInStartWin"]').addClass("zcf-video").removeClass("zcf-video-mute").attr({purpose:"muteVideoInStartWin",title:Resource.getRealValue("videochat.cameraoff")}),MediaUtil.updateAVStatusInContainer($("#start_primetime_win").find("#ptvideopreviewcnt"),"video",!1,PrimeTimeImpl.currentUpStream),PrimeTimeImpl.currentUpStream._enableVideoTrack()},enableVideoInStartWin:function(e,i){WebRTCUserMedia.closeStream(PrimeTimeImpl.currentUpStream._getType()),PrimeTimeImpl.currentUpStream=void 0;WebRTCUserMedia.requestAudioVideoStream((function(e){PrimeTimeImpl.currentUpStream=e,i.addClass("zcf-video").removeClass("zcf-video-mute").attr({purpose:"muteVideoInStartWin",title:Resource.getRealValue("videochat.cameraoff")})}),(function(){WebRTCUserMedia.requestAudioStream((function(e){PrimeTimeImpl.currentUpStream=e}),(function(){$WC.$Win.destroy("start_primetime_win")}))}))},minimizeWindow:function(){PrimeTimeUI.showMinimizedWindow()},maximizeWindow:function(){PrimeTimeUI.showMaximizedWindow(),$("#primetimerhscnt").hasClass("huddl-associatedresource-view")&&$("#primetimewindow").hasClass("show-aside")&&PrimeTimeHandler.UIEvents.openAssociatedResource()},muteAudio:function(e,i){PrimeTimeImpl.muteAudio(!0)},unmuteAudio:function(e,i){$('[primetimebuttons][purpose="unmuteAudio"]').addClass("zcf-mic").removeClass("zcf-mic-mute").attr({purpose:"muteAudio",title:Resource.getRealValue("common.micoff")}),PrimeTimeImpl.handleAVStatusChange("audio",!1,!0)},muteVideo:function(e,i){PrimeTimeImpl.muteVideo(!0)},unmuteVideo:function(e,i){$('[primetimebuttons][purpose="unmuteVideo"]').addClass("zcf-video").removeClass("zcf-video-mute").attr({purpose:"muteVideo",title:Resource.getRealValue("videochat.cameraoff")}),PrimeTimeImpl.handleAVStatusChange("video",!1,!0)},swapVideoContainers:function(e,i){var t=PrimeTimeImpl.getCurrentSession();t&&!t.isHost($zcg._ZUID)&&t.hasScreenShareSession()&&PrimeTimeUI.swapVideoContainers(i)},openInFullScreen:function(e,i){ZCMediaDomUtil.openFullScreen($(i.attr("targetElemSelector"))[0],(function(){PrimeTimeUI.handleOpenFullScreen(i)}),(function(e,t){t?PrimeTimeUI.handleOpenFullScreen(i):PrimeTimeUI.handleExitFullScreen(i)})),"undefined"!=typeof Conference&&Conference.hideAssociatedResourceIFrame(PrimeTimeImpl.getCurrentSession().getId())},exitFromFullScreen:function(e,i){ZCMediaDomUtil.exitFullScreen(),$("#primetimerhscnt").hasClass("huddl-associatedresource-view")&&$("#primetimewindow").hasClass("show-aside")&&PrimeTimeHandler.UIEvents.openAssociatedResource()},showBottomPane:function(e,i){i.attr({title:Resource.getRealValue("primetime.hide.participants"),purpose:"hideBottomPane"}),i.addClass("zcf-downArrow").removeClass("zcf-upArrow"),$("#primetimewindow").removeClass("PT-footer-hide"),PrimeTimeImpl.getCurrentSession().setBottomPaneAsVisible()},hideBottomPane:function(e,i){i.attr({title:Resource.getRealValue("primetime.show.participants"),purpose:"showBottomPane"}),i.addClass("zcf-upArrow").removeClass("zcf-downArrow"),$("#primetimewindow").addClass("PT-footer-hide"),PrimeTimeImpl.getCurrentSession().setBottomPaneAsHidden()},openDevicesDropDown:function(e,i){var t=i.parents("[dropdowncnt]");Clickoutside.bind({srcid:t.attr("id"),destid:t.find("[dropdown]").attr("id")})},setDevice:function(e,i){Clickoutside.handleClickOnChild(e);var t=i.parents("[dropdowncnt]"),s=t.attr("selecteddeviceid"),r=i.attr("deviceid");if(r!==s){t.find("[dropdowninput]").text(i.attr("devicelabel")),t.attr("selecteddeviceid",r);var n=t.attr("devicekind"),a=$("#start_primetime_win");a.find("#ptpreviewvideo")[0]._removeStream(),ZCMediaDevices.setPreferredDevice(ZCMediaDevices.get(n,r)),WebRTCUserMedia.closeStream(PrimeTimeImpl.currentUpStream._getType());var o=!PrimeTimeImpl.currentUpStream._isAudioTrackEnabled(),m=!PrimeTimeImpl.currentUpStream._isVideoTrackEnabled();PrimeTimeImpl.currentUpStream=null;WebRTCUserMedia.requestAudioVideoOrAudioStream((function(e){PrimeTimeImpl.currentUpStream=e;var i=a.find("#ptvideopreviewcnt");e._setTrackStatus("audio",o),e._hasVideoTrack()?e._setTrackStatus("video",m):a.find("[primetimebuttons][videostatus]").addClass("zcf-video-mute").removeClass("zcf-video").attr({purpose:"enableVideoInStartWin",title:Resource.getRealValue("videochat.cameraon")}),MediaUtil.setStreamInContainer($zcg._ZUID,i,e),MediaUtil.fitVideoContainer(a.find("#ptvideopreviewwrapper"),i);var t=i.find("[audiowaves]");e._startAudioFrequencyAnalyser((function(e){return MediaUtil.adjustAudioPulsesCnt(t,e),!0}))}),(function(){$WC.$Win.destroy("start_primetime_win")}))}},raiseSpeakerRequest:function(){if(PrimeTimeImpl.hasCurrentSession()){this.hideRequestCancelledNotification();WebRTCUserMedia.requestAudioVideoOrAudioStream((function(e){PrimeTimeImpl.currentUpStream=e;var i=PrimeTimeImpl.getCurrentSession();i.disableLivePicture(),PrimeTimeAPI.raiseSpeakerRequest(i.getId());var t=i.getCurrentMember();t.setSpeakerRequest(WmsImpl.getSid()),PrimeTimeUI.modifyList(t),$('[primetimebuttons][purpose="raiseSpeakerRequest"]').addClass("dN"),$('[primetimebuttons][purpose="dropSpeakerRequest"]').removeClass("dN")}))}},dropSpeakerRequest:function(){if(PrimeTimeImpl.hasCurrentSession()){WebRTCUserMedia.closeStream(PrimeTimeImpl.currentUpStream._getType()),PrimeTimeAPI.dropSpeakerRequest(PrimeTimeImpl.getCurrentSession().getId());var e=PrimeTimeImpl.getCurrentSession().getCurrentMember();e.resetSpeakerRequest(),PrimeTimeUI.modifyList(e)}$('[primetimebuttons][purpose="dropSpeakerRequest"]').addClass("dN"),$('[primetimebuttons][purpose="raiseSpeakerRequest"]').removeClass("dN")},hideRequestCancelledNotification:function(){var e=$("[ptReqCancellationInfo]");e.length&&e.remove()},stepDownFromSpeaker:function(){PrimeTimeImpl.hasCurrentSession()&&(PrimeTimeAPI.endSpeakerRole(PrimeTimeImpl.getCurrentSession().getId()),PrimeTimeImpl.getCurrentSession().disconnectSpeakerConnection(),WebRTCUserMedia.closeStream(PrimeTimeImpl.currentUpStream._getType()))},endSpeakerSession:function(){var e=PrimeTimeImpl.getCurrentSession();e&&e.isHost($zcg._ZUID)&&(PrimeTimeAPI.terminateSpeaker(e.getId(),e.getSpeakerUserId()),e.disconnectSpeakerConnection())},approveSpeakerRequest:function(e,i){var t=PrimeTimeImpl.getCurrentSession();if(t&&t.isHost($zcg._ZUID)){var s=t.getSpeakerUserId();s&&PrimeTimeAPI.terminateSpeaker(t.getId(),s);var r=i.parents("[userid]").attr("userid"),n=t.getMember(r);n.resetSpeakerRequest(),PrimeTimeUI.modifyList(n),PrimeTimeAPI.approveSpeakerRequest(t.getId(),r,n.getSessionId())}},denySpeakerRequest:function(e,i){if(PrimeTimeImpl.hasCurrentSession()){var t=PrimeTimeImpl.getCurrentSession(),s=i.parents("[userid]").attr("userid"),r=t.getMember(s);r.resetSpeakerRequest(),PrimeTimeUI.modifyList(r),PrimeTimeAPI.denySpeakerRequest(t.getId(),s)}},copyGuestLink:function(){var e=PrimeTimeImpl.getCurrentSession();e&&e.isHost($zcg._ZUID)&&(e.hasGuestLink()?PrimeTimeImpl.copyGuestLink():PrimeTimeUI.showGuestLinkGenerateDlg())},hideInfoModal:function(){PrimeTimeUI.hasUserInteracted=!0,$("#primetimewindow").find("#ptinfomodal").remove(),PrimeTimeUI.autoPlayVideos()},showDeviceSettings:function(){if(PrimeTimeImpl.hasCurrentSession()){var e=PrimeTimeImpl.getCurrentSession().getCurrentMember(),i=PrimeTimeImpl.currentUpStream;if(void 0!==i){var t={};t[ZCMediaDevices.kinds.AUDIO_OUTPUT]=!1,i._hasVideoTrack()||(t[ZCMediaDevices.kinds.VIDEO_INPUT]=!1),MediaDeviceWidget.show((function(t){if(!$WC.Util.isEmptyObject(t)&&(ZCMediaDevices.setPreferredDevices(t,!0),PrimeTimeImpl.hasCurrentSession()&&(t[ZCMediaDevices.kinds.AUDIO_INPUT]||t[ZCMediaDevices.kinds.VIDEO_INPUT]))){var s=WebRTCUserMedia.streamTypes.AUDIO_ONLY,r=!1;t[ZCMediaDevices.kinds.AUDIO_INPUT]&&t[ZCMediaDevices.kinds.VIDEO_INPUT]?(s=WebRTCUserMedia.streamTypes.AUDIO_VIDEO,r=!0):t[ZCMediaDevices.kinds.VIDEO_INPUT]&&(s=WebRTCUserMedia.streamTypes.VIDEO_ONLY,!1,r=!0);WebRTCUserMedia.requestAndReplaceTracksInStream(i,s,(function(i){PrimeTimeImpl.hasCurrentSession()?(r&&i._getPrimaryVideoTrack().applyConstraints({width:{min:640,max:640},height:{min:360,max:360}}).catch(),PrimeTimeImpl.currentUpStream=i,e.replaceTracksInStream(i,s),e.setUpdatedAVStatus()):WebRTCUserMedia.closeStream(i._getType())}))}}),t,i,void 0,void 0)}}},leave:function(){var e=PrimeTimeImpl.getCurrentSession(),i=$("#primetimecta"+e.getId()),t=WmsImpl.isGuestUser()?ZCMediaConstants.endCases.leave:void 0;PrimeTimeImpl.handleEnd(!0,t),i&&!WmsImpl.isLocalUser(e.getHostId())&&(i.removeAttr("disabled"),i.text(I18N("videobroadcast.join")))},joinFromCard:function(e,i){var t=i.attr("nrs_id"),s=$("#primetimecta"+t);$Util.Button.addLoadIconForAjax(s),PrimeTime.join(t,()=>{$Util.Button.showCompletionAndResetContent(s,!1),s.attr("disabled",""),s.text(I18N("videobroadcast.isviewing")),s.attr("style","")})},playRecording:function(e,i){ZCTrack.track("RECORDING_PLAYED",{TRIGGER:"CHAT_WINDOW"});var t=i.attr("nrs_id");CallHistoryData.fetchRecordings(ZCMediaConstants.callRecordingTypes.ASSEMBLY,t,e=>{var i=e[0],s={nrs_id:t,host:{id:i.owner.id}};MediaRecordingPlayer.open(s,i.index,ConferenceImpl.getRecordingName(i),void 0,!0)})}},UIOnChangeEvents:{switchModeInStartUI:function(e,i){var t=i.is(":checked")?"PT-handshake":"PT-assembly";$("#start_primetime_win").removeClass("PT-handshake PT-assembly").addClass(t)},switchScopeInStartUI:function(e,i){var t=i.val();$("#start_primetime_win").find("[scope_input]").each((function(){var e=$(this);e.toggleClass("dN",t!==e.attr("scope_input"))})),PrimeTimeImpl.validateStartInputs()}},UITransitionEvents:{animateRhs:function(){PrimeTimeUI.handleResize(),PrimeTimeUI.setChatWindowFocus()},switchRhsView:function(){$("#primetimeusersection, #primetimechatsection").removeClass("rhs-dN"),PrimeTimeUI.setChatWindowFocus()}}};