var $pex={events:[],process:function(e){var s=(new Date).getTime();e.evid=""+s;var t=new PexRequest(e);($pex.events[s]=t).beforesendcb();try{PexBridge.submitEvent(t.getObjectToSend())}catch(e){var r={eid:s,rs:"-1",err:{c:"109",m:"CLIENT_NO_CONNECTION"}};PexBridge.handleEvent(s,r)}}},PexBridge={};function PexError(e){this.code=e.c,this.message=e.m,this.remotestatuscode=e.rc,this.remoteresponse=e.rm}function PexResponse(e,s){this.readyState=e,"string"==typeof(this.response=s)&&(this.resposeText=s)}function PexRequest(e){this.evid=e.evid,this.operation=e.operation,this.header=e.header,this.data=e.data,this.complete=e.complete,this.success=e.success,this.error=e.error,this.progress=e.progress,this.beforeSend=e.beforeSend,this.completecb=function(e,s){this.complete&&this.complete(e,s)},this.progresscb=function(e){this.progress&&this.progress(e)},this.successcb=function(e){this.success&&this.success(e)},this.failurecb=function(e){this.error&&this.error(e)},this.beforesendcb=function(){this.beforeSend&&this.beforeSend(this)},this.addHeader=function(e,s){this.header||(this.header={}),this.header[e]=s},this.getObjectToSend=function(){return{i:""+this.evid,o:this.operation,h:this.header,d:this.data}}}PexBridge.handleEvent=function(e,s){var t=s.eid,r=s.rs,i=$pex.events[t];if(i)if(0<=r){var o=new PexResponse(r,s.res);i.progresscb(o),4==r&&(i.successcb(o),i.completecb(o,!0))}else{var n=new PexError(s.err);i.failurecb(n),i.completecb(n,!1)}};