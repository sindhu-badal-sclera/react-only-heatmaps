var HistoryModule=function(){let t={DIRECTCALLS:"Direct_calls",MEETINGS:"Meetings",BROADCASTS:"Broadcasts",LIVE_EVENTS:"Live_events",COVERSATION:"Conversation",SENT_HISTORY:"SentHistory"},e=t.DIRECTCALLS,s=[t.DIRECTCALLS,t.MEETINGS,t.BROADCASTS,t.LIVE_EVENTS,t.COVERSATION],i=[{id:"showDMCalls",purpose:"showDMCalls",icon:"zcf-call",name:"directcalls.title",type:t.DIRECTCALLS},{id:"showMeetingHistory",purpose:"showMeetingHistory",icon:"zcf-meetings",name:"groupcalls.title",type:t.MEETINGS},{id:"showBroadcastHistory",purpose:"showBroadcastHistory",icon:"zcf-primetime",name:"media.primetime",type:t.BROADCASTS},{id:"showLiveEventsHistory",purpose:"showLiveEventsHistory",icon:"",name:"liveevent.title",type:t.LIVE_EVENTS},{id:"showConvoHistory",purpose:"showConvoHistory",icon:"zcf-chat",name:"common.chats",type:t.COVERSATION}],a="",n="",l="",o="",r={dateFilterOptionEle:"#dateFilterOptns",dateFilterDisplayEle:"#dateFilterDisplay",datePickerDOMEle:"#date-picker-dom",calendarContainer:"#calender_container",calendarParentContainer:"#calenspc",calendar:"#calender",dateFilterTextEle:"#dateFilterTxt",toDate:"#todate",specificDateEle:'[data-name="specific_fil_cal"]',dateFilterNameEle:"#dateFilterName"},d="date-picker-dom",c="calender";if(Config.isSentMessageHistoryEnabled()){s.push(t.SENT_HISTORY);var p={id:"showSentMsgHistory",purpose:"showSentMsgHistory",icon:"zcf-senthistory",name:"history.sentmessages",type:t.SENT_HISTORY};i.push(p)}let h=(t,e)=>$WC.template.replace(e,{item_id:t.id,item_purpose:t.purpose,icon_cls:t.icon,$name:t.name,item_type:t.type,active_cls:t.type===HistoryModule.defaultActiveTab?"chatsel":""});return{defaultActiveTab:e,openHistoryRhs:()=>{Config.isClientMemoryOptimizationEnabled()&&(CallsHistoryUI.reinitConstants(),ConversationsHistoryUI.reinitConstants()),$("#showDMCalls_counter").text(CallHistoryStorage.getMissedCallsCount()>0?CallHistoryStorage.getMissedCallsCount():""),HistoryModule.defaultActiveTab===t.COVERSATION?ConversationsHistoryUI.construct():HistoryModule.defaultActiveTab==t.SENT_HISTORY?Config.isSentMessageHistoryEnabled()&&ConversationsHistoryUI.constructSentHistoryUI():CallsHistoryUI.construct(HistoryModule.defaultActiveTab),ZCPermalink.updateUrl(routingPaths.history[HistoryModule.defaultActiveTab])},getModuleObject:t=>i.filter((function(e){return e.type==t})),subModules:i,getSubModuleHtml:()=>{let e=`<div class="flex fdirC h100">\n\t\t\t\t<div class="flexG">\n\t\t\t\t\t<div class="lhs-sub-hdr"><span class="LHS-name">{{history_hdr}}</span></div>${(()=>{let e="";for(let s of i)(PrimeTime.isAssemblyModeAllowed()||s.type!==t.BROADCASTS)&&(Conference.isAudioConferenceAllowed()||Conference.isVideoConferenceAllowed()||s.type!==t.MEETINGS)&&(Conference.isRTCPLiveEventsEnabled()||s.type!==t.LIVE_EVENTS)&&(e+=h(s,'<div class="lhs-sub-item ellips LHS-item {{active_cls}}" id="{{item_id}}" purpose="{{item_purpose}}" type={{item_type}}>\n\t\t\t\t<div class="item-icn {{icon_cls}}"></div>\n\t\t\t\t<div class="item-name ellips flexG">{{name}}</div>\n\t\t\t\t<div class="LHS-icon-wrp flexC fshrink"><div id="{{item_id}}_counter" class="LHS-count "></div></div>\n\t\t\t</div>'));return e})()}\n\t\t\t\t</div>\n\t\t\t</div>`;return $WC.template.replace(e,{$history_hdr:"history.hdr"})},showChathistory:t=>{LhsModules.highlightModule(LHSConstants.ModuleIds.MYHISTORY),LhsNavigation.updateSubModuleCategory(),ConversationsHistoryUI.construct(t)},handlePermalink:function(e){switch(LhsModules.highlightModule(LHSConstants.ModuleIds.MYHISTORY),e.split("/")[2]){case"direct-calls":HistoryModule.defaultActiveTab=t.DIRECTCALLS;break;case"meetings":HistoryModule.defaultActiveTab=t.MEETINGS;break;case"broadcasts":HistoryModule.defaultActiveTab=t.BROADCASTS;break;case"live-events":HistoryModule.defaultActiveTab=t.LIVE_EVENTS;break;case"conversations":HistoryModule.defaultActiveTab=t.COVERSATION;break;case"sent-history":HistoryModule.defaultActiveTab=t.SENT_HISTORY}LhsNavigation.updateSubModuleCategory(),HistoryModule.openHistoryRhs()},clearCallCounter:()=>{LhsModules.activeTabId===LHSConstants.ModuleIds.MYHISTORY&&HistoryModule.defaultActiveTab===t.DIRECTCALLS&&(CallHistoryData.clearCallCounter(),$("#callhistory_listview").find("[unread]").removeAttr("unread"))},Constants:t,showDateInUI:function(t){l=o;var e=t.find(r.dateFilterDisplayEle),s=t.find(r.dateFilterTextEle),i=t.find(r.dateFilterNameEle);if(t.find(r.datePickerDOMEle).addClass("date_display").addClass("datefil-bdr"),t.find(".ml-date").addClass("bdRBLR0 bdRTLR0"),l){i.text(HistoryViewUtils.getAppliedFilterName(a));var n=$Date.getMonthString(l.getTime()).slice(0,3)+" "+l.getDate()+", "+l.getFullYear();s.text(n),e.addClass("ml-filterdate")}},resetDateFilter:function(){a="",n="",l=""},getDateFilter:function(){let t={};var e=new Date(l).getTime();return a.includes("after")?t.from=new Date(e).setHours(23,59,59,999):a.includes("before")?t.to=new Date(e-864e5).setHours(23,59,59,999):a.includes("on")&&(t.from=new Date(e).setHours(0,0,0,0),t.to=new Date(e).setHours(23,59,59,999)),t},removeDateFilter:function(t){t.find(r.dateFilterDisplayEle).removeClass("ml-filterdate"),t.find(".ml-date").removeClass("bdRBLR0 bdRTLR0"),t.find(r.dateFilterTextEle).text(""),t.find(r.dateFilterName).text(""),t.find(r.calendarParentContainer).find("#"+a).removeClass("active"),t.find(r.dateFilterOptionEle).find("."+a).addClass("dN"),t.click(),a="",n="",l=""},showCalendar:(t,e,s)=>{Clickoutside.handleClickOnChild(e),Clickoutside.clear(c);var i=$WC.template.replace(MediaListingTemplates.getHtml(MediaListConstants.CALENDER_SPECIFIC),{$date_txt:"common.date",$apply_txt:"sticky.calender.apply"}),d=s.find(r.calendarParentContainer);(n=e.target.id)&&(d.find("#"+e.target.id).addClass("active"),s.find(r.calendarContainer).html(i),Clickoutside.bind({srcid:e.target.id,destid:"calender2",event:e,customShow:function(){s.find(r.calendarParentContainer).removeClass("dN"),function(t,e){var s=l||Date.now(),i={setButtonNeeded:!1,time:!1,range:{to:Date.now()},preview:!1},a=new DateTimeWidget(t,i),n=new Date(s);n.setHours(0,0,0,0);var d=n.getDate()+" "+$Date.getMonthString(n.getTime(),!0)+" "+n.getFullYear()%100;e.find(r.toDate).text(d),a.initialize(n),o=n,a.handleModify=function(t){var s=this.getSelection();o=s;var i=s.getDate()+" "+$Date.getMonthString(s.getTime(),!0)+" "+s.getFullYear()%100;e.find(r.toDate).text(i)}}("elemCalender3",s),s.find(r.specificDateEle).addClass("active"),s.find(r.calendar).css("width","240px"),s.find(r.calendarParentContainer).attr("showcalendar","")},customHide:function(e,i){"applyCustomDateFilter"==i.target.getAttribute("data-action")&&(a&&s.find(r.dateFilterOptionEle).find("."+a).addClass("dN"),a=n);var l=s.find(r.calendarParentContainer);$(t).removeClass("active"),l.addClass("dN"),d.find("#"+n).removeClass("active"),n="",s.find(r.specificDateEle).removeClass("active")}}))},showCalendarOptions:function(t,e,s){var i=s.find(r.dateFilterOptionEle);i.removeClass("hide").addClass("active"),Clickoutside.clear("dateFilterOptns"),$(t).addClass("active"),a&&i.find("."+a).removeClass("dN");var n={srcid:d,event:e,destid:"dateFilterOptns",customHide:function(){i.addClass("hide"),$(t).removeClass("active")},closeOnClickSrc:!0};Clickoutside.bind(n)},currentDateFilter:a}}();let ChatHistoryData={getAll:t=>{let{limit:e=30,totime:s=(new Date).getTime(),title:i="",successcallback:a=$.noop,failurecallback:n=$.noop,type:l,muted:o,currentPageCount:r,searchVal:d,historyType:c,from:p,to:h,inChats:m}=t,u={type:l,limit:e,totime:s,title:i,muted:o};var v="/v1/history";if("sentHistory"==c){["limit","muted","title","type","totime"].forEach(t=>delete u[t]);var g={from:$zcg._ZUID,lim:20,raw_search_input:"from: @Me ",includeallowedchannels:!1};$.extend(u,g),r&&(u.pno=r),h&&(u.to=h),m&&(u.in=m),d&&(u.raw_search_input+=d,u.message=d),v="/v1/messagesearch"}p&&(u.fromtime=p),h&&(u.totime=h),$ZCAjx.ajax({url:v,data:u,success:function(t){a(t,u)},error:function(t){n(t,u)}})}},HistoryUIHandler=void 0,ConversationTemplates=function(){"use strict";let t={conversationItem:'<div id="trans{{chat_id}}" purpose="chathistoryrow" channel="{{is_channel}}" threadchattitle="{{thread_chat_title}}" deleted="{{is_deleted}}" removed="{{is_removed}}" chid="{{chat_id}}" lmtime="{{lm_time}}" {{unread_param}} class="chathistory-item {{custom_class}}" data-chidandtime="{{chatAndTimeAttr}}" {{lastEntryTime}}>\n\t        \t<div class="flexC w100 posrel">\n\t        \t\t<div class="convo-img fshrink flexM">\n\t        \t\t\t{{img_html}}\n\t    \t\t\t</div>\n\t    \t\t\t<div class="flexG fdirC mR20 ellips">\n\t    \t\t\t\t<div id="transtitle{{chat_id}}" class="font15 fontB clr-H line20"><span>{{chat_title}}</span>{{user_tag}}{{thread_badge}}</div>\n\t    \t\t\t\t<div class="clr-S font14 line20 mT6 ellips">{{last_msg_info}}</div>\n    \t\t\t\t</div>\n    \t\t\t\t<div class="clr-lp2 font13 fshrink">{{last_mtime}}</div>\n    \t\t\t\t\x3c!--<div class="more-actns dN mL10">\n    \t\t\t\t\t<em class="zcf-more font13"></em>\n\t\t\t\t\t</div>--\x3e\n\t\t\t\t</div>\n        \t</div>',sentMessages:'<div id="msgsender" uid="{{uid}}" class="flex-base zcunrdltmsg font14">\n\t\t\t\t\t\t<span class="fshrink zcunrdname mR5 fontB {{hideMsgClass}}">{{userName}}</span>\n\t\t\t\t\t\t<span class="infomsg {{hideFileClass}} pL0">{{fileMsg}}</span>\n\t\t\t\t\t\t<span class="flexG ellips lastMsg zcsenthistorymsg {{hideMsgClass}}">{{message}}</span>\n\t\t\t\t\t</div>',empty:'<div class="emptyresult" id="emptyresult">\n        \t\t\t<div class="zcglrscnt flexM">\n        \t\t\t\t<div class="zcnorsfd mB30">\n        \t\t\t\t\t<div class="zcempty-img search_empty"></div>\n        \t\t\t\t\t<div>{{nodata_desc}}</div>\n        \t\t\t\t\t<div class="srchin">{{SEARCH_INPUT}}</div>\n\t\t\t\t\t\t\t<div class="flexM">\n        \t\t\t\t\t\t<div class="gschtbtn" purpose="newsearch">{{trynew_search}}</div>\n\t\t\t\t\t\t\t</div>\n        \t\t\t  </div>\n        \t\t</div>',historyHeader:'<div class="w100 flexC justifySB">\n    \t\t\t<div class="flexG flexC">\n        \t\t\t<div class="flexC fshrink" style="line-height: 1;">\n        \t\t\t\t<div class="{{icon}} clr-icons mR10"></div>\n        \t\t\t\t<div class="font16 clr-H fontB" style="margin-bottom: 2px;">{{convo_hdr}}</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t{{search_container}}\n    \t\t\t</div>\n    \t\t\t<div class="fshrink">\n    \t\t\t\t{{start_btn}}\n    \t\t\t\t<div class="zcl-icon zcf-markallasread zcl-icon--default dN"></div>\n    \t\t\t</div>\n    \t\t</div>',historyFilterBand:'<div class="mLR30 flexG">\n\t\t\t\t<div class="zcl-win-modal1-srch fshrink">\n\t\t\t\t\t<div class="zcl-search2">\n\t\t\t\t\t    <span class="zcf-search2 zcl-seach-icon"></span>\n\t\t\t\t\t    <div class="zcl-search-input">\n\t\t\t\t\t        <input type="text" id="chat-history-search-field" placeholder="{{placeholder}}">\n\t\t\t\t\t    </div>\n\t\t\t\t    </div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t<div class="fshrink">\n\t\t\t\t<div class="zcl-icon zcf-markallasread zcl-icon--default"></div>\n\t\t\t</div>',mainContainer:`<div id="conversation_history_view" class="wh100 flex fdirC convo-history">\n        \t\t<div class="main-container-header ovrflwH fshrink">\n        \t\t\t{{container_header}}\n\t\t\t\t</div>\n\t\t\t\t{{conversation_header}}\n        \t\t<div id="historychats_listview" zc_sticky_title_list class="flexG ovrflwA pTB10">\n        \t\t\t{{container_content}}\n        \t\t</div>\n        \t\t<div id="transcriptcontainer" opener="chathistory" class="hst-rht zcmulticht zcmsgbothside" style="display:none;">\n\t\t\t\t\t<div class="zcempty-con">\n\t\t\t        \t<div class="zcempty-title font18">${Resource.getRealValue("history.chat.select")}</div>\n\t\t\t        </div>\n\t\t\t     </div>\n\t\t\t</div>`,conversationHeader:'<div class="convohistory-header fshrink flexC mL4">\n\t\t\t<div class="fshrink posrel mR12">\n\t\t\t\t<div class="flexIC cur font15  category-list-item-cont ellips" id="convohistoryoptcont" purpose="viewFilter"><em class="zcf-funnel clr-icon mR5"></em><span class="flexG font15 clr-H fontB ellips" id="filtertxt">{{all}}</span><em class="zcf-downArrow mL6 mT4 font10 clr-icon"></em>\n\t\t\t</div>\n\t\t\t<div id="convohistoryoptions" class="zcl-menu-wrap no-pointer convo-drop-down hide">\n\t\t\t\t<div class="zcl-menu-item posrel sel sel_status" purpose="applyFilter">{{all}}</div>\n\t\t\t\t<div class="zcl-menu-item posrel" purpose="applyFilter" type="channel">{{channels}}</div>\n\t\t\t\t<div class="zcl-menu-item posrel" purpose="applyFilter" type="dm">{{directmessages}}</div>\n\t\t\t\t<div class="zcl-menu-item posrel" purpose="applyFilter" type="chat">{{groupchats}}</div>\n\t\t\t\t<div class="zcl-menu-item posrel" purpose="applyFilter" type="threads">{{threadchats}}</div>\n\t\t\t\t<div class="zcl-menu-item posrel" purpose="applyFilter" type="bot">{{bots}}</div>\n\t\t\t\t<div class="zcl-menu-item posrel" purpose="applyFilter" type="muted">{{mutedchats}}</div>\n\t\t\t\t</div></div>\n\t\t\t\t<div class="flexG flexC {{justify}}">\n\t\t\t\t<div class="zcl-search2 zchistory-search" style="width: 50%;">\n\t\t\t\t\t<span class="zcf-search2 zcl-seach-icon"></span>\n\t\t\t\t\t<div class="zcl-search-input">\n\t\t\t\t\t\t<input type="text" id="chat-history-search-field" placeholder="{{placeholder}}">\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div class="flex-col mL50" id="mutedmsgcheckbox">\n\t\t\t\t\t<label class="flexIC curP mL3 conv-history-mutedchats-filter" id="checkbox">\n\t\t\t\t\t<div class="zcl-checkbox"><input id="hideAllMutedChats" type="checkbox" purpose="hideMutedChats" {{hide_muted_chats}}><span class="zcf-tick flexM"></span></div>\n            \t\t<div class="font14 lineN zcl-checkbox-label">{{hideallmutedchats}}</div>\n\t\t\t\t\t</label>\n\t\t\t\t</div>\n\t\t\t\t{{markAllReadBtn}}\n\t\t\t\t{{dateFilterHTML}}\n\t\t\t\t</div>\n\t\t\t</div>',sentMsgHistoryHeader:'\n\t\t<div class="convohistory-header zc-senthistoryheader flex flexC justifyE pTB10">\n\t\t\t{{searchInputHTML}}\n\t\t\t{{sharedByHTML}}\n\t\t\t{{dateFilterHTML}}\n\t\t\t\n\t\t</div>',dateFilterHTML:'<div class="posrel flex {{hide_filter_cls}} mLR10">\n\t\t<div id="date-picker-dom" purpose="showCalendarOptions" class="flexC">\n\t\t\t<div id="dateFilterDisplay" class="date-filter-display flexC justifySB zcl-icon">\n\t\t\t\t<span id="dateFilterName" class="sentdatefiltername mR5 text-transC"></span>\n\t\t\t\t<div id="dateFilterTxt" class="datefil_txt"></div>\n\t\t\t\t<div data-action="removeDateFilter" class="zcf-close clr-icon font10  h100 flexC p5 mT2"></div>\n\t\t\t</div>\n\t\t\t<div class="drpdwn-wrp zcl-icon zcl-icon--default posrel ml-date">\n\t\t\t\t<em class="zcf-calendar p10"></em>\n\t\t\t</div>\n\t\t\t</div>\n\t\t\t<div id="dateFilterOptns" class="zcl-menu-wrap zcsentmsghistory posa no-pointer hide" purpose="pickDate">\n\t\t\t\t{{dateFilterOptionsHTML}}\n\t\t\t</div>\n\t\t\t{{calendarHTML}}\n\t\t</div>',calendarOption:'<div id="today" class="zcl-menu-item justifySB" data-chid = "{{chid}}" data-uid = "{{uid}}" data-action="Datedropfilters"> <em id="todaysel" class="clrG msi-tick dN p5"></em></div>',dateFilterOptions:'<div id="{{id}}" class="zcl-menu-item justifySB">{{displayName}}<em class="{{class}} clrG msi-tick dN p5"></em></div>',calendarHTML:'\n\t\t<div id="calenspc" class="zcsenthistorycal zcl-popup daterange-popup mediarange-popup dN" purpose="calenderAreaClick">\n\t\t<div id="calender_container"></div>\n\t\t<div class="daterange-aside" purpose="pickDate">\n\t\t  \t{{dateFilterOptionsHTML}}\n\t\t</div>\n\t</div>',searchInputHTML:'<div id="ml_search" class="zcl-search ml-search">\n\t\t\t<div id="ml_search_icon" class="zcl-seach-icon zcf-search2 zcl-icon--default" purpose="showSearchInput"></div>\n\t\t\t<div class="zcl-search-input flexC">\n\t\t\t   <input id="ml_search_input" type="text" type="text" placeholder="{{search_placeholder}}">\n\t\t\t\t<span purpose="clearSearch" class="zcl-search-clear">{{clear_txt}}</span>\n\t\t\t</div>\n\t\t\t<div purpose="hideSearch" class="zcl-seach-close zcf-close clr-icon font10 zcl-dropdown-divider"></div>\n\t\t</div>',chats:'<div chid="{CHID}" elemtype="chat" purpose="search" class="flexC zcrtchtcontct remcontact font13"><span class="usrimgsts">{CHATIMAGE}{USERSTATUS}</span><span class="usrname ellips" title="{TITLE}">{TITLENAME}<em></em></span><div class="msi-hisseld selectind" ></div></div>',sharedByHTML:`<div id="sharedByDrpdwn" purpose="showSentMessageOptions" class="callhis-filter drpdwn-input wfit fshrink drpdwn-wrp mL10 mlsharedby flexC posrel">\n\t\t\t\t<div class="flexC">\n\t\t\t\t\t<div class="clr-lp1 font13 clr6">${I18N("common.filter")}:</div>\n\t\t\t\t\t<div  class="mL8 flexC">\n\t\t\t\t\t<div id="filter_txt" class="selectedusers callhis-filter zcsenthisfilter clr-H font13 flex">{{all}}</div>\n\t\t\t\t\t\t<em class="mL8 clr-icon zcf-downArrow font10"></em>\n\t\t\t\t\t\t<div id="sentHistoryDrpDwnOpts" class="zcl-menu-wrap zcsentmsghistory posa no-pointer hide">\n\t\t\t\t\t\t\t<div class="zcl-menu-item justifySB" data-action="removeUserAndChatsFilters">\n\t\t\t\t\t\t\t\t<span>{{all}}</span>\n\t\t\t\t\t\t\t\t<em id="allsel" class="clrG msi-tick p5"></em></div>\n\t\t\t\t\t\t\t<div id="sentmsgusers" class="zcl-menu-item justifySB" data-searchtype="users" purpose="showUsersSelctionDrpDwn">\n\t\t\t\t\t\t\t\t<span data-searchtype="users" purpose="showUsersSelctionDrpDwn">{{sentto}}</span>\n\t\t\t\t\t\t\t\t<div id="userslist" class="ml-filter zcsentlist"></div>\n\t\t\t\t\t\t\t\t<em data-searchtype="users" class="zcf-rightArrow mL20" purpose="showUsersSelctionDrpDwn"></em>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<div id="sentmsgchats" class="zcl-menu-item justifySB" data-searchtype="chats" purpose="showUsersSelctionDrpDwn">\n\t\t\t\t\t\t\t\t<span data-searchtype="chats" purpose="showUsersSelctionDrpDwn">{{sentin}}</span> \n\t\t\t\t\t\t\t\t<div id="chatslist" class="ml-filter zcsentlist zcchatlist"></div>\n\t\t\t\t\t\t\t\t<em  class="zcf-rightArrow mL20" data-searchtype="chats" purpose="showUsersSelctionDrpDwn"></em>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>`,markAllReadBtn:'<div id="markallreadbtn" class="zcl-btn-sm zcl-btn--secondary mL20" purpose="markAllAsRead"><span class="zcl-btn-icn zcf-markallasread mR10"></span><span class="ellips font14 ">{{markallasread}}</span></div>',searchcontainer:'<div class="mLR30 flexG">\n\t\t\t\t<div class="fshrink">\n\t\t\t\t<div class="zcl-search2" style="max-width: 50%; margin: auto;">\n\t\t\t\t\t<span class="zcf-search2 zcl-seach-icon"></span>\n\t\t\t\t\t\t<div class="zcl-search-input">\n\t\t\t\t\t\t\t<input type="text" id="chat-history-search-field" placeholder="{{placeholder}}">\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>',selectedFilterImg:'<div data-chid="{{chid}}" class="dIB zcricnt posl zcsenthistoryfilterimg textC" title="{{title}}">\n\t\t\t\t{{footerImgHTML}}\n\t\t\t\t{{removeHTML}}\n\t\t</div>',removeHTML:'<div data-chid="{{chid}}" class="msi-close posa dN cur" data-action="removeChats"></div>',threadchatbadge:'<span class="old-name-search ellips fshrink" title="{{thread_chat_title}}">{{thread_chat_title}}</span>'},e=e=>$WC.template.replace(t.conversationHeader,{$placeholder:"sentHistory"!==e?"common.searchhistory.minchars":"history.sentmsg.placeholder",$all:"common.all",$directmessages:"common.directmessages",$channels:"module.channels",$groupchats:"common.groupchats",$threadchats:"common.threadchats",$markallasread:"chat.markread.all",$bots:"bots.title",$hideallmutedchats:"history.hide.muted",$mutedchats:"common.mutedchats",hide_muted_chats:1==Settings.canHideMutedConversations()?"checked":"",markAllReadBtn:"sentHistory"!==e?s():"",dateFilterHTML:i(),justify:"sentHistory"!==e?"justifyE":"justifyFS"},"InSecureHTML");var s=function(){return $WC.template.replace(t.markAllReadBtn,{$markallasread:"chat.markread.all"},"InSecureHTML")},i=function(){return $WC.template.replace(t.dateFilterHTML,{dateFilterOptionsHTML:a(),calendarHTML:$WC.template.replace(t.calendarHTML,{dateFilterOptionsHTML:a(!0)},"InSecureHTML")},"InSecureHTML")},a=function(e){var s="";return["beforesentmsg","aftersentmsg","onsentmsg"].forEach(i=>{s+=$WC.template.replace(t.dateFilterOptions,{id:i,class:e?"dN":i,displayName:I18N("history.filter."+i)})}),s};let n=()=>$WC.template.replace(t.searchcontainer,{$placeholder:"common.searchhistory.minchars"},"inSecureHTML"),l=e=>{var s=o(e);return $WC.template.replace(t.historyHeader,{search_container:window.Config.isConversationHistoryFilterEnabled()?"":n(),$convo_hdr:s.title,icon:s.icons,$placeholder:"common.searchhistory.minchars"},"InSecureHTML")};var o=function(t){return{sentHistory:{icons:"zcf-senthistory",title:"history.sentmessages"},conversationHistory:{icons:"zcf-chat",title:"common.chats"}}[t]||{}};return{getItemHtml:()=>t.conversationItem,getContainerHtml:s=>$WC.template.replace(t.mainContainer,{container_header:l(s),conversation_header:"sentHistory"==s?$WC.template.replace(t.sentMsgHistoryHeader,{searchInputHTML:$WC.template.replace(t.searchInputHTML,{clear_txt:I18N("common.clear"),search_placeholder:I18N("history.sentmsg.placeholder")}),sharedByHTML:$WC.template.replace(t.sharedByHTML,{all:I18N("common.all"),sentto:I18N("history.sentmsg.to"),sentin:I18N("history.sentmsg.in")}),dateFilterHTML:i()},"InSecureHTML"):window.Config.isConversationHistoryFilterEnabled()?e(s):""},"InSecureHTML"),getNoDataHtml:e=>{let s=$WC.template.replace(t.empty,{$nodata_desc:"globalsearch.empty",$trynew_search:"globalsearch.trynew"},"InSecureHTML");return $WC.template.replace(s,{SEARCH_INPUT:e})},getConversationHeader:e,getThreadChatBadge:e=>$WC.template.replace(t.threadchatbadge,{thread_chat_title:e},"inSecureHTML"),getSentMsgTemplate:()=>t.sentMessages,getChatTemplate:()=>t.chats,getChatRemoveTemplate:e=>$WC.template.replace(t.removeHTML,{chid:e},"InSecureHTML"),getSelectedFilterImages:(e,s)=>$WC.template.replace(t.selectedFilterImg,{chid:e,title:s},"InSecureHTML"),getDateFilterHTML:i,getSearchInputHTML:function(){return $WC.template.replace(t.searchInputHTML,{clear_txt:I18N("common.clear"),search_placeholder:I18N("history.sentmsg.placeholder")},"InSecureHTML")}}}();var HistoryTemplate={mainContainer:'<div id="historyContainer" class="wh100 flex fdirC convo-history historyContainer">\n                        {{headerHTML}}\n                        <div class="convohistory-header fshrink flexC mL4 {{customClass}}">\n                            {{dropDownHTML}}\n                            <div id="filterWrapper" class="flexC flexG justifyE">\n                                {{muteButtonHTML}}\n                                {{searchHTML}}\n                                {{markAllReadButtonHTML}}\n                                {{dateFilterHTML}}\n                            </div>\n                        </div>\n                        <div id="historyMainContainer" class="flexG ovrflwA pTB10 pTB35" zc_sticky_title_list>{{loaderHTML}}</div>\n                     </div>',groupMessageContainer:'\n                    <div class="date-divider {{dateClass}}" zc_running_title date-divider="{{date}}" data-time="{{time}}">{{date}}</div>\n                    <div class="zchistory__sentmsg--container posrel">\n                        <div class="zchistory__sentmsg--header flexC">\n                            <div class="zchistory__image flexM posrel">{{imageHTML}}</div>\n                            <div class="zchistory__title font15 fontB clr-H pL10 line20">{{title}}{{userTag}}{{threadBadgeHTML}}</div>\n                        </div>\n                        <div class="zchistory__sentmsg--main mL20 pB15" >\n                            {{groupMessageHTML}}\n                        </div>\n                    </div>',threadBadgeHTML:'<span class="old-name-search ellips fshrink" title="{{title}}">{{title}}</span>',groupMessage:'<div class="zchistory__sentmsg flexC font14 pT8 pB8 pL12 pR10 curP" data-view="msgcontainer" data-chid="{{chid}}" data-time="{{time}}" data-msguid="{{msguid}}" data-action="{{action}}" data-chidandtime="{{chidandtime}}" msg-hov>\n                        {{message}}\n                        <div class="clr-lp2 font13 fshrink mLAuto" data-type="time">{{msgTime}}</div>\n                        <span data-chid="{{chid}}" data-type="optionicon" data-messageuid="{{msguid}}" data-time="{{time}}" class="optionicon rolechange-icn mL12 mR10 zcl-icon zcf-moreV  dN" data-action="openScheduleMsgListOptions"></span>\n                    </div>',message:'<div class="ellips-L3 w90 {{msgStyleClass}}" data-type="message">{{message}}</div>',msgOptions:'<div id="schedulelistoptions" class="zcl-menu-wrap zcschedule-listoptions dN">\n                        {{actions}}\n                </div>',action:'<div class="p10 zcl-menu-item {{className}}" data-action="{{action}}" data-schMsgUid="{{schMsgUid}}" data-chid="{{chid}}" data-time="{{msgTime}}">{{actionName}}</div>',stickyDate:'<div id="sticky_date_item" class="date-divider w100 sticky-date-cnt" zc_sticky_title></div>\n    <div>{{listHTML}}</div>',headerHTML:'<div class="main-container-header ovrflwH fshrink">\n        \t\t        <div class="w100 flexC justifySB">\n    \t\t\t            <div class="flexG flexC">\n        \t\t\t            {{title}}\n    \t\t\t            </div>\n                            {{button}}\n    \t\t            </div>\n\t\t            </div>',title:'<div class="flexC fshrink" style="line-height: 1;">\n                     <div class="{{icon}} clr-icons mR10"></div>\n                     <div class="font16 clr-H fontB" style="margin-bottom: 2px;">{{title}}</div>\n                </div>',button:'<div class="fshrink">\n                    <div class="ellips zcl-btn-xs zcl-btn--primary" data-action="{{action}}" style="line-height: 1;">{{name}}</div>\n                    <div class="zcl-icon zcf-markallasread zcl-icon--default dN"></div>\n                </div>',footerImgHTML:'<img src="{{src}}" />',removeChatHTML:'<div data-chid="{{chid}}" class="msi-close posa dN cur" data-action="{{action}}"></div>',removeUserHTML:'<div data-uid="{{uid}}" class="msi-close posa dN cur" data-action="{{action}}"></div>',searchAgentChatHTML:'<div chid="{CHID}" elemtype="chat" purpose="search" class="flexC zcrtchtcontct remcontact font13">\n                <span class="list-img posrel usrimgsts">\n                    {CHATIMAGE}\n                    {USERSTATUS}\n                </span>\n                <span class="usrname ellips mL10" title="{TITLE}">{TITLENAME}<em></em></span>\n                <div class="msi-hisseld selectind"></div>\n        </div>',transcriptContainer:`<div id="transcriptcontainer" opener="chathistory" class="hst-rht zcmulticht zcmsgbothside" style="display:none;">\n\t\t\t\t\t<div class="zcempty-con">\n\t\t\t        \t<div class="zcempty-title font18">${Resource.getRealValue("history.chat.select")}</div>\n\t\t\t        </div>\n\t\t\t     </div>`,searchBtn:`<div class="ellips zcl-btn-xs zcl-btn--primary sentmsghistory-searchbtn search p20" data-action="{{action}}">${Resource.getRealValue("globalsearch.trynew")}</div>`,chatFilters:'<div data-chid="{{chid}}" class="dIB zcricnt posl zcsenthistoryfilterimg flexM textC {{customClass}}" title="{{title}}">\n                 {{footerImgHTML}}\n                 {{removeHTML}}\n         </div>',transcriptBtnHTML:`<div class="zcflt_btn">\n                        <div id="continuechat" chid="{{chid}}" data-time="{{time}}" data-msguid="{{msguid}}" data-chid="{{chid}}" purpose="transcriptoptions" class="zcl-btn zcl-btn--primary zctransciptbtn">${I18N("common.continue")}</div>\n            </div>`,transcriptFailureHTML:'<span id="transcriptclose" purpose="transcriptoptions" class="msi-close cclose"></span>{{emptyStateHtml}}'},HistoryViewUtils={chatsFilterList:[],usersFilterList:[],currentchat:null,isCwinOpen:!1,CONSTANTS:{USERS:"USERS",CHATS:"CHATS"},template:{tourHTML:"<article id='onboardtour' class='posfix' module='senthistory' style='display:none'><div class='zc-tourbg posrel bdrR4 p16'><div id='toursenttriangle' class='triangle-left posfix'></div><div class='flex fjustifySB font15 fontB'><div>History of all your Sent Messages</div><div class='zcf-close curP posabs font10' data-purpose='close-tour' style='top:10px; right:10px'></div></div><div class='mT10 font14 line20'>You can now find and easily access records of all messages you have sent to others in one place.</div><div class='mT5 w100 flexI justifyE'><div class='fontB zcf-underline curP' data-purpose='close-tour'>Ok, got it</div></div></div></article>"},onBeforeClose:function(){this.currentchat=null,this.isCwinOpen=!1},getSelectedList:function(){return MediaListingEvents.addParticipants.getTempIgnoreList()},setSelectedList:function(t){MediaListingEvents.addParticipants.setTempIgnoreList(t)},setFilteredList:function(t,e){t==this.CONSTANTS.CHATS&&(this.chatsFilterList=e,this.usersFilterList=[]),t==this.CONSTANTS.USERS&&(this.usersFilterList=e,this.chatsFilterList=[])},getFilteredList:function(t){return t==this.CONSTANTS.CHATS?this.chatsFilterList:t==this.CONSTANTS.USERS?this.usersFilterList:[]},getSelectedType:function(){return MediaListingEvents.addParticipants.getSearchType()},setSelectedType:function(t,e){var s=e||(t?t.target.dataset.type:void 0);MediaListingEvents.addParticipants.setSearchType(s)},clearFilterList:function(){this.usersFilterList=[],this.chatsFilterList=[]},getImageOfSelectedFilters:function(t,e){for(var s="",i=t.type==this.CONSTANTS.CHATS,a=t.selectedList,n=t.isRemoveInSearchAgentFooter||!1,l=0;l<a.length;l++){if(3==l&&!e){s+='<div id="sharedByNames" title="" class="dIB zcricnt posl ml-selcontactcnt textC zcchatcount">'+(a.length-l)+"+</div>";break}s+=i?this.getImageOfChats(a[l],n):this.getImageOfUsers(a[l],n)}return s},getImageOfChats:function(t,e){var s={},i=ConversationsList.get(t);return void 0===i?" ":(s.footerImgHTML=HistoryUI.getRecipantsPhoto(i.recipants,i.pcount,i.addinfo,i.title,i.ctype,t,i.customgroup,!1,{needRoundedCorner:!e,needZcfIcon:!0}),s.removeHTML=this.getChatRemoveTemplate(t,e?"removeSelectedChatsInSearchAgentFooter":"removeFilteredChats"),$WC.template.replace(HistoryTemplate.chatFilters,{footerImgHTML:s.footerImgHTML,chid:i.chid,title:i.title||"",removeHTML:s.removeHTML,customClass:e?"zchistsearchwidth":"zchistauto"},"InSecureHTML"))},getImageOfUsers:function(t,e){let s=$.extend(RemindersUtil.getUserDetails(t),{remove_html:""});return s.remove_html=this.getUserRemoveTemplate(t,e?"removeSelectedUser":"removeUsers"),$WC.template.replace(MediaListingTemplates.getHtml("imgNodeHTML"),s,"InSecureHTML")},getChatRemoveTemplate:function(t,e){return $WC.template.replace(HistoryTemplate.removeChatHTML,{chid:t,action:e},"InSecureHTML")},getUserRemoveTemplate:function(t,e){return $WC.template.replace(HistoryTemplate.removeUserHTML,{uid:t,action:e},"InSecureHTML")},isHistoryInViewPort:function(){return $("#historyContainer").length>0},isResponseEmpty:function(t){return 0==t.length},setSessionStorage:function(t,e){sessionStorage.setItem(t,JSON.stringify(e))},updateSessionStorage:function(t,e){var s=this.getSessionStorage(t);null!=s?($.extend(s,e),this.setSessionStorage(t,s)):this.setSessionStorage(t,e)},clearAndUpdateSessionStorage:function(t,e){var s=this.getSessionStorage(t);null!=s&&delete s[e],this.setSessionStorage(t,s)},getSessionStorage:function(t){return JSON.parse(localStorage.getItem(t))},getAppliedFilterName:function(t){if(!t)return"";var e=I18N("common.on");return t.includes("after")?e=I18N("common.after"):t.includes("before")&&(e=I18N("common.before")),e+":"},showSentMsgTour:function(){var t=$WC.template.replace(this.template.tourHTML,{},"InSecureHTML"),e=this.getTourPosition();$("body").append(t),Clickoutside.bind({destid:"onboardtour",customShow:function(){var t=$("#onboardtour"),s=e.left,i=e.top;t.find("#toursenttriangle").css({left:`${s-20}px`,top:`${i+5}px`}),t.css({left:`${s-10}px`,top:`${i-10}px`,zIndex:99}).fadeIn(),Tour.bindEvents()},customHide:function(){Tour.closeTour(!0),HistoryViewUtils.closeTour()}})},closeTour:function(){ZCTrack.track("ANNOUNCEMENT",{VERSION:$zcg._ANNOUNCEMENT.version,ACTION:"announcement_closed"}),Settings.update({announcementversion:$zcg._ANNOUNCEMENT.version}),$("#lhs_history").removeClass("zcf-newhistoryfeature"),$("#lhs_history_counter").removeClass("dN"),this.isShowHistoryAnnouncement=!1},showNewFeatureIconInLHSHistory:function(){$("#lhs_history").addClass("zcf-newhistoryfeature"),$("#lhs_history_counter").addClass("dN"),this.isShowHistoryAnnouncement=!0},getTourPosition:function(){return{left:$("#module_content").width(),top:$("#showSentMsgHistory")[0].getBoundingClientRect().top}}},HistoryViewModel=function(t){this.apiParams=t.apiParams,this.nextToken,this.data=[],this.filterParams={},this.currentFetchData,this.initFilterParams(t.filterParams)};HistoryViewModel.prototype={fetchHistoryList:function(t){var e=Object.assign({},this.getApiParams()),s=this,i=Object.assign({},e.payload);if(t&&(i.next_token=this.getNextToken()),Object.keys(this.filterParams)){var a="function"==typeof e.getApiParamsCB?e.getApiParamsCB(this.filterParams):{};$.extend(i,a)}this.handleBeforeFetch();var n=this.getFetchId();return this.setIsFetching(!0),MsgUtil.makeGetRequest(e.url,i).then(t=>(s.setNextToken(t.next_token||t.data.next_token),s.setIsFetching(!1),t.beforeFetchId=n,t.afterFetchId=s.getFetchId(),t))},handleBeforeFetch:function(){this.setFetchId(),this.setIsFetching()},setIsFetching:function(t=!0){this.isFetching=t},isAlreadyFetching:function(){return this.isFetching},setFetchId:function(){this.fetchId=window.getEventId()},getFetchId:function(){return this.fetchId},getApiParams:function(){return this.apiParams},setNextToken:function(t){this.nextToken=t},getNextToken:function(){return this.nextToken},hasNextToken:function(){return Boolean(this.nextToken)},setFilterParams:function(t,e){this.filterParams[t]=e},getFilterParams:function(t){return this.filterParams[t]},removeFilterParams:function(t){delete this.filterParams[t]},getCurrentOpenTranscriptChatId:function(){return this.currentOpenTranscriptChatId},setCurrentOpenTranscriptChatId:function(t){this.currentOpenTranscriptChatId=t},hasSearch:function(){return Boolean(this.getFilterParams("searchText"))},hasFilter:function(){return Boolean(this.getFilterParams("date"))||Boolean(this.getFilterParams("dropDown"))},getGroupList:function(t){if(0==t.length)return[];var e=[],{chid:s,time:i,schedule_status:a}=t[t.length-1];return this.setPrevTimeAndChid(i,s),this.setPrevScheduleStatus(a),t.reduce((e,s,i)=>{var a=t[i-1]||{};if(this.isSameChat(a.chid,s.chid)&&(this.isSameDate(a.time,s.time)||this.isSameStatus(a.schedule_status,s.schedule_status))){var n=0==e.length?0:e.length-1,l=e[n];l=l||[],e[n]=l.concat(s)}else e.push([s]);return e},e),e},isSameChat:function(t,e){return t==e},setPrevTimeAndChid:function(t,e){this.setPreviousChid(e),this.setPrevTime(t)},setPrevTime:function(t){this.prevMsgTime=t},getPrevTime:function(){return this.prevMsgTime},setPreviousChid:function(t){this.prevMsgChid=t},getPreviousChid:function(){return this.prevMsgChid},setPrevScheduleStatus:function(t){this.prevScheduleStatus=t},getPrevScheduleStatus:function(){return this.prevScheduleStatus},isSameDate:function(t,e){return $Date.isSameDay(t,e)},isSameStatus:function(t,e){return void 0!==t&&t==e},setMsgUid:function(t){this.msgUid=t},getMsgUid:function(){return this.msgUid},initFilterParams:function(t){this.filterParams=t||{}}};var HistoryViewUI=function(t){this.initParams(t)};HistoryViewUI.prototype={initParams:function(t){return this.params=t,this},render:function(){this.initUI()},initUI:function(){var{list:t}=this.params;t.length>0&&this.createHistoryViewUI()},createHistoryViewUI:function(){var{isGroupView:t}=this.params;t?this.createGroupHistoryViewUI():this.createListHistoryViewUI()},createGroupHistoryViewUI:function(){var t=$WC.template.replace(HistoryTemplate.stickyDate,{listHTML:this.groupListsHTML()},"InSecureHTML");this.getHistoryMainContainer().html(t),this.isViewAlreadyConstruced=!0,$Util.initializeStickyTitle($("#historyContainer"))},hasViewAlreadyConstruced:function(){return this.isViewAlreadyConstruced},setAlreadyViewConstructed:function(t){this.isViewAlreadyConstruced=t},groupListsHTML:function(){var{list:t,prevMsgTime:e,prevMsgChid:s,prevMsgUid:i,prevScheduleStatus:a}=this.params,n="",l=a||e;return t.forEach(t=>{t[0].chid==s&&($Date.isSameDay(e,t[0].time)||this.isSameStatus(a,t[0].schedule_status))?this.appendMessageDirectly(i,this.getGroupMessageHTML(t)):n+=this.getGroupListHTML(t,l),l=t[0].schedule_status||t[0].time}),n},getGroupListHTML:function(t,e){return $WC.template.replace(HistoryTemplate.groupMessageContainer,{imageHTML:this.getImage(t[0].chid),userTag:this.getTagHtml(t[0].chid),title:$WC.$CUtil.processXSS(t[0].ctitle),threadBadgeHTML:this.getThreadBadgeHTML(t[0].chid),date:void 0===e?this.getDynamicStatusTitle(t[0].schedule_status)||$Date.date(t[0].time):$Date.isSameDay(e,t[0].time)?"":$Date.date(t[0].time),dateClass:void 0===e?"":$Date.isSameDay(e,t[0].time)?"dN":$Date.date(t[0].time),time:t[0].schedule_status||t[0].time,chid:t[0].chid,groupMessageHTML:this.getGroupMessageHTML(t)},"InSecureHTML")},isSameStatus:function(t,e){return void 0!==t&&t==e},getImage:function(t){var e=ConversationsList.get(t);return HistoryUI.getRecipantsPhoto(e.recipants,e.pcount,e.addinfo,e.title,e.ctype,t,e.customgroup,!1,{needZcfIcon:!0,needRoundedCorner:!0,needThreadTypeIcon:!0})},getTagHtml:function(t){if(ConversationsList.isOnetoOneChat(t)){let e=ConversationsList.getRecipientDatafor121chat(t);if(!$WC.Util.isEmpty(e))return otherZuid=e.zuid,Users.getTag(otherZuid)}return""},getThreadBadgeHTML:function(t){if(ConversationsList.isThreadChat(t)){var e=ConversationsList.get(t),s=ConversationsList.getTitle(e.parentChatId,e.parentChatTitle);return $WC.template.replace(HistoryTemplate.threadBadgeHTML,{title:s})}return""},getGroupMessageHTML:function(t){var e="";return t.forEach(t=>{e+=$WC.template.replace(HistoryTemplate.groupMessage,{message:this.getProcessedMsg(t),msgTime:t.schedule_status?"":$Date.time(t.time),chid:t.chid,msguid:t.msguid,time:t.schedule_status||t.time,action:this.params.action,chidandtime:t.chid+t.time},"InSecureHTML")}),e},getDynamicStatusTitle:function(t){return{check_in:Resource.getRealValue("schmsg.user.checkout",["user"]),user_available:Resource.getRealValue("schmsg.user.dnd",["user"]),call_end:Resource.getRealValue("schmsg.user.onacallormeeting",["user"]),check_out:Resource.getRealValue("schmsg.user.checkin",["user"])}[t]},getProcessedMsg:function(t){var{messagetype:e}=t,s=!1,i=MsgUtil.getSearchedMessageData(t);i=Smiley.replace(i),i=MsgUtil.getDisplayableSilentUserMentionMsg(i),i=Smiley.convertAnimatedTo24(i),i=this.getHighlightSearchMessage(i),i=MsgUtil.isMentionMsg(i)?MsgTemplate.getDisplayableMention(t,i,Template.MentionHTML):i;var a=MsgTemplate.getCustomEmojiOrStickerHtml(t,i);return a.iscustomemojiavailable?a.customEmojiOrSticker:(e!=this.CONSTANTS.MTYPE&&e!=this.CONSTANTS.ATT||(i=Resource.getRealValue("chat.att.shared",this.CONSTANTS.YOU),s=!0),$WC.template.replace(this.templates.message,{message:i,msgStyleClass:s?"fontI font13":""},"InSecureHTML"))},getHighlightSearchMessage:function(t){var e=this.params.searchText||"";if(e.length>0){var s=new RegExp(e,"i");return t=t.replace(s,`<b>${e}</b>`)}return t},appendMessageDirectly:function(t,e){this.getHistoryMainContainer().find('[data-msguid="'+t+'"]').after(e)},appendInBody:function(t){var{isGroupView:e}=t;e&&this.getHistoryMainContainer().append(this.groupListsHTML())},showLoader:function(){this.getHistoryMainContainer().html(TemplateUtil.getLoaderHtml())},showBottomLoader:function(){this.getHistoryMainContainer().append(TemplateUtil.getListMoreLoader())},getHeaderHTML:function(t){if(t){var e=this.templates;return $WC.template.replace(e.headerHTML,{title:this.getHeaderTitle(t.pageInfo),button:this.getHeaderButton(t.buttonOptions)},"InSecureHTML")}},getHeaderTitle:function(t){return $WC.template.replace(this.templates.title,{title:t.title,icon:t.icon},"InSecureHTML")},getHeaderButton:function(t){return $WC.template.replace(this.templates.button,{action:t.action,name:t.name},"InSecureHTML")},removeBottomLoader:function(){var t=this.getHistoryMainContainer(),{historyMain:e}=this.domSelectors;t.find(e.footerLoader).remove()},createListHistoryViewUI:function(){},getHistoryViewContainer:function(){return this.historyViewContainer||(this.historyViewContainer=$("#historyContainer"))},getHistoryMainContainer:function(){return this.getHistoryViewContainer()?this.historyViewContainer.find(this.domSelectors.historyMain.mainSection):$("#historyMainContainer")},appendCwin:function(t){this.getHistoryViewContainer().find(this.domSelectors.transcript.container).html(t)},showCwin:function(t){this.getHistoryViewContainer().find("#"+t).addClass("flex wh100").css({width:""}).show()},showCwinContainer:function(){var t=this.getHistoryViewContainer().find(this.domSelectors.transcript.container);t.removeClass("hst-rht").addClass("zc-dcontainer chtwndws zc-detachedcwin"),t.show().animate({left:"52%"})},showLoaderInCwinContainer:function(){this.getHistoryViewContainer().find(this.domSelectors.transcript.container).html(TemplateUtil.getLoaderHtml())},isTranscriptViewExist:function(){return this.getHistoryViewContainer().find(this.domSelectors.transcript.container).length>0},appendTranscriptContainer:function(){var t=$WC.template.replace(this.templates.transcriptContainer,{},"InSecureHTML");this.getHistoryMainContainer().find(this.domSelectors.transcript.container).remove(),this.getHistoryMainContainer().append(t)},showTranscriptWindow:function(t){var e=this,s={destid:this.CONSTANTS.TRANSCRIPT_CONTAINER,event:t,customShow:function(t){e.getHistoryViewContainer().find("#"+t.destid).show().animate({left:"52%"},500)},doNotClose:function(){return ImgViewer.isVisible()||MediaPlayer.isPipModeActive()},customHide:function(t){MainUI.handleIframes("chathistory"),Clickoutside.clear(e.CONSTANTS.TRANSCRIPT_CONTAINER),e.getHistoryViewContainer().find("#"+t.destid).animate({left:"100%"},500,e.closeTranscriptCB.bind(e))}};Clickoutside.bind(s)},closeTranscriptCB:function(){this.getHistoryViewContainer().find("#"+this.CONSTANTS.TRANSCRIPT_CONTAINER).remove(),this.getHistoryMainContainer().find(this.domSelectors.historyMain.typeMsg).removeClass("sel")},setTranscriptHeader:function(t){var e=ConversationsList.getTitle(t),s=ConversationsList.isThreadChat(t);let i=$WC.template.replace(Template.transcriptViewHeader+Template.transcriptView,{title:e,chid:t,threadchattitle:s?ThreadChatUtils.getThreadTitleForTransHeader(e,ConversationsList.isClosedThread(t)):""},"InSecureHTML");this.getHistoryViewContainer().find(this.domSelectors.transcript.container).html(i)},showOptionsInTransctiptHeader:function(t,e){var s=ConversationsList.get(t),{time:i,msguid:a}=e.currentTarget.dataset,n=$WC.template.replace(HistoryTemplate.transcriptBtnHTML,{chid:t,msguid:a,time:i},"InSecureHTML"),l=(s.deleted,s.removed,new $CliqChatId(t).isChannel(),ConversationsList.isThreadChat(t),`<div id="printtranscript" purpose="transcriptoptions" chid=${t} title="${Resource.getRealValue("common.print")}" class="msi-print clrb cur mrgL10 font16 zchsicn"></div>`);this.getHistoryViewContainer().find(this.domSelectors.transcript.header).append(n+l),$Util.animateBtnTransView(this.getHistoryViewContainer().find(this.domSelectors.transcript.container))},showTranscriptFailure:function(){var t=this.domSelectors,e=this.getHistoryViewContainer().find(t.transcript.container),s={imageclass:"error_img",title:I18N("history.chat.error"),fontsize:"18"},i=$WC.template.replace(this.templates.transcriptFailureHTML,{emptyStateHtml:$Util.emptyStateHtml(s)},"InSecureHTML");e.html(i)},highLightActiveMessage:function(t,e){var s=t.currentTarget.dataset.chidandtime,i=this.getHistoryMainContainer();e&&i.find("[data-chid="+e+"]").removeClass("sel"),i.find("[data-chidandtime="+s+"]").addClass("sel")},getCurrentTranscriptContainer:function(){return this.getHistoryViewContainer().find(this.domSelectors.transcript.currentrans)},removeHightLightMessage:function(){this.getHistoryMainContainer().find(this.domSelectors.historyMain.typeMsg).removeClass("sel")},showEmptyState:function(t,e){var{searchEmpty:s,filterEmpty:i,defaultEmpty:a}=e,n=t.hasSearch?s:t.hasFilter?i:a,l=`<div class=${n.className}></div>`,o=void 0;if(n.button){var{template:r,name:d,action:c}=n.button;o=$WC.template.replace(r,{content:d,purpose:c,action:c},"InSecureHTML")}this.getHistoryMainContainer().html(TemplateUtil.noCategoryResult(n.name,l,o))},domSelectors:{historyMain:{mainSection:"#historyMainContainer",footerLoader:"#loadmore",typeMsg:'[data-view="msgcontainer"]'},transcript:{container:"#transcriptcontainer",header:"#transcriptheader",currentrans:"#currenttranscript"}},CONSTANTS:{TRANSCRIPT_CONTAINER:"transcriptcontainer",MTYPE:"3",ATT:"20",YOU:"You"},templates:HistoryTemplate};var HistoryViewController=function(t){this.params=t,this.historyModel=new HistoryViewModel(t),this.historyView=new HistoryViewUI(t),this.init()};HistoryViewController.prototype.init=function(){this.$element=document.createElement("div"),this.$element.setAttribute("data-historycomponent",this.params.uniqueid),this.$element.setAttribute("class","zchistory__container"),this.initializeHistoryFilterComponents(),this.$element.innerHTML=this.getHistoryViewElement(),this.bindEvents(),this.fetchHistoryList()},HistoryViewController.prototype.initializeHistoryFilterComponents=function(){var{searchParams:t,dateFilterParams:e,dropDownParams:s,checkBoxParams:i}=this.params;this.hasSearchInHistoryView()&&($.extend(t,{$el:this.$element,searchCB:this.searchCB.bind(this)}),this.search=new TextInputComponent(t)),this.hasDateFilterInHistoryView()&&($.extend(e,{$el:this.$element,dateCB:this.dateCB.bind(this)}),this.dateFilter=new DateFilterComponent(e)),this.hasDropDownFilterInHistoryView()&&($.extend(s,{$el:this.$element,dropDownCB:this.dropDownCB.bind(this)}),this.dropDown=new DropDown(s))},HistoryViewController.prototype.getHTML=function(){return this.$element},HistoryViewController.prototype.getHistoryViewElement=function(){return $WC.template.replace(HistoryTemplate.mainContainer,{searchHTML:this.search?this.search.getHTML():"",muteButtonHTML:Config.isFollowUpAtMentionEnabled()&&this.hasCheckBoxFilterInHistoryView()?this.getCheckBoxHTML():"",markAllReadButtonHTML:this.markAllReadBtnHTML||"",dateFilterHTML:this.dateFilter?this.dateFilter.getHTML():"",dropDownHTML:this.dropDown?this.dropDown.getHTML():"",loaderHTML:TemplateUtil.getLoaderHtml(),customClass:this.hasFilter()?"":"dN",headerHTML:this.historyView.getHeaderHTML(this.params.headerParams)||""},"InSecureHTML")},HistoryViewController.prototype.getParams=function(){return $.extend(this.params,{parentContainer:this.$element})},HistoryViewController.prototype.bindEvents=function(){var t=$(this.$element),e=this;t.on("click","[data-action]",(function(t){var{action:s}=t.target.dataset;if(void 0===s)var{action:s}=t.currentTarget.dataset;s in e&&e[s](t)})),t.on("click","[purpose='transcriptoptions']",(function(t){var s=t.target.id;s in e&&e[s](t)})),this.bindFilterElements(),this.bindEventsOnScroll(),this.bindMouseEvents()},HistoryViewController.prototype.bindFilterElements=function(){this.search&&this.search.bindEvents(),this.dateFilter&&this.dateFilter.bindEvents(),this.dropDown&&this.dropDown.bindEvents()},HistoryViewController.prototype.bindEventsOnScroll=function(){this.getHistoryViewContainer().find("#historyMainContainer").on("scroll",$Util.debounce(this.fetchHistoryListOnScroll,this,200))},HistoryViewController.prototype.getCheckBoxHTML=function(){var t=this.params.checkBoxParams.checkBoxOptions,e={align:"HR",options:[{id:t.id,checked:t.isChecked,label:t.name}]};return CHECK_BOX.getHTML(e)},HistoryViewController.prototype.bindMouseEvents=function(){var t=this,e=this.getHistoryViewContainer();e.on("mouseover","[msg-hov]",(function(e){t.handleMouseOver(e),e.stopPropagation()})),e.on("mouseleave","[msg-hov]",(function(e){t.handleMouseLeave(e),e.stopPropagation()}))},HistoryViewController.prototype.handleMouseOver=function(t){var e=this.params.listDataParams||{};"function"==typeof e.onMouseOverCB&&e.onMouseOverCB(t,this.getHistoryViewContainer())},HistoryViewController.prototype.handleMouseLeave=function(t){var e=this.params.listDataParams||{};"function"==typeof e.onMouseLeaveCB&&e.onMouseLeaveCB(t,this.getHistoryViewContainer())},HistoryViewController.prototype.fetchHistoryListOnScroll=function(t){this.isValidScroll(t.target)&&(this.getView().showBottomLoader(),this.fetchHistoryList(!0))},HistoryViewController.prototype.isValidScroll=function(t){var e=this.getModel();return ZCScroll.isScrollNearBottom(t)&&e.hasNextToken()&&!e.isAlreadyFetching()},HistoryViewController.prototype.fetchHistoryList=function(t){this.getModel().fetchHistoryList(t).then(e=>this.onFetchHistoryListSuccess(e,t),t=>this.onFetchHistoryListFailure)},HistoryViewController.prototype.onFetchHistoryListSuccess=function(t,e){if(t.afterFetchId===t.beforeFetchId){var s=this.getView(),i=this.getModel(),a="function"==typeof this.params.getMockResponse?this.params.getMockResponse(t.data):t.data,n={prevMsgTime:i.getPrevTime()||void 0,prevMsgChid:i.getPreviousChid()||void 0,prevMsgUid:i.getMsgUid()||void 0,prevScheduleStatus:i.getPrevScheduleStatus()||void 0},l={element:this.$element,list:this.params.isGroupView?i.getGroupList(a):a,isGroupView:this.params.isGroupView,action:this.params.listDataParams.action||void 0,searchText:i.getFilterParams("searchText")};if(!HistoryViewUtils.isResponseEmpty(a)||s.hasViewAlreadyConstruced()){if(e&&$.extend(l,n),a.forEach(t=>i.setMsgUid(t.msguid)),s.hasViewAlreadyConstruced())return s.removeBottomLoader(),void s.initParams(l).appendInBody(l);this.getView().initParams(l).render()}else{var o={hasSearch:i.hasSearch(),hasFilter:i.hasFilter()};s.showEmptyState(o,this.params.emptyStateParams)}}},HistoryViewController.prototype.searchCB=function(t){var e=this.getModel();t=t||"",(e.getFilterParams("searchText")||"")!=t&&(""==t.trim()?e.removeFilterParams("searchText"):this.getModel().setFilterParams("searchText",t),this.handleBeforeFetch(),this.fetchHistoryList())},HistoryViewController.prototype.getView=function(){return this.historyView},HistoryViewController.prototype.getModel=function(){return this.historyModel},HistoryViewController.prototype.initiateDirectMessage=function(t){QuickChat.createwin(void 0,"directmessagewin"),t.stopPropagation()},HistoryViewController.prototype.dateCB=function(t,e){var s=this.getModel(),i={filterName:t,date:e};e?s.setFilterParams("date",i):s.removeFilterParams("date"),HistoryViewUtils.updateSessionStorage(this.params.uniqueid,{date:i}),this.handleBeforeFetch(),this.fetchHistoryList()},HistoryViewController.prototype.dropDownCB=function(t,e){var s={type:t,value:e};this.getModel().setFilterParams("dropDown",s),HistoryViewUtils.updateSessionStorage(this.params.uniqueid,{dropDown:s}),0==e.length&&HistoryViewUtils.clearAndUpdateSessionStorage(this.params.uniqueid,"dropDown"),this.handleBeforeFetch(),this.fetchHistoryList()},HistoryViewController.prototype.handleCheckBoxChange=function(t){var e=this.params.checkBoxParams.checkBoxOptions;this.getModel().setFilterParams(e.key,t),this.handleBeforeFetch(),this.fetchHistoryList()},HistoryViewController.prototype.handleBeforeFetch=function(){var t=this.getView();t.showLoader(),t.setAlreadyViewConstructed(!1)},HistoryViewController.prototype.getHistoryViewContainer=function(){return this.historyViewContainer||(this.historyViewContainer=$(this.$element))},HistoryViewController.prototype.viewChat=function(t){t.stopImmediatePropagation();var e=t.currentTarget.dataset.chid,s=this.getModel(),i=s.getCurrentOpenTranscriptChatId(),a=this.getView(),n=a.isTranscriptViewExist();if(a.highLightActiveMessage(t,i),Config.isDetachedCwinIntegrationEnabled()){if(e==i&&n)return void this.scrollToMsgInChatWindow(t);LazyLoader.loadDetachedCwinFiles().then(()=>{this.handleDetachedChatWindow(e,t)})}else{if(e==i&&n)return void this.scrollToMsg(t);ChatUI.removeTranscriptView(i),Clickoutside.clear("transcriptcontainer"),a.appendTranscriptContainer(),a.showTranscriptWindow(t),a.setTranscriptHeader(e);var l={chid:e,time:t.currentTarget.dataset.time,lineslimit:Chat.LINESLIMIT,container:a.getCurrentTranscriptContainer()};s.setCurrentOpenTranscriptChatId(e),ChatUI.getTranscriptView(l).then(e=>this.handleTranscriptFetched(e,t),t=>this.handleTranscriptFetchFailure(t))}},HistoryViewController.prototype.handleBeforeOpeningTranscript=function(t){var e=this.getModel(),s=this.getView();s.appendTranscriptContainer(),s.showCwinContainer(),s.showLoaderInCwinContainer(),HistoryViewUtils.currentchat=t,e.setCurrentOpenTranscriptChatId(t)},HistoryViewController.prototype.scrollToMsgInChatWindow=function(t){var e=t.currentTarget.dataset,s=e.chid,i=e.time;Chat.findAndScrollToMsg(s,!0,void 0,i)},HistoryViewController.prototype.handleDetachedChatWindow=function(t,e){this.handleBeforeOpeningTranscript(t);var s=this.getView();DetachedCwin.create(t).then(i=>{s.appendCwin(i),s.showCwin(t),HistoryViewUtils.isCwinOpen=!0,ChannelTabsUI.switchToMessagesTab(t),this.scrollToMsgInChatWindow(e),ChatUI.showMsgTimeOnChatWindowOpened(),this.setCBInCwinInstance(t)})},HistoryViewController.prototype.setCBInCwinInstance=function(t){ChatUI.getWin(t).onBeforeCloseCB=()=>this.onBeforeChatClose()},HistoryViewController.prototype.onBeforeChatClose=function(){this.getView().removeHightLightMessage(),HistoryViewUtils.onBeforeClose()},HistoryViewController.prototype.handleTranscriptFetchFailure=function(t){var e=this.getModel(),s=this.getView();t.chid===e.getCurrentOpenTranscriptChatId()&&s.showTranscriptFailure()},HistoryViewController.prototype.handleTranscriptFetched=function(t,e){var s=this.getModel(),i=this.getView(),a=t.chid;a===s.getCurrentOpenTranscriptChatId("chid")&&(i.showOptionsInTransctiptHeader(a,e),this.scrollToMsg(e))},HistoryViewController.prototype.scrollToMsg=function(t){var{chid:e,time:s}=t.currentTarget.dataset;ChatUI.scrollToMsgInTranscriptView(e,null,s)},HistoryViewController.prototype.transcriptclose=function(t){var e=this.getModel();Clickoutside.handleClickOnChild(t),ChatUI.removeTranscriptView(e.getCurrentOpenTranscriptChatId()),e.setCurrentOpenTranscriptChatId(""),this.getView().closeTranscriptCB()},HistoryViewController.prototype.continuechat=function(t){var{time:e,chid:s,msguid:i}=t.target.dataset;Chat.jumpToConversation(s,!1,i,e)},HistoryViewController.prototype.printtranscript=function(t){HistoryUI.handleTranscriptoptions(t.target),t.stopImmediatePropagation()},HistoryViewController.prototype.hasFilter=function(){return this.hasSearchInHistoryView()||this.hasDateFilterInHistoryView()||this.hasDropDownFilterInHistoryView()},HistoryViewController.prototype.hasSearchInHistoryView=function(){return"searchParams"in this.params},HistoryViewController.prototype.hasDropDownFilterInHistoryView=function(){return"dropDownParams"in this.params},HistoryViewController.prototype.hasDateFilterInHistoryView=function(){return"dateFilterParams"in this.params},HistoryViewController.prototype.hasCheckBoxFilterInHistoryView=function(){return"checkBoxParams"in this.params},HistoryViewController.prototype.hasMuteFilterInHistoryView=function(){return"muteFilterParams"in this.params};let ConversationsHistoryUI=function(){"use strict";let t,e=!1,s=!1,i=null,a=0,n=null,l=!1;var o=null,r=null,d=1,c=!1,p=!1,h=void 0;let m,u,v,g,f=[],C=[],y="",_="",S=!1;var T;let L=()=>{a=0,e=!1,n=null,m=void 0,u=void 0,v=void 0,l=!1,r=null,o=null,d=1,c=!1,S=!1,h=void 0,T=void 0},M="sentHistory",I="conversationHistory",w="msg-container-empty",H="search_empty",b="You",A="sharedByDrpdwn",E="sentHistoryDrpDwnOpts",O="chats",R="ml_search_icon",D="ml_search",U=20,N='[purpose="showSentMsgHistory"]',P="#mutedmsgcheckbox",k="#sentHistoryDrpDwnOpts",x="#sharedByDrpdwn",z="#ml_search_input",F="#filter_txt",V="#allsel",W="#ml_search",B=()=>{var t=j(),e=Object.keys(ConversationsList.getAll(t));return e=e.filter((function(t){return ConversationsList.hasUnread(t)}))},j=()=>{var t;switch(g.attr("type")||null){case"dm":t="directMessage";break;case"chat":t="groupchats";break;case"channel":t="channels";break;case"threads":t="threadchats";break;case"bot":t="bots";break;case"muted":t="mutedchats"}return t},G=()=>{var t=0==B().length;$("#markallreadbtn").attr("disabled",t)},Y=t=>{var e=t.data.chats;ConversationsList.updateConversationsDB(e||[]),ConversationsHistoryUI.populate(e)};var Z=function(t){p=!1;var e=q(t.data.messages);e.length>U&&e.pop(),ConversationsList.updateConversationsDB(e),ConversationsHistoryUI.populate(e,"sentHistory")},q=function(t){return t?(t.forEach((function(e,s){t[s].chatid=e.chid,t[s].lmtime=e.time,t[s].title=e.ctitle?e.ctitle:" ",t[s].chat_type=e.ctype,ConversationsList.isOnetoOneChat(e.chatid)&&(t[s].recipants="string"==typeof e.recipientssumm?JSON.parse(e.recipientssumm):e.recipientssumm)})),t):[]};let K=t=>{var e;"threadchats"==t&&(e=$("#convohistoryoptions").find('[type="threads"]'),it(e),st())},J=()=>{if(SecurityManager.hasPermission(Modules.DirectMessage)){return $WC.template.replace(TemplateUtil.getLhsLongBtn(),{purpose:"initiateDirectMessage",$content:"common.chat.start"})}return""};var X=function(){return v.val()?H:w},Q=function(t){return t==H?Resource.getRealValue("history.sentmsgs.search.none"):t==w?Resource.getRealValue(c?"history.filter.none":"history.sentmsgs.none"):void 0},tt=function(t){return t!=w?t==H?$WC.template.replace(TemplateUtil.getSearchBtn(),{purpose:"newsearch",$content:"globalsearch.trynew"}):"":c?void 0:J()};let et=e=>{var a;if(s||(d=1),s=e.length>0,i=e.length>0?e:null,window.Config.isConversationHistoryFilterEnabled()&&!l){var n=g.attr("type"),o="muted"!=n?n:void 0,r=!$("#hideAllMutedChats")[0].checked&&void 0;a="muted"==n||r}clearTimeout(t),u.html(TemplateUtil.getLoaderHtml());var c={type:o,historyType:l?M:I,muted:a,title:e,successcallback:function(t){ConversationsList.updateConversationsDB(t.data.chats||[]),ConversationsHistoryUI.populate(t.data.chats)}};c=dt(c),l&&(c.currentPageCount=s?d:1,c.searchVal=e,c.successcallback=Z,c=Nt(c),c=Ut(c),p=!0),s||(d=1),t=setTimeout((function(){ChatHistoryData.getAll(c)}),400)},st=()=>{if(l)return;u.html(TemplateUtil.getLoaderHtml());var t=g.attr("type");$("#checkbox").attr("disabled","muted"==t);var e=$("#hideAllMutedChats")[0].checked,s=!e&&void 0;Settings.updateHideMutedConversations(e);var i="muted"==t||s;t="muted"!=t?t:void 0;let a={title:v.val().trim(),type:t,muted:i,successcallback:function(t){Y(t)}};a=dt(a),c=!!(t||a.fromTime||a.toSentMsgTime),ChatHistoryData.getAll(a),G()},it=t=>{""!=v.val().trim()&&v.focus();var e=t.parent(),s=t.attr("type")||null,i=t.text();e.find(".sel_status").removeClass("sel sel_status"),t.addClass("sel sel_status"),g.attr("type",s),g.find("#filtertxt").text(i)},at=()=>{ZCScroll.customScroll(u),m.on("click","[purpose]",(function(e){let s=$(this),i=s.attr("purpose");if("chathistoryrow"===i)ConversationsHistoryUI.viewChat(s,e),e.stopPropagation();else if("initiateDirectMessage"===i)QuickChat.createwin(void 0,"directmessagewin"),e.stopPropagation();else if("viewFilter"===i)ConversationsHistoryUI.viewFilterOptions(),e.stopPropagation();else if("applyFilter"===i)Lt(),it(s),st();else if("hideMutedChats"==i)st();else if("markAllAsRead"===i)(()=>{var e=B();Chat.markAllChatsRead("",e),clearTimeout(t),u.html(TemplateUtil.getLoaderHtml());var s=g.attr("type"),i="muted"!=s?s:void 0,a=!$("#hideAllMutedChats")[0].checked&&void 0,n="muted"==s||a;t=setTimeout((function(){ChatHistoryData.getAll({type:i,muted:n,successcallback:function(t){Y(t),G()}})}),400)})();else if("newsearch"==i)v.val("").focus(),et(""),d=1,S=!0;else if("hideSearch"==i)m.find(W).removeClass("active zcl-search-focus"),v.val().length>0&&(v.val(""),Tt());else{if("clearSearch"==i)return v.val().length>0&&Tt(),void e.preventDefault();if("showSearchInput"==i)Clickoutside.clear(D),ht();else if("showCalendarOptions"==i){if("removeDateFilter"==e.target.getAttribute("data-action"))return pt(),void(l?ct():st());HistoryModule.showCalendarOptions(s,e,m)}else if("pickDate"==i)HistoryModule.showCalendar(s,e,m);else{if("clearSelctedUser"==i)return ot(e),kt(),ct(),void e.stopPropagation();if("showSentMessageOptions"==i){if("removeUserAndChatsFilters"==e.target.getAttribute("data-action"))return rt(),ct(),void Clickoutside.handleClickOnChild(e);if("removeChats"==e.target.getAttribute("data-action"))return lt(e),xt(),ct(),void e.stopPropagation();Clickoutside.handleClickOnChild(e),Clickoutside.clear(E);var a={srcid:A,event:e,destid:E,customShow:function(){y&&(m.find("#sentmsg"+y).addClass("active"),m.find(V).addClass("dN")),m.find(k).removeClass("hide").addClass("active")},customHide:function(){m.find(k).removeClass("active").addClass("hide")},closeOnClickSrc:!0};Clickoutside.bind(a)}else if("showUsersSelctionDrpDwn"==i){if(e.stopPropagation(),!e.target.hasAttribute("purpose")&&!e.target.hasAttribute("data-action"))return;if(e.target.hasAttribute("data-action"))return void Dt(e);(t=>{_&&m.find("#sentmsg"+_).removeClass("active").find("#"+_+"list").html(""),_=t.target.getAttribute("data-searchtype");let e=$WC.template.replace(MediaListingTemplates.getHtml("addParticipantsHTML"),{$searchpholder:ConversationsHistoryUI.isSentMsgSearchInChats()?"history.searchin.usersandchats":"history.searchin.users",$add:"sticky.calender.apply",search_entity:MediaDomIDS.ADD_PARTICIPANT_SEARCH,purpose:"saveAddedParticipants"}),s=m.find(k);SearchField.clearSearchField(MediaDomIDS.ADD_PARTICIPANT_SEARCH),s.find("#"+_+"list").html(e),Clickoutside.clear(MediaDomIDS.ADD_PARTICIPANT_SEARCH),SearchField.init(MediaDomIDS.ADD_PARTICIPANT_SEARCH),m.find("#sentmsg"+_).addClass("active"),ZCScroll.customScroll($("#"+MediaDomIDS.ADD_PARTICIPANT_LIST),!0);var i={srcid:"sentmsg"+t.target.id,destid:MediaDomIDS.ADD_PARTICIPANT_SEARCH,event:t,customShow:function(t){SearchField.clearSearchField(MediaDomIDS.ADD_PARTICIPANT_SEARCH);let e=m.find("#sentmsg"+_).find("#"+MediaDomIDS.ADD_PARTICIPANT_SEARCH);var s=_==O?C:f;MediaListingEvents.addParticipants.getSelectedParticipantsAndInit(e,!0,l,s),e.show(),e.find("#"+MediaDomIDS.ADD_PARTICIPANT_SRCHFLD).focus()},customHide:function(t){let e=m.find("#sentmsg"+_).find("#"+MediaDomIDS.ADD_PARTICIPANT_SEARCH);m.find("#sentmsg"+_).removeClass("active"),e.hide()}};Clickoutside.bind(i)})(e)}else"calenderAreaClick"==i&&"applyCustomDateFilter"==e.target.getAttribute("data-action")&&(Clickoutside.handleClickOnChild(e),l?nt():(HistoryModule.showDateInUI(m),st()))}}})),u.on("scroll",(function(){if(e&&ZCScroll.isScrollNearBottom(this,150)){let t=$(this);if(0===t.find("#loadmore").length){ConversationsHistoryUI.currloadingcount++;let e=TemplateUtil.getListMoreLoader();t.append(e),ConversationsHistoryUI.loadMore()}}})),u.on("click","a",(function(t){t.preventDefault()})),v.on("focus",(function(t){wt()})),v.on("keyup",(function(t){ConversationsHistoryUI.handleSearch($(this),t)})),m.find("#transcriptcontainer").on("click","[purpose='deletechatrows']",(function(){let t=u.find(".sel").attr("chid");$Util.showChatDeleteAlert((function(){ConversationsHistoryUI.deleteChats(t),Mt($("#transcriptcontainer")),StorageManager.clearByChid(t)}))})),m.find("#transcriptcontainer").on("click","[purpose='transcriptoptions']",(function(t){if("transcriptclose"===this.id)Clickoutside.handleClickOnChild(t),l&&$t();else if(Config.isSentMessageHistoryEnabled()&&l){if("printtranscript"==this.id)return void HistoryUI.handleTranscriptoptions(this);Chat.jumpToConversation(this.getAttribute("chid"),!0,void 0,r,o),HistoryUI.handleContinue(),ConversationsHistoryUI.currenttranscript=null}else HistoryUI.handleTranscriptoptions(this)}))};var nt=function(){HistoryModule.showDateInUI(m),u.html(TemplateUtil.getLoaderHtml());var t={historyType:M,searchVal:i,successcallback:Z,pageCount:1};t=dt(t),t=Ut(t),t=Nt(t),c=!0,p=!0,d=1,ChatHistoryData.getAll(t)},lt=function(t){var e=t.target.getAttribute("data-chid");C=C.filter(t=>t!==e)},ot=function(t){var e=t.target.getAttribute("data-uid");f=f.filter(t=>t!==e)},rt=function(){f=[],C=[],m.find("#sentmsg"+y).removeClass("active").find("#"+y+"list").html(""),y="",m.find(V).removeClass("dN"),xt(),kt(),c=!1},dt=function(t){return Object.assign(t,HistoryModule.getDateFilter())},ct=function(){var t={historyType:M,searchVal:i,successcallback:Z,currentPageCount:1};p=!0,d=1,t=dt(t),t=Nt(t),(t=Ut(t)).to||t.inChats||t.fromTime||t.toSentMsgTime?c=!0:(c=!1,d=1),u.html(TemplateUtil.getLoaderHtml()),ChatHistoryData.getAll(t)},pt=()=>{HistoryModule.removeDateFilter(m),d=1};let ht=function(){Clickoutside.bind({srcid:R,destid:D,doNotClose:function(){return S?(S=!1,!0):""!==m.find(z)[0].value},customShow:function(t){m.find(W).addClass("active zcl-search-focus"),m.find(z).select()},customHide:function(t){m.find(W).removeClass("active zcl-search-focus")}})},mt=t=>{let e,s="",i=ConversationTemplates.getItemHtml();l&&(e=1==d?void 0:h);for(let a of t)s+=ut(a.lmtime,e),s+=vt(a,i),e=a.lmtime,l&&(h=e);return s},ut=(t,e)=>{let s=window.Config.isConversationHistoryFilterEnabled();return void 0!==e&&$Date.isSameDay(t,e)||!s?"":`<div class="date-divider" zc_running_title date-divider="${t}">${$Date.date(t)}</div>`},vt=(t,e)=>{let s,i=gt(t),a=i.chid,n=ConversationsList.get(a)||{},l=i.img_html,o=ConversationsList.isOnetoOneChat(a);if(n.ctype===$zcg.THREADCHAT){var r=ConversationsList.getTitle(a,n.title);l=HistoryUI.getRecipantsPhoto($WC.Util.isEmpty(n.participants)?{}:JSON.parse(n.participants),n.participantscount,Chat.parseAddinfo(n.addinfo),r,n.ctype,a,n.customgroup)}if(o){s=ConversationsList.getRecipientDatafor121chat(a).zuid}return e=$WC.template.replace(e,{chat_title:i.threadChatTitle||i.title,chat_id:i.chid,lm_time:i.lmtime,is_channel:i.is_channel,is_deleted:i.is_deleted,is_removed:i.is_removed,thread_chat_title:i.threadChatTitle||"",unread_param:i.isunread?"unread":"",custom_class:i.customclass,chatAndTimeAttr:i.chid+i.lmtime,lastEntryTime:`data-lastEntryTime=${t.lmtime}`}),$WC.template.replace(e,{img_html:l,user_tag:Users.getTag(s),last_mtime:i.lastmsgtime,last_msg_info:i.lastmsghtml,thread_badge:i.threadChatBadge||""},"InSecureHTML")},gt=t=>{let e=_t(t),s=t.chatid,i=new $CliqChatId(s),a=ConversationsList.hasUnread(s),n=t.chat_type==$zcg.THREADCHAT,o=ConversationsList.getLastMsgInChat(s,t.lastmsginfo);o=ConversationsList.parseLastMsgInfo(s,o);let r=t.lmtime;o.time&&o.time>r&&(r=o.time);let d={};i.isChat()&&2==t.pcount&&(Users.getName(o.sender,o.dname)==t.title&&(d.senderhtml=""));let c=t.title;if(MyBots.isBotChid(s)){var p=MyBots.getObjectByChid(s);void 0!==p&&(c=p.name)}if(i.isChannel()){let t=ConversationsList.getTitle(s);t&&(c=t)}let h={chid:s,img_html:e,isunread:a,lastmsghtml:ConversationsList.getLastMsgHTML(s,o,c,d),lastmsgtime:$Date.daytime(r),lmtime:r,title:c,customclass:"",is_channel:i.isChannel(),is_deleted:void 0!==t.deleted?t.deleted:0,is_removed:void 0!==t.removed?t.removed:0};if(n){var m=ConversationsList.isClosedThread(s);h.title=ConversationsList.getTitle(t.parent_chat_id,t.parent_chat_title),h.threadChatTitle=ConversationsList.getTitle(s,t.title),h.threadChatBadge=ConversationTemplates.getThreadChatBadge(h.title,m),m&&(h.customclass="closedthreadlist")}return Config.isSentMessageHistoryEnabled()&&l&&(h.lastmsghtml=ft(t),h.isunread=!1),h};var ft=function(t){var e,{sender:s,sendername:i,message:a,messagetype:n}=t;e=s&&i?Users.getName(s,i):b;var l=MsgUtil.getSearchedMessageData(t);l=Smiley.replace(l),l=MsgUtil.getDisplayableSilentUserMentionMsg(l),l=Smiley.convertAnimatedTo24(l),l=Ct(l),l=yt(l,t);var o=ConversationTemplates.getSentMsgTemplate();if("3"==n||"20"==n)var r=Resource.getRealValue("chat.att.shared",[e||b]);return $WC.template.replace(o,{userName:e?`${e}:`:"",message:l,fileMsg:r,uid:t.msguid,hideMsgClass:r?"dN":"",hideFileClass:a?"dN":""},"InSecureHTML")},Ct=function(t){if(v){var e=v.val();if(e.length>2){var s=new RegExp(e,"i");return t=t.replace(s,`<b>${e}</b>`)}}return t},yt=function(t,e){if(MsgUtil.isMentionMsg(t)){var s=Template.MentionHTML;return t=MsgTemplate.getDisplayableMention(e,t,s)}return t};let _t=t=>{let e="",{chat_type:s,chatid:i,pcount:a,customgroup:n,title:l,recipants:o}=t;if(s==$zcg.NO_OPERATIONCHAT){return`<img class="wh100 bdrR100" src="${MyBots.getImgByChid(i)}">`}if(s==$zcg.THREADCHAT)return $WC.Util.isEmpty(ConversationsList.getPhotoId(t.parent_chat_id))?`<div class="wh100 bdrR100 chnnel-icn-img msi-sc${ConversationsList.getScope(t.parent_chat_id)} msci flexM"></div>`:`<img class="wh100 bdrR100" src="${ConversationsList.getImgUrlByChid(t.parent_chat_id)}">`;if(s==$zcg.ORGCHANNEL){let t=ConversationsList.getPhotoId(i),e=ConversationsList.getScope(i);if($WC.Util.isEmpty(t))return`<div class="wh100 bdrR100 chnnel-icn-img msi-sc${e} msci flexM"></div>`;return`<img class="wh100 bdrR100" src="${ConversationsList.getImgUrlByChid(i)||ChannelsRHS.getImageByPhotoId(t,e,50,void 0,void 0,!0)}">`}if(o="string"==typeof o?JSON.parse(o):o,!$.isEmptyObject(o)){let t=$WC.Util.isEmpty(a)?0:parseInt(a);if(t>1)if(t>2||n)e=St(l);else for(let t of o)WmsImpl.isLocalUser(t.zuid)||(e=`<img elemtype="user" hover="true" uid="${t.zuid}" class="wh100 bdrR100 cur" title="${Users.getName(t.zuid,t.dname)}" src="${Users.getImgUrlById(t.zuid)}">`)}return $WC.Util.isEmpty(e)&&(e=St(l)),e},St=t=>{let e=$WC.Util.decodeHTMLEntities(t).match(/[~!@$%^&*()-+=\;:"'>.<,\/?\[\]\{\}\w]/g);return`<div class="wh100 bdrR100 default-ch-img text-transC"><span>${e?e[0]:"-"}</span></div>`},Tt=e=>{clearTimeout(t),v.val(""),et("")},Lt=()=>{var t=$("#convohistoryoptcont"),e=$("#convohistoryoptions");t.is(":visible")||Clickoutside.clear(t[0].id),e.removeClass("hide"),t.addClass("active"),Clickoutside.bind({srcid:t[0].id,event:event,destid:e[0].id,customHide:function(){e.addClass("hide"),t.removeClass("active")}})},Mt=t=>{Clickoutside.clear("transcriptcontainer"),$(t).hide(),$(t).html(""),ChatUI.removeTranscriptView(ConversationsHistoryUI.currenttranscript),Config.isSentMessageHistoryEnabled()&&l&&(ConversationsHistoryUI.currenttranscript=null)};var It=function(t){Config.isDetachedCwinIntegrationEnabled()&&ConversationsHistoryUI.currenttranscript!==t&&wt()},wt=function(){if(ConversationsHistoryUI.currentchat){m&&m.find("#transcriptcontainer").removeClass("transit-anime");var t=ChatUI.getWin(ConversationsHistoryUI.currentchat);t&&t.closeWindow()}},Ht=function(){m&&m.find("#trans"+ConversationsHistoryUI.currentchat).removeClass("sel"),ConversationsHistoryUI.currentchat=null,ConversationsHistoryUI.isCwinOpen=!1},bt=function(t){Clickoutside.closeAll();var e=t.detachedChatContainer;e.removeClass("hst-rht").addClass("zc-dcontainer zc-detachedcwin chtwndws"),e.show().animate({left:"52%"}),e.html(TemplateUtil.getLoaderHtml()),At(t)},At=function(t){var e=t.detachedChatContainer,s=(t.time,t.chid);ConversationsHistoryUI.currentchat=s,DetachedCwin.create(s).then(t=>{e.html(t),e.find("#"+s).addClass("flex wh100").css({width:""}).show(),ChannelTabsUI.switchToMessagesTab(s),ConversationsHistoryUI.isCwinOpen=!0,u&&u.find("#trans"+s).removeAttr("unread").removeAttr("unseen"),Et(),ChatUI.showMsgTimeOnChatWindowOpened(),ChatUI.getWin(s).focus()})},Et=function(){ChatUI.getWin(ConversationsHistoryUI.currentchat).onBeforeCloseCB=Ht},$t=function(){m.find("[data-chidandtime="+ConversationsHistoryUI.currenttranscript+r+"]").removeClass("sel")};let Ot=t=>{if(t.chid!==ConversationsHistoryUI.currenttranscript)return;let e=m.find("#transcriptcontainer"),s='<span id="transcriptclose" purpose="transcriptoptions" class="msi-close cclose"></span>'+$Util.emptyStateHtml({imageclass:"error_img",title:I18N("history.chat.error"),fontsize:"18"});e.html(s)},Rt=t=>{var e=t.chid;if(e!==ConversationsHistoryUI.currenttranscript||!StorageManager.isExist(e,t.id))return;let s=m.find("#transcriptcontainer");var i=!1;if(StorageManager.getStorage(e,t.id).getList().isEmpty()){var a=$Util.emptyStateHtml({imageclass:"no_chats",title:I18N("channel.conv.none.chat"),fontsize:"18"});s.find("#currenttranscript").html(a),i=!0}var n=u.find("#trans"+e);n.removeAttr("unread").removeAttr("unseen");var o=new $CliqChatId(e),d=!o.isChannel()&&!ConversationsList.isThreadChat(e);a=(o.isChannel()?'<div class="zcflt_btn btn-anim"><div id="continuechat" chid="'+e+'" purpose="transcriptoptions" class="zcl-btn zcl-btn--primary" style="min-width: 140px; padding: 0px 20px;">'+Resource.getRealValue("common.continue")+"</div></div>":0===parseInt(n.attr("removed"))&&0===parseInt(n.attr("deleted"))?'<div class="zcflt_btn btn-anim"><div id="continuechat" chid="'+e+'" purpose="transcriptoptions" class="zcl-btn zcl-btn--primary" style="min-width: 140px; padding: 0px 20px;">'+Resource.getRealValue("common.continue")+"</div></div>":"")+(i?"":'<div id="printtranscript" purpose="transcriptoptions" chid="'+e+'" title="'+Resource.getRealValue("common.print")+'" class="msi-print clrb cur mrgL10 font16 zchsicn"></div>')+(d?'<div purpose="deletechatrows" chid="'+e+'" title="'+Resource.getRealValue("common.delete")+'" class="msi-ppdel clrb cur font16 mrgL10 zchsicn"></div>':"")+"</div>";s.find("#transcriptheader").append(a),$Util.animateBtnTransView(s),Config.isSentMessageHistoryEnabled()&&l?ChatUI.scrollToMsgInTranscriptView(e,null,r):ChatUI.markChatReadFromTranscriptView(t)},Dt=t=>{let e=$(t.target),s=e.attr("data-action");if("removeSelectedUser"===s)ot(t),MediaListingEvents.handleClickEventDelegation[s](e,t);else if("removeChats"==s){lt(t);MediaListingEvents.handleClickEventDelegation.removeSelectedUser(e,t)}else"saveAddedParticipants"===s&&(O==_?(xt(),y="chats",f=[]):(kt(),y="users",C=[]),t.stopPropagation(),Ft(),m.find("#"+y+"list").html(""),ct())};var Ut=function(t){return f.length>0&&(t.to=f.join(",")),t},Nt=function(t){return ConversationsHistoryUI.isSentMsgSearchInChats()&&C.length>0&&(t.inChats=C.join(",")),t};let Pt=function(){m.find(V).removeClass("dN"),m.find("#sentmsg"+y).removeClass("active"),y=""},kt=()=>{var t=m.find(x);if(f.length>0){y="users";var e=CallsHistoryUI.getSelectedUserHTML(f);t.find(F).html(e)}else if(0==C.length&&0==f.length){var s=`<span>${I18N("common.all")}</span>`;t.find(F).html(s),Pt(),HistoryModule.currentDateFilter||(c=!1)}},xt=function(){var t=m.find(x);if(C.length>0){y="chats";var e=zt();t.find(F).html(e)}else if(0==C.length&&0==f.length){var s=`<span>${I18N("common.all")}</span>`;t.find(F).html(s),Pt(),HistoryModule.currentDateFilter||(c=!1)}};var zt=function(t){for(var e="",s=0;s<C.length;s++){if(3==s&&!t){e+='<div id="sharedByNames" title="" class="dIB zcricnt posl ml-selcontactcnt textC zcchatcount">'+(C.length-s)+"+</div>";break}var i=C[s],a=RemindersUtil.getChatDetails(i),n=ConversationsList.get(i),l=HistoryUI.getRecipantsPhoto(n.recipants,n.pcount,n.addinfo,n.title,n.ctype,i,n.customgroup);a.footerImgHTML=l,a.removeHTML=ConversationTemplates.getChatRemoveTemplate(i);var o=a.name||"";e+=$WC.template.replace(ConversationTemplates.getSelectedFilterImages(i,o),a,"InSecureHTML")}return e},Ft=function(){m.find(k).addClass("hide"),m.find(x).removeClass("active"),m.find("#"+MediaDomIDS.ADD_PARTICIPANT_SEARCH).hide()};return{loadmore:e,currenttranscript:n,currloadingcount:a,autoloadingcount:10,construct:(t,e)=>{e=e||{};L(),u&&u.html("");var a=e.type==M?M:I;Config.isSentMessageHistoryEnabled()&&a==M&&(u&&u.html(""),l=!0);let n=ConversationTemplates.getContainerHtml(a),o=TemplateUtil.getLoaderHtml(),r=window.Config.isConversationHistoryFilterEnabled();var d=1!=Settings.canHideMutedConversations()&&void 0;if(n=$WC.template.replace(n,{container_content:o,start_btn:J()},"InSecureHTML"),LhsNavigation.updateRHSView(n),m=$("#conversation_history_view"),u=$("#historychats_listview"),v=l?m.find(z):$("#chat-history-search-field"),r&&(g=$("#convohistoryoptcont"),$("#historychats_listview").addClass("pTB35")),l&&(g.addClass("dN"),xt(),kt()),HistoryModule.resetDateFilter(),"threadchats"==t&&r)K(t);else{var c={historyType:a,muted:d,successcallback:t=>{ConversationsList.updateConversationsDB(t.data.chats||[]),ConversationsHistoryUI.populate(t.data.chats)},failurecallback:t=>ConversationsHistoryUI.handleError(t)};l?ct():ChatHistoryData.getAll(c)}v.focus(),l?($(N).addClass("chatsel").siblings().removeClass("chatsel"),m.find(P).addClass("dN"),i=null,s=!1):$('[purpose="showConvoHistory"]').addClass("chatsel").siblings().removeClass("chatsel"),window.Config.isConversationHistoryFilterEnabled()&&G(),at()},populate:(t,s)=>{let i,a=m.find("[chid]").length;u.find("#loadmore").remove();let n=window.Config.isConversationHistoryFilterEnabled();if(!function(t){return"Conversation"==HistoryModule.defaultActiveTab&&t==M||"SentHistory"==HistoryModule.defaultActiveTab&&t!==M}(s)&&!(l&&s!=M||!l&&s==M))if(l&&1==d&&(a=!1),t.length)i=mt(t),!a&&n&&(i='<div id="sticky_date_item" class="date-divider w100 sticky-date-cnt" zc_sticky_title></div><div>'+i+"</div>"),a?u.append(i):u.html(i),!a&&n&&$Util.initializeStickyTitle($("#conversation_history_view")),e=!$WC.Util.isEmpty(i);else if(e=!1,!a){if(l){var o=X(),r=Q(o),c=`<div class=${o}></div>`,p=tt(o);return void u.html(TemplateUtil.noCategoryResult(r,c,p))}var h=ConversationTemplates.getNoDataHtml(v.val());u.html(h)}},handleError:()=>{$("#callslist_container").html(TemplateUtil.getApiFailureHtml())},loadMore:()=>{if(p)return;e=!1;let t=u.find("[lmtime]").last();if(!t.length)return;let s=parseInt(t.attr("data-lastEntryTime"))-1;var a;if(window.Config.isConversationHistoryFilterEnabled()&&!l){var n=g.attr("type"),o="muted"!=n?n:void 0,r=!$("#hideAllMutedChats")[0].checked&&void 0;a="muted"==n||r}var c={title:v.val()?v.val().trim():"",type:o,historyType:l?M:I,totime:s,muted:a,successcallback:function(t){ConversationsList.updateConversationsDB(t.data.chats||[]),ConversationsHistoryUI.populate(t.data.chats)}};c=dt(c),l&&(d+=1,c.currentPageCount=d,c.searchVal=i,c.successcallback=Z,c=Nt(c),p=!0),ChatHistoryData.getAll(c)},handleSearch:(t,e)=>{let a=t.val().trim();if(a.length<3)i&&(d=1,et(""),i=null);else{var n=e.which;38===n||40===n?u.hasOnlyChildrenlike("chat_id")&&(t=DropdownUtil.handleListNavigation(e,u,"[chat_id]")):27===n||s&&0===a.length?(a.length&&Tt(t),e.stopImmediatePropagation()):a.length>=3&&i!==a&&(d=1,et(a))}},viewChat:(t,e)=>{Config.isDetachedCwinIntegrationEnabled()||"none"!==$("#transcriptcontainer").css("display")||Clickoutside.bind({destid:"transcriptcontainer",customShow:function(t){$("#"+t.destid).show().animate({left:"52%"},500)},doNotClose:function(){return ImgViewer.isVisible()||0==$("#conversation_history_view").length||MediaPlayer.isPipModeActive()},customHide:function(t){MainUI.handleIframes("chathistory"),$("#"+t.destid).animate({left:"100%"},500,(function(){Mt($(this))}))}});let s=t.attr("chid");var i=t.attr("lmtime"),a=m.find("#transcriptcontainer");if(Config.isDetachedCwinIntegrationEnabled()){It(s);var n,d=!1;t.addClass("sel"),!ConversationsHistoryUI.currentchat&&a.length>0&&(d=!0,a.remove()),(0==a.length||d)&&(m.find("#historychats_listview").after(Template.TransriptOverlay.replace(/{CHID}/g,s)),n=m.find("#transcriptcontainer"));var c={time:i,detachedChatContainer:n=n||a,chid:s};if(ConversationsHistoryUI.currentchat===s&&!d)return;LazyLoader.loadDetachedCwinFiles().then(()=>{wt(),bt(c)})}else{if(Config.isSentMessageHistoryEnabled()&&l){$t();i=t.attr("lmtime");if(o=t.find("#msgsender").attr("uid"),r=i,ConversationsHistoryUI.currenttranscript==s)return t.addClass("sel"),void ChatUI.scrollToMsgInTranscriptView(s,null,i)}if(ConversationsHistoryUI.currenttranscript===s&&!ChatUI.isTranscriptEmpty(s))return;ChatUI.removeTranscriptView(ConversationsHistoryUI.currenttranscript);let e=m.find("#transcriptcontainer");l?$t():m.find("#trans"+ConversationsHistoryUI.currenttranscript).removeClass("sel"),t.addClass("sel"),ConversationsHistoryUI.currenttranscript=s;let a,n=m.find("#trans"+s);a=ConversationsList.isThreadChat(s)||chatIdVsCtype.get(s)==$zcg.THREADCHAT?m.find("#transtitle"+s).children()[1].title:m.find("#transtitle"+s).children().first().text().trim(),n.removeAttr("unread");let d=n.attr("threadchattitle")||"",c=$WC.template.replace(Template.transcriptViewHeader+Template.transcriptView,{title:a,chid:s});c=$WC.template.replace(c,{threadchattitle:d?ThreadChatUtils.getThreadTitleForTransHeader(d,ConversationsList.isClosedThread(s)):""},"InSecureHTML"),e.html(c),e=e.find("#currenttranscript");var p={chid:s,totime:$Util.getSyncedCurrentTime(),lineslimit:Chat.LINESLIMIT,container:e};ChatUI.getTranscriptView(p).then(Rt,Ot)}},deleteChats:function(t){t.length<=0||$ZCAjx.ajax({url:"/deleteselectedchat.do",type:"POST",data:{chid:t},success:function(){var e=t.split(",")[0];u.find("#trans"+e).remove(),l&&u.find("[chid="+e+"]").remove(),ChatUI.isExist(e)&&!$WC.Util.isEmpty(ConversationsList.getCategory(e))&&(ChatUI.removeWindow(e),ConversationsList.delete(e)),-1!==e.indexOf(ConversationsHistoryUI.currenttranscript)&&(ChatUI.removeTranscriptView(ConversationsHistoryUI.currenttranscript),ConversationsHistoryUI.currenttranscript=null)}})},viewFilterOptions:Lt,isSentHistory:()=>l,isSentMsgSearchInChats:()=>O==_,updateSelectedUsersList:t=>f.push(t),updateSelectedChatsList:t=>C.push(t),getImageOfFilterChats:zt,getSelectedChatsList:()=>C,getSelectedUsersList:()=>f,isSentHistoryInViewPort:function(){return!!$("#conversation_history_view").length},getLastMsgHTML:ft,getImageHTML:_t,constructSentHistoryUI:function(){var t,e,s,i,a="USERS",n="CHATS",l=20,o="msg-container-empty",r="search_empty",d=JSON.parse(sessionStorage.getItem("sentmessages")),c={uniqueid:"sentmessages",headerParams:{pageInfo:{icon:"zcf-senthistory",title:I18N("history.sentmessages")},buttonOptions:{name:I18N("common.chat.start"),action:"initiateDirectMessage"}},searchParams:{searchInExpandMode:!0,searchInputPlaceHolder:I18N("history.sentmsg.placeholder"),clearPlaceHolder:I18N("common.clear")},dropDownParams:{dropDownFilterOptions:(t=null!=d?d.dropDown:"",e=t?t.type:"",s=t?t.value:"",i=[{name:I18N("common.all"),id:"alltypes",action:"resetToAll",selected:!0,type:"ALL"},{name:I18N("history.sentmsg.to"),id:"sentusers",action:"openUserList",icon:"zcf-rightArrow",type:a},{name:I18N("history.sentmsg.in"),id:"sentchats",action:"openChatsList",icon:"zcf-rightArrow",type:n}],e&&0!=s.length?i.map(t=>e==t.type?$.extend(t,{searchType:e,value:s}):t):i)},dateFilterParams:{dateFilterOptions:function(){var t=[{name:I18N("history.filter.beforesentmsg"),id:"beforedatefilter"},{name:I18N("history.filter.aftersentmsg"),id:"afterdatefilter"},{name:I18N("history.filter.onsentmsg"),id:"ondatefilter"}],e=null!=d?d.date:"";return e&&"object"==typeof e?t.map(t=>e.filterName==t.id?$.extend(t,{selected:!0,value:e.date}):t):t}()},checkBoxParams:{checkBoxOptions:{name:I18N("common.mentions"),action:"showMentions",key:"hasMention",id:"sentmessagefollowup"}},listDataParams:{action:"viewChat"},emptyStateParams:{defaultEmpty:{name:I18N("history.sentmsgs.none"),className:o,button:{name:I18N("common.chat.start"),action:"initiateDirectMessage",template:TemplateUtil.getLhsLongBtn()}},searchEmpty:{name:I18N("history.sentmsgs.search.none"),className:r,button:{name:I18N("globalsearch.trynew"),action:"clearSearch",template:HistoryTemplate.searchBtn}},filterEmpty:{name:I18N("history.filter.none"),className:r}},apiParams:{url:"/v1/messagesearch",payload:{from:$zcg._ZUID,lim:20,raw_search_input:"from: @Me ",includeallowedchannels:!1},getApiParamsCB:function(t){return function(t){var e={},{searchText:s,date:i,dropDown:l={}}=t;s&&s.length>0&&(e.message=t.searchText);var o=l.type,r=l.value||[];if(o==a&&r.length>0&&(e.to=r.join(",")),o==n&&r.length>0&&(e.in=r.join(",")),i){var d=i.filterName,c=new Date(parseInt(i.date));"afterdatefilter"==d?e.fromtime=new Date(c).setHours(23,59,59,999):"beforedatefilter"==d?e.totime=new Date(c-864e5).setHours(23,59,59,999):"ondatefilter"==d&&(e.fromtime=new Date(c).setHours(0,0,0,0),e.totime=new Date(c).setHours(23,59,59,999))}return t.hasMention&&(e.hasMention=!0),e}(t)}},isGroupView:!0,getMockResponse:function(t){var e=t.messages;return e?(e.length>l&&e.pop(),e.forEach((function(t,s){e[s].chatid=t.chid,e[s].lastmessagetime=t.time,e[s].title=t.ctitle?t.ctitle:" ",e[s].chat_type=t.ctype,e[s].recipants=[],ConversationsList.isOnetoOneChat(t.chid)&&(e[s].recipants="string"==typeof t.recipientssumm?JSON.parse(t.recipientssumm):t.recipientssumm)})),ConversationsList.updateConversationsDB(e),e):[]}};if(null!=d&&Object.keys(d).length>0){var p={date:d.date,dropDown:d.dropDown};!function(t){if(void 0!==t.dropDown&&null!==t.dropDown){var e=t.dropDown||{},s=e.type||"",i=e.value||[];HistoryViewUtils.setSelectedType(void 0,s),HistoryViewUtils.setFilteredList(s,i)}}(p),$.extend(c,{filterParams:p})}T=new HistoryViewController(c),LhsNavigation.updateRHSView(T.getHTML()),$(N).addClass("chatsel").siblings().removeClass("chatsel")},getSentMsgHistoryControllerInstance:()=>T,isCwinOpen:!1,currentchat:n,reinitConstants:L}}(),CallHistoryData=function(){let t=()=>HistoryModule[HistoryModule.defaultActiveTab.toLowerCase()+"_obj"],e=e=>{let s={},i=t(),a=i&&i.params,{successcallback:n=$.noop,failurecallback:l=$.noop,type:o,call_category:r,load_type:d,user_id:c,from:p,to:h}=e,m=void 0===i&&"loadMore"!==d;void 0!==c?c.split(",").length>1?(s.recipient_ids=c,m=m||a&&i.params.recipient_ids!==c):(s.recipient_id=c,m=m||a&&i.params.recipient_id!==c):m=m||a&&void 0!==i.params.recipient_id,m=m||a&&i.params.filter!==r,"direct_call"===e.type&&"missed"===e.call_category&&CallHistoryStorage.getMissedCallsCount()>0&&($.isEmptyObject(CallsHistoryUI.getFilterDetails())||CallHistoryStorage.setMissedCallsCount(0),m=!0,delete s.recipient_id,delete s.recipient_ids,$("#callhistoryheadercont").replaceWith(CallHistoryTemplates.getCallHistoryHeader()),CallsHistoryUI.clearFilter()),void 0!==e.from||void 0!==e.to?(e.from&&(m=m||a&&i.params.from!==e.from,s.from=p),e.to&&(m=m||a&&i.params.to!==e.to,s.to=h)):m=(m=m||a&&void 0!==i.params.from)||a&&void 0!==i.params.to,m&&(s.type=o,$WC.Util.isEmpty(r)||(s.filter=r),i=((t,e,s)=>{var i=20,a=$("#callhistory_listview").innerHeight();if(void 0!==a&&0!==a&&""!==a){i=Math.floor(a/60)+5}let n=HistoryModule[t+"_obj"]=new CliqListView(t,e,s,{},i,!0,!1,!0);return n.resetListView(),n})(HistoryModule.defaultActiveTab.toLowerCase(),"/api/v2/mediasessions",s)),"loadMore"===d?i.loadMore(n,l):i.load(n,l)},s={};return{updateLastViewedTime:()=>{MediaAPI.getConferenceAjaxWrapper()({url:"/api/v2/settings/calls",type:"PUT",contentType:"application/json",data:{clear_missed_121_calls:!0}})},getAll:t=>{Object.assign(t,CallsHistoryUI.getFilterDetails()),Object.assign(t,HistoryModule.getDateFilter()),t.call_type===HistoryModule.Constants.DIRECTCALLS?(t.type="direct_call","all"===t.call_category&&delete t.call_category):t.call_type===HistoryModule.Constants.MEETINGS?(t.type="audio_conference,video_conference",t.call_category="viewed"):t.call_type===HistoryModule.Constants.BROADCASTS?(t.type="handshake,assembly",t.call_category="viewed"):CallsHistoryUI.isLiveEventCallType(t.call_type)&&(t.type="live_event",t.call_category="viewed"),e(t)},getSummary:()=>{var t=t=>{let e=t.data["121_missed_calls_count"];void 0===e&&(e=t.data.count),CallHistoryStorage.setMissedCallsCount(e);let s=t.data["121_last_viewed_time"];void 0===s&&(s=t.data.viewed_time),CallHistoryStorage.setViewedTime(s),CallsHistoryUI.updateCounter(CallHistoryStorage.getMissedCallsCount())};if(!UserStates.isMissedCallFetchNeeded()){var e=$DB.get("one2one_missed_call_info");return e=$Util.cloneObject(e),void t(e)}MediaAPI.getConferenceAjaxWrapper()({url:"/api/v2/mediasessions/summary",success:e=>{t(e),CallHistoryData.updateSessionStorageWithLmtime()}})},incrementMissedCallsCount:()=>{var t=CallHistoryStorage.getMissedCallsCount();CallsHistoryUI.updateCounter(++t),CallHistoryStorage.setMissedCallsCount(t)},getMissed121CallsLastViewedTime:()=>CallHistoryStorage.getViewedTime(),updateSessionStorageWithLmtime:()=>{var t=$DB.get("one2one_missed_call_info");void 0===t&&(t={});var e=UserStates.getMissedCallLMTime();void 0!==e&&(t.lm_time=e,$DB.update("one2one_missed_call_info",t))},clearCallCounter:()=>{CallHistoryStorage.getMissedCallsCount()&&CallHistoryData.updateLastViewedTime(),$.isEmptyObject(CallsHistoryUI.getFilterDetails())&&CallHistoryStorage.setMissedCallsCount(0),CallHistoryStorage.setViewedTime(Date.now()),CallsHistoryUI.clearCounter()},syncOngoingCalls:()=>{MediaAPI.getConferenceAjaxWrapper()({url:"/api/v2/mediasessions",data:{filter:"live"},success:t=>{s={};for(var e=0;e<t.data.length;e++){var i=t.data[e];s[i.nrs_id||i.session_id]=i}CallsHistoryUI.populateOngoingCalls(s)}})},addOngoingCall:t=>{t.unread=!WmsImpl.isLocalUser(t.host.id);var e=MediaUtil.isLiveEvent(t.type)?t.session_id:t.nrs_id;s[e]=t,CallsHistoryUI.populateOngoingCalls(s),t.chat&&t.chat.id&&MediaManager.updateGroupCallOptionsInChatHeader(t.chat.id)},removeOngoingCall:t=>{var e=s[t];delete s[t],CallsHistoryUI.populateOngoingCalls(s),$WC.$Win.destroy(t+"_transfer_group_call"),e&&e.chat&&e.chat.id&&MediaManager.updateGroupCallOptionsInChatHeader(e.chat.id)},addOngoingDirectCall:t=>{var e=WmsImpl.isLocalUser(t.caller_id);t.title=e?t.callee_name:t.caller_name;var i=!0;"undefined"!=typeof MediaCallImpl&&MediaCallImpl.hasCurrentSession()&&(i=MediaCallImpl.getCurrentSession().getId()!==t.session_id),t.unread=i,s[t.session_id]=t,CallsHistoryUI.populateOngoingCalls(s)},removeOngoingDirectCall:t=>{delete s[t],CallsHistoryUI.populateOngoingCalls(s)},getOngoingCalls:()=>s,markOngoingCallsAsViewed:()=>{var t=!1;for(var e in s)if(s[e].unread){t=!0;break}t&&MediaAPI.getConferenceAjaxWrapper()({url:"/api/v2/mediasessions/clearongoing",type:"PUT",success:()=>{for(var t in s)s[t].unread=!1}})},markOngoingCallAsViewed:t=>{var e=s[t];e&&(e.unread=!1);var i=0;for(var t in s)s[t].unread&&i++;$("#ongoing-calls-lhs-anim").toggleClass("active",i>0)},getOngoingCallForChat:t=>{for(var e in s){var i=s[e];if(i.chat&&i.chat.id===t)return i}},getChatForOngoingCall:t=>{var e=s[t];if(e&&e.chat)return e.chat.id},getSessionByNRSId:(t,e)=>{MediaAPI.getConferenceAjaxWrapper()({url:"/api/v2/mediasessions/"+t,type:"GET",success:t=>{e(t)}})},updateOnGoingCallTitleByNrsId:(t,e)=>{var i=s[t];i&&(i.title=e,$("#ongoing-calls-list").find("[conference_id="+t+"]").find("[title_content]").text(e))},fetchRecordings:(t,e,s)=>{var i;i=t===ZCMediaConstants.callRecordingTypes.AUDIO_CONFERENCE||t===ZCMediaConstants.callRecordingTypes.VIDEO_CONFERENCE?"/api/v2/conferences/"+e+"/recordings":t===ZCMediaConstants.callRecordingTypes.ASSEMBLY?"/api/v2/primetimes/"+e+"/recordings":MediaCall.isDirectCall(t)?"/api/v2/calls/"+e+"/recordings":t===ZCMediaConstants.callRecordingTypes.LIVE_EVENT?"/api/v2/liveevents/"+e+"/recordings":"/api/v2/mediasessions/"+e+"/recordings",MediaAPI.getConferenceAjaxWrapper()({url:i,success:t=>{s(t.data)},error:t=>{let e=$("#callhistory-preview-container");if(e.length){let s=$WC.template.replace(HuddleWidgetHandler.recordingEmptyStateHtml,{desc:t.message});e.html(s)}else UI.updateBanner(t.message,3e3,!0)}})},fetchWhiteboards:(t,e,s)=>{var i;i=t===ZCMediaConstants.callRecordingTypes.AUDIO_CONFERENCE||t===ZCMediaConstants.callRecordingTypes.VIDEO_CONFERENCE?"conferences":"mediasessions",MediaAPI.getConferenceAjaxWrapper()({url:"/api/v2/"+i+"/"+e+"/whiteboards",success:t=>{s(t.data)},error:t=>{let e=$("#callhistory-preview-container");if(e.length){let s=$WC.template.replace(HuddleWidgetHandler.recordingEmptyStateHtml,{desc:t.message});e.html(s)}else UI.updateBanner(t.message,3e3,!0)}})},fetchPresentations:(t,e,s,i)=>{var a;a=t===ZCMediaConstants.callRecordingTypes.AUDIO_CONFERENCE||t===ZCMediaConstants.callRecordingTypes.VIDEO_CONFERENCE?"conferences":"mediasessions",MediaAPI.getConferenceAjaxWrapper()({url:"/api/v2/"+a+"/"+e+"/presentations",data:{session_key:s},success:t=>{i(t.data)},error:t=>{let e=$("#callhistory-preview-container");if(e.length){let s=$WC.template.replace(HuddleWidgetHandler.recordingEmptyStateHtml,{desc:t.message});e.html(s)}else UI.updateBanner(t.message,3e3,!0)}})},getCurrentListViewObj:t,downloadParticipantAttendance:t=>{let e="/v2/mediasessions/"+t+"/participants/attendance",s=$("#download_attendance_btn_"+t);s.find("[download_icon]").addClass("dN"),$Util.Button.addLoadIconForAjax(s),MediaAPI.getConferenceAjaxWrapper()({url:e,success:()=>{$(document.createElement("a")).attr({href:e}).get(0).click(),$Util.Button.showCompletionAndResetContent(s,!1,()=>{s.find("[download_icon]").removeClass("dN")})}})},loadParticipantsListView:(t,e,s,i)=>{let a;if(e){let e=25,n=$("#callhistory-preview-container").innerHeight();if(void 0!==n&&0!==n&&""!==n){e=Math.floor(n/60)+5}let l={host:!1,cohost:!1,members:!1,invitees:!1};CallHistoryData.participantsListViewSync=!0,(a=CallHistoryData.participantsListView=new CliqListView("call_participants","/api/v2/mediasessions/"+t+"/participants",{},{"X-API-VERSION":1},e,!1,!1,!0)).resetListView(),a.headerAdded=l,a.load(s,i)}else a=CallHistoryData.participantsListView,!CallHistoryData.participantsListViewSync&&a.hasLoadMore()&&($("#callhistory-preview-container").after(TemplateUtil.getListMoreLoader()),CallHistoryData.participantsListViewSync=!0,a.loadMore(s,i));return a}}}();var CallHistoryStorage=function(){let t={count:0,viewed_time:void 0},e=()=>{var e=$DB.get("one2one_missed_call_info");void 0===e&&(e={}),e.data=t,$DB.update("one2one_missed_call_info",e)};return{getMissedCallsCount:()=>t.count,getViewedTime:()=>t.viewed_time,setMissedCallsCount:s=>{t.count=s,e()},setViewedTime:s=>{t.viewed_time=s,e()}}}();let CallsHistoryUIHandler=function(){return{handleClick:t=>{},handleKeyUp:t=>{var e=$(this);"chat-history-search-field"==e.id&&CallsHistoryUI.handleSearch(e,e.val().trim(),t)},handleScroll:t=>{if(CallsHistoryUI.loadmore&&ZCScroll.isScrollNearBottom(this,150)){let t=$(this);if(0===t.find("#loadmore").length){let e=TemplateUtil.getListMoreLoader();t.append(e),CallsHistoryUI.loadMore()}}}}}(),CallHistoryTemplates=function(){"use strict";let t={dateItem:'<div class="date-hdr-item">\n\t\t\t\t\t<div class="font13 fontB clr-lp1">{{day_string}}</div>\n\t\t\t\t</div>',directCallItem:'<div caller_id="{{session_id}}" class="flexC callhistory-item {{missed_cls}}" {{unread}} item_time={{start_time}}>\n\t\t\t\t\t<div class="fshrink mR16">\n\t\t\t\t\t\t<div class="font10 {{call_status_icn}} {{txt_clr}}"></div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class="flexG flexC">\n\t\t\t\t\t\t<div class="pR30 fshrink ellips flexC" style="width: 30%;">\n\t\t\t\t\t\t\t<div class="posrel caller-img fshrink">\n\t\t\t\t\t\t\t\t<img class="wh100 bdrR100" src="{{caller_img_url}}"/>\n\t\t\t\t\t\t\t\t<div class="call-type call-status flexM font10"><span class="{{call_type_icn}}"></span></div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<div class="pL20 font14 fontB clr-M ellips {{txt_clr}}">{{caller_name}}</div>\n\t\t\t\t\t\t\t{{user_tag}}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class="flexC"  style="width: 30%;">\n\t\t\t\t\t\t\t<div class="time-info flexC font13 fshrink">\n\t\t\t\t\t\t\t\t<div class="clr-S">{{time_info}}</div>\n\t\t\t\t\t\t\t\t<div class="mL6 clr-lp1 ital {{txt_clr}}">{{duration_info}}</div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class="flexM" style="width: 10%">{{related_entities_html}}</div>\n\t\t\t\t\t\t<div class="callhistory-item-actns textR dN" style="width: 30%;">\n\t\t\t\t\t\t\t<div purpose="triggerAudioCall" uid="{{user_id}}" class="zcl-btn-xs zcl-btn--secondary mL24 {{audio_call_cls}}"><span class="zcl-btn-icn zcf-call mR0"></span></div>\n\t\t\t\t\t\t\t<div purpose="triggerVideoCall" uid="{{user_id}}" class="zcl-btn-xs zcl-btn--secondary mL24 {{video_call_cls}}"><span class="zcl-btn-icn zcf-video mR0"></span></div>\n\t\t\t\t\t\t\t<div purpose="triggerChat" uid="{{user_id}}" class="zcl-btn-xs zcl-btn--secondary mL24"><span class="zcl-btn-icn zcf-chat mR0"></span></div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>',directCallUserProfileInfo:'<div caller_id="{{session_id}}" uid="{{user_id}}" class="flexC callhistory-item {{missed_cls}}" item_time={{start_time}}>\n\t\t\t\t\t<div class="fshrink mR25">\n\t\t\t\t\t\t<div class="font10 {{call_status_icn}} {{txt_clr}}"></div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class="flexG flexC">\n\t\t\t\t\t\t<div class="pR30 fshrink ellips flexC {{txt_clr}}" style="width: 40%;">\n\t\t\t\t\t\t\t<div class="flexM font14 pR5 mT2"><span class="{{call_type_icn}}"></span></div>\n\t\t\t\t\t\t\t<div class="fontB font14">{{call_receive_type_txt}}</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class="flexC"  style="width: 40%;">\n\t\t\t\t\t\t\t<div class="time-info flexC font13 fshrink">\n\t\t\t\t\t\t\t\t<div class="clr-S">{{time_info}}</div>\n\t\t\t\t\t\t\t\t<div class="mL6 clr-lp1 ital {{txt_clr}}">{{duration_info}}</div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class="flexM dN" style="width: 30%">{{related_entities_html}}</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>',groupCallItem:`<div caller_id="{{call_id}}" class="flexC callhistory-item" chid="{{chat_id}}" scope="{{scope}}" uid="{{call_id}}" purpose="viewCallParticipants">\n\t\t\t\t\t<div class="flexG flexC">\n\t\t\t\t\t\t<div class="pR30 fshrink ellips flexC " style="width: 40%;">\n\t\t\t\t\t\t\t<div class="posrel caller-img group-caller-img">\n\t\t\t\t\t\t\t\t{{caller_img_url}}\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<div class="pL20 flex fdirC ellips">\n\t\t\t\t\t\t\t\t<div class="flexC">\n\t\t\t\t\t\t\t\t\t<div class="font14 fontB clr-M ellips">{{call_name}}</div>\n\t\t\t\t\t\t\t\t\t<div class="mL5 type-token flexM">{{type_txt}}</div>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t<div class="font13 clr-lp1 ellips mT4 ital">{{part_cnt}}</div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class="flexC" style="width: 20%;">\n\t\t\t\t\t\t\t<div class="time-info flexC font13 fshrink">\n\t\t\t\t\t\t\t\t<div class="clr-S">{{time_info}}</div>\n\t\t\t\t\t\t\t\t<div class="mL6 clr-lp1 ital">{{duration_info}}</div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class="flexM" style="width: 15%">{{related_entities_html}}</div>\n\t\t\t\t\t\t<div class="callhistory-item-actns textR dB" style="width: 25%;">\n\t\t\t\t\t\t\t<div purpose="goToGroupCallChat" chid="{{chat_id}}" scope="{{scope}}" class="zcl-btn-xs zcl-btn--secondary mL24 {{visibility_cls}}"><span class="zcl-btn-icn zcf-chat mR0"></span></div>\n\t\t\t\t\t\t\t<div purpose="groupCallFromhistory" uid="{{call_id}}" scope="{{scope}}" class="zcl-btn-xs zcl-btn--secondary mL24">\n\t\t\t\t\t\t\t\t<span class="zcf-video-conf zcl-btn-icn"></span><span class="ellips" title="${I18N("common.start.again")}">${I18N("common.start.again")}</span>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>`,historyHeader:'<div class="w100 flexC justifySB">\n        \t\t\t<div class="flexG flexC">\n\t        \t\t\t<div class="flexC fshrink" style="line-height: 1;">\n\t        \t\t\t\t<div class="{{hdr_icon}}  module-icn clr-icon"></div>\n\t        \t\t\t\t<div class="font16 clr-H fontB" style="margin-bottom: 2px;">{{hdr_txt}}</div>\n\t        \t\t\t</div>\n\t        \t\t\t{{category_filters}}\n        \t\t\t</div>\n        \t\t\t<div class="fshrink">{{start_btn}}</div>\n        \t\t</div>',mainContainer:'<div id="callhistory_view" class="wh100 flex fdirC ovrflwH" call_type="{{callhistory_type}}">\n\t        \t\t<div class="main-container-header {{container_class}} fshrink">\n\t        \t\t\t{{container_header}}\n\t        \t\t</div>\n\t        \t\t{{callhistory_header}}\n\t        \t\t<div id="callhistory_listview" zc_sticky_title_list class="flexG ovrflwA callhistory-container pT35 pB35">\n\t        \t\t\t{{container_content}}\n\t        \t\t</div>\n\t        \t</div>',lhsOngoingCalls:'<div id="ongoing-calls-lhs" class="remote-notify-box-wrap">\n\t\t\t\t    <div id="ongoing-calls-lhs-anim" action="showList" class="remote-notify-box flexC {{active_class}}">\n\t\t\t\t\t    <em class="zcf-video-conf font16 mR10"></em>\n\t\t\t\t\t    <span class="flexG fontB ellips">\n\t\t\t\t\t    \t<span id="ongoing-call-txt">{{ongoing_call_txt}}</span> \n\t\t\t\t\t    </span>\n\t\t\t\t\t    <em class="zcf-pointer font8 mLR10"></em>\n\t\t\t\t\t    <em action="close" class="zcf-close remote-notify-box_close flexM"></em>\n\t\t\t\t\t</div>\n\t\t\t\t</div>',lhsOngoingCallItem:`<div class="flexC remote-notify-list {{call_type_class}}" call_id="{{call_id}}">\n\t\t\t\t\t<div class="flexG ovrflwH">\n\t\t\t\t\t\t<div class="flexC ellips">\n\t\t\t\t\t\t\t{{chatTitleHtml}}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class="flexC">\n\t\t\t\t\t\t\t<div class="fshrink mR12">\n\t\t\t\t\t\t\t\t<div class="zcl-img"><img src="{{host_img}}"></div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<div>\n\t\t\t\t\t\t\t\t<div class="flexC flexG mT6" title_content>\n\t\t\t\t\t\t\t\t\t{{device_icon}}\n\t\t\t\t\t\t\t\t\t<span class="font16 fontB line26">{{title}}</span>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t<div class="mT4 font13 flexC remote-notify-host">\n\t\t\t\t\t\t\t\t\t<span class="flexG">\n\t\t\t\t\t\t\t\t\t\t<span class="clr-lp1">${I18N("media.host")} : </span>\n\t\t\t\t\t\t\t\t\t\t{{host}}\n\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class="flexC mT10">\n\t\t\t\t\t\t\t<div class="remote-notify-call-join-btn zcl-btn-xs zcl-btn--primary" call_id="{{call_id}}" {{join_attribute}}>\n\t\t\t\t\t\t\t\t<span class="{{icon_class}} mR6"></span>\n\t\t\t\t\t\t\t\t{{button_text}}\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t{{unsupported_info}}\n\t\t\t\t\t\t\t<div class="mLA">\n\t\t\t\t\t\t\t\t<span class="fshrink font13 media-onair">\n\t\t\t\t\t\t\t\t\t<span id="ongoing-{{id}}" start_time="{{start_time}}"></span>\n\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>`,listViewDivider:'<div class="zcl-hor-divider mTB16 posrel">\n\t\t\t\t\t<span class="remote-notify-list-type">{{category_name}}</span>\n\t\t\t\t</div>',rhsPreview:`<div id="callhistory_details_container" ms_id="{{id}}" class="callhistory-rhs flex-col">\n\t\t\t\t   <div class="callhistory-rhs-head flexC fshrink">\n\t\t\t\t      <div class="flexG fontB">{{call_info}}</div>\n\t\t\t\t      <em purpose="closePreview" class="zcf-close p10 font12 clr-icon cur fontB"></em>\n\t\t\t\t   </div>\n\t\t\t\t   <div class="zc-callinfo-subheader flexC fshrink">\n\t\t\t\t\t\t<div class="fshrink mR16 zcl-img xl">{{img_html}}</div>\n\t\t\t\t\t\t<div class="font14 flexG">\n\t\t\t\t\t\t\t<div class="fontB">{{title}}</div>\n\t\t\t\t\t\t\t<div class="clr-S mT10">{{participants_count}}</div>\n\t\t\t\t\t\t\t<div class="clr-S mT10">{{start_time}}</div>\n\t\t\t\t\t\t\t<div class="clr-S mT10">{{duration}}</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t   </div>\n\t\t\t\t   <div class="callhistory-rhs-tab fshrink">\n\t\t\t\t      <div class="zcl-hor-tab">\n\t\t\t\t         <div class="zcl-hor-tab-item {{member_class}} {{member_sel}}" purpose="viewCallParticipants">{{members}}</div>\n\t\t\t\t         <div class="zcl-hor-tab-item {{recording_class}}" purpose="showRecordings">{{recordings}}</div>\n\t\t\t\t         <div class="zcl-hor-tab-item {{whiteboard_class}}" purpose="showWhiteboards">{{whiteboards}}</div>\n\t\t\t\t         <div class="zcl-hor-tab-item {{presentation_class}}" purpose="showPresentations">{{presentations}}</div>\n\t\t\t\t      </div>\n\t\t\t\t   </div>\n\t\t\t\t   \n\t\t\t\t   <div id="callhistory-preview-container" class="callhistory-rhs-main flexG ovrflwA">{{loader_html}}</div>\n\t\t\t\t   <div id="download_attendance_{{nrs_id}}" class="fshrink mLR30 pTB26 dN" call_id="{{nrs_id}}" purpose="downloadAttendanceList">\n\t\t\t\t\t\t<div id="download_attendance_btn_{{nrs_id}}" class="zcl-btn-xs zcl-btn--secondary"><span download_icon class="zcf-download mR6 clr-icon2"></span>${I18N("calls.download.attendance")}</div>\n\t\t\t\t   </div>\n\t\t\t\t</div>`,callHistoryHeader:`<div id="callhistoryheadercont" class="callhistory-header mL4 fjustifySB">\n\t\t\t\t\t<div class="fontB font14 ml16 clr-H">{{header}}</div>\n\t\t\t\t\t<div class="flexC">\n\n\t\t\t\t\t\t<div id="callhistoryoptcont" class="drpdwn-input flexC callhis-filter mlsharedby fshrink drpdwn-wrp mT1" purpose="showCallHistoryOptns">\n\t\t\t\t\t\t\t<div class="flexC">\n\t\t\t\t\t\t\t\t<div class="clr-lp1 font13 clr6">${I18N("common.logsof")}:</div>\n\t\t\t\t\t\t\t\t<div class="mL8 flexC">\n\t\t\t\t\t\t\t\t\t<div id="filter_txt" class="selectedusers clr-H font13">{{all_calls}}</div>\n\t\t\t\t\t\t\t\t\t<em class="mL8 clr-icon zcf-downArrow font10 mT1"></em>\n\t\t\t\t\t\t\t\t\t<div id="callhistoryopts" class="zcl-menu-wrap posa no-pointer hide">\n\t\t\t\t\t\t\t\t\t\t<div class="zcl-menu-item justifySB" purpose="selectAllUsers">{{all_calls}}<em id="allsel" class="clrG msi-tick p5"></em>\n\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t<div id="channelFilter" class="zcl-menu-item jsutifySB" purpose="showUsersSelctionDrpDwn">{{calls_with}}<em class="zcf-rightArrow mL20"></em>\n\t\t\t\t\t\t\t\t\t\t\t<div id="addparticipants" class="ml-filter"></div>\n\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t{{dateFilterHTML}}\n\n\t\t\t\t\t</div>\n\t\t\t\t</div>`},e=e=>{var s="call.logs",i="call.allcalls",a="call.callswith";return e===HistoryModule.Constants.MEETINGS&&Conference.isNomenclatureEnabled()&&(s="meeting.logs",i="meeting.allmeetings",a="meeting.meetingswith"),$WC.template.replace(t.callHistoryHeader,{$header:s,$all_calls:i,$calls_with:a,dateFilterHTML:ConversationTemplates.getDateFilterHTML()},"InSecureHTML")},s=e=>{var s=HistoryModule.getModuleObject(e)[0];return $WC.template.replace(t.historyHeader,{$hdr_txt:s.name,hdr_icon:s.icon,category_filters:i(e)},"InSecureHTML")},i=t=>t===HistoryModule.Constants.DIRECTCALLS?`<div class="flexG flexM">\n\t    \t\t<div id="type_filters" class="flexM zcl-tab">\n\t    \t\t\t<div data-type="all" purpose="selectCallCategory" class="zcl-tab-item font14 fontB curP sel" data-selected="">${I18N("common.all")}</div>\n\t    \t\t\t<div data-type="missed" purpose="selectCallCategory" class=" zcl-tab-item  font14 fontB curP">${I18N("common.missed")}</div>\n\t    \t\t\t<div data-type="received" purpose="selectCallCategory" class=" zcl-tab-item  font14 fontB curP">${I18N("common.received")}</div>\n\t    \t\t</div>\n    \t\t</div>`:"";return{getItemHtml:(e,s)=>e===HistoryModule.Constants.DIRECTCALLS?"user_profile"===s?t.directCallUserProfileInfo:t.directCallItem:e===HistoryModule.Constants.MEETINGS||e===HistoryModule.Constants.BROADCASTS||e===HistoryModule.Constants.LIVE_EVENTS?t.groupCallItem:void 0,getContainerHtml:i=>$WC.template.replace(t.mainContainer,{container_class:i===HistoryModule.Constants.MEETINGS&&Conference.isNomenclatureEnabled()?"grp-call-sec-header":"ovrflwH",container_header:s(i),callhistory_type:i,callhistory_header:e(i)},"InSecureHTML"),getCallHistoryHeader:e,getOngoingCallsMainHTML:(e,s,i)=>$WC.template.replace(t.lhsOngoingCalls,{ongoing_call_txt:CallsHistoryUI.getLhsHeaderText(e,s),active_class:i>0?"active":""}),getOngoingCallsListHTML:e=>{var s=[];for(var i in e)s.push(e[i]);s=$Util.sort(s,"start_time",!0);var a="",n="",l="",o=MediaManager.getActiveMediaSessionId();s.sort((function(t,e){return o===(t.nrs_id||t.session_id)?-1:(e.nrs_id||e.session_id)==o?1:0}));for(var r=0;r<s.length;r++){var d=s[r],c=MediaUtil.isOneToOneCall(d.type),p=!c&&MediaUtil.isLiveEvent(d.type),h=c||p?d.session_id:d.nrs_id,m=c?d.caller_id:d.host.id,u=Users.getName(d.callee_id,d.callee_name),v=Users.getName(d.caller_id,d.caller_name),g=c?WmsImpl.isLocalUser(d.caller_id)?u:v:d.title,f=o===h,C=Users.getName(m,c?d.caller_name:d.host.name),y=void 0!==d.chat?d.chat:"",_="";y&&y.title&&(_=`<div class="zcl-alert-xs zcl-alert-info remote-notify-btn cur ellips mR12" chid="${y.id}" purpose="chatlink"><span class="ellips font13 fontN">${$WC.$CUtil.processXSS(y.title)}</span></div>`);var S="",T="joinPrimetime";c?(T="joinMediaCall",MediaUtil.isCallHandOffSupported(d.caller_client_support,d.callee_client_support)||(S=$WC.template.replace('<span class="zcf-failed AV-call-warning" title="{{info_text}}"></span>',{$info_text:"avcliq.mediacall.call.handoff.error"}))):p?T="joinLiveEvent":"audio_conference"!==d.type&&"video_conference"!==d.type||(T="joinConference");var L=$WC.template.replace(t.lhsOngoingCallItem,{device_icon:c?MediaTemplates.getDeviceInfoIndicationHtml(WmsImpl.isLocalUser(d.caller_id)?d.callee_client_type:d.caller_client_type):"",host:MsgUtil.getDisplayableSilentUserMentionMsg("["+$WC.$CUtil.processXSS(C)+"](zohoid:"+m+")"),chatTitleHtml:_,unsupported_info:S},"InSecureHTML"),M=$WC.template.replace(L,{title:g,id:d.session_id,start_time:d.start_time,call_id:h,call_type_class:c?"zc-av-direct-call":"",icon_class:f?"dN":"audio_conference"===d.type||"audio"===d.type?"zcf-call":"zcf-video",join_attribute:f||""!==S?"disabled":"action="+T,$button_text:f?"videobroadcast.joined":c?"common.transfer.here":"common.join",host_img:Users.getImgUrlById(m)});a+=M,c?n+=M:l+=M}return""!==n&&""!==l&&(a=$WC.template.replace(t.listViewDivider,{$category_name:"directcalls.title"})+n+$WC.template.replace(t.listViewDivider,{$category_name:"common.meetings"})+l),'<div id="ongoing-calls-list" class="zcl-popup remote-notify-popup" style="top: 141px;left: 6px; display: none;">'+a+"</div>"},getCallRHSPreviewHTML:(e,s)=>{var i=MediaUtil.isOneToOneCall(e.type);let a=WmsImpl.isLocalUser(e.caller_id),n=i?2:e.participant_count;var l=i?a?Users.getName(e.callee_id,e.callee_name):Users.getName(e.caller_id,e.caller_name):e.title,o=CallsHistoryUI.getGroupCallImage(i?[{id:a?e.callee_id:e.caller_id}]:e.participants?e.participants:[e.host]),r=$WC.template.replace(t.rhsPreview,{id:e.id,nrs_id:e.nrs_id,title:l,$call_info:"common.details",start_time:$Date.date(e.start_time,{withtime:!0}),participants_count:1==n?n+" "+I18N("module.participant").toLowerCase():n+" "+I18N("module.participants").toLowerCase(),duration:CallsHistoryUI.getDurationTime(e.end_time,e.start_time),$members:"channel.role.4",$recordings:"media.recordings",$whiteboards:"media.whiteboards",$presentations:"avcliq.media.presentations",member_sel:"members"===s?"sel":"",member_class:i?"dN":"",recording_class:e.recording?"recordings"===s?"sel":"":"dN",presentation_class:e.has_presentations?"presentations"===s?"sel":"":"dN",whiteboard_class:e.whiteboards?"whiteboards"===s?"sel":"":"dN"});return $WC.template.replace(r,{img_html:o,loader_html:TemplateUtil.getLoaderHtml()},"InSecureHTML")}}}(),CallsHistoryUI=function(){"use strict";let t,e,s,i=!1,a=!1,n="",l={},o=[],r=()=>{a=!1,i=!1,t=void 0,e=void 0},d={},c=t=>d[t],p=(t,e)=>{if(void 0!==e&&0!==e.length)for(let t of e){let e=t.id;d[e]=t}},h=t=>{$('[purpose="'+t+'"]').addClass("chatsel").siblings().removeClass("chatsel")},m=()=>{CallHistoryData.getAll({call_type:s,call_category:n,load_type:"load",successcallback:(t,e)=>{e.id===s.toLowerCase()&&CallsHistoryUI.populate(t),p(0,t)},failurecallback:t=>CallsHistoryUI.handleError(t)},s)};const u=()=>s===HistoryModule.Constants.DIRECTCALLS?"directcall-illus":s===HistoryModule.Constants.MEETINGS?"groupcall-illus":s===HistoryModule.Constants.BROADCASTS||s===HistoryModule.Constants.LIVE_EVENTS?"broadcast-illus":"";let v=()=>{if(s==HistoryModule.Constants.DIRECTCALLS){let t=CallsHistoryUI.getFilterDetails();if(!$.isEmptyObject(t)){let e=Users.getDisplayName(t.user_id)||"this user";return I18N("callhistory.121.empty."+n,[e,I18N("quickaction.header.calluserwin.audio.video")])}}else if(s===HistoryModule.Constants.BROADCASTS)return I18N("broadcast.empty");return I18N("callhistory.empty")},g=({call_items:t,ignoreExistingDate:e,source:i,type_in_view:a=s})=>{let n,l="",o=CallHistoryTemplates.getItemHtml(a,i);for(let s of t)l+=C(s.start_time,n,e),l+=f(s,o,a),n=s.start_time;return l},f=(t,e,s)=>s===HistoryModule.Constants.DIRECTCALLS?y(t,e):s===HistoryModule.Constants.MEETINGS||s===HistoryModule.Constants.BROADCASTS||s===HistoryModule.Constants.LIVE_EVENTS?S(t,e):"",C=(e,s,i)=>{if(void 0===s||!$Date.isSameDay(e,s)){const s=6048e5;var a=(new Date).getTime()-e<s;if(!i)return`<div class="date-divider" zc_running_title date-divider="${e}">${$Date.date(e,a?{withday:!0}:{})}</div>`;if(0==t.find('[date-divider="'+e+'"]').length)return`<div class="date-divider" zc_running_title date-divider="${e}">${$Date.date(e,a?{withday:!0}:{})}</div>`}return""},y=(t,e)=>{let s=WmsImpl.isLocalUser(t.caller_id),i="missed"===t.category?"clr-R":"",a="missed"===t.category?"missed-call":"",n=s?"zcf-dialled":"zcf-received",l="video"===t.type?"zcf-video3":"screen_with_media"===t.type?"zcf-sharescrn2":"zcf-call2",o=$Date.time(t.start_time),r=s?Users.getName(t.callee_id,t.callee_name):Users.getName(t.caller_id,t.caller_name),d=s?t.callee_id:t.caller_id,c=Users.getImgUrlById(d),p="";if("missed"===t.category){let e=CallHistoryData.getMissed121CallsLastViewedTime();e&&t.start_time>e&&(p="unread")}let h="",m="missed"===t.category?"missed.call":s?"common.outgoing":"common.incoming";return t.recording&&(h+=`<div purpose="showRecordings" nrs_id="{{call_id}}" uid="{{call_id}}" title="${I18N("common.viewrecordings")}" class="zc-circle-btn zcl-btn-xs zcl-btn--secondary mL24">\n\t\t\t\t<div class="flexIC">\n\t\t\t\t\t<span class="record-dot-icon alignselfC"></span>\n\t\t\t\t\t<span class="bold font8 clr-lp1">REC</span>\n\t\t\t\t</div>\n\t\t\t</div>`),NoteBookUtil.isIntegrationEnabledByAdmin()&&t.notes&&(h+=`<div purpose="showNotes" uid="{{call_id}}" title="${I18N("common.notes")}" class="zc-circle-btn zcl-btn-xs zcl-btn--secondary mL24">\n\t\t\t\t<span class="zcf-notebook"></span>\n\t\t\t</div>`),t.whiteboards&&(h+=_("showWhiteboards","media.whiteboards","zcf-whiteboard")),Conference.isPresentationsAllowed()&&t.has_presentations&&(h+=_("showPresentations","avcliq.media.view.presentations","zcf-presentation")),e=$WC.template.replace(e,{related_entities_html:h,user_tag:Users.getTag(d),$call_receive_type_txt:m,duration_info:"missed"===t.category?"":"("+M(t,s)+")"},"InSecureHTML"),$WC.template.replace(e,{call_id:t.id,session_id:t.session_id,txt_clr:i,missed_cls:a,unread:p,call_type_icn:l,call_status_icn:n,caller_name:r,caller_img_url:c,user_id:d,time_info:o,start_time:t.start_time,video_call_cls:MediaCall.isVideoCallAllowed()?"":"hide",audio_call_cls:MediaCall.isAudioCallAllowed()?"":"hide"})},_=(t,e,s)=>$WC.template.replace('<div purpose="{{purpose}}" nrs_id="{{nrs_id}}" uid="{{call_id}}" title="{{content}}" class="zc-circle-btn zcl-btn-xs zcl-btn--secondary mL24">\n\t\t\t\t\t\t\t\t\t\t<div class="flexIC">\n\t\t\t\t\t\t\t\t\t\t<span class="{{class_name}} alignselfC"></span>\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t</div>',{purpose:t,$content:e,class_name:s}),S=(t,e)=>{let s=$Date.time(t.start_time),i=t.participants?t.participants:[t.host],a=L(i),n=t.participant_count+" "+(t.participant_count>1?I18N("common.participants"):I18N("common.participant")),l=T(t.type),o=void 0===t.chat_id?"dN":"";var r="";return t.recording&&(r+=`<div purpose="showRecordings" nrs_id="{{nrs_id}}" uid="{{call_id}}" title="${I18N("common.viewrecordings")}" class="zc-circle-btn zcl-btn-xs zcl-btn--secondary mL24">\n\t\t\t\t<div class="flexIC">\n\t\t\t\t\t<span class="zcf-play font6 mR2"></span>\n\t\t\t\t\t<span class="bold font8 clr-lp1">REC</span>\n\t\t\t\t</div>\n\t\t\t</div>`),t.whiteboards&&(r+=_("showWhiteboards","whiteboard.view.boards","zcf-whiteboard")),Conference.isPresentationsAllowed()&&t.has_presentations&&(r+=_("showPresentations","avcliq.media.view.presentations","zcf-presentation")),NoteBookUtil.isIntegrationEnabledByAdmin()&&t.notes&&(r+=`<div purpose="showNotes" uid="{{call_id}}" title="${I18N("common.notes")}" class="zc-circle-btn zcl-btn-xs zcl-btn--secondary mL24">\n\t\t\t\t<span class="zcf-notebook"></span>\n\t\t\t</div>`),e=$WC.template.replace(e,{caller_img_url:a,related_entities_html:r,duration_info:"("+I18N("common.duration")+" "+I(t.end_time,t.start_time)+")"},"InSecureHTML"),$WC.template.replace(e,{call_id:t.id,call_name:t.title,time_info:s,chat_id:t.chat_id,part_cnt:n,scope:t.scope,type_txt:l,nrs_id:t.nrs_id,visibility_cls:o})},T=t=>{var e="primetime.assembly";return"audio_conference"===t?e=Conference.isNomenclatureEnabled()?"media.audio":"videochat.audiocall":"video_conference"===t?e=Conference.isNomenclatureEnabled()?"media.video":"videochat.videocall":"handshake"===t?e="primetime.handshake":"live_event"===t&&(e="liveevent.title"),I18N(e)},L=t=>{let e=t.length;return 1==e?`<img class="wh100 bdrR100 curP" src="${Users.getImgUrlById(""+t[0].id)}" uid="${t[0].id}" documentclick="viewprofileimage">`:2==e?`<div class="flex fdirC two-images">\n\t    \t\t\t\t<img class="img1" src="${Users.getImgUrlById(""+t[0].id)}">\n\t    \t\t\t\t<img src="${Users.getImgUrlById(""+t[1].id)}">\n\t    \t\t\t</div>`:3==e?`<div class="flex fdirC two-images">\n    \t\t\t\t\t<img class="img1" src="${Users.getImgUrlById(""+t[0].id)}">\n\t    \t\t\t\t<div class="flex flexS">\n\t\t    \t\t\t\t<img class="img2" src="${Users.getImgUrlById(""+t[1].id)}">\n\t\t    \t\t\t\t<img class="img3" src="${Users.getImgUrlById(""+t[2].id)}">\n\t\t    \t\t\t</div>\n\t    \t\t\t</div>`:e>=4?`<div class="flex fdirC two-images">\n\t    \t\t\t\t<div class="flex flexS">\n\t    \t\t\t\t\t<img class="img1 img2" src="${Users.getImgUrlById(""+t[0].id)}">\n\t    \t\t\t\t\t<img class="img1 img3" src="${Users.getImgUrlById(""+t[1].id)}">\n\t    \t\t\t\t</div>\n\t    \t\t\t\t<div class="flex flexS">\n\t    \t\t\t\t\t<img class="img2" src="${Users.getImgUrlById(""+t[2].id)}">\n\t    \t\t\t\t\t<img class="img3" src="${Users.getImgUrlById(""+t[3].id)}">\n\t    \t\t\t\t</div>\n    \t\t\t\t</div>`:imgs_html},M=(t,e)=>"missed"===t.category?"<b>"+I18N("missed.call")+"</b>":void 0===t.attend_time&&e?I18N("unanswered.call"):void 0===t.attend_time&&!e||t.attend_time&&t.end_time&&t.end_time-t.attend_time==0?I18N("cancelled.call"):!t.attend_time||t.end_time&&"-1"!==t.end_time?I18N("common.duration")+" "+I(t.end_time,t.attend_time):I18N("common.ongoing"),I=(t,e)=>{let s=t-e,i="";if(s>0){let t=Math.floor(s/1e3%60),e=Math.floor(s/6e4%60),a=Math.floor(s/36e5%24);i=a>0?a+":"+(e=e>9?e:"0"+e)+" hrs":e>0?e+":"+(t=t>9?t:"0"+t)+" mins":(t=t>9?t:"0"+t)+" secs"}return i},w=()=>{t.on("click","[purpose]",i=>{let a=$(i.currentTarget),n=a.attr("purpose");if("triggerAudioCall"===n)MediaCall.initiateStartCallProcess(MediaCallConstants.types.AUDIO,a.attr("uid"),void 0,"call_history"),i.stopImmediatePropagation();else if("triggerVideoCall"===n)MediaCall.initiateStartCallProcess(MediaCallConstants.types.VIDEO,a.attr("uid"),void 0,"call_history"),i.stopImmediatePropagation();else if("triggerChat"===n)ContactsList.reqForChat(a.attr("uid"),void 0,!0),LhsNavigation.removeRHSView(),i.stopImmediatePropagation();else if("groupCallFromhistory"===n)P(a.attr("uid")),i.stopImmediatePropagation();else if("goToGroupCallChat"===n)ConversationsList.attachContinueActiveChat(a.attr("chid")),LhsNavigation.removeRHSView(),i.stopImmediatePropagation();else if("showNotes"===n){i.stopImmediatePropagation();let t=a.attr("uid"),e=CallHistoryData.getCurrentListViewObj().getObject(t),s="",n="";HistoryModule.defaultActiveTab===HistoryModule.Constants.DIRECTCALLS?(s=e.session_id,n=WmsImpl.isLocalUser(e.caller_id)?Users.getName(e.callee_id,e.callee_name):Users.getName(e.caller_id,e.caller_name)):(s=e.nrs_id,n=e.title),NotebookIntegration.openRelatedNotes(s,n),NoteBookLHS.trackAction("OPEN_NOTE","HISTORY")}else if("downloadAttendanceList"===n){var l=a.attr("call_id");CallHistoryData.downloadParticipantAttendance(l)}else if("viewCallParticipants"===n||"showRecordings"===n||"showWhiteboards"===n||"showPresentations"===n){var o=a.attr("uid");void 0===o&&(o=a.parents("#callhistory_details_container").attr("ms_id"),a.parent().find(".sel").removeClass("sel"),a.addClass("sel"),$("#callhistory-preview-container").html(TemplateUtil.getLoaderHtml()));let t=c(o);var r=()=>{if("viewCallParticipants"===n)q(t);else if("showRecordings"===n){var e=$("#callhistory_details_container"),s="direct_call"===t.call_type||MediaUtil.isLiveEvent(t.type)?t.session_id:t.nrs_id;CallHistoryData.fetchRecordings(t.type,s,(function(s){if(e.find('[purpose="showRecordings"]').hasClass("sel")){var i=W(t,s);$("#callhistory-preview-container").html(i),V()}})),$("#download_attendance_"+s).addClass("dN")}else if("showWhiteboards"===n){e=$("#callhistory_details_container"),s="direct_call"===t.call_type?t.id:t.nrs_id;CallHistoryData.fetchWhiteboards(t.type,s,(function(s){if(e.find('[purpose="showWhiteboards"]').hasClass("sel")){var i=j(t,s);$("#callhistory-preview-container").html(i)}})),$("#download_attendance_"+s).addClass("dN")}else if("showPresentations"===n){e=$("#callhistory_details_container"),s="direct_call"===t.call_type?t.id:t.nrs_id;var i=t.session_id;CallHistoryData.fetchPresentations(t.type,s,i,(function(s){if(e.find('[purpose="showPresentations"]').hasClass("sel")){var i=B(t,s);$("#callhistory-preview-container").html(i)}})),$("#download_attendance_"+s).addClass("dN")}},d=$("#callhistory_details_container");if(d.length>0){if(d.attr("ms_id")===o)return void r();d.remove()}let e="viewCallParticipants"===n?"members":"showWhiteboards"===n?"whiteboards":"showPresentations"===n?"presentations":"recordings";$("#callhistory_listview").after(CallHistoryTemplates.getCallRHSPreviewHTML(t,e)),r(),Clickoutside.bind({destid:"callhistory_details_container",doNotClose:(t,e,s,i,a)=>!e&&(s&&$(s.target).parents("#wms_popout_mountpoint").length>0||a&&(a.startsWith("white_board")||a.startsWith("recording_dropdown_")||a.startsWith("download_attendance_btn_"))),customShow:()=>{$("#callhistory_details_container").css("display","flex")},customHide:()=>{$("#callhistory_details_container").remove()}}),i.stopImmediatePropagation()}else if("closePreview"===n)i.stopImmediatePropagation(),Clickoutside.handleClickOnChild(i,a);else if("initiateDMCalls"===n)QuickChat.createwin(void 0,"calluserwin"),i.stopImmediatePropagation();else if("initiateConference"===n)Conference.trigger(Conference.types.VIDEO,ZCMediaConstants.scopeTypes.PERSONAL,void 0,void 0,ZCMediaConstants.triggerSource.QUICK_ACTION,void 0),i.stopImmediatePropagation();else if("initiateBroadcast"===n)PrimeTime.trigger(ZCMediaConstants.triggerSource.QUICK_ACTION,PrimeTime.modes.ASSEMBLY,ZCMediaConstants.scopeTypes.ORG,void 0,void 0),i.stopImmediatePropagation();else if("scheduleOnlineMeeting"===n)i.stopPropagation(),SecurityManager.hasPermission(Modules.Events)&&EventsMain.UI.openLoadingWindow((function(){EventsUI.openCreateWin(!1,void 0,(function(){EventsRHSCUWidget.handle.makeOnlineEvent()}))}),!0);else if("startQuickAudioConference"===n)i.stopPropagation(),Conference.trigger(Conference.types.AUDIO,ZCMediaConstants.scopeTypes.PERSONAL,void 0,Conference.getAdhocDefaultTitle(),ZCMediaConstants.triggerSource.CALL_HISTORY,{isQuickStart:!0});else if("startQuickVideoConference"===n)i.stopPropagation(),Conference.trigger(Conference.types.VIDEO,ZCMediaConstants.scopeTypes.PERSONAL,void 0,Conference.getAdhocDefaultTitle(),ZCMediaConstants.triggerSource.CALL_HISTORY,{isQuickStart:!0});else if("showOptionsDropDown"===n){var p=a.attr("id");Clickoutside.bind({srcid:p,destid:p+"_list",event:i,customShow:function(t){$("#"+t.srcid).addClass("active"),$("#"+t.destid).removeClass("hide")},customHide:function(t){$("#"+t.srcid).removeClass("active"),$("#"+t.destid).addClass("hide")}})}else if("selectCallCategory"===n){if(!$(a).hasClass("sel")){let t=a.attr("data-type");a.siblings().removeClass("sel").removeAttr("data-selected"),a.addClass("sel").attr("data-selected",""),N(t)}}else if(null!==i.target.getAttribute("recording_dropdown_menu"))i.stopImmediatePropagation(),MediaListingUI.handleRecordingMoreOptions(i,a[0]);else if("viewRecording"===n){if(null!=i.target.parentNode.getAttribute("rec_options"))return;i.stopImmediatePropagation(),ZCTrack.track("RECORDING_PLAYED",{TRIGGER:"CALL_HISTORY"});let t=c(a.attr("uid")),e={};("true"==a.attr("video")?SecurityManager.hasPermission(Modules.GroupVideoCall,MActions.DownloadRecordings):SecurityManager.hasPermission(Modules.GroupAudioCall,MActions.DownloadRecordings))||(e.hidedownloadicon=!0),MediaRecordingPlayer.open(t,a.parent().attr("ref_index"),a.attr("rec_name"),void 0,"true"==a.attr("video"),e)}else if("downloadRecording"===n)i.stopImmediatePropagation(),Conference.handleDownloadRecording(a.attr("index"),a.attr("nrs_id"));else if("showCallHistoryOptns"===n)H(i);else if("showUsersSelctionDrpDwn"===n){if(i.stopPropagation(),!i.target.hasAttribute("purpose")&&!i.target.hasAttribute("data-action"))return;i.target.hasAttribute("data-action")?E(i):b(i)}else if("selectAllUsers"===n)A(!0);else if("clearSelctedUser"===n)i.stopPropagation(),s===HistoryModule.Constants.DIRECTCALLS?A(!0):Y(a);else if("showCalendarOptions"==n){if(i.stopPropagation(),"removeDateFilter"==i.target.getAttribute("data-action"))return HistoryModule.removeDateFilter(t),e.html(TemplateUtil.getLoaderHtml()),void m();HistoryModule.showCalendarOptions(a,i,t)}else"pickDate"===n?(i.stopPropagation(),HistoryModule.showCalendar(a,i,t)):"calenderAreaClick"==n&&"applyCustomDateFilter"==i.target.getAttribute("data-action")&&(Clickoutside.handleClickOnChild(i),HistoryModule.showDateInUI(t),e.html(TemplateUtil.getLoaderHtml()),m())}),e.on("scroll",(function(){if(i&&ZCScroll.isScrollNearBottom(this,150)){let t=$(this);if(0===t.find("#loadmore").length){let e=TemplateUtil.getListMoreLoader();t.append(e),CallsHistoryUI.loadMore()}}}))},H=t=>{let e=$("#callhistoryopts"),s=$("#callhistoryoptcont");e.is(":visible")||Clickoutside.clear(e[0].id),e.addClass("show").removeClass("hide"),s.addClass("active"),Clickoutside.bind({srcid:s[0].id,event:t,destid:e[0].id,customHide:function(){e.addClass("hide").removeClass("show"),s.removeClass("active")}})},b=t=>{let e=$WC.template.replace(MediaListingTemplates.getHtml("addParticipantsHTML"),{$searchpholder:"quickchat.node.placeholder",$add:"sticky.calender.apply",search_entity:MediaDomIDS.ADD_PARTICIPANT_SEARCH,purpose:"saveAddedParticipants"});$("#callhistoryopts").find("#addparticipants").html(e),SearchField.init(MediaDomIDS.ADD_PARTICIPANT_SEARCH),$("#channelFilter").addClass("active"),ZCScroll.customScroll($("#"+MediaDomIDS.ADD_PARTICIPANT_LIST),!0),Clickoutside.bind({srcid:"channelFilter",destid:MediaDomIDS.ADD_PARTICIPANT_SEARCH,event:t,customShow:function(t){SearchField.clearSearchField(MediaDomIDS.ADD_PARTICIPANT_SEARCH);let e=$("#"+MediaDomIDS.ADD_PARTICIPANT_SEARCH);e.show(),MediaListingEvents.addParticipants.getSelectedParticipantsAndInit(e,!0),e.find("#"+MediaDomIDS.ADD_PARTICIPANT_SRCHFLD).focus()},customHide:function(t){let e=$("#"+MediaDomIDS.ADD_PARTICIPANT_SEARCH);$("#channelFilter").removeClass("active"),e.hide()}})},A=t=>{let e=$("#"+MediaDomIDS.ADD_PARTICIPANT_SELECTION).children(),i=e.length,a=[],n="",l={},r=$("#callhistoryoptcont");if(i&&!t){if(s===HistoryModule.Constants.DIRECTCALLS&&i>1)a.push(e[1].getAttribute("uid"));else for(var d=0;d<i;d++){let t=$(e[d]).attr("uid");a.push(t)}n=O(a),r.find("#filter_txt").html(n),l={user_id:a.join()},D()}else{let t="call.allcalls";s===HistoryModule.Constants.MEETINGS&&(t="meeting.allmeetings"),r.find("#filter_txt").html(I18N(t)),U()}o.join()!==a.join()&&(G(l),Z(),o=a)},E=t=>{let e=$(t.target),s=e.attr("data-action");"removeSelectedUser"===s?MediaListingEvents.handleClickEventDelegation[s](e,t):"saveAddedParticipants"===s&&(A(),H(t))},O=t=>{let e="";for(var s=0;s<t.length;s++){let i=t[s],a=$.extend(RemindersUtil.getUserDetails(i),{remove_html:""});if(s>3){e+='<div id="sharedByNames" title="" class="dIB zcricnt posl ml-selcontactcnt textC">'+(t.length-4)+"+</div>";break}a.remove_html='<div class="msi-close posa dN cur" purpose="clearSelctedUser" data-uid='+i+"></div>",e+=$WC.template.replace(MediaListingTemplates.getHtml("imgNodeHTML"),a,"InSecureHTML")}return e},R=()=>{let t=CallsHistoryUI.getFilterDetails();if(!$.isEmptyObject(t)&&!$.isEmptyObject(t.user_id)){let e=O(t.user_id.split(","));$("#filter_txt").html(e),D()}},D=()=>{let t=$("#callhistoryoptcont");t.find("#allsel").addClass("dN"),t.find("#channelFilter").addClass("sel")},U=()=>{let t=$("#callhistoryoptcont");t.find("#allsel").removeClass("dN"),t.find("#channelFilter").removeClass("sel")},N=t=>{a=!1,i=!1,n=t,e.html(TemplateUtil.getLoaderHtml()),m()},P=t=>{let e=c(t);if("audio_conference"===e.type||"video_conference"===e.type){var s="audio_conference"===e.type?Conference.types.AUDIO:Conference.types.VIDEO;if(l=e.chat_id)Conference.trigger(s,ZCMediaConstants.scopeTypes.CHAT,l,Conference.getDefaultTitle(l,e.chat.title),ZCMediaConstants.triggerSource.CALL_HISTORY,{chatTitle:e.chat.title});else{var i=[],a={},n=e.participants;n&&n.length?(n.forEach((function(t){var e=""+t.id;e!==$zcg._ZUID&&(a[e]={name:t.name},i.push(e))})),Conference.trigger(s,ZCMediaConstants.scopeTypes.PERSONAL,i,void 0,ZCMediaConstants.triggerSource.CALL_HISTORY,{userDetails:a})):CallParticipantView.fetchParticipants(e.nrs_id,t=>{t.data.forEach((function(t){var e=""+t.id;e!==$zcg._ZUID&&(a[e]={name:t.name},i.push(e))})),Conference.trigger(s,ZCMediaConstants.scopeTypes.PERSONAL,i,void 0,ZCMediaConstants.triggerSource.CALL_HISTORY,{userDetails:a})})}}else if(MediaUtil.isLiveEvent(e.type)){(l=e.chat_id)&&Conference.triggerLiveEvent(ZCMediaConstants.scopeTypes.CHAT,l,e.title)}else{var l;if(l=e.chat_id)PrimeTime.trigger(ZCMediaConstants.triggerSource.REMOTE_WORK,PrimeTime.getMode(e.type),ZCMediaConstants.scopeTypes.CHAT,[l],{chatTitle:e.chat.title,broadcastTopic:e.title});else if("org"===e.scope)PrimeTime.trigger(ZCMediaConstants.triggerSource.REMOTE_WORK,PrimeTime.getMode(e.type),ZCMediaConstants.scopeTypes.ORG,void 0,void 0);else if(MediaManager.isTeamScope(e.scope)){var o=[],r={};e.teams.forEach((function(t){var e=""+t.id;r[e]={name:t.name},o.push(e)})),PrimeTime.trigger(ZCMediaConstants.triggerSource.REMOTE_WORK,PrimeTime.getMode(e.type),ZCMediaConstants.scopeTypes.TEAM,o,{teamDetails:r})}}},k=t=>{let e="",s="";if(t===HistoryModule.Constants.DIRECTCALLS&&MediaCall.isAudioOrVideoCallAllowed()){let t=MediaCall.isAudioCallAllowed()?".audio":"";e="initiateDMCalls",s="quickaction.header.calluserwin"+(t+=MediaCall.isVideoCallAllowed()?".video":"")}else if(t===HistoryModule.Constants.MEETINGS&&Conference.isInstantConferenceAllowed()){if(e="initiateConference",s="conference.start.title",Conference.isNomenclatureEnabled()){var i="",a="",n="",l="",o=void 0,r="",d=Conference.isAudioConferenceAllowed(),c=Conference.isVideoConferenceAllowed(),p=$zcg._HUDDLE_IN_EVENTS_ENABLED&&SecurityManager.hasPermission(Modules.Events);if(c){n=$WC.template.replace('<div class="zcl-menu-item" purpose="startQuickVideoConference"><em class="zcl-menu-item-icn zcf-video"></em><span class="ellips">{{video}}</span></div>',{$video:"conference.title.video"}),o="startQuickVideoConference",r="zcf-video"}if(d){a=$WC.template.replace('<div class="zcl-menu-item" purpose="startQuickAudioConference"><em class="zcl-menu-item-icn zcf-call"></em><span class="ellips">{{audio}}</span></div>',{$audio:"conference.title.audio"}),o="startQuickAudioConference",r="zcf-call"}return p&&(d||c)&&(l=$WC.template.replace('<div class="zcl-btn-xs zcl-btn--primary fontN" purpose="scheduleOnlineMeeting"><span class="zcl-btn-icn zcf-calendar font16 pT2"></span><span>{{schedule_meeting}}</span></div>',{$schedule_meeting:"event.schedule.meeting"})),void 0!==o&&(i=$WC.template.replace('<div class="zcl-btn-xs zcl-btn--primary fontN mR14 zcl-split-btn" purpose="{{purpose}}"><span class="zcl-btn-icn {{icon}} font16 pT2"></span><span>{{start_meeting}}</span><span id="meet_now_opts" class="split-icon flexM zcf-pointer" purpose="showOptionsDropDown"></span><div id="meet_now_opts_list" class="zcl-menu-wrap hide posabs no-pointer" style="z-index:2;">{{audio_option}}{{video_option}}</div></div>',{audio_option:a,video_option:n},"InSecureHTML"),i=$WC.template.replace(i,{$start_meeting:"media.meet.now",purpose:o,icon:r})),void 0===o&&""===l||(i="<div>"+i+l+"</div>"),i}}else t===HistoryModule.Constants.BROADCASTS&&PrimeTime.isAssemblyModeAllowed()&&(e="initiateBroadcast",s="primetime.start.title");if($WC.Util.isEmpty(e))return"";return $WC.template.replace(TemplateUtil.getLhsLongBtn(),{purpose:e,content:I18N(s)})};var x=function(t,e){var s="";return s=t>0&&e>0?I18N("common.calls.and.meetings"):t>0?I18N("common.calls"):I18N("common.meetings"),I18N("common.ongoing")+" "+s.toLowerCase()};let z=()=>{var t=CallHistoryData.getOngoingCalls();if(0!==Object.keys(t).length){var e=$("#ongoing-calls-list");e.length>0&&e.remove();var s=CallHistoryTemplates.getOngoingCallsListHTML(t);$("body").append(s),function(){var t=$("#ongoing-calls-list");t.on("click","[action]",(function(e){e.stopPropagation();var s=$(e.currentTarget),i=s.attr("action");if("joinConference"===i||"joinPrimetime"===i||"joinMediaCall"===i){$Util.Button.addLoadIconForAjax(s);var a=s.attr("call_id"),n=function(){$Util.Button.showCompletionAndResetContent(s,!1),Clickoutside.handleClickOnChild(e),t.remove(),"joinPrimetime"===i&&LiveVideoMsgHandler.handleJoined(a)};"joinConference"===i?Conference.join(a,ZCMediaConstants.triggerSource.LHS_ONGOING_LIST,n):"joinPrimetime"===i?PrimeTime.join(a,n):MediaCall.handOffCall(a,n)}else"joinLiveEvent"===i&&(Clickoutside.handleClickOnChild(e),Conference.joinLiveEvent(s.attr("call_id")))})),$("#ongoing-calls-list").on("click","[purpose='chatlink']",(function(t){var e=$(t.currentTarget).attr("chid");e&&Chat.attachSession(e,!1)}))}()}},F=(t,e,s,i)=>{let a="",n=0,l=!1,o=$zcg._ZUID;s.forEach((function(e){"host"===e.role?(t.headerAdded.host||(a+=`<div class="w100 callhistory-members-head"><div class="h100 mL30 bold line30">${I18N("media.host")} (1)</div></div>`,t.headerAdded.host=!0),l=e.id===o):"cohost"===e.role?(t.headerAdded.cohost||(a+=`<div class="w100 callhistory-members-head"><div class="h100 mL30 bold line30">${I18N("conference.cohosts")} ({{cohostCount}})</div></div>`,t.headerAdded.cohost=!0),n+=1,l||(l=e.id===o)):e.start_time>0||e.end_time>0?t.headerAdded.members||(a+=`<div class="w100 callhistory-members-head"><div class="h100 mL30 bold line30">${I18N("common.participants")}</div></div>`,t.headerAdded.members=!0):t.headerAdded.invitees||(a+=`<div class="w100 callhistory-members-head"><div class="h100 mL30 bold line30">${I18N("media.invitedusers")}</div></div>`,t.headerAdded.invitees=!0),a+=CallParticipantView.getEachParticipantHtml(e,!0)})),a=$WC.template.replace(a,{cohostCount:n});let r=e.type;return!l||MediaUtil.isOneToOneCall(r)||MediaUtil.isLiveEvent(r)||$("#download_attendance_"+(e.nrs_id||e.session_id)).removeClass("dN"),a},V=()=>{$("#callhistory-preview-container").on("focusout","[recording_rhs_view]",t=>{MediaListingEvents.handleContainerEvent(t)})},W=(t,e)=>{var s;if(e&&e.length>0){s='<div id="recording_rhs_list" class="gridlay" style="padding: 20px 30px">';for(var i=0;i<e.length;i++){var a=e[i],n=a.id,l=a.owner;CallsHistoryUI.getRecordingStorage[n]=a;var o=`<div id="rhs_recording_item_{{sr_id}}" sr_id="{{sr_id}}" nrs_id="{{nrs_id}}" ref_index="{{index}}" class="ml-grid-item curP zchtmsgcnt zc-ml-recording">\n\t\t\t\t\t<div data-name="item_cont" class="posrel flexC" uid="{{id}}" video={{has_video}} rec_name="{{title}}" {{huddlewidget}} purpose="viewRecording">\n\t\t\t\t\t\t<div class="grid_options posabs h100 flex dN flexS justifySB p10 curN">\n\t\t\t\t\t\t\t<div id="user_image" data-action="user_details" class="ml-list-img flexM" title="{{owner_name}}">\n\t\t\t\t\t\t\t   <div sender="{{owner_id}}" nname="{{owner_name}}" class="sender ellips floatl me">\n\t\t\t\t\t\t\t      <div class="chtimg floatl posrel" rec_options><img elemtype="user" hover="true" uid="{{owner_id}}" src="{{owner_img_url}}" class="cur"></div>\n\t\t\t\t\t\t\t      <span elemtype="user" hover="true" uid="{{owner_id}}" class="zctxtseln cur">{{owner_name}}</span>\n\t\t\t\t\t\t\t   </div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<div class="flexC ml-icon_dom">\n\t\t\t\t\t\t\t\t<div title="${I18N("common.download")}" uid="{{id}}" sr_id="{{sr_id}}" nrs_id="{{nrs_id}}" index="{{index}}" purpose="downloadRecording" {{huddlewidget}} class="zcimg-actn-btn p5 mL8 curP {{download_class}}">\n\t\t\t\t\t\t\t\t\t<em class="zcf-download"></em>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t<div id="rhs_recording_dropdown_{{sr_id}}" {{huddlewidget}} purpose="showRecordingMoreOptions" rec_options uid="{{sr_id}}" ref_index="{{index}}" nrs_id="{{nrs_id}}" recording_dropdown_menu class="zcimg-actn-btn p5 mL8 curP textC ml-drpdwm_menu {{hide_more_options}}">\n\t\t\t\t\t\t\t\t\t<em class="zcf-more" title="${I18N("common.more")}" recording_dropdown_menu></em>\n\t\t\t\t\t\t\t\t\t<div id="rhs_recording_dropdown_menu_{{sr_id}}" recording_dropdown_menu data-uid="{{sr_id}}"></div>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div id="videoplayer" class="zcvideomn zcfilevw">\n\t\t\t\t\t\t\t{{video_placeholder}}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div id="rhs_recording_name_{{sr_id}}" class="ellips curP p4" title="{{title}}">{{title}}</div>\n\t\t\t\t\t<input id="rhs_recording_nameinput_{{sr_id}}" recording_rhs_view type="text" class="recording-name-container p4 width100 font15 dN" sr_id="{{sr_id}}" data-action="renameRecording" maxlength={{maxlen}} autocomplete="off" />\n\t\t\t\t</div>`;let m=MediaUtil.isOneToOneCall(t.type);var r=ConferenceImpl.getRecordingName(a),d=m?t.nrs_conf_id:t.nrs_id||t.session_id,c=!a.audio&&!a.video||void 0!==a.video&&a.video,p=c?SecurityManager.hasPermission(Modules.GroupVideoCall,MActions.DownloadRecordings):SecurityManager.hasPermission(Modules.GroupAudioCall,MActions.DownloadRecordings);o=$WC.template.replace(o,{video_placeholder:(new $WC.VideoPlayer).createInitialState(MediaListingUI.getRecordingThumbnailUrl(t.nrs_id||t.session_id,a.index))},"InSecureHTML");var h=MediaUtil.isLiveEvent(t.type);s+=$WC.template.replace(o,{id:t.id,index:""+a.index,sr_id:n,title:r,huddlewidget:$("#call_info_win"+d).length>0?"huddlewidget":"",nrs_id:d,has_video:c,hide_more_options:h?"dN":"",download_class:h||!p?"dN":"",owner_id:l?l.id:"",owner_name:l?Users.getName(l.id,l.name):"",owner_img_url:l?Users.getImgUrlById(l.id):"",maxlen:RecordingConstants.nameMaxLength})}s+="</div>"}else s=`<div class="flexG wh100 flexM fdirC">\n\t\t\t\t<div class="font17 clr-lp1 line22 textC m30">${I18N("media.recordings.none")}</div>\n\t\t\t</div>`;return s},B=(t,e)=>{var s;if(e&&e.length>0){s='<div class="gridlay gridlay-padding">';for(var i=0;i<e.length;i++){var a=new Presentation(e[i]),n=a.getFileName(),l=a.getFileId();s+=$WC.template.replace('<div id="presentation_{{id}}" class="ml-grid-item curP zchtmsgcnt wb-preview-item" uid="{{meeting_id}}" session-key="{{session_key}}" data-uid="{{uid}}" data-title="{{title}}" smartconferencebutton purpose="openPresentationFromHistory"><div data-name="item_cont" class="posrel flexC"><div class="grid_options posabs h100 flex dN flexS justifySB p10 curN"><div class="flexC wb-preview-opts"></div></div><div id="wb_preview" class="zcvideomn zcfilevw"><div class="zc-av-alignM zc-av-flexM" presentation_thumbnail_cnt><img src="{{thumbnail_url}}" class="wh100" onerror="PresentationImpl.replaceImageWithPresentationIcon($(this));"></div></div></div><div class="flexC p4"><div class="p4 textC ellips flexG" title="{{title}}">{{title}}</div></div></div>',{id:t.id,meeting_id:"audio_conference"===t.type||"video_conference"===t.type?t.nrs_id:t.session_id,session_key:t.session_id,thumbnail_url:PresentationImpl.getThumbnailURL(l),title:n,uid:l,drp_dwn_class:a.getPresenterId()===$zcg._ZUID?"":"dN",$more_txt:"event.more",$download_txt:"common.download"})}s+="</div>"}else s=$WC.template.replace('<div class="flexG wh100 flexM fdirC">\n\t\t\t\t<div class="font17 clr-lp1 line22 textC mT28">{{content}}</div>\n\t\t\t</div>',{$content:"avcliq.media.presentations.none"});return s},j=(t,e)=>{var s;if(e&&e.length>0){s='<div class="gridlay" style="padding: 20px 30px">';for(var i=0;i<e.length;i++){var a=e[i],n='<div id="white_board_{{id}}" class="ml-grid-item curP zchtmsgcnt wb-preview-item" uid="{{meeting_id}}" data-uid="{{uid}}" data-title="{{title}}" whiteboardbutton purpose="openboardFromHistory"><div data-name="item_cont" class="posrel flexC"><div class="grid_options posabs h100 flex dN flexS justifySB p10 curN"><div class="flexC wb-preview-opts"></div></div><div id="wb_preview" class="zcvideomn zcfilevw"><div class="zc-av-alignM zc-av-flexM"><img src="'+WhiteBoard.getBoardThumbnailURL(a.board_id)+'" class="wh100"></div></div></div><div class="flexC p4"><div class="p4 textC ellips flexG" title="{{title}}">{{title}}</div><div id="white_board_copylink_{{id}}" uid="{{uid}}" whiteboardbutton purpose="copyBoardURL" class="zcl-icon-sm zcl-icon--filled zcf-link mR10" title="{{copy_whiteboard_url}}"></div></div></div>',l=a.board_name;s+=$WC.template.replace(n,{id:t.id,meeting_id:t.type.endsWith("_conference")?t.nrs_id:t.session_id,title:l,uid:a.board_id,$open_whiteboard:"whiteboard.open",drp_dwn_class:a.creator===$zcg._ZUID?"":"dN",$more_txt:"event.more",$download_txt:"common.download",$copy_whiteboard_url:"whiteboard.copy.link"})}s+="</div>"}else s=`<div class="flexG wh100 flexM fdirC">\n\t\t\t\t<div class="font17 clr-lp1 line22 textC mT28">${I18N("media.recordings.none")}</div>\n\t\t\t</div>`;return s},G=t=>{l=t},Y=t=>{let e=t[0].dataset.uid,s=l.user_id.split(","),i=s.indexOf(e);if(s.splice(i,1),!s.length)return void A(!0);G({user_id:s.join()});let a=O(s);$("#callhistoryoptcont").find("#filter_txt").html(a),Z()},Z=()=>{let t=$("#type_filters").find("[data-selected]").attr("data-type")||"all";N(t)},q=t=>{if(CallHistoryData.participantsListViewSync)return;let e=$("#callhistory-preview-container"),s=()=>{CallHistoryData.participantsListViewSync=!1,e.next().remove()},i=t.nrs_id||t.session_id;e.on("scroll",$Util.debounce((function(a){if(ZCScroll.isScrollDown(e[0])){a.stopImmediatePropagation();let n=s=>{CallHistoryData.participantsListViewSync=!1;let i=CallHistoryData.participantsListView;e.next().remove(),e.append(F(i,t,s))};CallHistoryData.loadParticipantsListView(i,!1,n,s)}}),CallsHistoryUI,300)),CallHistoryData.participantsListViewSync=!0,CallHistoryData.loadParticipantsListView(i,!0,s=>{CallHistoryData.participantsListViewSync=!1;let i=CallHistoryData.participantsListView;e.html(F(i,t,s))},s)};return{construct:i=>{s=i,r(),d={};let a,l=CallHistoryTemplates.getContainerHtml(i),o=TemplateUtil.getLoaderHtml();switch(l=$WC.template.replace(l,{container_content:o,start_btn:k(i)},"InSecureHTML"),LhsNavigation.updateRHSView(l),R(),i){case HistoryModule.Constants.DIRECTCALLS:a="showDMCalls";break;case HistoryModule.Constants.MEETINGS:a="showMeetingHistory";break;case HistoryModule.Constants.BROADCASTS:a="showBroadcastHistory";break;case HistoryModule.Constants.LIVE_EVENTS:a="showLiveEventsHistory"}if(i===HistoryModule.Constants.DIRECTCALLS){n=CallHistoryStorage.getMissedCallsCount()>0?"missed":n||"all";let t=$("#type_filters");t.find(".sel").removeClass("sel").removeAttr("data-selected"),t.find('[data-type="'+n+'"]').addClass("sel").attr("data-selected","")}h(a),t=$("#callhistory_view"),e=$("#callhistory_listview"),HistoryModule.resetDateFilter(),m(),w()},populate:(s=[])=>{if(0==t.length)return;t.find("#loadmore").remove();let a=t.find("[caller_id]").length;if(s.length){let t=g({call_items:s,ignoreExistingDate:a});t.length>0&&!a&&(t='<div id="sticky_date_item" class="date-divider w100 sticky-date-cnt" zc_sticky_title></div>'+t),a?e.append(t):e.html(t),t.length>0&&!a&&$Util.initializeStickyTitle($("#callhistory_view")),i=!$WC.Util.isEmpty(t)}else if(i=!1,!a){let t=v();e.html(TemplateUtil.noCategoryResult(t,'<div class="'+u()+'"></div>'))}},handleError:()=>{e.html(TemplateUtil.getApiFailureHtml())},loadMore:()=>{CallHistoryData.getAll({call_type:s,call_category:n,load_type:"loadMore",successcallback:t=>{CallsHistoryUI.populate(t),p(0,t)},failurecallback:t=>CallsHistoryUI.handleError(t)})},updateCounter:t=>{$("#"+LHSConstants.ModuleIds.MYHISTORY+"_counter").text(t>0?t:""),ISCHandler.updateModuleUnreadCount(LHSConstants.ModuleIds.MYHISTORY,t)},clearCounter:()=>{$("#"+LHSConstants.ModuleIds.MYHISTORY+"_counter").text(""),$("#showDMCalls_counter").text(""),ISCHandler.updateModuleUnreadCount(LHSConstants.ModuleIds.MYHISTORY,0)},clearFilter:()=>{l={},o=[]},goToGroupCallView:()=>{LhsModules.highlightModule(LHSConstants.ModuleIds.MYHISTORY),LhsNavigation.updateSubModuleCategory(),HistoryModule.defaultActiveTab=HistoryModule.Constants.MEETINGS,HistoryModule.openHistoryRhs()},populateOngoingCalls:t=>{var e=$("#ongoing-calls-lhs"),s=0,i=0,a=0;for(var n in t){t[n].unread&&s++;var l=t[n];MediaUtil.isOneToOneCall(l.type)?i++:a++}if($("#ongoing-calls-lhs-anim").toggleClass("active",s>0),Object.keys(t).length>0){if(e.length>0)e.show(),$("#ongoing-call-txt").text(x(i,a));else{var o=CallHistoryTemplates.getOngoingCallsMainHTML(i,a,s),r=$("#lhs_remote_work");r.length>0?r.after(o):$("#leftpannel").prepend(o),(()=>{var t=$("#ongoing-calls-lhs");t.on("click","[action]",(function(e){e.stopPropagation();var s=e.currentTarget.getAttribute("action");"showList"===s?(CallHistoryData.markOngoingCallsAsViewed(),$("#ongoing-calls-lhs-anim").removeClass("active"),z(),Clickoutside.bind({srcid:"ongoing-calls-lhs",destid:"ongoing-calls-list",event:e,customShow:function(){for(var t=$("#ongoing-calls-list"),e=t.find("[start_time]"),s=0;s<e.length;s++){var i=e[s];SessionTimers.setTimer(i.id,{startTime:i.getAttribute("start_time"),type:"+"})}t.show()},customHide:function(){for(var t=$("#ongoing-calls-list"),e=t.find("[start_time]"),s=0;s<e.length;s++){var i=e[s];$(i).empty(),SessionTimers.clearTimer(i.id)}t.hide()}})):"close"===s&&(t.slideUp(),$("#ongoing-calls-list").hide(),CallHistoryData.markOngoingCallsAsViewed())}))})()}z()}else e.hide(),$("#ongoing-calls-list").hide()},populateOngoingCallsList:z,getLhsHeaderText:x,resetCallJoinLoader:(t,e)=>{var s=$("#ongoing-calls-list").find('[call_id="'+t+'"][action=joinConference], [call_id="'+t+'"][action=joinPrimetime]');$Util.Button.showCompletionAndResetContent(s,e)},getDurationTime:I,getGroupCallImage:L,getFilterDetails:()=>{if(s===HistoryModule.Constants.DIRECTCALLS&&!$.isEmptyObject(l)){let t=Object.assign({},l);return t.user_id=t.user_id.split(",")[0],t}return l},isCallHistoryFilterIsActive:()=>$("#callhistoryopts").is(":visible"),getRecordingStorage:{},getRecordingsHTML:W,getWhiteboardsHTML:j,bindFocusOutEventForRecording:V,isLiveEventCallType:t=>HistoryModule.Constants.LIVE_EVENTS===t,getCurrentCallTypeInView:()=>s,getSelectedUserHTML:O,handleCallParticipantListView:q,getListItemsHtml:g,highlightSubModule:h,reinitConstants:r}}();var PhoneModule=function(){let t={Dashboard:{id:"Dashboard",icon:"zcf-dashboard",name:"dashboard.title",purpose:"showPhoneModule",url:"/dashboard",permalink:"dashboard"},Phone_calls:{id:"Phone_calls",icon:"zcf-phone-call",name:"phonecalls.title",purpose:"showPhoneModule",url:"/logs/list",permalink:"phone-calls"},Active_phone_calls:{id:"Active_phone_calls",icon:"zcf-active-phone-call",name:"activephonecalls.title",purpose:"showPhoneModule",url:"/livecalls",permalink:"active-phone-calls"},Voicemails:{id:"Voicemails",icon:"zcf-voicemail",name:"voicemails.title",purpose:"showPhoneModule",url:"/logs/voicemail",permalink:"voicemails"},Phone_recordings:{id:"Phone_recordings",icon:"zcf-phone-recording",name:"phonerecordings.title",purpose:"showPhoneModule",url:"/logs/callrecords",permalink:"phone-recordings"},Sms:{id:"Sms",icon:"zcf-event-mail",name:"sms.title",purpose:"showPhoneModule",url:"/sms/conversation",permalink:"sms"},Contacts:{id:"Contacts",icon:"zcf-peopledirectory",name:"contacts.title",purpose:"showPhoneModule",url:"/contacts/list",permalink:"contacts"}},e=t.Dashboard.id,s=Config.isZohoVoiceAllowed(),i=[];s&&i.push({id:t.Dashboard.id,purpose:t.Dashboard.purpose,icon:t.Dashboard.icon,name:t.Dashboard.name,type:t.Dashboard.id},{id:t.Phone_calls.id,purpose:t.Phone_calls.purpose,icon:t.Phone_calls.icon,name:t.Phone_calls.name,type:t.Phone_calls.id},{id:t.Voicemails.id,purpose:t.Voicemails.purpose,icon:t.Voicemails.icon,name:t.Voicemails.name,type:t.Voicemails.id},{id:t.Phone_recordings.id,purpose:t.Phone_recordings.purpose,icon:t.Phone_recordings.icon,name:t.Phone_recordings.name,type:t.Phone_recordings.id},{id:t.Sms.id,purpose:t.Sms.purpose,icon:t.Sms.icon,name:t.Sms.name,type:t.Sms.id},{id:t.Contacts.id,purpose:t.Contacts.purpose,icon:t.Contacts.icon,name:t.Contacts.name,type:t.Contacts.id});let a=(t,e)=>$WC.template.replace(e,{item_id:t.id,item_purpose:t.purpose,icon_cls:t.icon,$name:t.name,item_type:t.type,active_cls:t.type===PhoneModule.defaultActiveTab?"chatsel":""}),n=e=>{let s=e.id,i=e.url,a=$("#zohovoice_iframe"),n=(e=>I18N(t[e].icon))(s)+" module-icn clr-icon",o=(e=>I18N(t[e].name))(s);if(0===a.length){let t=$("#voicetab-main");t.html($WC.template.replace('<div id="lhs_zohovoice_loader" class="flexM wh100 lhs-mycalendar-popup-loader">\n\t\t    \t\t\t<div class="flexM fdirC">\n\t\t\t\t\t\t\t<div class="zcl-rloader"></div>\n\t\t\t\t\t\t\t<div class="clr-S font18 mT20">{{loading_text}}</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>',{loading_text:TemplateUtil.getRandomQuotes()}));let e=`<iframe id="zohovoice_iframe" src="${$zcg._ZOHO_VOICE_SERVER}/app/zvt.jsp?isIFrame=true&isSubFrame=false&frameorigin=${$Util.getFrameOrigin()}#`+i+'" class="wh100 flexG bdrN dN"></iframe>';t.prepend(e);let s=`<div class="main-container-header ovrflwH fshrink lhs-voice-iframe-header">\n\t\t\t\t\t\t\t  \t<div class="w100 flexC justifySB">\n\t\t\t\t\t\t\t      <div class="flexC">\n\t\t\t\t\t\t\t         <div class="flexC line1">\n\t\t\t\t\t\t\t            <div id="voicetab-icon" class="${n}"></div>\n\t\t\t\t\t\t\t            <div id="voicetab-header" class="clr-H font16 fontB mB2">${o}</div>\n\t\t\t\t\t\t\t         </div>\n\t\t\t\t\t\t\t      </div>\n\t\t\t\t\t\t\t  \t</div>\n\t\t\t\t\t\t\t  </div>`;t.prepend(s)}else $("#voicetab-icon")[0].className=n,$("#voicetab-header").text(o),a[0].contentWindow.postMessage({action:"navigate",page:i.slice(1)},$zcg._ZOHO_VOICE_SERVER);MainUI.getMefront("voicetab-main",!0),l(s)},l=t=>{$("#zc_"+t).addClass("chatsel").siblings().removeClass("chatsel")},o=()=>"voicetab-main",r=void 0;return{defaultActiveTab:e,openPhoneRhs:()=>{n(t[PhoneModule.defaultActiveTab]),ZCPermalink.updateUrl(routingPaths.phone[PhoneModule.defaultActiveTab])},subModules:i,getSubModuleHtml:()=>{let e="";return e+=`<div class="flex fdirC h100">\n\t\t\t\t<div class="flexG">\n\t\t\t\t\t<div class="lhs-sub-hdr"><span class="LHS-name">{{phone_hdr}}</span></div>${(()=>{let e="";for(let s of i)s.id===t.Contacts.id&&(e+='<div class="zcl-hor-divider m12"></div>'),e+=a(s,'<div id="zc_{{item_type}}" class="lhs-sub-item ellips LHS-item {{active_cls}}" id="{{item_id}}" purpose="{{item_purpose}}" type={{item_type}}>\n\t\t\t\t\t<div class="item-icn {{icon_cls}}"></div>\n\t\t\t\t\t<div class="item-name ellips flexG">{{name}}</div>\n\t\t\t\t\t<div class="LHS-icon-wrp flexC fshrink"><div id="{{item_id}}_counter" class="LHS-count "></div></div>\n\t\t\t\t</div>');return e})()}\n\t\t\t\t</div>\n\t\t\t</div>`,$WC.template.replace(e,{$phone_hdr:"phone.hdr"})},handlePermalink:function(e){LhsModules.highlightModule(LHSConstants.ModuleIds.MYPHONE);for(let s in t){let i=t[s];i.permalink===e.split("/")[2]&&(PhoneModule.defaultActiveTab=i.id)}LhsNavigation.updateSubModuleCategory(),PhoneModule.openPhoneRhs()},handleIframeMessages:t=>{let e=t.action;if("pageload"===e){t.url.replaceAll("/","_");$("#lhs_zohovoice_loader").remove(),$("#zohovoice_iframe").removeClass("dN")}else if("makeCall"===e&&"undefined"!=typeof ZCVoiceIntegration){let e=ZCVoiceIntegration.getInstance();void 0!==e&&e.makeCall(t.cinfo)}},handleExternalLiveCallsAllowed:()=>{s&&i[1].id!==t.Active_phone_calls.id&&i.splice(1,0,{id:t.Active_phone_calls.id,purpose:t.Active_phone_calls.purpose,icon:t.Active_phone_calls.icon,name:t.Active_phone_calls.name,type:t.Active_phone_calls.id})},getVoiceIframeTabId:o,isPhoneModulePermalink:e=>{for(let s in t){if(t[s].permalink===e)return!0}return!1},addToViewPort:()=>{$("#voicetab-main").show(),r="voicetab-main"},removeFromViewPort:()=>{$("#voicetab-main").hide(),r=void 0,MainUIManager.handleClose("voicetab-main")},isPresentInViewPort:()=>"voicetab-main"==r}}();let MyPins=function(){let t=t=>{let e,s,i,a,n=LHSConstants.ChatsCategory.PINNED;Config.isMyPinsNewFlowEnabled()?(s=(e=MyPinsCustomizer.getPinsChatids()).length,i=ConversationsList.getAll("pinnedchats")):(e=ConversationsList.getAll(n),s=(a=ConversationsUI.getAllSortedChats(n)).length);let l="";if(Config.isMyPinsNewFlowEnabled()&&Config.isFoldersEnabled())l=Folders.getFolderSectionHtml(i,!0);else for(let t=0;t<s;t++){let s,o;if(Config.isMyPinsNewFlowEnabled()?(s=e[t],o=$Util.cloneObject(i[s])):(s=a[t][0],o=$Util.cloneObject(e[s])),o.chid=s,o.deleted||o.removed){ConversationsList.delete(o.chid);continue}let r=ConversationsList.parseDetails(o);r&&("channel"!==(r=Config.isMyPinsNewFlowEnabled()?MyPinsCustomizer.checkParseDetails(r,s):r).profile||Channels.getObject(r.profileid)||o?l+=ConversationsUI.getHtml(n,s,o,r):ConversationsList.delete(o.chid))}return $WC.Util.isEmpty(l)&&(l=`<div emptymsg="true" class="lhs-sub-item-empty" >${Resource.getRealValue("pinnedchat.none")}</div>`),l},e={pinsReorderOption:'<span id="pincategoryoptions" class="zcf-moreS mL10 LHS-btn mypins-optn {{VISIBLITY_CLASS}}" elemtype="pincategoryoptions"></span>'},s=()=>{let t=Config.isFoldersEnabled()||MyPinsCustomizer.getPinsChatids().length>1?"":"vsbH";return $WC.template.replace(e.pinsReorderOption,{VISIBLITY_CLASS:t})};return{getListHtml:t,getSubModuleHtml:()=>{let e=t(),i=`<div id="pinnedchats" category="pinnedchats" class="flexG h100 flex-col ovrflwA lhs-caetgorized-pinsection">\n\t\t\t\t<div id="pinnedchatwrapper">\n\t\t\t\t\t<div id="pinnedchatsheader" class="lhs-sub-hdr lhs-sub-hdr-sticky fshrink">\n\t\t\t\t\t\t<span class="flexG">{{pins_hdr}}</span>\n\t\t\t\t\t\t${Config.isMyPinsNewFlowEnabled()?s():""}\n\t\t\t\t\t</div>\n\t\t\t\t\t<div id="pinnedchatslistholder" modules_scoller class="LHS-list-main">\n\t\t\t\t\t\t<div id="pinnedchatslist" class="pinnedchatslist">${e}</div>\n\t\t\t\t\t</div>\n\t\t\t\t<div>\n\t\t\t</div>`;return $WC.template.replace(i,{$pins_hdr:"common.pinnedchats"},"InSecureHTML")},htmlTemplates:e,getMypinsOption:s}}(),WidgetsLHS=function(){let t=(t,e,s)=>{var i=$WC.$CUtil.processXSS(t.name);if(!$WC.Util.isEmpty(e)){if(!i||-1===i.toLowerCase().indexOf(e))return"";i=_highlightSearchText(i,e)}let a={id:t.id,image_url:Applets.getImgUrl(t),name:i,tooltip_Name:$WC.$CUtil.processXSS(t.name),extn_name:t.extension?t.extension.name:"",extn_icon:"",$extn_icon_tooltip:"",hide_unseenTag:s?"":"hide"},n="";t.extension&&(n=$WC.template.replace('<span title="{{extn_name}} - {{tooltip}}" class="zcf-integ mL5"><span>',{$tooltip:"sandbox"===t.extension.type?"app.sandbox":"common.extension"}));let l="";s&&(l='<span class="clr-warning posabs unseentag zcf-unseen-star" ></span>');let o=$WC.template.replace(AppletTabs.isMoreAppsOverlayView()?'<div id="tabapplet-{{id}}" app_id="{{id}}" catagory="app_tab" elemtype="app_tab" class="flex-col flexC otherAppItem" purpose="showWidgetFromSection">\n\t\t\t\t<div class="tab_img flexM fshrink {{icon_class}} posrel font16   otherappIcon">\n\t\t\t\t\t<img class= "tab_img"  src="{{image_url}}">\n\t\t\t\t\t{{unseenTagHtml}}\n\t\t\t\t</div>\n\t\t\t\t<div title="{{tooltip_Name}}" class=" textC font14  mT5   ellips-L2 w100 otherAppName clr0"><span>{{name}}</span>{{extn}}</div>\n\t\t\t</div>':'<div id="tabapplet-{{id}}" app_id="{{id}}" catagory="app_tab" elemtype="app_tab" class="LHS-item">\n\t\t\t<div class="LHS-img">\n\t\t\t\t<img src="{{image_url}}">\n\t\t\t</div>\n\t\t\t<div title="{{name}}" class="LHS-name"><span class="ellips">{{name}}</span>{{extn}}</div>\n\t\t</div>',{extn:n,unseenTagHtml:l},"InSecureHTML");return $WC.template.replace(o,a,"InSecureHTML")},e=function(t){var e=Applets.getUnseenAppletIds();e.length>0&&-1!=e.indexOf(t)&&HomeUI.markseenAndRemoveComponentDiv("homeui_"+t,"applets")},s=t=>{let s=AppletTabs.getWidgetOutput(t);void 0!==s?(!AppletTabs.isMoreAppsOverlayView()&&MainUI.getMefront("applet-"+t,!0),AppletTabs.populate(s)):AppletTabs.fetchAppletLayout(t),ZCPermalink.updateUrl(routingPaths.widgets+"/"+t),e(t)},i=t=>{let s=Object.keys(Applets.getAll()),i=t||WidgetsLHS.last_viewed_id;if(s.length){let t=$WC.Util.isEmpty(i)?s[0]:i,a=AppletTabs.getWidgetOutput(t);void 0!==a?(!AppletTabs.isMoreAppsOverlayView()&&MainUI.getMefront("applet-"+t,!0),AppletTabs.populate(a)):AppletTabs.fetchAppletLayout(t),ZCPermalink.updateUrl(routingPaths.widgets+"/"+t),e(t)}else{let t=a();AppletTabs.isMoreAppsOverlayView()?WidgetsOverlay.updateMoreAppsOverLayRhs(t):LhsNavigation.updateRHSView(t),ZCPermalink.updateUrl(routingPaths.widgets)}},a=()=>{let t=`<div class="pLR38 flexM wh100 fdirC">\n\t\t\t\t<div class="Applets_empty"></div>\n\t\t\t\t<div class="font17 clr-lp1 textC mT28 line22 w75">${I18N("applet.actions.info")}</div>\n\t\t\t\t<div documentclick="createWidgetBtn" class="fshrink zcl-btn zcl-btn--primary mT20">${I18N("applet.actions.create")}</div>\n\t\t\t</div>`;return $WC.template.replace('<div id="widgets_rh_view" class="wh100 flex fdirC">\n\t    \t\t<div class="main-container-header ovrflwH fshrink {{hide_header}}">\n        \t\t\t<div class="flexC fshrink" style="line-height: 1;">\n        \t\t\t\t<div class="zcf-applet module-icn clr-icon"></div>\n        \t\t\t\t<div class="font16 clr-H fontB" style="margin-bottom: 2px;">{{container_header}}</div>\n        \t\t\t</div>\n\t    \t\t</div>\n\t    \t\t<div class="flexG ovrflwA p30">\n\t    \t\t\t{{container_content}}\n\t    \t\t</div>\n\t\t\t</div>',{hide_header:AppletTabs.isMoreAppsOverlayView()?"hide":"",$container_header:"integration.applet.title",container_content:t},"InSecureHTML")};return{last_viewed_id:"",getSubModuleHtml:(e,s)=>{let i=((e,s)=>{let i=Applets.getAll(),a=IntegrationsUtil.sortByKey(i,"name"),n="",l=a.length,o=s?Applets.getUnseenAppletIds():[];for(let s=0;s<l;s++){let l=i[a[s]];-1==o.indexOf(l.id)&&(n+=t(l,e))}return $WC.Util.isEmpty(n)&&!AppletTabs.isMoreAppsOverlayView()&&(n=`<div class="mAuto mT45 widgets-empty"></div><div class="mT10 textC font13 clr-lp1">${Resource.getRealValue("applet.empty.desc")}</div>`),n})(s,e);if(e)return i;let a=`<div class="flexG flex-col h100">\n\t\t\t\t<div id="app_tabheader" class="lhs-sub-hdr fshrink"><span class="LHS-name">{{applets_hdr}}</span></div>\n\t\t\t\t<div id="app_tablistholder" class="flexG ovrflwA">\n\t\t\t\t\t<div id="app_tablist" class="LHS-bot">${i}</div>\n\t\t\t\t</div>\n\t\t\t</div>`;return $WC.template.replace(a,{$applets_hdr:"integration.applet.title"},"InSecureHTML")},populateRHSView:(t,e)=>{if(LhsModules.activeTabId===t&&e){if(void 0===Applets.getObject(t))return void $WC.$Dlg.create({id:"remove-section-widget",version:2,class:"zcdalogbx zcbg_mask alert_dialog",headerhtml:$WC.$Dlg.frameHeaderHTML({imagehtml:'<img height="48px" width="48px" src="'+$zcg._IMGDEFAULTSTATICURL+'/applet.png">',header:Resource.getRealValue("wid.sect.remove.info")}),buttons:[{text:Resource.getRealValue("common.remove"),colour:$WC.$Dlg.RED_BUTTON,action:function(){LeftPannelContextMenu.handle.unpinWidgetFromLHS(t,$("#"+t))}}]});s(t)}else i(t)},closeWidgetView:()=>{var t=$("#apptabs-container").attr("app_id");t&&MainUI.close("applet-"+t)},getWidgetTabsLHSHtml:(t,e)=>{let s=e.applets;if(s.tabs){let e=s.tabs,a="";let n=`<div tab_id="{{id}}" applet_button="tab_click" class="${AppletTabs.isMoreAppsOverlayView()?"zcitllst-item ":"LHS-item"} {{sel_class}}">\n\t\t\t\t\t<div title="{{name}}" class="LHS-name"><span class="ellips">{{name}}</span></div>\n\t\t\t\t</div>`;for(var i=0;i<e.length;i++){let t=e[i];a+=$WC.template.replace(n,{id:t.id,name:t.label,sel_class:t.id===s.active_tab?AppletTabs.isMoreAppsOverlayView()?"sel":"chatsel":""})}let l=`<div class="flexG flex-col h100">\n\t\t\t\t\t<div id="app_tabheader" class="lhs-sub-hdr fshrink {{hide_appTabHeader}}">\n\t\t\t\t\t\t<span class="LHS-name">{{applets_hdr}}</span>\n\t\t\t\t\t\t<span title="{{refresh}}" applet_button="refresh" class="LHS-btn zcf-refresh font14"></span>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div id="app_tablistholder" class="flexG ovrflwA">\n\t\t\t\t\t\t<div id="app_tablist">${a}</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>`;return $WC.template.replace(l,{applets_hdr:t,hide_appTabHeader:AppletTabs.isMoreAppsOverlayView()?"hide":"",$refresh:"formdialog.refresh"},"InSecureHTML")}},pinWidgetToLhs:(t,e)=>{LhsModuleOrder.addTabtoLhs({data:{module:"widget",id:t},successCallBack:e,errorCallBack:e})},unpinWidgetToLhs:(t,e)=>{let s=LhsModuleOrder.getPinnedWidgetTabId(t);LhsModuleOrder.removeTabFromLhs({tab_id:s,successCallBack:e,widget_id:t,errorCallBack:e})},getNoWidgetsConfiguredHtml:a,getUnseenAppletsListHtml:e=>{let s=Applets.getUnseenAppletObjects(),i=IntegrationsUtil.sortByKey(s,"name"),a="",n=i.length;for(let l=0;l<n;l++){let n=s[i[l]];a+=t(n,e,!0)}return a}}}(),WidgetsOverlay=function(){let t={moreAppsOverlayWin_Html:'<div class="wh100 flex fdirC">\n\t\t\t\t\t<div class="settings-hdr fshrink justifySB flexC {{draggable}}">\n\t\t\t\t\t\t<div class="flexC">\n\t\t\t\t\t\t\t<div class="zcf-marketplace2 mR12 font22 clr-icon"></div>\n\t\t\t\t\t\t\t<div id="moreAppsHeader" class="flexG">\n\t\t\t\t\t\t\t\t{{moreAppsHeaderHtml}}\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class="flexC">\n\t\t\t\t\t\t\t<div id = "removeAddBtn">{{add_removeBtnHtml}}</div>\n\t\t\t\t\t\t\t<div id ="appletRefresh">{{appletRefreshBtnHtml}}</div>\n\t\t\t\t\t\t\t{{minimise_btn}}\n\t\t\t\t\t\t\t<span id="winclose" class="{{moreAppsClose_cls}} zcf-closeB zcl-icon-xl zcl-icon--filled2 zcl-round close-btn "></span>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class="mcontent flexC flexG">\n\t\t\t\t\t\t<div class="zcsetng_lft zcmodal-left flex-col">\n\t\t\t\t\t\t\t<div id="moreAppsLhsSection" class="zcmodal-list pT10">{{lhs_items_html}}</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div id="moreAppsRhs" class="zcsetng_rht zcmodal-right ovrflwH">\n\t\t\t\t\t\t\t<div id="moreAppsRhsContent" class="flex-col wh100 posl zcsetting2_main">{{MOREAPPSRHSCONTENT}}</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div> ',moreAppsOverlaySubSection:`<div class="zcitllst-item sel"  purpose="showInstalledAppsListing" ><span class="zciticcnt"><span class="zcf-applet  font20"></span></span><span>${I18N("installed.apps")}</span></div>\n\t\t\t\t<div class="zcitllst-item " entity="Marketplace" category="installed"  purpose="showMarketPlaceUI" integlhsmenu ><span class="zciticcnt"><span class="zcf-marketplace font20"></span></span><span>${I18N("app.marketplace")}</span></div>`,moreAppsOverlayRhsSection:'<div id = "moreAppsOverlayRhsSection" class ="flex-col  h100 ovr_hiden" >\n\t\t\t\t\t{{installedAppsRhsHtml}}\n\t\t\t\t</div>',installedAppsRhsListing:'<div class = "flex-col h100 m30 ovr_hiden">\t\n\t\t\t\t\t{{note_html}}\n\t\t\t\t\t{{searchBarHtml}}\n\t\t\t\t\t{{installedAppsListingHtml}}\n\t\t\t\t</div>',appletRhsLayoutHtml:'<div id="apptabs-container_preview" class="wh100 flex-col zapptab">\n\t\t\t\t\t\t<div id="apptabs-main" class="wh100 flx1"></div>\n\t\t\t\t\t\t<div id="apptabs-iframe-con" class="wh100 dN"></div>\n\t\t\t\t\t\t<div id="apptabs-map-con" class="wh100 zwc-web-view dN"></div>\n\t\t\t\t\t\t<div id="apptabs-cwin" class="zappchatwin dN"></div>\n\t\t\t\t</div>',installedAppsRhsListingHtml:'<div id ="allowedAppsListing" class="flexG ovr_hiden">\n\t\t\t\t\t\t<div class="ovrflw-auto pT30 h100">\n\t\t\t\t\t\t\t<div class="{{hide_recently_addedApps}} pB20">\n\t\t\t\t\t\t\t\t<div class="clr-S  pTB10 font14 line18">{{recently_AddedAppsList_txt}}</div>\n\t\t\t\t\t\t\t\t<div class = "installedAppsRhs">{{recentlyAddedAppsListHtml}}</div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<div class="">\n\t\t\t\t\t\t\t\t<div class="clr-S pTB10 font14 line18 {{hide_allowedAppsList}}">{{allowedAppsList_txt}}</div>\n\t\t\t\t\t\t\t\t<div id = "installedAppsRhsSectionListing" class ="installedAppsRhs ">{{installedAppsRhs}}</div></div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div>\t\n\t\t\t\t\t<div>',moreAppsPrimaryHeaderHtml:`<span  class="zcl-hdrline  font18 line20 fontB curP {{secondary_selected}} " purpose="goToAppsListingView">${I18N("tabs.more.apps")}</span>`,moreAppsSecondaryHeaderHtml:'<span id ="app-name" class="clr-S mLR5">&gt;</span><span id="tabapplet-{{id}}" app_id="{{id}}" catagory="app_tab" elemtype="app_tab" purpose="showWidgetFromSection" class="{{LINKCLASS}} fontB font18">{{app_name}}</span>',addToLhsBtnHtml:`<div class="zcl-btn zcl-btn--primary mL20 mR10" id="addToLhsBtn" app_id="{{id}}" purpose="pinWidgetToLHS"  {{disabled_btn}}>+ ${I18N("tab.addToSidebar")}</div>`,removeFromLhsBtnHtml:`<div class="zcl-btn zcl-btn--secondary mL20 mR10" id="removeFromLhsBtn" app_id="{{id}}" purpose="unpinWidgetFromLHS"{{disabled_btn}}>${I18N("tab.removeFromSideBar")}</div>`,moreAppsSearchBarHtml:`<div class="fshrink zcl-search2 zcl-search2-sm">\n\t    \t\t\t\t<span class="zcf-search2 zcl-seach-icon"></span>\n\t    \t\t\t\t<div class="zcl-search-input">\n\t    \t\t\t\t\t<input type="text" tab_id={{tab_id}} id="installed-apps-search-field" onkeyup="WidgetsOverlay.moreAppsHandleSearchKeyUp(event)" placeholder="{{placeholder}}"  {{disable_Search}}>\n\t    \t\t\t\t\t<span class="zcl-search-clear" purpose="clearSearchInput">${I18N("common.clear")}</span>\n\t    \t\t\t\t</div>\n\t    \t\t\t</div>`,appletRefreshBtnHtml:`<span  applet_button="refresh" class=" zcf-refresh mR10 font22 zcl-icon-xl zcl-icon--filled2 zcl-round close-btn" title="${I18N("formdialog.refresh")}"></span>`,moreAppsNoteHtml:`<div class = "clr-S fshrink font14 line24 pB30 ">${I18N("moreApps.note")}</div>`};var e=function(e){var s,i="";if(s=$WC.template.replace(t.moreAppsPrimaryHeaderHtml,{secondary_selected:e?"zcl-breadcum-link":""}),e){var a=Applets.getObject(e);i=$WC.template.replace(t.moreAppsSecondaryHeaderHtml,{app_name:a.name,id:e},"InSecureHTML")}return s+i},s=function(){return $WC.template.replace(t.moreAppsOverlayRhsSection,{installedAppsRhsHtml:i()},"InSecureHTML")},i=function(){return $WC.template.replace(t.installedAppsRhsListing,{installedAppsListingHtml:a(),searchBarHtml:$WC.template.replace(t.moreAppsSearchBarHtml,{$placeholder:"widget.search.ph"}),note_html:t.moreAppsNoteHtml},"InSecureHTML")},a=function(e){if(0===Object.keys(Applets.getAll()).length)return WidgetsLHS.getNoWidgetsConfiguredHtml();var s=function(t){return WidgetsLHS.getUnseenAppletsListHtml(t)}(e),i=WidgetsLHS.getSubModuleHtml(!0,e);return $WC.Util.isEmpty(i)&&$WC.Util.isEmpty(s)?"":$WC.template.replace(t.installedAppsRhsListingHtml,{hide_recently_addedApps:$WC.Util.isEmpty(s)?"hide":"",$recently_AddedAppsList_txt:"recently.installedApps",$allowedAppsList_txt:"Other apps",installedAppsRhs:i,hide_allowedAppsList:$WC.Util.isEmpty(i)?"hide":"",recentlyAddedAppsListHtml:s},"InSecureHTML")},n=function(e){if($WC.Util.isEmpty(e))return"";var s=AppletsUI.isPinnedInLhs(e)?t.removeFromLhsBtnHtml:t.addToLhsBtnHtml;return $WC.template.replace(s,{id:e,disabled_btn:LhsModuleOrder.isTabLockedByAdmin(e)||LhsModules.isLhsAdminOrgLocked()?"disabled":""},"InSecureHTML")},l=function(e){return $WC.Util.isEmpty(e)?"":t.appletRefreshBtnHtml},o=function(t,e){let s=e?$("#installed-apps-search-field"):$(t.target),i=$.trim(s.val());var n=$zcg.ESCAPE_KEYCODE?$zcg.ESCAPE_KEYCODE:KeyCodes?KeyCodes.ESCAPE_KEYCODE:27;t.keyCode!=n&&!e||$WC.Util.isEmpty(i)||(t.stopImmediatePropagation(),s.val("").focus(),i="");var l=a(i.toLowerCase()),o=$("#allowedAppsListing");if($WC.Util.isEmpty(l)){var r=$Util.emptyStateHtml({imageclass:"applets_noresult",title:Resource.getRealValue("common.search.empty")});o.html(`<div class="h100 searchEmptyImgClass ">${r}</div>`),o.addClass("installedAppsListEmpty")}else o.html(l),o.removeClass("installedAppsListEmpty")},r=function(s,i){-1!==Object.keys(Applets.getAll()).indexOf(s)&&((i=i||$("#moreAppsOverlayWin")).find("#removeAddBtn").html(n(s)),i.find("#appletRefresh").html(l(s)),i.find("#moreAppsOverlayRhsSection").html(t.appletRhsLayoutHtml),i.find("#moreAppsHeader").html(e(s)),i.find("#moreAppsLhsSection").html(TemplateUtil.getSubListLoader()),WidgetsLHS.populateRHSView(s,!0,!0))},d=function(s){(s=s||$("#moreAppsOverlayWin")).on("click","[purpose]",(function(s){var a=$("#moreAppsOverlayWin"),d=a.find(this),c=d.attr("purpose");if("showWidgetFromSection"===c){let t=d.attr("app_id");r(t,a)}else if("showInstalledAppsListing"===c)d.siblings().removeClass("sel"),d.addClass("sel"),a.find("#removeAddBtn").html(n()),a.find("#appletRefresh").html(l()),a.find("#moreAppsHeader").html(e()),a.find("#moreAppsOverlayRhsSection").html(i()),a.find("#installed-apps-search-field").focus(),ZCPermalink.updateUrl(routingPaths.widgets);else if("goToAppsListingView"===c)a.find("#removeAddBtn").html(n()),a.find("#appletRefresh").html(l()),a.find("#moreAppsHeader").html(e()),a.find("#moreAppsOverlayRhsSection").html(i()),a.find("#moreAppsLhsSection").html(t.moreAppsOverlaySubSection),a.find("#installed-apps-search-field").focus(),ZCPermalink.updateUrl(routingPaths.widgets);else if("unpinWidgetFromLHS"===c){let t=d.attr("app_id");LhsModuleOrder.updateLhsWidgetPin({id:t,elem:d,fromMoreAppsOverlay:!0,action:"remove_widget"})}else if("pinWidgetToLHS"===c){let t=d.attr("app_id");LhsModuleOrder.updateLhsWidgetPin({id:t,elem:d,fromMoreAppsOverlay:!0,action:"add_widget"})}else if("clearSearchInput"===c)o(s,!0);else if("showMarketPlaceUI"===c){var p=d.attr("entity");d.siblings().removeClass("sel"),d.addClass("sel"),a.find("#moreAppsOverlayRhsSection").html('<div id="IntegrationsRHS" transitionelem class="zcitrht zcmodal-right">'+TemplateUtil.getLoaderHtml()+"</div>"),a.find("#removeAddBtn").html(n()),a.find("#appletRefresh").html(l()),a.find("#moreAppsHeader").html(e()),IntegrationUI.show(p,!0,s)}}))};return{showMoreAppsOverlay:function(i){if(AppletTabs.setFromMoreAppsOverlayContainer(!0),$WC.$Win.isExist("moreAppsOverlayWin"))MinimizedWindows.isMinimisedWindow("moreAppsOverlayWinminimised")&&(MinimizedWindows.maximiseWindow("moreAppsOverlayWinminimised"),$("#moreAppsOverlayWin").find("#installed-apps-search-field").focus(),i&&r(i));else{var a=$WC.$Win.create({id:"moreAppsOverlayWin",class:"personalizewin moreAppsOverlayWin",aligncenter:!1,html:$WC.template.replace(t.moreAppsOverlayWin_Html,{MOREAPPSRHSCONTENT:TemplateUtil.getLoaderHtml(),lhs_items_html:t.moreAppsOverlaySubSection,moreAppsHeaderHtml:e(),add_removeBtnHtml:"",appletRefreshBtnHtml:"",minimise_btn:Config.isMinimizeWindowEnabled()?`<span id="moreApps_win_minimise_btn" documentclick="minimizeWindow" data-id="moreAppsOverlayWin" class="zcf-minusB minimise-btn zcl-icon-xl zcl-icon--filled2 zcl-round mR10" title="${I18N("common.minimize")}"></span>`:"",moreAppsClose_cls:UI.isCrmPlusUI()?"":"moreAppsClose"},"InSecureHTML"),draggable:!0,closefn:function(){AppletTabs.setFromMoreAppsOverlayContainer(!1),Config.isMinimizeWindowEnabled()&&MinimizedWindows.handleWindowDestroy("moreAppsOverlayWinminimised"),ZCPermalink.resetURLPath()},closeonesc:!UI.isCrmPlusUI()}),n=function(){$("#moreAppsRhsContent").html(s()),i&&r(i),d(a),a.find("#installed-apps-search-field").focus()};$zcg._LATESTWIDGETCOMPONENTAVALIABLE?HomeUI.getLatestComponents({successCallBack:function(t){t.applets&&(Applets.storeUnseenApplets(t.applets),Applets.addListToStorage(Applets.convertListToV2(t.applets)),$zcg._LATESTWIDGETCOMPONENTAVALIABLE=!1),n()},errorCallBack:function(){n()}}):n()}},showWidgetSelectionInMoreAppsOvrly:r,updateAddRemoveTabBtnHtml:function(t){var e=$("#moreAppsOverlayWin");e.find("#removeAddBtn").html(n(t)),e.find("#appletRefresh").html(l(t))},updateMoreAppsOverLayRhs:function(t){$("#moreAppsOverlayRhsSection").html(t)},moreAppsHandleSearchKeyUp:o,showOnMaximise:function(){Config.isMinimizeWindowEnabled()&&MinimizedWindows.handleWindowDestroy("moreAppsOverlayWinminimised"),$("#moreAppsOverlayWin").find("#installed-apps-search-field").focus()},getMinimisedTabName:function(t){if(t){let i=t.split("/");i[1];var e=i[2];if(t.includes(routingPaths.widgets)){if(e){var s=Applets.getObject(e);return s?s.name:Resource.getRealValue("installed.apps")}return Resource.getRealValue("installed.apps")}if(t===routingPaths.integrations.Marketplace)return Resource.getRealValue("app.marketplace")}return""},updateWidgetHeaderBtnsHtml:function(){var t=$("#removeAddBtn").find("[app_id]");if(t.length>0){var e=t[0].getAttribute("app_id");WidgetsOverlay.updateAddRemoveTabBtnHtml(e)}}}}(),MyConvosLHS={getSubModuleHtml:function(){let t=ChatUI.isThreadAsSectionUnderChats()?'<div id="threadchats" category="threadchats" class="recentchts"></div>':"";return $WC.template.replace('<div class="flexG h100 flex-col mychats">\n\t\t\t<div id="allchats_listing" modules_scoller class="flexG ovrflwA pB5">\n\t\t\t\t<div id="pinnedchats" category="pinnedchats" class=""></div>\n\t\t\t\t<div id="chats" category="chats" class="recentchts"></div>\n\t\t\t\t{{thread_chat_module}}\n\t\t\t\t<div id="mutedchats" category="mutedchats" class="zcmutedchts"></div>\n\t\t\t</div>\n\t\t</div>',{thread_chat_module:t},"InSecureHTML")},populate:()=>{LhsNavigation.updateSubModuleCategory(),MyConvosLHS.updateList()},updateList:()=>{LhsModules.activeTabId===LHSConstants.ModuleIds.MYCONVOS&&(ConversationsList.populate("pinnedchats"),ConversationsList.populate("chats"),ConversationsList.populate("mutedchats"),ChatUI.isThreadAsSectionUnderChats()&&ConversationsList.populate("threadchats"))}},MyBotsLHS={getSubModuleHtml:()=>'<div id="" class="flexG h100 flex-col">\n\t\t\t<div modules_scoller class="flexG ovrflwA pB5">\n\t\t\t\t<div id="botcontacts" category="botcontacts" class=""></div>\n\t\t\t</div>\n\t\t</div>',populate:()=>{LhsNavigation.updateSubModuleCategory(),BotContactsList.populateBotContacts()}},MyDMsLHS={getSubModuleHtml:()=>`<div id="" class="flexG h100 flex-col">\n\t\t\t\t\t<div modules_scoller class="flexG ovrflwA pB5">\n\t\t\t\t\t<div id="contactinvitations" category="contactinvitations" class="zclftconcnt"></div>\n\t\t\t\t\t<div id="generalcontacts" category="generalcontacts" class=""></div>\n\t\t\t\t\t${LhsModules.showBotsAsSeparateModule()?"":'<div id="botcontacts" category="botcontacts" class=""></div>'}\n\t\t\t\t</div>\n\t\t\t</div>`,populate:()=>{LhsNavigation.updateSubModuleCategory(),ContactsList.populate(),LhsModules.showBotsAsSeparateModule()||BotContactsList.populateBotContacts()}},MyChatsLHS=(()=>{let t=10,e=10,s=!1,a=s=>{LHSConstants.ChatsCategory.CHATS;let i=ConversationsList.getAll(),a=ConversationsUI.getSortedChatsList(),l=a.chatsarr,o=a.chatswithunread,r=a.chatswithdrafts,d=l.length,c="",p=0,h=void 0,m=!1,u="",v=0,g=void 0,f=!1,C="",y=0,_=void 0,S=!1;const T=ChatUI.isThreadAsSectionUnderChats();let L=d;for(let t=0;t<o.length;t++){let e=o[t][0];new $CliqChatId(e).isChannel()||ConversationsList.isPinned(e)||ConversationsList.isMuted(e)||((ConversationsList.isOnetoOneChat(e)||ConversationsList.isOneToOneGuestChat(e)||MyBots.isBotChid(e))&&(h=e),ConversationsList.isGroupChat(e)&&(g=e),ConversationsList.isThreadChat(e)&&(_=e))}let M=[];for(let t=0;t<r.length;t++)M.push(r[t][0]);l=r.concat(l);for(let s=0;s<L;s++){let a=M.length&&s+1<=M.length,n=l[s][0],o=$Util.cloneObject(i[n]);if(o.chid=n,new $CliqChatId(n).isChannel())continue;if(!a&&-1!=M.indexOf(n))continue;if(o.deleted||o.removed){ConversationsList.delete(o.chid);continue}let r=ConversationsList.parseDetails(o);if(!r||"channel"===r.profile)continue;let d="chats";if(ConversationsList.isPinned(n)&&(d="pinnedchats"),ConversationsList.isMuted(n)&&(d="mutedchats"),ConversationsList.isThreadChat(n)){if(!T||!ConversationsList.isThreadFollower(n))continue;d="threadchats"}if(!ConversationsList.isActiveChat(n)||ConversationsList.isPinned(n))continue;let L=ConversationsUI.getHtml(d,n,o,r);"contact"!==r.profile&&"bot"!==r.profile&&"guest"!==r.profile||!(p<t||a)&&m?"group"!==r.profile&&!r.profile.startsWith("chatlet_")||!(v<e||a)&&f?"thread"==r.profile&&(y<e||a||!S)&&(C+=L,y++,(_==n||!_&&y==e)&&(S=!0)):(u+=L,v++,(g==n||!g&&v==e)&&(f=!0)):(c+=L,p++,(h==n||!h&&p==t)&&(m=!0))}return(c=n(c,LHSConstants.MyChats.DM))+(u=n(u,LHSConstants.MyChats.GROUP))+(C=T?n(C,LHSConstants.MyChats.THREAD):"")},n=(t,e)=>{let s=Resource.getRealValue("chat.none");e==LHSConstants.MyChats.THREAD&&(s=Resource.getRealValue("threadchat.none")),$WC.Util.isEmpty(t)&&(t=`<div emptymsg="true" class="lhs-sub-item-empty" >${s}</div>`);let i=`<div id="${e}" class="">\n\t\t\t\t<div class="lhs-sub-hdr flexC justifySB">\n\t\t\t\t\t<div class="flexG font14 line20 LHS-name">{{hdr_txt}}</div>\n\t\t\t\t\t<div class="LHS-btn zcf-plusB font10 fshrink {{hide_action_class}}" documentclick="{{click_action}}"></div>\n\t\t\t\t</div>\n\t\t\t\t${t}\n\t\t\t</div>`,a="",n="",l="";return e===LHSConstants.MyChats.DM?(a="common.directmessages",n="quickDMChatPopup"):e===LHSConstants.MyChats.GROUP?(a="chat.adhoc.title",n="quickGroupChatPopup"):e==LHSConstants.MyChats.THREAD&&(a="common.threadchats",l="dN"),$WC.template.replace(i,{$hdr_txt:a,click_action:n,hide_action_class:l})},l=t=>{let e=t.chatsCont,s=t.category,i=t.removeFliter,a=t.retainingLastState;if(e.length){var n="channels"==s,l=$(e[0].querySelectorAll('[catagory="'+s+'"]:not([unread="true"])')),r=$(e[0].querySelectorAll('[catagory="'+s+'"][data-muted]'));i?(l.slideDown(),r.slideDown(),setTimeout((function(){LhsModules.updateUnreadNotifier()}),500),n&&e.children().removeClass("dN")):(a?(l.hide(),r.hide()):(l.slideUp(),r.slideUp()),n&&(e.children().addClass("dN"),o(e)),setTimeout((function(){LhsModules.updateUnreadNotifier()}),500))}},o=t=>{let e=Channels.getUnreadSubHeaderIds(),s=e.length;for(let a=0;a<s;a++){var i=e[a];t.find("#tab"+i).removeClass("dN")}},r=t=>{let e=`<div id="lhsunreadopts" class="mT20 flexC justifySB">\n\t\t\t\t<div class="unread-active flexC">\n\t\t\t\t\t<span  class="font13">${I18N("common.unread")}</span>\n\t\t\t\t\t<span id="lhsunreadclose" elemtype="clearChannelsUnreadChats" class="zchat-close mL8 diB font9 unread-close"></span>\n\t\t\t\t</div>\n\t\t\t\t<div id="lhsmarkasread" class="font12 fontB clr-theme curP" data-category="channels" elemtype="channelsMarkAllAsRead">${I18N("chat.markread.all")}</div>\n\t\t\t</div>`;t.append(e),t.find("#lhsreadstatusicn").removeClass("lhsallchats").addClass("lhsunreadchats"),t.find("#lhsunreadfilter").attr({title:I18N("chat.moreoptions.viewallchats"),"data-purpose":"viewAll"})},d=t=>{"viewUnread"===t.purpose?(s=!0,l(t),r(t.parentCont)):(t.removeFliter=!0,s=!1,l(t),(t=>{t.find("#lhsunreadopts").remove(),t.find("#lhsunreadfilter").attr({title:I18N("chat.moreoptions.viewunread"),"data-purpose":"viewUnread"}),t.find("#lhsreadstatusicn").removeClass("lhsunreadchats").addClass("lhsallchats")})(t.parentCont))};return{getSubModuleHtml:()=>{return`<div id="allchats_listing" class="flexG h100 flex-col mychats">\n\t\t\t\t<div id="my_chats_list" modules_scoller class="LHS-list-wrp flexG ovrflwA">\n\t\t\t\t\t${a()}\n\t\t\t\t</div>\n\t\t\t</div>`},addNewInUI:(t,e,a)=>{let n=e.length,l=[];if(0!==n){for(i=0;i<n;i++){let t=e[i],s=ConversationsList.get(t);if(void 0===s||Chat.isChannelChid(t)){let e=Channels.getByChid(t);$WC.Util.isEmptyObject(e)||(ConversationsList.updateConversationsDB([Channels.getChatObjFormat(e)]),s=ConversationsList.get(t))}s.chid=t;var o=ConversationsList.parseDetails(s);o&&("channel"!==o.profile||Channels.getObject(o.profileid)||s?void 0!==s&&(s.ispinned?(l.push(LHSConstants.ChatsCategory.PINNED),"channel"===o.profile?l.push(LHSConstants.ChatsCategory.CHANNELS):l.push(LHSConstants.ChatsCategory.CHATS)):"channel"===o.profile?l.push(LHSConstants.ChatsCategory.CHANNELS):"thread"===o.profile?l.push(LHSConstants.ChatsCategory.THREADS):l.push(LHSConstants.ChatsCategory.CHATS)):ConversationsList.delete(t))}var r=LhsModules.activeTabId==LHSConstants.ModuleIds.MYTEAMS||LhsModules.isSegmentedView()&&LhsModules.activeTabId==LHSConstants.ModuleIds.MYCHATS&&(l.indexOf(LHSConstants.ChatsCategory.CHATS)>=0||l.indexOf(LHSConstants.ChatsCategory.THREADS)>=0),d=r?LhsDomCache.getLHSModuleParent().find(LhsModules.activeTabId==LHSConstants.ModuleIds.MYTEAMS?"#channelslistholder":"#my_chats_list").scrollTop():0;l.indexOf(LHSConstants.ChatsCategory.PINNED)>=0&&LhsModules.activeTabId===LHSConstants.ModuleIds.MYPINS?(LhsNavigation.updateSubModuleCategory(),LeftPannel.LHSList.rearrangeLHSList(t),_doChangesIfInitialised(t),ConversationsUI.updateChatsHeaderHtml(LHSConstants.ChatsCategory.PINNED)):l.indexOf(LHSConstants.ChatsCategory.CHATS)>=0&&LhsModules.activeTabId===LHSConstants.ModuleIds.MYCHATS?(MyChatsLHS.populate(),LeftPannel.LHSList.rearrangeLHSList(LHSConstants.ChatsCategory.CHATS),_doChangesIfInitialised(LHSConstants.ChatsCategory.CHATS),ConversationsUI.updateChatsHeaderHtml(LHSConstants.ChatsCategory.CHATS||t)):l.indexOf(LHSConstants.ChatsCategory.THREADS)>=0&&(LhsModules.activeTabId===LHSConstants.ModuleIds.MYTHREADS||LhsModules.activeTabId===LHSConstants.ModuleIds.MYCHATS&&ChatUI.isThreadAsSectionUnderChats())?(MyThreadsLHS.populate(),LeftPannel.LHSList.rearrangeLHSList(LHSConstants.ChatsCategory.THREADS),_doChangesIfInitialised(LHSConstants.ChatsCategory.THREADS),ConversationsUI.updateChatsHeaderHtml(LHSConstants.ChatsCategory.THREADS||t)):l.indexOf(LHSConstants.ChatsCategory.CHANNELS)>=0&&LhsModules.activeTabId===LHSConstants.ModuleIds.MYTEAMS&&!s&&(LhsNavigation.updateSubModuleCategory(),_doChangesIfInitialised(t),ConversationsUI.updateChatsHeaderHtml(LHSConstants.ChatsCategory.CHANNELS||t)),r&&d&&(LhsDomCache.getLHSModuleParent().find(LhsModules.activeTabId==LHSConstants.ModuleIds.MYTEAMS?"#channelslistholder":"#my_chats_list").scrollTop(d),LhsModules.updateUnreadNotifier()),l.forEach((function(t){LhsModules.updateCounter(t)}))}},rearrangeCategory:(t,e)=>{if(void 0===t){t="chats";var s=e.chid,i=ChatUI.isChannel(e.ctype)?Channels.getChatObjFormat(Channels.getByChid(s)):ConversationsList.get(s);t=ChatUI.isMuted(s)?"mutedchats":!$.isEmptyObject(i)&&i.ispinned?"pinnedchats":t;var a=!$.isEmptyObject(i)&&i.ctype==$zcg.THREADCHAT;"chats"==t&&a&&ChatUI.isThreadAsSeparateTabOrUnderChatsInLhs()&&(t="threadchats")}ConversationsUI.rearrangeChats(t)},handleViewUnread:d,clearUnreadView:()=>{var t={purpose:"viewAll",parentCont:$("#lhsutilityopts"),category:"channels",chatsCont:$("#channelslist")};d(t)},populate:()=>{LhsNavigation.updateSubModuleCategory()},addUnreadUiChanges:r,readAllUnreadChats:t=>{if(t==LHSConstants.ChatsCategory.CHANNELS){var e=MyTeamsLHS.getLHSSearcVal(),s=MyTeamsLHS.getUnreadChatIDs(e);Chat.markAllChatsRead(t,s,(function(){MyTeamsLHS.LHSChannelsSort.clearUnreadChatsView()}))}}}})(),MyThreadsLHS=function(){const t=`<div class="flexG h100 flex-col mychats">\n        <div id="allchats_listing" modules_scoller class="flexG ovrflwA pB5">\n            <div id="threadchats" category="threadchats" class="recentchts separate-thread">\n                <div class="mAuto mT45 followed_empty_lhs"></div><div class="mT10 textC font13 clr-lp1">${Resource.getRealValue("threadchat.none")}</div>\n            </div>\n        </div>\n    </div>`;return{getSubModuleHtml:()=>t,populate:()=>{LhsNavigation.updateSubModuleCategory(),MyThreadsLHS.updateList()},updateList:()=>{LhsModules.activeTabId===LHSConstants.ModuleIds.MYTHREADS&&ConversationsList.populate("threadchats")}}}(),MyTeamsLHS=function(){let t,e={lastSearchVal:void 0},s=`<div id="tab{CHID}" catagory="channels" elemtype="channel" chid="{CHID}" uid="{OC_ID}" class="LHS-item {UNREADCOUNTCLASS}" profile="channel" {ISUNREAD} {PINATTR} {MUTEATTR}>\n\t\t\t<div id="tabscode{CHID}" class="zcf-channel LHS-info-icon mR10"></div>\n\t\t\t<div id="chnmultiicn" class="LHS-name flexC {CHN_ICONS}" elemname>\n\t\t\t    <span  id="channeldname_{OC_ID}" class="ellips">{CNAME}</span>\n\t\t\t    <span id="lhschnicon{CHID}" class="usrdtl-icns fshrink">{CHN_TYPE_ICON} {CHN_LCK} </span>\n\t\t    </div>\n\t\t    <div id="otherinfo{CHID}" class="LHS-icon-wrp flexC fshrink">\n\t\t    \t<div id="typingelem{CHID}" class="" typingelem></div>\n\t\t    \t<div id="msgcount{CHID}" class="LHS-count {MUTECSS}">{UNREADCOUNT}</div>\n\t    \t\t${Config.isConsolidatedLHSMoreActionEnabled()?'<div id="tabinfo{CHID}" tooltip-title="Show Info" class="zcf-infoS LHS-icon font20 pL10 line28"></div><div id="tabmore{CHID}" tooltip-title="More" class="zcf-more-stroke LHS-icon font20 line28"></div>':'<div id="tabpin{CHID}" title="{PINTITLE}" class="{PINCSS} LHS-icon"></div>'}\n\t\t    </div>\n\t\t</div>`,i=`<div id="lhsutilityopts" class="lhs-search-cont">\n\t\t\t<div id="lhschatssearch" class="flexC">\n\t\t\t\t<div class="lhs-chats-search flexC">\n\t\t\t\t\t<div class="zcf-search2 mR5"></div>\n\t\t\t\t\t<div class="zcl-search-input lhssrchfield flexC">\n\t\t\t\t\t\t<input id="lhs-chats-search-field" class="font14 curP w100 ovrflwH mR5" type="text" placeholder=${I18N("common.search")}>\n\t\t\t\t\t\t<span id="lhssearchclear" class="msi-chtclose" ></span>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div id="lhsChannelsSortIcon" class="lhs-channels-sort zcf-sort" elemtype="lhsChannelsSort"></div>\n\t\t\t</div>\n\t\t</div>`,a=()=>(()=>{MyTeamsLHS.show_LoadAll=!1;let t,e={limit:50,sort:!0,include_pinned:!0,listhtml:s,selectedSort:MyTeamsLHS.LHSChannelsSort.getSelectedSort()};return e.selectedSort==MyTeamsLHS.LHSChannelsSort.sortIdConstants.UNREAD&&0==MyTeamsLHS.getUnreadChatIDs().length&&(MyTeamsLHS.LHSChannelsSort.setSelectedSort(MyTeamsLHS.LHSChannelsSort.getLastPreviousUsedSort()),e.selectedSort=MyTeamsLHS.LHSChannelsSort.getSelectedSort()),t=_isLhsRevampEnabled()&&MyTeamsLHS.isLHSSearchFocused()&&!$WC.Util.isEmpty(MyTeamsLHS.getLHSSearcVal())?n():Channels.getJoinedFromLocalStorage(),Channels.SEGMENT=!0,(t.length>50||Channels.HAS_MOREJOINED)&&(MyTeamsLHS.show_LoadAll=!0),ChannelsUI.List.LHS.getCategorySegregatedHtml(t,e)})(),n=()=>{searchVal=MyTeamsLHS.getLHSSearcVal();var t={searchin:SearchAgent.CHANNELS,val:searchVal,ignorehtml:!0,isjoinedonly:!0,containssearch:!0,startswithsearch:!0,joinedchannelsearch:!0,successcallback:function(t){LHSHandler.openTeamsModule(!0),c()},limit:50},e=Channels.getSearchResults(t);return joinedchannels=e.content,joinedchannels},l=t=>{t[0].value="",t.focus(),o(),r("")},o=e=>{var s=e?e.currentTarget:$("#lhs-chats-search-field")[0],i=$.trim(s.value);e&&e.keyCode==$zcg.ESCAPE_KEYCODE&&(e.stopPropagation(),i="",s.value=""),t=i,r(i);var a=s.getAttribute("data-val");s.setAttribute("data-val",i),i!=a&&(LHSHandler.openTeamsModule(!0),c())},r=t=>{var e=$("#lhssearchclear");t.length&&!e.is(":visible")?e.removeClass("dN"):t.length||e.addClass("dN")},d=t=>{var e=$DB.get("conversations"),s=[];for(var i in e)if(e[i].unreadtime>0&&Chat.isChannel(i)&&!ConversationsList.isMuted(i)){var a=e[i].title.toLowerCase();t?t&&a.includes(t)&&s.push(i):s.push(i)}return s},c=e=>{0==(a=d(i).length)&&MyTeamsLHS.LHSChannelsSort.getSelectedSort()==MyTeamsLHS.LHSChannelsSort.sortIdConstants.UNREAD&&LHSHandler.openTeamsModule();var s=$("#lhsunreadfilter");if(s.length){var i=p()?t.toLowerCase():"",a=d(i).length;"enable"==(e=e||a?"enable":"disable")?s.removeClass("dN"):s.addClass("dN")}},p=()=>{var t=$("#lhs-chats-search-field");return t&&t.is(":focus")&&t[0].hasAttribute("data-val")},h=()=>t?t.toLowerCase():"";return{show_LoadAll:!1,getSubModuleHtml:()=>{let t=a(),e=`<div id="channelslhs" class="flexG ovrflwH flex-col">\n\t\t\t\t<div id="channelsheader" class="LHS-title lhs-sub-hdr">\n\t\t\t\t\t<div class="LHS-name flexC">\n\t\t\t\t\t\t<span class="ellips">{{channels_hdr}}</span>\n\t\t\t\t\t\t<span class="fshrink mT2">\n\t\t\t\t\t\t\t<span class="dot-sprtr mLR10"></span>\n\t\t\t\t\t\t\t<span workfor="channel" elemtype="join" class="LHS-join cur">\n\t\t\t\t\t\t\t\t<span class="LHS-join-txt line22">${I18N("common.join")}</span>\n\t\t\t\t\t\t\t\t<span id="newcount" elemtype="morecount" class="LHS-count" title="" style="display: none;"></span>\n\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t</span>\n\t\t\t\t\t</div>\n\t\t\t\t\t<span id="createorjointip" class="fshrink">\n\t\t\t\t\t\t<span class="LHS-btn zcf-plusB font10" workfor="channel" elemtype="create"></span>\n\t\t\t\t\t</span>\n\t\t\t\t</div>\n\t\t\t\t<div modules_scoller id="channelslistholder" class="flexG ovrflwA channels-list">\n\t\t\t\t\t<div id="channelspendinglist" class="LHS-pending-channel mB10" style="display: block;"></div>\n\t\t\t\t\t<div id="channelslist">${t}</div>\n\t\t\t\t</div>\n\t\t\t</div>`,s=`<div id="lhssearchemptystate" class="lhssearchnores mT60">\n\t\t\t\t<div class="search_empty mL30"></div>\n\t\t\t\t<div class="mT5 font13 textC lhsemptysearch">${I18N("common.search.empty")}</div>\n\t\t\t</div>`;var n=_isLHSChatSearchEnabled();return n&&!p()?e=i+e:n&&p()&&!t.length&&(e=s),$WC.template.replace(e,{$channels_hdr:"menuname.channelsandgroups"},"InSecureHTML")},populate:()=>{LhsNavigation.updateSubModuleCategory()},addPinUnpinInUI:(t,e)=>{var s=$("#channelslhs").find("[chid="+t+"]"),i=s.find("#tabpin"+t);e?(i.removeClass("zcf-pinB").addClass("zcf-unpin"),i.attr("title",I18N("common.channel.unpin")),s.attr("data-pinned","")):(i.addClass("zcf-pinB").removeClass("zcf-unpin"),i.attr("title",I18N("common.channel.pin")),s.removeAttr("data-pinned"))},getUnreadChatIDs:d,updateUnreadFilter:c,updateMuteUI:(t,e)=>{var s=$("[chid="+e+"]"),i=s.find("#msgcount"+e);let a=s.find("#mentionedIcon"+e);t?(s.attr("data-muted",""),i.addClass("mute"),a.addClass("mute")):(s.removeAttr("data-muted"),i.removeClass("mute"),a.removeClass("mute"))},arrangeChatsInUnreadView:(t,e)=>{var s=$("[elemtype=channel][chid="+t+"]");"show"!=e||s.is(":visible")?"hide"==e&&s.is(":visible")&&s.slideUp():(s.parents("#channelssublist").prepend(s),s.slideDown())},isLHSSearchFocused:p,getSearchSortedList:t=>{for(var e=[],s=[],i=0;i<t.channelsList.length;i++){var a=t.channelsList[i],n=Channels.getNameWithoutHash(t.channelsObj[a].cn).toLowerCase();t.channelsObj[a].chid;t.searchVal=t.searchVal.toLowerCase(),n.startsWith(t.searchVal)?e.push(a):n.includes(t.searchVal)&&s.push(a)}return e.concat(s)},handleChatsInUnreadState:(t,e)=>{var s=Chat.isChannel(t);LhsModules.activeTabId==LHSConstants.ModuleIds.MYTEAMS&&s&&!ConversationsList.isMuted(t)&&(c(),MyTeamsLHS.LHSChannelsSort.getSelectedSort()==MyTeamsLHS.LHSChannelsSort.sortIdConstants.UNREAD&&MyTeamsLHS.arrangeChatsInUnreadView(t,e))},getLHSSearcVal:h,getNewLHSChanneslListHtml:()=>s,updateLastRecentState:function(){e.lastSearchVal=h()},retainLastRecentState:function(){if(MyTeamsLHS.LHSChannelsSort.getSelectedSort()==MyTeamsLHS.LHSChannelsSort.sortIdConstants.UNREAD&&MyChatsLHS.addUnreadUiChanges($("#lhsutilityopts")),e.lastSearchVal){var t=$("#lhs-chats-search-field");t.val(e.lastSearchVal),t.focus(),o()}},LHSChannelsSort:{templates:{menuIconContentCont:"<em class='zcl-menu-item-icn {{ICON_CLASS}} {{CUSTOM_CLASS}}'></em><span class='ellips'>{{MENU_ITEM_CONT}}</span>"},stringifiedSelectedSortData:void 0,sortIdConstants:{RECENT:"1",ALPHABET:"2",UNREAD:"3"},lastSelectedSort:void 0,lastPreviousUsedSort:void 0,clearExistingOptnsMenu:function(){let t=$("#lhsChannelsSortOptns");if(t.length){let e=t.attr("id");return t.remove(),Clickoutside.clear(e),!0}return!1},initializeSelectedSortInfo:function(){this.stringifiedSelectedSortData=Settings.getFromObj("selected_lhs_channels_sort",!0),this.lastSelectedSort=this.stringifiedSelectedSortData.split(",")[1],this.lastPreviousUsedSort=this.stringifiedSelectedSortData.split(",")[0]},createAndAppendOptnsList:function(){let t={parentId:"lhsChannelsSortOptns",parentClass:"no-pointer lhs-channels-sort-optns font14",parentCustomAttr:"closeonscroll style='z-index: 999'",options:[{className:"",content:$WC.template.replace(this.templates.menuIconContentCont,{ICON_CLASS:"zcf-event-clock",CUSTOM_CLASS:"",MENU_ITEM_CONT:I18N("channels.sort.recent")}),customAtt:`data-sort='${this.sortIdConstants.RECENT}'`},{className:"",content:$WC.template.replace(this.templates.menuIconContentCont,{ICON_CLASS:"zcf-alphabet-sort",CUSTOM_CLASS:"",MENU_ITEM_CONT:I18N("channels.sort.alphabetical")}),customAtt:`data-sort='${this.sortIdConstants.ALPHABET}'`},{className:MyTeamsLHS.getUnreadChatIDs().length?"":"dN",content:$WC.template.replace(this.templates.menuIconContentCont,{ICON_CLASS:"zcf-unreadchats",CUSTOM_CLASS:"",MENU_ITEM_CONT:I18N("channels.sort.unread")}),customAtt:`data-sort='${this.sortIdConstants.UNREAD}'`}]};this.lastSelectedSort||this.initializeSelectedSortInfo();let e=this.lastSelectedSort;e=1*e-1,t.options[e].className+=" sel_status";let s=DROP_DOWN.getHtml(t);$("body").append(s)},addPostioningStyles:function(t,e){let s=$Util.getElememtProperties($("#lhsChannelsSortIcon")),i={};i.top=s.offsetBottom+3,i.left=s.offsetLeft,t.css(i)},handleClickForPinsOptnsMenu:function(t){Clickoutside.handleClickOnChild(t);let e=t.currentTarget.getAttribute("data-sort");Object.values(this.sortIdConstants).includes(e)&&e!=this.getSelectedSort()&&(this.setLastPreviousUsedSort(this.getSelectedSort()),this.setSelectedSort(e),LHSHandler.openTeamsModule(),this.lastSelectedSort==MyTeamsLHS.LHSChannelsSort.sortIdConstants.UNREAD&&MyChatsLHS.addUnreadUiChanges($("#lhsutilityopts")),this.stringifiedSelectedSortData=`${this.getLastPreviousUsedSort()},${this.getSelectedSort()}`,Settings.update({selected_lhs_channels_sort:this.stringifiedSelectedSortData}))},bindEventsForOptnsList:function(t,e){t.getAttribute("id");let s=e[0].getAttribute("id");Clickoutside.bind({srcid:t,destid:s,customHide:function(){e.remove()}});let i=this;e.on("click","[data-sort]",(function(t){i.handleClickForPinsOptnsMenu(t)}))},handleSortIconClick:function(t,e){if(t.stopPropagation(),this.clearExistingOptnsMenu())return;this.createAndAppendOptnsList();let s=$("#lhsChannelsSortOptns");this.addPostioningStyles(s,t),this.bindEventsForOptnsList(e,s)},clearUnreadChatsView:function(){this.setSelectedSort(this.getLastPreviousUsedSort()),LHSHandler.openTeamsModule()},setSelectedSort:function(t){this.lastSelectedSort=t},getSelectedSort:function(){return this.lastSelectedSort||this.initializeSelectedSortInfo(),this.lastSelectedSort},setLastPreviousUsedSort:function(t){this.lastPreviousUsedSort=t},getLastPreviousUsedSort:function(){return this.lastPreviousUsedSort}},bindEventsForUnreadFilter:t=>{if(!p()){var e=t.find("#lhs-chats-search-field");t.on("click","[data-purpose]",(function(t){var e=t.currentTarget,s=e.getAttribute("data-purpose"),i=e.getAttribute("data-category"),a={purpose:s,parentCont:$("#lhsutilityopts"),category:i,chatsCont:$("#channelslist")};MyChatsLHS.handleViewUnread(a)})),e.on("keyup",(function(t){o(t)})),t.find("#lhssearchclear").on("click",(function(){l(e)})),r("")}}}}(),MyFiles=function(){let t={mainContainer:'<div id="mycliqfiles_view" class="wh100 flex fdirC">\n\t        \t\t\t{{container_header}}\n\t        \t\t<div id="mycliqfiles_listview" class="flexG ovrflwA h100">\n\t        \t\t\t{{container_content}}\n\t        \t\t</div>\n\t        \t</div>',headerContainer:'<div class="w100 flex justifySB">\n\t    \t\t\t<div class="flexG flexC posrel">\n\t        \t\t\t<div class="flexC fshrink" style="line-height: 1;">\n\t        \t\t\t\t<div class="zcf-mediagallery clr-icons mR10"></div>\n\t        \t\t\t\t<div class="font16 clr-H fontB" style="margin-bottom: 2px;">{{file_hdr}}</div>\n\t        \t\t\t</div>\n\t        \t\t\t<div class="posabs">{{filetype_filter}}</div>s\n\t    \t\t\t</div>\n\t    \t\t</div>'},e=["showCliqFiles","showTazFiles","showRecordings"],s=[{id:"showCliqFiles",purpose:"showCliqFiles",icon:"zcf-mediagallery",name:"ml.sharedin.cliq",type:e[0]},{id:"showTazFiles",purpose:"showTazFiles",icon:"zcf-mediagallery",name:"settings.noti.taz",type:e[1]}];s.push({id:"showRecordings",purpose:"showRecordings",icon:"zcf-meeting",name:"media.recordings",type:e[2]});let i=(t,e)=>$WC.template.replace(e,{item_id:t.id,item_purpose:t.purpose,icon_cls:t.icon,item_type:t.type,$name:t.name,active_cls:t.id===MyFiles.last_accessed?"chatsel":""}),a=e=>{let s=t.mainContainer,i=MediaListingUI.getHeaderHtml(!0,e),a=(t=>"showTazFiles"===t?MediaListingUI.getAllFiles(ChatBot.getChid()):"showRecordings"===t?(AppliedFilter[0]={},ZCTrack.track("MEDIA_GALLERY_FEATURE",{SOURCE:"LHS Files Tab",TYPE:"Recordings"}),MediaListingUI.getRecordings({share_type:MediaListingUI.getSelectedRecordingCategory()})):MediaListingUI.getAllFiles())(e);s=$WC.template.replace(s,{container_header:i,container_content:a},"InSecureHTML"),LhsNavigation.updateRHSView(s)};return{last_accessed:"showCliqFiles",showMyCliqFiles:a,showSelectedSourceData:(t=MyFiles.last_accessed)=>{MyFiles.last_accessed=t,a(t),MediaListingUI.highlightType(MediaListingUI.getLastAccessedMediaType()),(t=>{$("#sharedfilesources").find('[type="'+t+'"]').addClass("chatsel").siblings().removeClass("chatsel")})(t),MediaListingUI.bindEvents($("#mycliqfiles_view")),routingPaths.files.hasOwnProperty(t)&&ZCPermalink.updateUrl(routingPaths.files[t])},getSubModuleHtml:()=>{let t=`<div id="sharedfiles" class="flexG h100 flex-col">\n\t\t\t\t<div id="fileslistheader" class="lhs-sub-hdr fshrink">\n\t\t\t\t\t<span class="LHS-name">{{files_hdr}}</span>\n\t\t\t\t</div>\n\t\t\t\t<div id="fileslistholder" class="flexG ovrflwA">\n\t\t\t\t\t<div id="sharedfilesources" class="">${(()=>{var t="";for(var e of s)t+=i(e,'<div class="lhs-sub-item ellips {{active_cls}} LHS-item" id="{{item_id}}" purpose="{{item_purpose}}" type={{item_type}}>\n\t\t\t\t<div class="item-icn {{icon_cls}}"></div>\n\t\t\t\t<div class="item-name ellips">{{name}}</div>\n\t\t\t</div>');return t})()}</div>\n\t\t\t\t</div>\n\t\t\t</div>`;return $WC.template.replace(t,{$files_hdr:"media.files"},"InSecureHTML")}}}(),TasksLHS=function(){let t,e=!1,s=["tasks","issues"],i=`<div class="lhs-search-cont">\n\t\t<div id="lhstaskssearch" class="flexC">\n\t\t\t<div class="lhs-tasks-search flexC">\n\t\t\t\t<div class="zcf-search2 mR5"></div>\n\t\t\t\t<div class="zcl-search-input lhssrchfield flexC">\n\t\t\t\t\t<input id="lhs-tasks-search-field" class="font14 curP w100 ovrflwH mR5" type="text" placeholder=${I18N("common.search")}>\n\t\t\t\t\t<span id="lhssearchclear" class="msi-chtclose zcl-search-clear bdrN"></span>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\t</div>`,a=(t,e,s)=>$WC.template.replace('<div id="tabproject-{{id}}" purpose="showTasksForProject" iframe_url="{{url}}" project_id="{{id}}" chat_id="" class="lhs-sub-item ellips LHS-item {{active_class}}">\n\t\t\t<div title="{{name}}" class="LHS-name flexC">\n\t\t\t\t<span class="ellips">{{name}}</span>\n\t\t\t\t<div class="fav-icn {{icon_class}}"></div>\n\t\t\t\t<span class="zcl-rloader zcl-rloader-lhs xs mL10"></span>\n\t\t\t</div>\n\t\t</div>',{id:t.id,name:Resource.getRealValue(t.label),url:t.url,icon_class:void 0!==e?e:"dN",active_class:s?"chatsel":""}),n=(t,e)=>{let i="";var n=$("#lhs-tasks-search-field").val();n=void 0!==n?n.trim().toLowerCase():"";for(let l=0;l<s.length;l++){let o=t[s[l]];if(void 0!==o){i+=$WC.template.replace('<div class="lhs-sub-hdr"><span class="LHS-name">{{hdr}}</span></div>',{$hdr:"projects."+s[l]});for(let t=0;t<o.length;t++){let s,l=o[t];if("favorite"==l.type&&(s="msi-starsel"),""!==n&&-1===l.name.toLowerCase().indexOf(n))continue;let r=l.id==e;i+=a(l,s,r)}}}return $WC.Util.isEmpty(i)&&(i=""!==n?`<div id="lhssearchemptystate" class="lhssearchnores mT60">\n\t\t\t\t\t<div class="search_empty mL30"></div>\n\t\t\t\t\t<div class="mT5 font13 textC lhsemptysearch">${I18N("common.search.empty")}</div>\n\t\t\t\t</div>`:`<div emptymsg="true" class="lhs-sub-item-empty">${Resource.getRealValue("apptabs.initial.none")}</div>`),i};var l=function(t){ZProjects.fetchProjectViewsFromServer(t,(function(t){LhsModules.activeTabId===LHSConstants.ModuleIds.MYTASKS&&(LhsNavigation.updateSubModuleCategory(),ZProjectsTabUI.bindPortalsDropDown())}),(function(t){if(LhsModules.activeTabId===LHSConstants.ModuleIds.MYTASKS){var e='<div class="mT60 pLR15"><div class="clr-halfW textC font14 line20">{{error}}</div>{{btn}}</div>';if(void 0!==t.code&&"user_not_in_portal"===t.code)e=$WC.template.replace(e,{$error:"projects.user.not.in.portal",btn:""}),$("#module_content").html(e);else{let t=function(){if($zcg._ISSUPERADMINPORTALEXISTS){var t=_isAppAccountAdmin();e=$WC.template.replace(e,{$error:t?"projects.portal.error.admin":"projects.portal.error.user"}),e=$WC.template.replace(e,{$btn:t?$WC.template.replace('<div class="flexM mT20"><a target="_blank" href="/setup/zohoprojects"><div class="zcl-btn-xs zcl-btn--primary">{{text}}</div></a></div>',{$text:"common.configure"}):""},"InSecureHTML")}else e=$WC.template.replace(e,{$error:"zp.cliq.portal.not.mapped",btn:""});$("#module_content").html(e)};ZProjects.isSuperAdminPortalExists(t)}}}),t)},o=function(e,s,i,a){t=e;var n=$("#tasks_list");n.find(".chatsel").removeClass("chatsel"),n.find(".zc-tasks-ldng").removeClass("zc-tasks-ldng"),$("#tabproject-"+e).addClass("chatsel");r(e,s,!0,(function(){$("#projectstab-main").find('[purpose="openMappedChannel"]').removeClass("dN"),"function"==typeof a&&a()}));var l=$("#projectstab-main");let o=l.find('[purpose="openMappedChannel"]');o.setAsDraggable({draggablearea:o,dragboundary:l}),MainUI.getMefront("project-"+e,!0)},r=function(t,e,s,i,a){var n=$("#projectstab-main"),l=n.find("iframe");if(l.length>0&&!a){let a,o,r=l.attr("project_id"),d={};if(s){let e=t.split("_");d.customview_id=e[1],o=e[0]}else{d.project_id=t,o=new URL(e).searchParams.get("to_view")}if(a="load_"+o,r==t&&(s||n.attr("activetab")==o))return void("function"==typeof i&&i());l.attr("project_id",t),$zcg._ISCLIQPROJECTSPORTAL&&!$zcg._ISPAIDPROJECTSPORTAL&&(d.hide="rightsidepanel"),l[0].contentWindow.postMessage({service:"cliq",type:a,input:d},$zcg._PROJECTS_SERVER_URL),"function"==typeof i&&i()}else{$("#project-"+t).addClass("zc-tasks-ldng");var o=e+"&frameorigin=";"wp"!==$zcg._PARENTSERVICENAME&&"zohoone"!==$zcg._PARENTSERVICENAME||$WC.Util.isEmpty($zcg._WORKPLACEFRAMEORIGIN)?o+=window.location.origin:o+=$zcg._WORKPLACEFRAMEORIGIN+","+window.location.origin,o=ZProjectsUtil.addProjectsThemeParam(o);var r=ZProjectsUtil.getIframeHTML(o,t,(function(){var e=$("#projectstab-main");e.find("#applet-center-loader").remove(),e.find('iframe[service="projects"]').removeClass("dN"),$("#project-"+t).addClass("chatsel").removeClass("zc-tasks-ldng"),void 0!==i&&i()}));d(n),n.find("#projectstab-iframe").html(r)}},d=function(t){t.on("click","[projects-btn]",t=>{let e=$(t.currentTarget),s=e.attr("purpose");if("switchProjectModule"===s){if(!$(e).hasClass("sel")){let t=e.attr("data-type"),s=$("#projectstab-main");if(s.attr("activetab",t),e.siblings().removeClass("sel").removeAttr("data-selected"),e.addClass("sel").attr("data-selected",""),"tasks"==t){if((i=s.find("iframe")).length>0){let e=i.attr("project_id"),s=new URL(i.attr("src")),a=[routingPaths.projects,s.pathname.split("/")[2],e,t];ZCPermalink.updateUrl(a.join("/"));let n={project_id:e};$zcg._ISCLIQPROJECTSPORTAL&&!$zcg._ISPAIDPROJECTSPORTAL&&(n.hide="rightsidepanel"),i[0].contentWindow.postMessage({service:"cliq",type:"load_tasks",input:n},$zcg._PROJECTS_SERVER_URL)}}else if("issues"==t){var i;if((i=s.find("iframe")).length>0){let e=i.attr("project_id"),s=new URL(i.attr("src")),a=[routingPaths.projects,s.pathname.split("/")[2],e,t];ZCPermalink.updateUrl(a.join("/"));let n={project_id:e};$zcg._ISCLIQPROJECTSPORTAL&&!$zcg._ISPAIDPROJECTSPORTAL&&(n.hide="rightsidepanel"),i[0].contentWindow.postMessage({service:"cliq",type:"load_issues",input:n},$zcg._PROJECTS_SERVER_URL)}}else"notification"==t&&ZProjectsSettingUI.showNotificationSettings(e.attr("chid"),e.attr("project_id"))}}else if("openMappedChannel"===s){let t=e.attr("chid");ZProjectsUtil.openChatInRhs(t)}})};return{getSubModuleHtml:function(e){var s=ZProjects.getProjectViews();if($zcg._PROJECTS_MULTI_PORTAL_ENABLED&&void 0!==e){let t=ZProjects.getPortals();if(void 0!==t){let s=t.filter((function(t){return t.unique_name==e}));if(0!=s.length&&ZProjects.getSelectedPortalId()!=s[0].id)return l(s[0].id),TemplateUtil.getSubListLoader()}}if(void 0!==s){let e,l=$("#chatsection");if(l.hasClass("channel-tasks-view")){let t=new $CliqChatId(MainUI.currentchat).getParentChatId();l.removeClass("channel-tasks-view");let e=$("#"+t);e.find('[purpose="showMessages"]').addClass("sel"),e.find('[purpose="showProjects"]').removeClass("sel"),ChatUI.exist[t].retainScrollOnVisible()}if(void 0===t){let i=s.tasks[0];t=i.id,e=i.url}let o=`<div class="flexG flex-col h100" multi-portal="{{multi_portal}}">\n\t\t\t\t\t<div class="lhs-sub-hdr projects-hdr"><span class="LHS-name">{{projects}}</span></div>\n\t\t\t\t\t<div id="tasks_list_header" class="lhs-sub-hdr lhs-task-hdr fshrink portal-switch">\n\t\t\t\t\t\t<div class="zcdrpdwn cur drpdwn-wrp flexC" portals_drpdwn>\n\t\t\t\t\t\t\t<span id="portal_name" class="protal-hdr ellips" title="{{hdr}}">{{hdr}}</span>\n\t\t\t\t\t\t\t<em id="portal_drpdwn" class="zcf-downArrow font12 mL4"></em>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class="flexG ovrflwA">\n\t\t\t\t\t\t<div id="tasks_list">${n(s,t)}</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>`;s.length>10&&(o=i+o);var a=ZProjects.getSelectedPortalName();return void 0===a&&(a="projects.list"),MainUI.getMefront("project-"+t,!0),r(t,e,!0,(function(){$("#projectstab-main").find('[purpose="openMappedChannel"]').removeClass("dN")})),document.location.href.includes("/projects/")||ZCPermalink.updateUrl(routingPaths.projects),ZCTrack.track("TASK_MANAGEMENT_SECTION",{TRIGGER:"Section click"}),$WC.template.replace(o,{$hdr:a,$projects:"projects.list",multi_portal:$zcg._PROJECTS_MULTI_PORTAL_ENABLED})}return l(),TemplateUtil.getSubListLoader()},showTasksForProjectFromElem:function(t){o(t.attr("project_id"),t.attr("iframe_url"),t.attr("chat_id"))},getProjectListHtml:n,checkAndRenderIframe:r,isProjectInViewPort:function(){return e},handleRemovedFromViewPort:function(){e=!1},handleAddedToViewPort:function(){e=!0}}}(),PeopleModule=function(){let t,e,s,i,a,n,l={mainContainer:'<div class="wh100 flex ovrflwH" >\n\t\t\t\t\t<div class="fdirc wh100 ovrflwH">\n\t\t\t\t\t\t<div class="main-container-header ovrflwH fshrink people-cont-header">\n\t\t\t\t\t\t\t{{container_header}}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div id="people_listview" zc_sticky_title_list class="flexG ovrflwA user-card-container">\n\t\t\t\t\t\t\t{{container_content}}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div id="peopleUserPreviewCnt" class="people-user-preview-cnt hide userdetail fdirC">\n\t\t\t\t\t\t<div id="peoplePreviewHdr" class="people-user-preview-hdr posrel flexC">\n\t\t\t\t\t\t\t<div id="peoplePreviewSubHdr" class="winheader zcl-hdrline"></div>\n\t\t\t\t\t\t\t<div class="people-preview-close zcf-closeB zcl-icon--filled2" documentclick="closePeoplePreview"></div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div id="peopleUserPreview" class="people-user-preview flexG"></div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>',headerHtml:'<div class="w100 flex justifySB">\n\t    \t\t\t<div class="flexG flexC">\n\t        \t\t\t<div class="flexC fshrink" style="line-height: 1;">\n\t        \t\t\t\t<div class="{{icn_cls}}  module-icn clr-icon"></div>\n\t        \t\t\t\t<div class="font16 clr-H fontB" style="margin-bottom: 2px;">{{hdr_txt}}</div>\n\t        \t\t\t</div>\n\t        \t\t\t<div class="mLR30 flexG">\n\t\t        \t\t\t<div class="fshrink">\n\t\t\t\t\t\t\t\t<div id="peoplesearchcont" class="zcl-search2" style="max-width: 50%; margin: auto;">\n\t\t\t\t\t\t\t\t    <span class="zcf-search2 zcl-seach-icon"></span>\n\t\t\t\t\t\t\t\t    <div class="zcl-search-input">\n\t\t\t\t\t\t\t\t        <input type="text" id="user-search-field" placeholder="{{placeholder}}">\n\t\t\t\t\t\t\t\t    </div>\n\t\t\t\t\t\t\t    </div>\n\t\t\t\t\t\t\t</div>\n\t        \t\t\t</div>\n\t    \t\t\t</div>\n\t    \t\t</div>',peopleSubModuleHtml:'<div class="lhs-sub-item ellips LHS-item {{active_cls}}" id="{{item_id}}" purpose="showPeopleSubModule" data-view="{{dataView}}">\n\t\t\t\t\t<div class="item-icn {{icon_cls}}"></div>\n\t    \t\t\t<div class="item-name ellips flexG">{{name}}</div>\n\t\t\t\t\t<div class="LHS-icon-wrp flexC fshrink"><div id="{{item_id}}_counter" class="LHS-count "></div></div>\n\t\t\t\t</div>',emptySearchResHtml:`<div class="flexG wh100 flexM fdirC">\n\t\t\t\t\t<div class="zcempty-img search_empty"></div>\n\t\t\t\t\t<div class="zcempty-title font20">${Resource.getRealValue("history.search.none")}</div>\n\t\t\t\t</div>`,emptyUsersHtml:'<div class="flexG wh100 flexM fdirC">\n\t\t\t\t\t<div class="zcempty-img people-myreports-empty"></div>\n\t\t\t\t\t<div class="zcempty-title font20 pL20">{{infoMsg}}</div>\n\t\t\t\t</div>'},o="myDeptMembersView",r="myReporteesView",d="allUsersView",c=!1,p=null,h=t=>{switch(t){case r:return!(a&&!a.length);case o:return!(i&&!i.length);case d:return!0}},m=()=>{e&&e.blur(),$("#peoplesearchcont").addClass("lhs-people-search-disable")},u=()=>$WC.template.replace(l.mainContainer,{container_header:v()},"InSecureHTML"),v=()=>$WC.template.replace(l.headerHtml,{icn_cls:"zcf-peopledirectory",$hdr_txt:"smiley.people",$placeholder:"quickchat.node.placeholder"}),g=t=>t===r?f():t===o?C():void 0,f=()=>{if(void 0!==a){return y(a,void 0,r)}let t=RemoteWork.isEnabled()?RemoteWork.getCurrentUserReporteeDetails():void 0;return void 0!==t?y(a=t,void 0,r):(S(),PeopleCardUI.getMultiCardLoader())},C=()=>{if(void 0!==i){return y(i,void 0,o)}let t=RemoteWork.isEnabled()?RemoteWork.getUserDeptDetails():void 0;if(void 0!==t){return i=t,y(t)}return T(),PeopleCardUI.getMultiCardLoader()},y=(t,e,s)=>{if(!t.length&&(s===r||s===o)){let t;return m(),t=s===r?Resource.getRealValue("my.direct.reports.empty"):Resource.getRealValue("my.dept.members.empty"),$WC.template.replace(l.emptyUsersHtml,{infoMsg:t})}let i;i=s===d?$Util.sort(t,"usage_count",!0):$Util.sortString(t,"first_name");if(e){e=e.toLowerCase();let t=[],s=[];for(let a=0;a<i.length;a++){let n=i[a].display_name.toLowerCase(),l=i[a].email_id.toLowerCase();n.startsWith(e)||l.startsWith(e)?t.push(i[a]):(n.includes(e)||l.includes(e))&&s.push(i[a])}if(0===(i=t.concat(s)).length)return l.emptySearchResHtml}let a=_(i);return H(a)},_=t=>{let e=[];for(let s=0;s<t.length;s++)e.push(t[s].zuid);return e},S=()=>{let t=Users.sourceIdConstants.LHS_ORG;$ZCAjx.ajax({url:"/v2/users/"+$zcg._ZUID+"/reportees?fields=all,user_status",type:"GET",data:{source:t},success:function(t){M(t,r)},error:function(){I()}})},T=()=>{$ZCAjx.ajax({url:"/api/v2/me?source=remote_tools",type:"GET",success:function(t){L(t)},error:function(){I()}})},L=t=>{if(void 0===t.department){return void M({data:[]},o)}let e=t.department.id;$ZCAjx.ajax({url:"/v2/departments/"+e+"/members?limit=1000&fields=all,user_status",type:"GET",success:function(t){M(t,o)},error:function(){I()}})},M=(t,e)=>{PeopleServerData.updateProfileInfoOfUsersArr(t.data,!0);let l=t.data;e==r?a=t.data:e===o&&(i=t.data);let d=y(l,void 0,e);n===e&&s.html(d)},I=()=>{s.html($Util.apiErrorStateHTML())},w=(t="",e=100)=>{let s={peopledata:!0,emailid:!0,val:t,limit:e,getfrompeoplesearch:!0,restricttosameorg:!0,successcallback:PeopleModule.handleAsyncFetch},i=Users.getSearchResults(s);if(i.furtherreq&&0==i.searchedlist.length){let e=$zcg._ACTIVE_ORG_USERS_COUNT<100?$zcg._ACTIVE_ORG_USERS_COUNT:100;return!t.length&&i.searchedlist.length<e&&(t=>{let e={fields:"all",limit:t,source:Users.sourceIdConstants.LHS_ORG};$ZCAjx.ajax({url:"/v2/users",type:"GET",data:e,success:function(t){M(t,d)},error:function(){I()}})})(e),PeopleCardUI.getMultiCardLoader()}{let t=i.searchedlist;return H(t)}},H=t=>{let e="";return t.length&&t.forEach(t=>{e+=PeopleCardUI.getUserCard(t)}),$WC.Util.isEmpty(e)?"":`<div class="flex flexW">${e}</div>`},b=()=>{s=$("#people_listview"),e.on("keyup",t=>{PeopleModule.handleSearch($(t.target),t)})},A=e=>{c=e.length>0,p=e.length>0?e:null,clearTimeout(t),t=setTimeout((function(){if(s.html(PeopleCardUI.getMultiCardLoader()),n===d)PeopleModule.updateListView(e,100);else{let t=n===o?i:a;s.html(y(t,e))}}),300)},E=()=>{clearTimeout(t),e.val(""),O("*")},O=(t,e)=>{let i=w(t,e);$WC.Util.isEmpty(i)&&(i=l.emptySearchResHtml),s.html(i)},R=(t,e,s,i)=>{var a=$("#peoplePreviewSubHdr"),n=a.find("[elemtype]"),l='<span id="hdr{{uid}}" data-key="{{uid}}" elemtype="{{type}}" purpose="search">{{dname}}</span>';l=$WC.template.replace(l,{uid:t,type:s,dname:e}),UserInfo.bindEvents($("#peopleUserPreviewCnt"));var o=a.find("#hdr"+t);o.length?o.nextAll().remove():i&&i[0].hasAttribute("data-peoplepreview")||!n.length?a.html(l):a.append(l),a.children().length>1?($("#peoplePreviewHdr").addClass("people-multi-subhdr"),a.removeClass("zcl-hdrline")):($("#peoplePreviewHdr").removeClass("people-multi-subhdr"),a.addClass("zcl-hdrline"))},D=t=>{t.empty();let e=`<div id="transcriptviewholder" purpose="transcriptholder" class="currchatpanel">${Template.messageArea}</div>`;t.html(e)},U=function(t){let e=t.chid,s=$("#transcriptviewholder");if(StorageManager.getStorage(e,t.id).getList().isEmpty()){s.empty();var i=$Util.emptyStateHtml({imageclass:"no_chats",title:Resource.getRealValue("channel.conv.none"),fontsize:"18",subtitle:Resource.getRealValue("channel.conv.none.chat")+'<em code=":smile:" title=":smile:" class="zcslymsg-smile"></em>'});return void s.html(i)}ConversationsList.getUnreadCount(e)&&$("#userrecentchat"+e).removeClass("unseen");$("#userrecentchat"+e);let a='<div class="zcflt_btn"><div class="zcl-btn zcl-btn--primary" purpose="continue" chid="{{chid}}" operationfor="chat">{{continue_txt}}</div></div>';a=$WC.template.replace(a,{chid:e,$continue_txt:"common.continue"}),$("#peopleUserPreview").append(a),$Util.animateBtnTransView($("#peopleUserPreview"))};return{getSubModuleHtml:()=>`<div class="lhs-sub-hdr"><span class="LHS-name mB8">${I18N("smiley.people")}</span></div>${(()=>{let t="<div id='peoplesubmodule'>",e=[{id:"showDirectoryUsers",icon:"zcf-org2",name:"all.users",activeClass:"",dataView:d},{id:"showDeptUsers",icon:"zcf-org2",name:"my.department",activeClass:"",dataView:o},{id:"showReportees",icon:"zcf-org2",name:"my.direct.reports",activeClass:"",dataView:r}];for(let s=0;s<e.length;s++)t+=$WC.template.replace(l.peopleSubModuleHtml,{item_id:e[s].id,icon_cls:e[s].icon,$name:e[s].name,active_cls:e[s].activeClass,dataView:e[s].dataView});return t+"</div>"})()}`,populate:t=>{let s,i=u();t===o||t===r?(s=g(t),n=t):(s=w(),n=d),routingPaths.people.hasOwnProperty(n)&&ZCPermalink.updateUrl(routingPaths.people[n]),i=$WC.template.replace(i,{container_content:s},"InSecureHTML"),LhsNavigation.updateRHSView(i),e=$("#user-search-field"),h(n)?(b(),e.focus()):m()},updateListView:O,handleSearch:(t,e)=>{let i=t.val().trim();var a=e.which;38===a||40===a?s.hasOnlyChildrenlike("uid")&&(t=DropdownUtil.handleListNavigation(e,s,"[uid]")):27===a?(i.length&&E(t),e.stopImmediatePropagation()):p!==i&&A(i)},handleAsyncFetch:(t,e,s,i,a)=>{O(a,100)},highlightSubmodule:t=>{let e=$("#peoplesubmodule"),s=e.find(".chatsel[purpose]");0===t.length&&(t=e.find("[data-view=allUsersView]")),s.removeClass("chatsel"),t.addClass("chatsel"),$('[purpose="showTeamsView"]').removeClass("chatsel"),$('[purpose="openDefaultChannel"]').removeClass("chatsel")},closePeoplePreviewWin:()=>{let t=$("#peopleUserPreviewCnt");t.addClass("hide"),t.find("#peoplePreviewSubHdr").empty(),t.find("#peopleUserPreview").empty().off("click")},updatePeoplePreviewHeader:R,handleTranscriptViewForPepoplePreview:t=>{let e=t.attr("chid")||t.attr("data-key"),s=$("#peopleUserPreview"),i=$WC.$CUtil.processXSS($("#userrecentchattitle"+e).text());R(e,i,"chat",void 0),D(s);let a={chid:e,totime:(new Date).getTime(),isNew:!0,lineslimit:Chat.LINESLIMIT,container:$("#peopleUserPreview")};ChatUI.removeTranscriptView(e),ChatUI.getTranscriptView(a).then(U)},getLastViewedSubModule:()=>void 0!==n?n:d,isPeopleViewInActive:()=>{return LhsModules.activeTabId===LHSConstants.ModuleIds.MYPEOPLE&&!!$("#people_listview").length}}}(),MyOrgModule=function(){let t=()=>OrgFeatures.isTeamSupported(),e={skeletonLoaderRepeatCount:1,isChannelOpenedInThisView:!1,currentlyOpenedChid:void 0,clientCachedChatId:void 0,htmls:{parentCont:`<div id="orgDefaultChannelSecCont" class="org-default-sec">\n\t\t\t\t\t\t\t<div class="lhs-sub-hdr"><span class="LHS-name mB8">${I18N("profileview.help.cliqresources")}</span></div>\n\t\t\t\t\t\t\t<div id="orgDefaultChannelSec" class="org-default-channels">{{CHANNELS_HTML}}</div>\n\t\t\t\t\t\t</div>`,defaultChannelChatWinContainer:"<div id='defaultOrgChannelCont' class='wh100 org-default-channel-cont'></div>"},getSubModuleHtml:function(){let t=this.getSubmoduleBodyHtml();return t.length?$WC.template.replace(this.htmls.parentCont,{CHANNELS_HTML:t},"InSecureHTML"):""},getSubmoduleBodyHtml:function(){if(!Config.isDefaultChannelsUnderOrgEnabled())return"";let t=this.getDefaultChannelDataFromClient();return t?this.getDefaultChannelsHtml(t):(this.getDefaultChannelDataFromServer(),TemplateUtil.getSubListLoader(this.skeletonLoaderRepeatCount).replace("p20","pB0 p20"))},getDefaultChannelDataFromClient:function(){let t=this.clientCachedChatId?Channels.getByChid(this.clientCachedChatId):void 0;if(t){return{data:{joined:[t]}}}},getDefaultChannelDataFromServer:function(){let t=this;Channels.getChannelsByCriteria({default:!0},(function(e){t.channelsDataSuccessCallback(t,e)}),(function(){UI.updateBanner(Resource.getRealValue("apierror.message.two"),2e3,!0)}))},channelsDataSuccessCallback:(t,e)=>{Channels.updateData(e.data);let s=t.getDefaultChannelsHtml(e);s.length?LeftPannel.container.find("#orgDefaultChannelSec").html(s):LeftPannel.container.find("#orgDefaultChannelSecCont").remove()},getDefaultChannelsHtml:t=>{let e=t.data.joined,s=e.length,i="",a=MyTeamsLHS.getNewLHSChanneslListHtml().replace('elemtype="channel"','purpose="openDefaultChannel"').replace('catagory="channels"','catagory="chats"');for(let t=0;t<s;t++)$.isEmptyObject(e[t])||(i+=ChannelsUI.List.LHS.getHTML(e[t],{listhtml:a}));return MyOrgModule.defaultSection.clientCachedChatId=s?e[0].chid:void 0,i},openChannel:function(t){if(this.isChannelOpenedInThisView)return;$("#chatsection").append(this.htmls.defaultChannelChatWinContainer),this.currentlyOpenedChid=t,MyOrgModule.lastSelectedOrgSubModule={isTeamsModuleSelected:!1,isDefaultChannelSelected:!0,defaultChannelId:t},FloatingCWin.openChat(t,{destId:"defaultOrgChannelCont",isPresent:function(){return ChatUI.isExist(t)},openCallback:this.openCallBack,closeCallback:this.closeCallBack})},openCallBack:()=>{LeftPannel.container.find("#tab"+MyOrgModule.defaultSection.currentlyOpenedChid).addClass("chatsel");let t=$("#defaultOrgChannelCont");t.removeAttr("style"),t.find("#"+MyOrgModule.defaultSection.currentlyOpenedChid).removeAttr("style"),MainUI.container.find("#main_container_dom").hide().html(""),MainUI.container.find("#chatwindows").hide(),LeftPannel.container.find("#peoplesubmodule").find(".chatsel").removeClass("chatsel"),MyOrgModule.defaultSection.isChannelOpenedInThisView=!0},closeCallBack:()=>{$("#chatsection").find("#defaultOrgChannelCont").remove(),MyOrgModule.defaultSection.isChannelOpenedInThisView=!1}};return{handleInitView:function(e){if(e){if("people"===e.type){var s=e.path,i=new BidiMap(routingPaths.people).getKeyFromValue(s);PeopleModule.populate(i);var a=$("#peoplesubmodule");PeopleModule.highlightSubmodule(a.find("[data-view="+i+"]")),t()&&LazyLoader.loadTeamManagementFiles().then((function(){Teams_LHS.init()}))}else if("teams"===e.type){let s=e.path.split("/"),i=s.length;if("explore"===(i>=3?s[2]:void 0)&&OrgFeatures.isPublicTeamsEnabled())LazyLoader.loadTeamManagementFiles().then((function(){PublicTeamsUIHandler.init()}));else{let e=i>=3?s[2]:void 0,a=4==i?s[3]:void 0;t()&&LazyLoader.loadTeamManagementFiles().then((function(){TeamInfo.setActiveTabFromRoutingPath(a),Teams_LHS.init(e,!0)}))}}}else{if(t()&&MyOrgModule.lastSelectedOrgSubModule&&MyOrgModule.lastSelectedOrgSubModule.isTeamsModuleSelected)return Teams_LHS.init(MyOrgModule.lastSelectedOrgSubModule.teamId),void TeamInfo.populateUI(MyOrgModule.lastSelectedOrgSubModule.teamId);if(Config.isDefaultChannelsUnderOrgEnabled()&&MyOrgModule.lastSelectedOrgSubModule&&MyOrgModule.lastSelectedOrgSubModule.isDefaultChannelSelected)MyOrgModule.defaultSection.openChannel(MyOrgModule.lastSelectedOrgSubModule.defaultChannelId);else if(OrgFeatures.isPublicTeamsEnabled()&&MyOrgModule.lastSelectedOrgSubModule&&MyOrgModule.lastSelectedOrgSubModule.isPublicTeamsSelected)LazyLoader.loadTeamManagementFiles().then((function(){PublicTeamsUIHandler.init()}));else{let t=PeopleModule.getLastViewedSubModule();PeopleModule.populate(t),PeopleModule.highlightSubmodule($("[data-view="+t+"]"))}t()&&LazyLoader.loadTeamManagementFiles().then((function(){Teams_LHS.init()}))}},getSubModuleHtml:function(){let s=PeopleModule.getSubModuleHtml(),i=t()?Teams_LHS.getSubModuleHtml():"";return`<div class="flex fdirC h100">${e.getSubModuleHtml()+s+i}</div>`},lastSelectedOrgSubModule:void 0,defaultSection:e}}();var CalendarLHS=function(){var t={calendarIframeUrl:$zcg._CALENDARSERVER+"/zc/?viewMode=embed&embedContainer=cliq&frameorigin={{frame_origin_url}}&embeddedFrameOrigin={{embedded_origin_url}}",containerId:"calendarstab-main",isCalendarInViewPort:!1,moduleName:"calendar",outgoingCommands:{APP_INITIALIZE:"app-initialize",NIGHT_MODE:"night-mode",APPLY_CSS:"apply-css",ADD_BODY_CLASS:"add-body-class",REMOVE_BODY_CLASS:"remove-body-class",UPDATE_CAL_MODE:"calendar-enable-disable"},incomingCommands:{APP_READY:"app-ready",APP_INITIALIZED:"app-initialized",CALENDAR_ACTION:"calendar-action"},calendarActionTypes:{NEW_EVENT:"new-event",EDIT_EVENT:"edit-event",VIEW_EVENT:"view-event",DELETE_EVENT:"delete-event",DUPLICATE_EVENT:"duplicate-event"},calendarTypes:["own","group","subscribed","shared","app"],calendarTypesVsResourcekeys:{own:"common.mycalendars",group:"common.teamcalendars",subscribed:"common.subscribedcalendars",shared:"common.sharedcalendars",app:"common.appcalendars"},calendarLhsLastAccessedTime:void 0,timeLimitForPreLoad:432e6,isAppReady:void 0},e={headerHtml:'<div class="main-container-header ovrflwH fshrink lhs-mycalendar-header">\n\t\t\t\t \t<div class="w100 flexC justifySB">\n\t\t\t\t \t\t<div class="flexG flexC">\n\t\t\t\t \t\t\t<div class="flexC fshrink line1">\n\t\t\t\t\t \t\t\t<div class="{{icn_cls}} module-icn clr-icon"></div> \n\t\t\t\t\t \t\t\t<div class="font16 clr-H fontB mB2">{{hdr_txt}}</div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t{{schedule_meeting_html}}\n\t\t\t\t\t<div class="fshrink">\n\t\t\t\t\t\t<div class="ellips zcl-btn-xs zcl-btn--primary" calendar_lhs_button purpose="openEventCreateView">{{create_event}}</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>',scheudleMeetingHtml:'<div class="fshrink mR15">\n\t\t\t\t\t\t\t\t\t\t<div class="ellips zcl-btn-xs zcl-btn--primary" calendar_lhs_button purpose="scheduleMeeting">{{schedule_meet}}</div>\n\t\t\t\t\t\t\t\t</div>',emptyCalendarHtml:'<div id="lhs_mycalendar_emptystate" class="mAuto mT45 calendar-empty"></div>\n\t\t\t<div class="mT10 textC font13 clr-lp1">{{content}}</div>',listHtml:'<div id="{{calendar_list_id}}" >\n\t\t\t\t<div class="flexG flex-col h100">\n\t\t\t\t\t<div id="calendars_list_header" class="lhs-sub-hdr lhs-task-hdr fshrink lhs-sub-hdr-sticky">\n\t\t\t\t\t\t<span class="protal-hdr ellips">{{hdr}}</span>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class="flexG ovrflwA">\n\t\t\t\t\t\t<div id="{{calendar_list_id}}_loader" class="flexM p20 dN"><span class="zcl-rloader-sm"></span></div>\n\t\t\t\t\t\t<div id="{{calendar_list_id}}_list">{{list_html}}</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>',itemHtml:'<div id="tab_{{caluid}}" caluid="{{caluid}}" class="LHS-item">{{checkbox_html}}</div>',checkboxHtml:'<div class="flexIC w100">\n\t\t\t\t\t<label id="{{label_id}}" purpose="updateCalendarState" class="flexIC curP mL3 lhs-mycalendar-tab-checkbox w100">\n\t\t\t\t\t<div class="zcl-checkbox">\n\t\t\t\t\t\t<input id="{{item_id}}" cuid="{{caluid}}" type="checkbox" {{custom_attr}} {{checked_status}}>\n\t\t\t\t\t\t<span class="zcf-tick flexM" style="{{inline_style}}"></span>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class="font14 lineN zcl-checkbox-label ellips" label_text>{{label_name}}</div>\n\t\t\t\t\t</label>\n\t\t\t\t</div>',loaderHtml:'<div id="lhs_mycalendar_loader" class="dN flexM wh100 lhs-mycalendar-popup-loader">\n\t\t\t\t    <div class="flexM fdirC">\n\t\t\t\t\t\t<div class="zcl-rloader"></div>\n\t\t\t\t\t\t<div class="clr-S font18 mT20">{{loading_text}}</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>'},s=function(t){return $WC.template.replace(e.itemHtml,{caluid:t.getId(),checkbox_html:i(t)},"InSecureHTML")},i=function(t){var s=t.getId();return $WC.template.replace(e.checkboxHtml,{label_id:"lhs_calendar_label_"+s,item_id:"lhs_calendar_item_"+s,caluid:s,inline_style:"background-color: "+t.getColor()+";  border-color: "+t.getColor()+"; color: "+t.getTextColor(),custom_attr:"lhs_calendar_attr_"+s,checked_status:t.getStatus()?"checked":"",label_name:t.getName()})},a=function(t,s,i){var a="";return $WC.Util.isEmpty(t)||(a=$WC.template.replace(e.listHtml,{list_html:t,calendar_list_id:s},"InSecureHTML"),a=$WC.template.replace(a,{$hdr:i})),a},n=function(){var e="";if(EventsMain.UTIL.isCalendarsPresent(!0)){var i=EventsDB.getAllCalendars(),l={};for(var o in i){var r=i[o];if(r.getVisibility()){var d=EventsMain.UTIL.getCalendarType(r);l[d]=(l[d]||"")+s(r)}}for(var o in t.calendarTypes){var c=t.calendarTypes[o];void 0!==l[c]&&(e+=a(l[c],"lhs_"+c+"_calendars",t.calendarTypesVsResourcekeys[c]))}e||(e=a(u("calendar.not.available"),"lhs_mycalendars","common.mycalendars"))}else{var p=function(t){LhsModules.activeTabId===LHSConstants.ModuleIds.MYCALENDAR&&$("#module_content").html(t)};EventsMain.API.getCalendars(!1,(function(){p(n())}),(function(){p(a(u("calendar.fetch.error",!0),"lhs_mycalendars","common.mycalendars"))})),e=TemplateUtil.getSubListLoader()}return'<div id="lhs_mycalendar_submodule" class="ovrflwA lhs-mycalendar-submodule">'+e+"</div>"},l=function(){return t.containerId},o=function(s){var i,a=$("#"+l());if(0==a.find("iframe").length){if(a.prepend($WC.template.replace(e.loaderHtml,{loading_text:TemplateUtil.getRandomQuotes()})),!s){var n=$("#lhs_mycalendar_loader");$("#"+l()).show(),n.removeClass("dN")}var o=m($WC.template.replace(t.calendarIframeUrl,{frame_origin_url:$Util.getFrameOrigin(),embedded_origin_url:$zcg._RAW_SERVERURL}));a.prepend(o),a.prepend((i=$WC.template.replace(e.headerHtml,{schedule_meeting_html:EventsMain.UTIL.isHuddleInEventsEnabled()?e.scheudleMeetingHtml:""},"InSecureHTML"),$WC.template.replace(i,{icn_cls:"zcf-zcalendar",$create_event:"event.add",$schedule_meet:"event.schedule.meeting",$hdr_txt:"smiley.calendar"}))),r()}s||(MainUI.getMefront(l(),!0),ZCPermalink.updateUrl(routingPaths.calendar),v()),d()},r=function(){$("#"+l()).on("click","[calendar_lhs_button]",(function(t){var e=$(t.currentTarget).attr("purpose");t.stopPropagation(),h[e]()}))},d=function(){var e=$Util.getSyncedCurrentTime();$DB.update("calendarLhsLastAccessedTime",e),t.calendarLhsLastAccessedTime=e},c=function(){var e=(null==t.calendarLhsLastAccessedTime&&(t.calendarLhsLastAccessedTime=$DB.get("calendarLhsLastAccessedTime"),t.calendarLhsLastAccessedTime=t.calendarLhsLastAccessedTime>0?t.calendarLhsLastAccessedTime:0),t.calendarLhsLastAccessedTime);return $Util.getSyncedCurrentTime()-e<t.timeLimitForPreLoad},p=function(){return!LhsModules.isHiddenModule(t.moduleName)&&c()},h={openEventCreateView:function(){SecurityManager.hasPermission(Modules.Events)&&EventsMain.UI.openLoadingWindow((function(){EventsUI.openCreateWin(),T("EVENT_CREATE","CALENDAR_HEADER")}),!0)},scheduleMeeting:function(){SecurityManager.hasPermission(Modules.Events)&&EventsMain.UI.openLoadingWindow((function(){EventsUI.openCreateWin(!1,void 0,(function(){EventsRHSCUWidget.handle.makeOnlineEvent()})),T("SCHEDULE_MEETING","CALENDAR_HEADER")}),!0)}},m=function(t,e){var s='<iframe service="calendar" src="{{iframe_url}}" class="lhs-mycalendar-tab-iframe wh100 bdrN"></iframe>';s=$WC.template.replace(s,{iframe_url:t});var i=$(s);return i.on("load",(function(){"function"==typeof e&&e()})),i},u=function(t,s){return $WC.template.replace(e.emptyCalendarHtml,{content:s?Resource.getRealValue(t,[$WC.template.replace('<span class="mL5 zcl-btn-theme--link text-transL" purpose="reloadCalendars" calendar_lhs_button >{{error_link_content}}</span>',{$error_link_content:"common.reload"})]):Resource.getRealValue(t)},"InSecureHTML")},v=function(t){if(EventsMain.UTIL.isCalendarInLHSEnabled()){var e=$("#"+l()).find("iframe"),s=Settings.isDarkModeChoosed();if(e.length>0&&(g(s),C("zc-nite-mode zc-gray-mode"),s)){var i=PersonalizeUI.isGrayDarkLhsTheme()?"zc-gray-mode":"zc-nite-mode";f(i)}}},g=function(e){y(t.outgoingCommands.NIGHT_MODE,{enabled:e})},f=function(e){y(t.outgoingCommands.ADD_BODY_CLASS,{bodyClassNames:e})},C=function(e){y(t.outgoingCommands.REMOVE_BODY_CLASS,{bodyClassNames:e})},y=function(e,s){if(t.isAppReady){const t=document.querySelector("[service=calendar]");s.action=e,S({action:e,type:"outgoing"}),t.contentWindow.postMessage(s,$zcg._CALENDARSERVER)}},_=function(e,s){switch(document.activeElement.blur(),e){case t.calendarActionTypes.NEW_EVENT:if(s.currentTime)EventsUI.openCreateWin(!1,EventsDB.getDefaultCalendarId());else{var i=new Date(s.startTime).getTime();i>$Util.getSyncedCurrentTime()&&EventsMain.UI.openLoadingWindow((function(){EventsUI.openCreateWin(!1,EventsDB.getDefaultCalendarId(),(function(){var t={};t.dateandtime={start:i,end:new Date(s.endTime).getTime()};var e=new Events(t);EventsRHSCUWidget.fillCreateWin(e);var a=$("#eventmanagementradio").is(":checked"),n=$("#noeventreminder").is(":checked"),l=$("#remindershead").find("[event_reminder]").attr("val");l=n?0:l,EventsRHSCUWidget.replaceHtmlInCnt("alert_cnt",EventsRHSCUWidget.getEventManagementOptionHTML(!0,l,a,"visible"===$("#scheduled_videoconference").css("visibility")))})),T("EVENT_CREATE","CALENDAR_IFRAME")}),!0)}break;case t.calendarActionTypes.EDIT_EVENT:if(s.pastEvent)UI.updateBanner(Resource.getRealValue("calendar.edit.past.notsupported"),2e3,!0);else{var a="future"===s.recurrenceEditMode?EventsMain.UTIL.recurringEditType.following:s.recurrenceEditMode;EventsUI.openLoadingWindow((function(){EventsUI.openEditWindow(s.eventUID,s.calendarUID,s.eventRecurrenceID,a),T("EVENT_EDIT","CALENDAR_IFRAME")}))}break;case t.calendarActionTypes.DELETE_EVENT:a="future"===s.recurrenceDeleteMode?EventsMain.UTIL.recurringEditType.following:s.recurrenceDeleteMode;EventsUI.deleteFromCalendar(s.eventUID,s.calendarUID,s.eventRecurrenceID,a),T("EVENT_DELETE","CALENDAR_IFRAME");break;case t.calendarActionTypes.VIEW_EVENT:EventsUI.openLoadingWindow((function(){var t=s.parentUID?s.parentUID:s.eventUID;EventsUI.openPreviewWin(t,s.calendarUID,!0,s.eventRecurrenceID),T("EVENT_PREVIEW","CALENDAR_IFRAME")}))}},S=function(t){_print("calendar_logs"," Action: "+t.action+" Time: "+new Date+" Type: "+t.type)},T=function(t,e){ZCTrack.track(t,{TRIGGER:e})};return{showCalendar:o,preloadCalendar:function(){p()&&EventsMain.UTIL.isEventsPresent()&&o(!0)},hideCalendar:function(){MainUI.close(l())},getContainerId:l,trackAction:T,getSubModuleHtml:function(){return n()},updateCalendarState:function(e,s){var i=e.attr("cuid");y(t.outgoingCommands.UPDATE_CAL_MODE,{enabled:s,calendarUID:i});var a=EventsDB.getCalendar(i);a.setStatus(s),EventsDB.updateCalendar(a),T("CALENDAR_STATE_UPDATE","LHS")},updateTheme:v,handleIframeMessages:function(e){switch(S({action:e.action,type:"incoming"}),e.action){case t.incomingCommands.APP_READY:t.isAppReady=!0;var s=$zcg._CSSTATICURL?$zcg._CSSTATICURL+"/officechat/styles/pages/calendar_min.a4bcd0e19c15d9d2cb3fee8c61976f19.css":$zcg._RAW_SERVERURL+"/officechat/styles/pages/calendar.03d6ee204c8906ef017b5a258ee670c4.css",i=Settings.isDarkModeChoosed()?PersonalizeUI.isGrayDarkLhsTheme()?"zc-gray-mode":"zc-nite-mode":"";y(t.outgoingCommands.APP_INITIALIZE,{leftTreeWidth:0,nightMode:!!Settings.isDarkModeChoosed(),allowAllCalendars:!0,cssFiles:[s],bodyClassNames:i});break;case t.incomingCommands.APP_INITIALIZED:$("#lhs_mycalendar_loader").addClass("dN");break;case t.incomingCommands.CALENDAR_ACTION:t.calendarActionTypes.DELETE_EVENT===e.type||t.calendarActionTypes.NEW_EVENT===e.type?_(e.type,e.calendarEvent):EventsMain.UI.openLoadingWindow((function(){_(e.type,e.calendarEvent)}),!0)}},reloadCalendars:function(){$("#module_content").html(n())},isCalendarInViewPort:function(){return t.isCalendarInViewPort},handleRemovedFromViewPort:function(){t.isCalendarInViewPort=!1},handleAddedToViewPort:function(){t.isCalendarInViewPort=!0}}}(),NoteBookUtil=function(){var t={lhsIframeUrl:$zcg._NOTEBOOK_SERVER_URL+"/zcliq_notes/all-notes?frameorigin=",conferenceIframeUrl:$zcg._NOTEBOOK_SERVER_URL+"/app_zcliq/allnotes?serviceOrigin="+$zcg._RAW_SERVERURL+"&frameorigin=",conferenceRhsIframeUrl:$zcg._NOTEBOOK_SERVER_URL+"/app_zcliq/allnotes?mode=conference&serviceOrigin="+$zcg._RAW_SERVERURL+"&frameorigin=",historyViewIframeUrl:$zcg._NOTEBOOK_SERVER_URL+"/app_zcliq/historyview?serviceOrigin="+$zcg._RAW_SERVERURL+"&frameorigin=",notesFetchLimit:11,view:{LHS:"lhs",CONFERENCE_RHS:"conference_rhs",CONFERENCE:"conference",HISTORY:"history"},themes:{DARK:"dark",DARK_GRAY:"dark_gray",DEFAULT:"default"},outgoingCommands:{CREATE_NOTEBOOK:"createNotebook",NOTEBOOK_PREVIEW:"notebookPreview",SET_THEME:"theme",ALL_NOTES_PREVIEW:"allNotesPreview",CLIQ_NOTES_PREVIEW:"cliqNotesPreview",SHARED_NOTES_PREVIEW:"sharedNotesPreview",OPEN_NEW_NOTE:"openNewNote",ALL_NOTEBOOKS_PREVIEW:"allNotebooksPreview"},incomingCommands:{NOTEBOOK_DETAILS:"notebookDetails",NOTEBOOK_DELETE:"notebookDelete",IFRAME_LOADED:"iframeLoaded"}},e=function(){return $zcg._NOTEBOOK_INTEGRATION_STATUS&&OrgFeatures.isIntranetRequest()};return{isIntegrationEnabled:function(){return e()},getNotesUrl:function(e){switch(e){case t.view.LHS:return t.lhsIframeUrl+$Util.getFrameOrigin();case t.view.CONFERENCE:return t.conferenceIframeUrl+$Util.getFrameOrigin();case t.view.CONFERENCE_RHS:return t.conferenceRhsIframeUrl+$Util.getFrameOrigin();case t.view.HISTORY:return t.historyViewIframeUrl+$Util.getFrameOrigin()}},notesFetchLimit:t.notesFetchLimit,outgoingCommands:t.outgoingCommands,incomingCommands:t.incomingCommands,view:t.view,themes:t.themes,logNotebookActions:function(t){_print("notebook_logs"," Action data: "+JSON.stringify(t)+" Time: "+new Date)},isIntegrationEnabledByAdmin:e,getServerUrl:function(){return $zcg._NOTEBOOK_SERVER_URL}}}(),NoteBookLHS=function(){var t={containerId:"notebooktab-main",isNotebookInViewPort:!1,defaultViewId:"all_notes",lhsNoteViews:[{id:"all_notes",name:Resource.getRealValue("common.allnotes")},{id:"cliq_notes",name:Resource.getRealValue("common.cliqnotes"),icon_class:"zcf-cliq"},{id:"shared_notes",name:Resource.getRealValue("common.sharedwithme"),icon_class:"zcf-users"}],lhsNoteIdVsActions:{all_notes:NoteBookUtil.outgoingCommands.ALL_NOTES_PREVIEW,cliq_notes:NoteBookUtil.outgoingCommands.CLIQ_NOTES_PREVIEW,shared_notes:NoteBookUtil.outgoingCommands.SHARED_NOTES_PREVIEW,all_notebooks:NoteBookUtil.outgoingCommands.ALL_NOTEBOOKS_PREVIEW}},e={headerHtml:'<div class="main-container-header ovrflwH fshrink lhs-mynotebook-header">\n\t\t\t\t \t<div class="w100 flex justifySB">\n\t\t\t\t \t\t<div class="flexG flexC">\n\t\t\t\t \t\t\t<div class="flexC fshrink line1">\n\t\t\t\t\t \t\t\t<div class="{{icn_cls}} module-icn clr-icon">\n\t\t\t\t\t \t\t\t</div> \n\t\t\t\t\t \t\t\t<div class="font16 clr-H fontB mB2">{{hdr_txt}}</div>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>',loaderHtml:'<div id="lhs_mynotebook_rightside_loader" class="dN flexM wh100 lhs-mynotebook-popup-loader">\n\t\t\t\t    <div class="flexM fdirC">\n\t\t\t\t\t\t<div class="zcl-rloader"></div>\n\t\t\t\t\t\t<div class="clr-S font18 mT20">{{loading_text}}</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>',emptyNotesHtml:'<div id="lhs_mynotebook_emptystate" class="mAuto mT45 notes-empty"></div>\n\t\t\t\t<div class="mT10 textC font13 clr-lp1">{{content}}</div>',listHtml:'<div id="{{notebook_list_id}}">\n\t\t\t\t\t<div class="flexG flex-col h100">\n\t\t\t\t\t\t<div id="notes_list_header" class="lhs-sub-hdr lhs-task-hdr fshrink">\n\t\t\t\t\t\t\t<span class="protal-hdr ellips">{{hdr}}</span>\n\t\t\t\t\t\t\t{{plus_icon}}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class="flexG ovrflwA">\n\t\t\t\t\t\t\t<div id="{{notebook_list_id}}_loader" class="flexM p20 dN"><span class="zcl-rloader-sm"></span></div>\n\t\t\t\t\t\t\t<div id="{{notebook_list_id}}_list">{{list_html}}</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>',itemHtml:'<div id="tabnote_{{id}}" purpose="showNote" notebook_lhs_button note_id="{{id}}" class="lhs-sub-item ellips LHS-item {{active_class}}">\n\t\t\t\t\t<div title="{{name}}" class="LHS-name flexC">\n\t\t\t\t\t\t<div class="item-icn fshrink notes-item-icn {{image_icon}}">{{image_div}}</div>\n\t\t\t\t\t\t<div class="item-name ellips">{{name}}</div>\n\t\t\t\t\t\t<span class="zcl-rloader zcl-rloader-lhs xs mL10"></span>\n\t\t\t\t\t</div>\n\t\t\t\t</div>',showMoreHtml:'<div id="notesshowmore" class="LHS-showmore" note_id="all_notebooks" notebook_lhs_button purpose="showNote" notes_offset="{{notes_offset}}">\n\t\t\t\t\t<span class="showmore text-nosel" workfor="notes" elemtype="more">{{show_more_content}}</span>\n\t\t\t\t</div>'},s=function(t,s){return $WC.template.replace(e.emptyNotesHtml,{content:s?Resource.getRealValue(t,[$WC.template.replace('<span class="mL5 zcl-btn-theme--link text-transL" purpose="reloadNotes" notebook_lhs_button >{{error_link_content}}</span>',{$error_link_content:"try.again"})]):Resource.getRealValue(t)},"InSecureHTML")},i=function(t,s){var i=$WC.template.replace(e.itemHtml,{image_div:t.cover_image?'<img class="wh100" src="'+t.cover_image+'"></img>':""},"InSecureHTML");return $WC.template.replace(i,{id:t.id,name:t.name,image_div:t.cover_image?'<img class="wh100" src="'+t.cover_image+'"></img>':"",image_icon:t.cover_image?"item-icn--img":t.icon_class?t.icon_class:"zcf-all-notes",active_class:s?"chatsel":""})},a=function(t,s,i){var a="lhs_mynotebook"===s,n=$WC.template.replace(e.listHtml,{list_html:t,plus_icon:a?'<span class="LHS-btn zcf-plusB font10 text-nosel tooltip-up tooltip-right0" notebook_lhs_button purpose="createNotebook" tooltip-title="{{create_notebook_title}}"></span>':"",notebook_list_id:s},"InSecureHTML");return $WC.template.replace(n,{$hdr:i,$create_notebook_title:"common.notebook.create"})},n=function(t){var e="";for(var s in t){var n=t[s];e+=i(n,!1)}return t||(e=a(e,"lhs_mynotebook","common.mynotebooks")),e},l=function(){return t.containerId},o=function(){return s=n(t.lhsNoteViews),a(s,"lhs_mynotebook_categories","common.notes")+n(e);var e,s},r=function(s){var i=$("#"+l());if(0==i.find("iframe").length){i.prepend($WC.template.replace(e.loaderHtml,{loading_text:TemplateUtil.getRandomQuotes()}));var a=$("#lhs_mynotebook_rightside_loader");$("#"+l()).show(),a.removeClass("dN");var n=p(NoteBookUtil.getNotesUrl(NoteBookUtil.view.LHS));i.prepend(n)}MainUI.getMefront(l(),!0),s=s||t.defaultViewId,$("#module_content").find("#tabnote_"+s).addClass("chatsel"),d(0,s),ZCPermalink.updateUrl(routingPaths.notebook)},d=function(t,i){var a=$("#lhs_mynotebook_list");a.children().length?a.removeClass("dN"):(t=t||0,$("#lhs_mynotebook_loader").removeClass("dN"),NoteBookAPI.get(t,(function(a){var l=a.has_more;l&&delete a.data[NoteBookUtil.notesFetchLimit-1];var o,r=n(a.data);$("#lhs_mynotebook_loader").addClass("dN"),l?r+=(o=t+NoteBookUtil.notesFetchLimit,$WC.template.replace(e.showMoreHtml,{$show_more_content:"app.show.more",notes_offset:o})):a.data&&a.data.length||(r=s("notebook.notes.not.available")),$("#lhs_mynotebook_list").html(r),i&&$("#module_content").find("#tabnote_"+i).addClass("chatsel"),$("#lhs_mynotebook_categories, #lhs_mynotebook").on("click","[notebook_lhs_button]",(function(t){var e=$(t.currentTarget),s=e.attr("purpose");t.stopPropagation(),c[s](e)}))}),(function(t){$("#lhs_mynotebook_loader").addClass("dN"),$("#lhs_mynotebook_list").html(s("notebook.notes.fetch.error",!0))})))},c={showNote:function(t){$("#module_content").find('[purpose="showNote"]').removeClass("chatsel");var e=t.attr("note_id");r(e),h(e),$("#lhs_modules_listing").find("#"+LHSConstants.ModuleIds.MYNOTEBOOK).attr("selected_note",e)},showMoreNotes:function(t){var e=parseInt(t.attr("notes_offset"));t.remove(),d(e)},createNotebook:function(){$("#"+l()).find("iframe")[0].contentWindow.postMessage(JSON.stringify({action:NoteBookUtil.outgoingCommands.CREATE_NOTEBOOK}),NoteBookUtil.getServerUrl()),NoteBookUtil.logNotebookActions({action:NoteBookUtil.outgoingCommands.CREATE_NOTEBOOK,type:"outgoing"}),u("NOTEBOOK_CREATE","LHS")},reloadNotes:function(t){d()}},p=function(t,e){var s='<iframe service="notebook" src="{{iframe_url}}" class="wh100 bdrN"></iframe>';s=$WC.template.replace(s,{iframe_url:t});var i=$(s);return i.on("load",(function(){"function"==typeof e&&e()})),i},h=function(e){var s=$("#"+l()).find("iframe")[0],i={},a=t.lhsNoteIdVsActions[e];a?i.action=a:(i.action=NoteBookUtil.outgoingCommands.NOTEBOOK_PREVIEW,i.entity_id=e),s.contentWindow.postMessage(JSON.stringify(i),NoteBookUtil.getServerUrl()),NoteBookUtil.logNotebookActions({action:a,type:"outgoing",note_id:e})},m=function(t){if(NoteBookUtil.isIntegrationEnabled()){var e=$("#"+l()).find("iframe")[0];if(void 0!==e){var s=Settings.isDarkModeChoosed();e.contentWindow.postMessage(JSON.stringify({action:NoteBookUtil.outgoingCommands.SET_THEME,theme_name:s?PersonalizeUI.isGrayDarkLhsTheme()?NoteBookUtil.themes.DARK_GRAY:NoteBookUtil.themes.DARK:NoteBookUtil.themes.DEFAULT,isDarkMode:s}),NoteBookUtil.getServerUrl()),NoteBookUtil.logNotebookActions({action:NoteBookUtil.outgoingCommands.SET_THEME,type:"outgoing"})}}},u=function(t,e){ZCTrack.track(t,{TRIGGER:e})};return{showNotebooks:r,getContainerId:l,getSubModuleHtml:function(){return o()},trackAction:u,updateTheme:m,hideNotebooks:function(){$("#"+l()).hide()},createNote:function(){NotebookIntegration.open(void 0,(function(){$("#notebook-integ").find("iframe")[0].contentWindow.postMessage(JSON.stringify({action:NoteBookUtil.outgoingCommands.OPEN_NEW_NOTE}),NoteBookUtil.getServerUrl()),NoteBookUtil.logNotebookActions({action:NoteBookUtil.outgoingCommands.OPEN_NEW_NOTE,type:"outgoing"})})),u("NOTE_CREATE","QUICK_PLUS")},reloadNotes:c.reloadNotes,handleIframeMessages:function(t){switch((t=JSON.parse(t)).action){case NoteBookUtil.incomingCommands.NOTEBOOK_DETAILS:!function(t){var e=$("#lhs_mynotebook");if(e.length){var s=e.find("#lhs_mynotebook_list");if(s.children().length){var a=i({id:t.notebook_id,name:t.name,cover_image:t.cover_image_src});s.find("#lhs_mynotebook_emptystate").length?s.html(a):s.prepend(a)}}}(t.details);break;case NoteBookUtil.incomingCommands.NOTEBOOK_DELETE:e=t.entity_id,(s=$("#lhs_mynotebook")).length&&s.find("#lhs_mynotebook_list").find("#tabnote_"+e).remove();break;case NoteBookUtil.incomingCommands.IFRAME_LOADED:$("#lhs_mynotebook_rightside_loader").addClass("dN"),$("#"+l()).addClass("lhs-mynotebook-tab"),m()}var e,s;NoteBookUtil.logNotebookActions({action:t.action,type:"incoming"})},isNotebookInViewPort:function(){return t.isNotebookInViewPort},handleRemovedFromViewPort:function(){t.isNotebookInViewPort=!1},handleAddedToViewPort:function(){t.isNotebookInViewPort=!0}}}(),NoteBookAPI={get:function(t,e,s){$ZCAjx.ajax({url:"/v2/notebooks",type:"GET",data:{limit:NoteBookUtil.notesFetchLimit,offset:t},success:e,error:s})}};let PeopleCardUI=function(){let t={UserCard:'<div uid="{{uid}}" type="user" class="user-card-item" documentclick="viewUserProfile" data-peoplepreview>\n\t\t\t\t\t<div class="flex fdirC">\n\t\t\t\t\t\t<div class="user-card-image">{{user_img_html}}</div>\n\t\t\t\t\t\t<div class="user-card-pinfo">{{user_info_html}}</div>\n\t\t\t\t\t\t{{user_actions_html}}\n\t\t\t\t\t</div>\n\t\t\t\t</div>',CardLoaderUI:'<div class="user-card-item skelton-loader">\n\t\t\t\t</div>'},e=t=>{let e=t.zuid,s=Users.getImgUrlById(e),i=(t.uid,`<div id="imgcontainer" class="flexM curP" id="contacthoverblurimg" uid="${e}" imgsrc="${s}">${Users.getTag(e)}<img style="height: 110px;" src="{{img_url}}"/><span id="time" class="zchvrtm dN">{{usertime}}</span></div>`),a="",n="";return t&&t.timezone&&(a=$Date.getOtherZoneTime(t.timezone,t.timeoffset),n=$.trim(a.split("(")[0])),$WC.template.replace(i,{img_url:s,usertime:n||""},"InSecureHTML")},s=t=>{let e=t.zuid,s=Users.getName(e,t.fullname)||"",i=t.emailid||Users.getEmailId(e)||"",a=Users.getCheckinStatus(e)||"",n=Users.getCheckinStatusText(e)||"",l=Contacts.isExist(e)?Contacts.getStatusStyle(e):"",o=t.designation?$WC.$CUtil.processXSS(t.designation):"",r=t.departmentname?$WC.$CUtil.processXSS(t.departmentname):"";return $WC.template.replace('<div class="flex fdirC">\n\t\t\t\t<div class="user-personal">\n\t\t\t\t\t<div class="flexC font15 line20 posrel">\n\t\t\t\t\t\t<span id="status" class="{{status_cls}} fshrink"></span>\n\t\t\t\t\t\t<span class="ellips fontB clr-M">{{name}}</span>\n\t\t\t\t\t\t<span id="checkin_status" uid="{{uid}}" class="font14 checkin_status zcpredot fshrink {{checkin_st}}">{{checkin_st_text}}</span>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class="mT3 font14 line18 clr-S ellips"><a class="clr-S" href="mailto:{{email}}">{{email}}</a></div>\n\t\t\t\t</div>\n\t\t\t\t<div class="mT15 font14 clr-lp1 line18">\n\t\t\t\t\t<div class="ellips">{{dept_name}}</div>\n\t\t\t\t\t<div class="ellips mT3">{{desig_name}}</div>\n\t\t\t\t</div>\n\t\t\t</div>',{name:s,email:i,checkin_st:a,checkin_st_text:n,uid:e,status_cls:l,desig_name:o?$WC.Matcher.replace("escapeReplacementString",o):"",dept_name:r?$WC.Matcher.replace("escapeReplacementString",r):""})},i=t=>{if(WmsImpl.isLocalUser(t))return"";let e="";return MediaCall.isAudioCallAllowed()&&(e+=a({uid:t,icon_cls:"zcf-call",action_name:"makeGlobalAudioCall"})),MediaCall.isVideoCallAllowed()&&(e+=a({uid:t,icon_cls:"zcf-video",action_name:"makeGlobalVideoCall"})),SecurityManager.hasPermission(Modules.DirectMessage)&&(e+=a({uid:t,icon_cls:"zcf-chat",action_name:"initiateChatWithUser"})),HoverDetails.hasPermissionforUserInfo(t)&&(e+=a({uid:t,icon_cls:"zcf-info font11 fontB",action_name:"viewUserProfile"})),`<div class="user-card-actions-band"><div class="flexC">${e}</div></div>`},a=t=>$WC.template.replace('<div class="user-card-action-icn zcl-icon zcl-icon--default {{icon_cls}}" uid="{{uid}}" documentclick="{{action_name}}" data-peoplepreview></div>',{uid:t.uid,action_name:t.action_name,icon_cls:t.icon_cls});return{getUserCard:a=>{let n=Users.getInfo(a);return n?$WC.template.replace(t.UserCard,{user_img_html:e(n),user_info_html:s(n),user_actions_html:i(a),uid:a},"InSecureHTML"):""},getMultiCardLoader:e=>{let s="";e=e||10;for(let i=0;i<=e;i++)s+=t.CardLoaderUI;return`<div class="flex flexW">${s}</div>`}}}(),PeopleLayout=void 0,LHSConstants={MyChats:{DM:"dm_chats",GROUP:"group_chats",CHANNEL:"channel_chats",THREAD:"threadchats",MUTED:"muted_chats"},ChatsCategory:{PINNED:"pinnedchats",MUTED:"mutedchats",CHATS:"chats",THREADS:"threadchats",CHANNELS:"channels",CONTACTS:"orgcontacts"},ModuleIds:{MYDMS:"mydms",MYPINS:"mypins",MYCHATS:"mychats",MYCONVOS:"myconvos",MYTHREADS:"mythreads",MYTEAMS:"myteams",MYHISTORY:"myhistory",MYPHONE:"mycalls",MYFILES:"myfiles",MYTASKS:"mytasks",MYWIDGETS:"mywidgets",MYBOTS:"mybots",MYPEOPLE:"mypeople",MYORG:"myorg",MYCALENDAR:"mycalendar",MYNOTEBOOK:"mynotebook"},ThreadsLhsLayouts:{0:"SECTION_UNDER_CHATS",1:"SEPARATE_MENU",2:"COMBINED_WITH_CONVERSATIONS",3:"INLINE_IN_CHATS",SECTION_UNDER_CHATS:"SECTION_UNDER_CHATS",SEPARATE_MENU:"SEPARATE_MENU",COMBINED_WITH_CONVERSATIONS:"COMBINED_WITH_CONVERSATIONS",INLINE_IN_CHATS:"INLINE_IN_CHATS"},updateNewModelConstants:()=>{LHSConstants.ModuleIds={MYDMS:"lhs_contacts",MYPINS:"lhs_pins",MYCHATS:"lhs_chats",MYCONVOS:"lhs_chats",MYTHREADS:"lhs_threads",MYTEAMS:"lhs_channels",MYHISTORY:"lhs_history",MYPHONE:"lhs_calls",MYFILES:"lhs_files",MYTASKS:"lhs_projects",MYWIDGETS:"lhs_widgets",MYBOTS:"lhs_bots",MYPEOPLE:"lhs_people",MYCALENDAR:"lhs_calendar",MYNOTEBOOK:"lhs_notebook",MYORG:"lhs_orgteams"}},Teams:{Members:"members",Channels:"channels",Settings:"settings"},PublicTeams:{AllTeams:"allTeams",JoinedTeams:"joinedTeams",RequestedTeams:"requestedTeams"},DarkModeToggle:"darkmode_switch_btn"};var LhsTabsConfigConstants={VIEW_TYPE:{SEGMENTED:"segmented",CONSOLIDATED:"consolidated"},THREAD_VIEWTYPE:{SECTION_UNDER_CHATS:"section_under_chats",SEPARATE_MENU:"separate_menu",COMBINED_WITH_CONVERSATION:"combined_with_conversations",INLINE_WITH_PARENT_CHATS:"inline_with_parent_chats"},CLIENT_TYPE:{WEB:"web",MOBILE:"mobile"},VIEW_TYPEKEY_THREAD_VIEW:{0:"section_under_chats",1:"separate_menu",2:"combined_with_conversations",3:"inline_with_parent_chats"}};let LHSListing={};var LhsDomCache={_lhs_module_parent:null,getLHSModuleParent:function(){return null==this._lhs_module_parent&&(this._lhs_module_parent=$("#module_content")),this._lhs_module_parent}};let LhsNavigation=function(){"use strict";let t,e={lhs_module_item:'<div id="{{item_id}}" class="lhs-nav-item {{active_cls}} {{overFlowTabsCls}}" purpose="{{item_purpose}}"  elemtype="{{item_elem_type}}" tab_id = "{{module_id}}"  >\n\t\t\t\t\t<div class="{{icon_cls}} posrel mod-icn">\n\t\t\t\t\t\t{{unseenTagHtml}}\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class="mod-name {{ellips_cls}}" title ="{{tooltip_name}}">{{name}}</div>\n\t\t\t\t\t<div id="{{item_id}}_counter" class="mod-counter"></div>\n\t\t\t\t</div>',lhs_module_item_img:'<div id="{{item_id}}" class="lhs-nav-item {{active_cls}} {{overFlowTabsCls}}" purpose="{{item_purpose}}"  elemtype="{{item_elem_type}}" tab_id = "{{module_id}}">\n\t\t\t\t\t<div class="mod-img posrel">\n\t\t\t\t\t\t<img src="{{img_src}}">\n\t\t\t\t\t\t{{unseenTagHtml}}\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class="mod-name {{ellips_cls}}" title="{{tooltip_name}}">{{name}}</div>\n\t\t\t\t\t<div id="{{item_id}}_counter" class="mod-counter"></div>\n\t\t\t\t</div>',lhs_module_wrapper:'<div id="lhs_module_nav" class="flex fdirC justifySB h100 lhs-module-navigator">\n\t\t\t\t\t<div id="lhs_module_items" class="flexG mB20 posrel">\n\t\t\t\t\t\t{{module_items_html}}\n\t\t\t\t\t</div>\n\t\t\t\t\t<div  class="fshrink flexM  lhs_bottomBar" >\n\t\t\t\t\t\t<div id ="navigationBottomBarOpts"   documentclick="showNavigationBottomBarOptions" class="lhs_bottomBar_icon_cnt flexM  curP">\n\t\t\t\t\t\t<span class="zcf-setting font18 lhs_bottomBar_icon"></span>\n\t\t\t\t\t\t{{unseenWidgetsTag}}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>',lhs_bottom_barOptions:`<div id ="navigationBottomBarOptionsCnt" class= "zcl-menu-wrap posabs no-pointer ovrflw-hidden">\n\t\t\t\t\t<div class="menuOpts">\n\t\t\t\t\t\t<div class="{{hide_moreAppsButton}} zcl-menu-item curP" purpose="showMoreAppsOverlay">\n\t\t\t\t\t\t\t<div class= "flexG">\n\t\t\t\t\t\t\t\t<span class="zcf-applet font15 clr-icon mR10 mT4"></span>\n\t\t\t\t\t\t\t\t<span class="clr-M  flexG font14 ellips">${I18N("tabs.more.apps")}</span>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<span class="clr-red font15 zcf-newfeature mlR5 {{hide_unseenTag}}"></span>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class="zcl-menu-item curP" purpose="configure_Sidebar"><span class="zcf-configureSidebar font16 mT2 mR10  clr-icon" ></span><span class="clr-M font14 flexG ellips">${I18N("lhs.configure.sidebar")}</span> </div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class="darkModeCnt curD flexC {{darkmode_cls}} p12"> \n\t\t\t\t\t\t<span class="zcf-moon font14 mR10  clr-icon"></span>\n\t\t\t\t\t\t<div class="mR10 clr-M flexG font15 ellips" >${I18N("profileview.theme.darkmode")}</div>\n\t\t\t\t\t\t<div  id="darkmode_head" class="flexM pTB20">\n\t\t\t\t\t\t\t<div class="flexIC posrel">\n\t\t\t\t\t\t\t\t<label class="zcl-switch zcl-switch-xs no-icon" for="darkmode_switch_btn" title="{{tooltip}}">\n\t\t\t\t\t\t\t\t\t<input id="darkmode_switch_btn" type="checkbox" purpose="switchDarkMode" documenclick="switchDarkMode" {{checked_cls}}>\n\t\t\t\t\t\t\t\t\t<span class="slider">\n\t\t\t\t\t\t\t\t\t\t<em class="switch"></em>\n\t\t\t\t\t\t\t\t\t\t<div class="zcl-dot--loader"><span></span><span></span><span></span></div>\n\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t</label>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>`,lhs_nav_wrapper:'<div id="list" class="app-left-wrapper flex flexG mT2">\n\t\t\t\t\t<div id="lhs_modules_listing" class="fshrink app-left-nav">{{module_wrapper}}</div>\n\t\t\t\t\t<div id="module_content" class="flexG app-submodule-nav flex-col h100 ovrflwH">{{submodule_container}}</div>\n\t\t\t\t\t<div id="unreadnotifier" purpose="notifyunread" class="zcunrdcr zcunrdcrbtm hidden">\n\t\t\t\t\t\t<div class="msi-arwdwn"></div><div id="counter" class="msgnotify"></div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>',lhs_module_moreOpt:'<div id="lhs_moreTabsOpt"  class="lhs-nav-item "  documentclick="{{item_purpose}}" prev_tab_id = "{{prev_tab_id}}">\n\t\t\t\t\t\t<span class=" zcf-more font12 mod-icn rotate90"></span>\n\t\t\t\t</div>',lhs_moduleOvrflw_Html:`<div id ="lhs_ovrFlw_Cnt" class = " mainLhsOverFlowContainer flex ovrflw-hidden flex-col" >\t\n\n\t\t\t\t\t<div id = "mainLhsOverflowSearch"  class="searchContainer p10 fshrink">\n\t\t\t\t\t\t<div class = "zcl-search2 " >\n\t\t\t\t\t\t\t<span class="zcf-search2 zcl-seach-icon"></span>\n\t\t\t\t\t\t\t<div class="zcl-search-input">\n\t\t\t\t\t\t\t\t<input type="text" tab_id={{tab_id}} id="moreLhs-search-field" placeholder="${I18N("lhsOverflow.search.ph")}"  {{disable_Search}}>\n\t\t\t\t\t\t\t\t<span class="zcl-search-clear zcf-close" purpose="clearMoreLhsSearchInput"></span>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\n\t\t\t\t\t<div class ="flexG flex-col ovrflwH">\n\t\t\t\t\t\t<div class="flexG  ovrflw-auto">\n\t\t\t\t\t\t\t<div id = "mainLhsOverFlwTabsSection" class= " moreTabsSection  h100   ">{{moreLhsSectionHtml}}</div> \n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class="bg-clr2 flexC fshrink ">\n\t\t\t\t\t\t\t<div class="w100 flexC  moreAppsOptionCnt {{hide_moreAppsButton}}"><span class="moreAppsOption mL10 fontB font14 mR15"  purpose="showMoreAppsOverlay">${I18N("tabs.more.apps")}</span></div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t</div>`,moreLhsListingSectionHtml:'<div class="h100 p15 ">\n\t\t\t\t\t<div class="{{hide_moreLhsTabs}} flexG flexC flexW  gap5 pB10 ">\n\t\t\t\t\t\t{{overFlw_modulesList}}\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class="{{hide_newlyaddedApps}}">\n\t\t\t\t\t\t<div class="clr-lp1 font12 line18 ellips pB5 {{hide_newlyaddedApps}}">{{suggestions_fromMoreApps_txt}}</div>\n\t\t\t\t\t\t<div id = "installedAppsRhsSectionListing" class =" flexG flexC flexW  gap5 ">{{newlyAddedAppletsListingHtml}}</div></div>\n\t\t\t\t\t</div>\n\t\t\t\t<div>\t'},s=({item_obj:t,fromOverFlow:s,val:i,unSeenWidget:a})=>{var n=Resource.getRealValue(t.name),l=!1;if(!$WC.Util.isEmpty(i)&&s){if(!n||-1===n.toLowerCase().indexOf(i))return"";l=!0,n=_highlightSearchText(n,i)}var o="";let r="";return a&&(r='<span class=" posabs unseentag zcf-unseen-star" ></span>'),o=$WC.template.replace(e.lhs_module_item,{unseenTagHtml:r},"InSecureHTML"),o=$WC.template.replace(o,{item_id:t.id,item_purpose:t.purpose,icon_cls:t.icon,active_cls:t.id===LhsModules.activeTabId?"active":"",overFlowTabsCls:s?"otherAppItem":"",$tooltip_name:t.name,ellips_cls:s?"ellips-L2 ":"ellips",module_id:t.module_id,item_elem_type:t.isLocked?"":"lhs_navigation_tab"}),o=l?$WC.template.replace(o,{name:n},"InSecureHTML"):$WC.template.replace(o,{name:n})},i=()=>{if(Config.isLhsCustomizationForUserEnabled())return d();if(window.Config.isLhsReorderNewModelEnabled())return a();let t="",e=LhsModules.getLhsModulesArray();return PersonalizeUI.getNewLhsModuleOrder().forEach(i=>{let a=i.split("-"),n=a[1];if(i=a[0],"0"!==n){let a=e.filter(t=>t.id===i);a[0]&&(t+=s({item_obj:a[0]}))}}),t},a=()=>{let t="",e=LhsModules.getLhsModulesArray(),i=LhsModuleOrder.getLhsOrder();var a=[];return i||(i=e),i.forEach(i=>{let l=i.module_id;if("enabled"===(i.state?i.state:"enabled")){let o=e.filter(t=>t.id==="lhs_"+l);"widget"===i.module?(t+=n({widget_id:l,widgetObj:i}),a.push({type:i.module,id:l,name:i.entity.name})):o[0]&&(t+=s({item_obj:o[0]}),a.push({type:i.module,id:"lhs_"+l}))}}),0!=a.length&&ISCHandler.initializeLHSModules(a),t},n=({widget_id:t,widgetObj:i,fromOverFlow:a,val:n,fromMainLhs:l,unSeenWidget:o})=>{let r={id:t,module_id:t,name:i.entity.name,isLocked:i.isSystemLocked()||i.isLocked(),purpose:l&&o?"showUnseenWidgetInMoreAppsOverlay":"showWidgetFromSection"},d=i.entity.photo_id;return d?(r.img_src=$Util.getUrlWithContext("/appletimg/"+d+"/photo.do"),(({item_obj:t,fromOverFlow:s,val:i,unSeenWidget:a})=>{var n=$WC.$CUtil.processXSS(Resource.getRealValue(t.name)),l=!1;if(!$WC.Util.isEmpty(i)&&s){if(!n||-1===n.toLowerCase().indexOf(i))return"";l=!0,n=_highlightSearchText(n,i)}var o="";let r="";return a&&(r='<span class=" posabs unseentag zcf-unseen-star" ></span>'),o=$WC.template.replace(e.lhs_module_item_img,{unseenTagHtml:r},"InSecureHTML"),o=$WC.template.replace(o,{item_id:t.id,item_purpose:t.purpose,img_src:t.img_src,active_cls:t.id===LhsModules.activeTabId?"active":"",overFlowTabsCls:s?"otherAppItem":"",$tooltip_name:s?t.name:"",ellips_cls:s?"ellips-L2":"ellips",module_id:t.module_id,item_elem_type:t.isLocked?"":"lhs_navigation_tab"}),o=l?$WC.template.replace(o,{name:n},"InSecureHTML"):$WC.template.replace(o,{name:n})})({item_obj:r,fromOverFlow:a,val:n,unSeenWidget:o})):(r.icon="zcf-applet",s({item_obj:r,fromOverFlow:a,val:n,unSeenWidget:o}))},l=()=>$WC.template.replace(e.lhs_module_wrapper,{module_items_html:i(),checked_cls:Settings.getFromObj("darkmode")?"checked":"",$tooltip:Settings.getFromObj("darkmode")?"turn.off.dark":"turn.on.dark",unseenWidgetsTag:LhsNavigation.showUnseenTagInLhs()?'<span id ="unseenAppletTag" class = "unseenAppletTag" ></span>':""},"InSecureHTML");const o=function(){return UI.isCrmPlusUI()?-1:$("#lhs_module_items")[0]?Math.trunc($("#lhs_module_items")[0].clientHeight/54)-1:Math.trunc((screen.height-288)/54)-1};var r=function(){let t=LhsModuleOrder.getLhsOrder(),e=LhsModules.getLhsModulesArray();for(var s=[],i=o(),a=t.length,n="",l=0;l<a;l++){var r=t[l];let i=r.getModuleId();if(r.isStateEnabled()){let t=e.filter(t=>t.id==="lhs_"+i);r.isWidget()?(s.push(r),i,i===LhsModules.activeTabId&&(n=i)):t[0]&&(s.push(r),i,"lhs_"+i===LhsModules.activeTabId&&(n=i))}}UI.isCrmPlusUI()&&(null!=e.filter(t=>t.id===LHSConstants.ModuleIds.MYWIDGETS)&&"undefined"!=typeof LhsTabsObj&&0===s.filter(t=>"widgets"===t.tab_id).length&&s.push(new LhsTabsObj({tab_id:"widgets",module:"default",module_id:"widgets",state:"enabled"})));if(i>s.length||-1===i)return s;var d=s.map(t=>t.getModuleId()).indexOf(n);if(i<=d&&-1!=d){var c=s[d];s.splice(d,1),s.splice(i-1,0,c)}return s};let d=function(){let t="",i=LhsModules.getLhsModulesArray(),a=r();for(var l=[],d="",c=0,p=0,h="",m=o(),u=!1,v=a.length,g=0;g<v;g++){var f=a[g];let e=f.getModuleId(),o="";if(f.isStateEnabled()){let t=i.filter(t=>t.id==="lhs_"+e);f.isWidget()?(o=n({widget_id:e,widgetObj:f}),l.push({type:f.module,id:e,name:f.entity.name})):t[0]&&(t[0].module_id=e,t[0].isLocked=f.isSystemLocked()||f.isLocked(),o=s({item_obj:t[0]}),l.push({type:f.module,id:"lhs_"+e,module_id:e}))}c>=m&&-1!=m?(u=!0,$WC.Util.isEmpty(o)||(p++,h=o)):$WC.Util.isEmpty(o)||(t+=o,d=e,c++)}return u&&1===p?t+=h:u&&p>1&&(t+=(t=>$WC.template.replace(e.lhs_module_moreOpt,{item_purpose:"showMoreLhsTabs",prev_tab_id:t}))(d)),0!=l.length&&ISCHandler.initializeLHSModules(l),t};var c=function(t){let e="",i=LhsModules.getLhsModulesArray(),a=r();for(var l=[],o=document.getElementById("lhs_moreTabsOpt"),d=o?o.getAttribute("prev_tab_id"):"",c=a.map(t=>t.getModuleId()).indexOf(d),p=a.length,h=0,m=c+1;m<p;m++){var u=a[m];let o=u.getModuleId(),r="";if(u.isStateEnabled()){let e=i.filter(t=>t.id==="lhs_"+o);u.isWidget()?(r=n({widget_id:o,widgetObj:u,fromOverFlow:!0,val:t}),l.push({type:u.module,id:o,name:u.entity.name})):e[0]&&(r=s({item_obj:e[0],fromOverFlow:!0,val:t}),l.push({type:u.module,id:"lhs_"+o}))}$WC.Util.isEmpty(r)||(e+=r,h++)}return[h,e]};var p=function(t){var s=u(t),[i,a]=c(t);return $WC.Util.isEmpty(a)&&$WC.Util.isEmpty(s)?"":$WC.template.replace(e.moreLhsListingSectionHtml,{overFlw_modulesList:a,hide_newlyaddedApps:$WC.Util.isEmpty(s)?"hide":"",hide_moreLhsTabs:$WC.Util.isEmpty(a)?"hide":"",$suggestions_fromMoreApps_txt:"contact.sugg",newlyAddedAppletsListingHtml:s},"InSecureHTML")},h=function(t,e){let s=e?$("#moreLhs-search-field"):$(t.target),i=$.trim(s.val());var a=$zcg.ESCAPE_KEYCODE?$zcg.ESCAPE_KEYCODE:KeyCodes?KeyCodes.ESCAPE_KEYCODE:27;t.keyCode!=a&&!e||$WC.Util.isEmpty(i)||(t.stopImmediatePropagation(),s.val("").focus(),i="");var n=p(i.toLowerCase()),l=$("#mainLhsOverFlwTabsSection");if($WC.Util.isEmpty(n)){var o=$Util.emptyStateHtml({imageclass:"applets_noresult mainOverflowTabsSearchEmpty",title:Resource.getRealValue("common.search.empty"),fontsize:"12"});l.html(`<div class="h100 searchEmptyImgClass ">${o}</div>`),l.addClass("installedAppsListEmpty")}else l.html(n),l.removeClass("installedAppsListEmpty"),LhsModules.updateCounter()};let m=function(){if(Config.isLhsCustomizationForUserEnabled()){var t=$("#lhs_ovrFlw_Cnt"),e=t.find("#mainLhsOverflowSearch");t.on("click","[purpose]",(function(t){var e=t.target;"clearMoreLhsSearchInput"===$(e).attr("purpose")?h(t,!0):LHSHandler.handleClick(t,this)})),e.on("keyup",(function(t){h(t)}))}};let u=function(t){let e=Applets.getUnseenAppletObjects();if(0===e.length)return"";let s=IntegrationsUtil.sortByKey(e,"name"),i="",a=s.length;for(let l=0;l<a;l++){let a=e[s[l]],o={entity:{photo_id:a.photo_id,name:a.name},module_id:a.id,module:"widget"};i+=n({widget_id:a.id,widgetObj:o,fromOverFlow:!0,val:t,fromMainLhs:!0,unSeenWidget:!0})}return i};return{getLHSHtml:()=>$WC.template.replace(e.lhs_nav_wrapper,{module_wrapper:l(),submodule_container:LhsModules.getSubModuleHtml(LhsModules.activeTabId)},"InSecureHTML"),updateSubModuleCategory:t=>{void 0!==Folders&&(Folders.isFolderCreationSelected=!1),MyPinsCustomizer.isPinOrderStateActive=!1;let e=_isLHSChatSearchEnabled(),s=LhsModules.activeTabId===LHSConstants.ModuleIds.MYTEAMS,i=LhsDomCache.getLHSModuleParent();if(s&&e&&MyTeamsLHS.isLHSSearchFocused()){var a=i.find("#lhssearchemptystate");i.find("#channelslhs").remove(),a.length&&a.remove(),i.append(LhsModules.getSubModuleHtml(LhsModules.activeTabId))}else if(i.html(LhsModules.getSubModuleHtml(LhsModules.activeTabId,t)),LhsModules.activeTabId===LHSConstants.ModuleIds.MYPINS&&Config.isFoldersEnabled()&&Folders.updateHeaderUnreadCount([],!0),s)if(ChannelsUI.List.LHS.checkAndCollapseSubHeader(),MyTeamsLHS.show_LoadAll){let t=`<div id="channelsmore" class="pT5 pB20 mgA textC" catagory="channels" workfor="channel" elemtype="more"><span class="showmore font14 pB2">${I18N("common.showall")}</span></div>`;$("#channelslist").append(t)}else $("#channelsmore").remove();LhsModules.bindedNotifierScroll=!1,$("#unreadnotifier").addClass("hidden").removeAttr("title"),s&&e&&(MyTeamsLHS.updateUnreadFilter(),MyTeamsLHS.bindEventsForUnreadFilter(i.find("#lhsutilityopts")))},switchLHSView:()=>{LhsModules.viewType=Settings.getFromObj("lhs_view_type"),LhsModules.activeTabId=LhsModules.isConsolidatedView()?LHSConstants.ModuleIds.MYCONVOS:LHSConstants.ModuleIds.MYCHATS;let t=$("#lhs_modules_listing");if(t.html(l()),t.find("#"+LhsModules.activeTabId).click(),Config.isFoldersEnabled()){let t=$("#list");t.hasClass("lhs-pinreorder-active lhs-category-pinorder")&&(t.removeClass("lhs-pinreorder-active lhs-category-pinorder"),t.removeClass("lhs-whole-section-reorder"))}},updateRHSView:t=>{let e=$("#main_container_dom");e.find("#mycliqfiles_view").length&&MediaListingUI.putLastAccessedMediaType(),e.html(t),MainUI.getMefront("main-data-container",!0)},removeRHSView:()=>{let t=$("#main_container_dom");t.is(":empty")||(UI.isDetachedCwinLoaded&&DetachedCwin.hasOpenedChats()&&(DetachedCwinUtils.closeAllOpenedChats(),NestedChatUI.hideAll()),t.find("#mycliqfiles_view").length&&MediaListingUI.putLastAccessedMediaType(),t.hide().html(""),Config.isClientMemoryOptimizationEnabled()&&(ConversationsHistoryUI.reinitConstants(),CallsHistoryUI.reinitConstants()),MainUI.close("main_container_dom"))},updateModuleOrder:e=>{if(e)clearTimeout(t),t=void 0;else if(void 0!==t)return;t=setTimeout((function(){t=void 0}),800),$("#lhs_modules_listing").html(l()),Config.isClientMemoryOptimizationEnabled()?$("#lhs_module_items").addClass("ovrflwA chatnativescroll"):ZCScroll.customScroll($("#lhs_module_items"))},showLhsOverflowTabs:function(t){var[s,i]=c(),a=$WC.template.replace(e.lhs_moduleOvrflw_Html,{moreLhsSectionHtml:'<div class="flexM h100"><div class="zcl-rloader posrel"></div></div>',hide_moreAppsButton:"undefined"!=typeof SecurityManager&&SecurityManager.hasPermission(Modules.Applets)&&Config.isLhsCustomizationForUserEnabled()?"":"hide"},"InSecureHTML"),n=$("#lhs_ovrFlw_Cnt");Clickoutside.clear("lhs_ovrFlw_Cnt"),n.remove(),0===n.length&&($("#leftpannel").after(a),Clickoutside.bind({srcid:"lhs_moreTabsOpt",event:t,destid:"lhs_ovrFlw_Cnt",customHide:function(t){$("#"+t.destid).remove()},customShow:function(t){$("#"+t.destid).css("display","flex"),s>4?$("#"+t.destid).addClass("moreTabsInOverflow"):$("#"+t.destid).removeClass("moreTabsInOverflow"),$("#"+t.destid).find("#moreLhs-search-field").focus()}}));var l=function(){$("#mainLhsOverFlwTabsSection").html(p()),m()};$zcg._LATESTWIDGETCOMPONENTAVALIABLE?HomeUI.getLatestComponents({successCallBack:function(t){t.applets&&(Applets.storeUnseenApplets(t.applets),Applets.addListToStorage(Applets.convertListToV2(t.applets)),$zcg._LATESTWIDGETCOMPONENTAVALIABLE=!1),l()},errorCallBack:function(){l()}}):l()},showBottomBarOptions:function(t){var s=$WC.template.replace(e.lhs_bottom_barOptions,{hide_moreAppsButton:"undefined"!=typeof SecurityManager&&SecurityManager.hasPermission(Modules.Applets)&&Config.isLhsCustomizationForUserEnabled()?"":"hide",darkmode_cls:UI.isWorkPlaceBundle()?"hide":"",checked_cls:Settings.getFromObj("darkmode")?"checked":"",$tooltip:Settings.getFromObj("darkmode")?"turn.off.dark":"turn.on.dark",hide_unseenTag:LhsNavigation.showUnseenTagInLhs()?"":"hide"},"InSecureHTML"),i=$("#navigationBottomBarOptionsCnt");Clickoutside.clear("navigationBottomBarOptionsCnt"),i.remove(),0===i.length?($("#navigationBottomBarOpts").after(s),Clickoutside.bind({srcid:"navigationBottomBarOpts",event:t,destid:"navigationBottomBarOptionsCnt",doNotClose:function(t,e,s){if(s&&s.target){var i=s?s.target:void 0;if("darkmode_switch_btn"===(i?i.getAttribute("id"):void 0))return!0}return!1},customShow:function(t){$("#"+t.srcid).addClass("show_icon")},customHide:function(t,e){if(e&&e.target){var s=e?e.target:void 0;"darkmode_switch_btn"===(s?s.getAttribute("id"):void 0)?$('[for="darkmode_switch_btn"]').addClass("loading_progress"):$("#"+t.destid).remove()}else $("#"+t.destid).remove();$("#"+t.srcid).removeClass("show_icon")}})):$("#navigationBottomBarOpts").removeClass("show_icon")},showUnseenTagInLhs:function(){return Config.isLhsCustomizationForUserEnabled()&&($zcg._LATESTWIDGETCOMPONENTAVALIABLE||Applets.getUnseenAppletIds().length>0)}}}(),LhsModules=function(){let t=!1;const e=()=>$ZCAjx.isAdminPanelRequest(),s=()=>SecurityManager.getModuleConfig(Modules.TabsWebPreferences),i=()=>{return"true"===SecurityManager.getModuleConfig(Modules.TabsWebPreferences).tabs_locked_web},a=()=>{return e()?LhsModuleReorderImpl.isCurrentViewSegmented():Config.isLhsCustomizationForUserEnabled()&&!$ZCAjx.isAdminPanelRequest()&&i()?s().tabs_viewtype_web===LhsTabsConfigConstants.VIEW_TYPE.SEGMENTED:1===Settings.getFromObj("lhs_view_type")},n=()=>{return e()?LhsModuleReorderImpl.isCurrentViewConsolidated():Config.isLhsCustomizationForUserEnabled()&&!$ZCAjx.isAdminPanelRequest()&&i()?s().tabs_viewtype_web===LhsTabsConfigConstants.VIEW_TYPE.CONSOLIDATED:0===Settings.getFromObj("lhs_view_type")};let l=LHSConstants.ModuleIds.MYCONVOS,o=function(){return $ZCAjx.isAdminPanelRequest()?FeatureAccess.isAllowed(FeatureAccess.modules.Bots):SecurityManager.hasPermission(Modules.Bots)};var r=()=>{let t=[];return t.push({id:LHSConstants.ModuleIds.MYCHATS,purpose:"showChatsTab",icon:e()?"/officechat/images/default/lhs_reorder/chat.svg":"zcf-chat",name:"common.shortcut.chats"}),t.push({id:LHSConstants.ModuleIds.MYPHONE,purpose:"showPhoneTab",icon:"/officechat/images/default/lhs_reorder/call.svg",name:"phone.hdr"}),t.push({id:LHSConstants.ModuleIds.MYTEAMS,purpose:"showTeamsTab",icon:e()?"/officechat/images/default/lhs_reorder/hash_channel.svg":"zcf-channel font13",name:"menuname.channelsandgroups"}),t.push({id:"lhs_events",purpose:"showCalendarsTab",icon:e()?"/officechat/images/default/lhs_reorder/events.svg":"zcf-zcalendar",name:"module.events"}),t};let d=function(t,e){return!!ConversationsList.isMuted(t)||(ConversationsList.isPinned(t)&&"pinnedchats"!=e?"channels"!=e&&LhsModules.isSegmentedView():ConversationsList.isThreadChat(t)?!(Config.isThreadsLhsEnabled()&&!p.isInlineInChats())||(!(!ConversationsList.isPinned(t)||"chats"!=e||!LhsModules.isSegmentedView())||!(ConversationsList.isPinned(t)&&"chats"==e&&!p.isSectionUnderChats())&&(!ConversationsList.isThreadFollower(t)||!("pinnedchats"==e||!p.isSeparateMenu()))):void 0)},c=t=>{let e=$DB.get("conversations"),s=0,i=0,a=0,n=0;for(let l in e)if(ConversationsList.getUnreadCount(l)>0){if("threadchats"==t&&ConversationsList.isThreadFollower(l)&&!ConversationsList.isPinned(l)&&n++,d(l,t))continue;if(LhsModules.isConsolidatedView())i++;else{let e=new $CliqChatId(l);"pinnedchats"===t&&ConversationsList.isPinned(l)?(s++,e.isChannel()&&a++):"chats"!==t||e.isChannel()?"channels"===t&&e.isChannel()&&a++:i++}}return{pinned:s,chats:i,channels:a,threads:n}};var p={isSectionUnderChats:function(){return 0==Settings.getThreadsModuleOrderInLhs()},isSeparateMenu:function(){return 1==Settings.getThreadsModuleOrderInLhs()},isCombinedWithConversation:function(){return 2==Settings.getThreadsModuleOrderInLhs()},isInlineInChats:function(){return 3==Settings.getThreadsModuleOrderInLhs()}};return{init:()=>{LhsModules.activeTabId=n()?LHSConstants.ModuleIds.MYCONVOS:LHSConstants.ModuleIds.MYCHATS},viewType:void 0,activeTabId:l,highlightModule:t=>{(t=>t?"lhs_moreTabsOpt"===t:"lhs_moreTabsOpt"===LhsModules.activeTabId)(t)||((t=>t?t!==LHSConstants.ModuleIds.MYWIDGETS:LhsModules.activeTabId!==LHSConstants.ModuleIds.MYWIDGETS)(t)&&WidgetsLHS.closeWidgetView(),(t=>t?t!==LHSConstants.ModuleIds.MYTASKS:LhsModules.activeTabId!==LHSConstants.ModuleIds.MYTASKS)(t)&&($("#projectstab-main").is(":visible")?MainUI.close("projectstab-main"):MainUIManager.handleClose("projectstab-main")),LhsModules.activeTabId=t);var e=$("#lhs_module_items");(e.find(".active").removeClass("active").removeAttr("data-activetab"),e.find("#"+t).addClass("active").attr("data-activetab",""),ISCHandler.highlightModule(t),UI.isCrmPlusUI()||0!==e.find("#"+t).length||(LhsNavigation.updateModuleOrder(!0),LhsModules.updateCounter()),MyOrgModule.defaultSection.isChannelOpenedInThisView&&LhsModules.activeTabId!=LHSConstants.ModuleIds.MYPEOPLE)&&(MyOrgModule.defaultSection.isChannelOpenedInThisView=!1,ChatUI.getWin(MyOrgModule.defaultSection.currentlyOpenedChid).closeWindow(),MainUIManager.openPrevious())},getLhsModulesArray:()=>{LhsModules.viewType=e()?LhsModuleReorderImpl.getCurrentViewType():Settings.getFromObj("lhs_view_type");let t=[];if(e()&&LhsModuleReorderImpl.currentClientViewType()===LhsTabsConfigConstants.CLIENT_TYPE.MOBILE)return r();if(a()&&(t.push({id:LHSConstants.ModuleIds.MYPINS,purpose:"showPinsTab",icon:e()?"fclq-pin":"zcf-pin",name:"common.pinnedchats"}),t.push({id:LHSConstants.ModuleIds.MYCHATS,purpose:"showChatsTab",icon:e()?"fclq-chat_lhs":"zcf-chat",name:"common.shortcut.chats"})),n()&&t.push({id:LHSConstants.ModuleIds.MYCONVOS,purpose:"showConvosTab",icon:e()?"fclq-chat_lhs":"zcf-chat",name:"common.shortcut.chats"}),OrgFeatures.isIntranetRequest()&&t.push({id:LHSConstants.ModuleIds.MYDMS,purpose:"showDMsTab",icon:e()?"fclq-event-organiser":"zcf-event-organiser font13",name:"Contacts"}),LhsModules.showThreadsAsSeparateModule()&&t.push({id:LHSConstants.ModuleIds.MYTHREADS,purpose:"showMyThreadsTab",icon:e()?"fclq-startthread":"zcf-startthread",name:"threads.title"}),("undefined"!=typeof SecurityManager&&SecurityManager.hasPermission(Modules.Channels)||"undefined"!=typeof FeatureAccess&&FeatureAccess.isAllowed(FeatureAccess.modules.CHANNELS))&&t.push({id:LHSConstants.ModuleIds.MYTEAMS,purpose:"showTeamsTab",icon:e()?"fclq-channels":"zcf-channel font13",name:"menuname.channelsandgroups"}),t.push({id:LHSConstants.ModuleIds.MYHISTORY,purpose:"showHistorysTab",icon:e()?"fclq-history":"zcf-history",name:"history.hdr"}),Config.isZohoVoiceAllowed()&&t.push({id:LHSConstants.ModuleIds.MYPHONE,purpose:"showPhoneTab",icon:e()?"fclq-video-conf":"zcf-video-conf",name:"phone.hdr"}),Config.isMediaGalleryViewEnabled()&&t.push({id:LHSConstants.ModuleIds.MYFILES,purpose:"showFilesTab",icon:e()?"fclq-fileicon":"zcf-fileicon",name:"media.files"}),(e()&&Config.isCalendarInLHSEnabled()||!$ZCAjx.isAdminPanelRequest()&&EventsMain.UTIL.isCalendarInLHSEnabled()&&!$Util.isExternalUser())&&t.push({id:LHSConstants.ModuleIds.MYCALENDAR,purpose:"showCalendarsTab",icon:e()?"fclq-zcalendar":"zcf-zcalendar",name:"smiley.calendar"}),(e()&&Config.isNotebookIntegrationEnabled()||!$ZCAjx.isAdminPanelRequest()&&NoteBookUtil.isIntegrationEnabled()&&!$Util.isExternalUser())&&t.push({id:LHSConstants.ModuleIds.MYNOTEBOOK,purpose:"showNotebooksTab",icon:e()?"fclq-notes":"zcf-notes",name:"common.notes"}),$ZCAjx.isAdminPanelRequest()?FeatureAccess.isAllowed(FeatureAccess.modules.ZOHOPROJECTS):!_isOauthDesktopApp()&&SecurityManager.hasPermission("taskmanagement")&&OrgFeatures.isIntranetRequest()){let s=$zcg._ISPAIDPROJECTSPORTAL?"projects.list":"projects.tasks";t.push({id:LHSConstants.ModuleIds.MYTASKS,purpose:"showTasksTab",icon:e()?"fclq-zohoprojects_lhs":"zcf-zohoprojects",name:s})}return $ZCAjx.isAdminPanelRequest()||!$ZCAjx.isAdminPanelRequest()&&Config.isLhsCustomizationForUserEnabled()&&!UI.isCrmPlusUI()||!("undefined"!=typeof SecurityManager&&SecurityManager.hasPermission(Modules.Applets)||"undefined"!=typeof FeatureAccess&&FeatureAccess.isAllowed(FeatureAccess.modules.Applets))||t.push({id:LHSConstants.ModuleIds.MYWIDGETS,purpose:"showWidgetsTab",icon:e()?"fclq-applet":"zcf-applet",name:"integration.applet.title"}),LhsModules.showBotsAsSeparateModule()&&t.push({id:LHSConstants.ModuleIds.MYBOTS,purpose:"showMyBotsTab",icon:e()?"fclq-bots":"zcf-bot",name:"bots.title"}),(()=>e()?$zcg._ISCLIQHRSYSTEMENABLED:!UI.isZillum())()&&t.push({id:LHSConstants.ModuleIds.MYPEOPLE,purpose:"showMyOrgTab",icon:e()?"fclq-org-icon_lhs":"zcf-org-icon",name:"module.org"}),t},getSubModuleHtml:(t,e)=>t===LHSConstants.ModuleIds.MYPINS?MyPins.getSubModuleHtml():t===LHSConstants.ModuleIds.MYCHATS&&a()?MyChatsLHS.getSubModuleHtml():t===LHSConstants.ModuleIds.MYCONVOS&&n()?MyConvosLHS.getSubModuleHtml():t===LHSConstants.ModuleIds.MYTHREADS?MyThreadsLHS.getSubModuleHtml():t===LHSConstants.ModuleIds.MYDMS?MyDMsLHS.getSubModuleHtml():t===LHSConstants.ModuleIds.MYBOTS?MyBotsLHS.getSubModuleHtml():t===LHSConstants.ModuleIds.MYTEAMS?MyTeamsLHS.getSubModuleHtml():t===LHSConstants.ModuleIds.MYHISTORY?HistoryModule.getSubModuleHtml():t===LHSConstants.ModuleIds.MYPHONE?PhoneModule.getSubModuleHtml():t===LHSConstants.ModuleIds.MYFILES?MyFiles.getSubModuleHtml():t===LHSConstants.ModuleIds.MYWIDGETS?WidgetsLHS.getSubModuleHtml():LhsModuleOrder.isActiveTabWidget(t)?TemplateUtil.getSubListLoader():t===LHSConstants.ModuleIds.MYTASKS?TasksLHS.getSubModuleHtml(e):t===LHSConstants.ModuleIds.MYCALENDAR?CalendarLHS.getSubModuleHtml():t===LHSConstants.ModuleIds.MYNOTEBOOK?NoteBookLHS.getSubModuleHtml():t===LHSConstants.ModuleIds.MYPEOPLE?MyOrgModule.getSubModuleHtml():t===LHSConstants.ModuleIds.MYORG?Teams_LHS.getSubModuleHtml():"",updateCounter:t=>{if(LhsModules.isConsolidatedView()){let e;if("invited_contacts"==t)return e=Contacts.getPendingContactsList(!0).length||"",$("#"+LHSConstants.ModuleIds.MYDMS+"_counter").html(e),void ISCHandler.updateModuleUnreadCount(LHSConstants.ChatsCategory.CONTACTS,e);e=Contacts.getPendingContactsList(!0).length||"",$("#"+LHSConstants.ModuleIds.MYDMS+"_counter").html(e),ISCHandler.updateModuleUnreadCount(LHSConstants.ChatsCategory.CONTACTS,e),e=c("chats").chats||"",$("#"+LHSConstants.ModuleIds.MYCONVOS+"_counter").html(e),ISCHandler.updateModuleUnreadCount(LHSConstants.ChatsCategory.CHATS,e)}else{let t=c("pinnedchats").pinned||"";$("#"+LHSConstants.ModuleIds.MYPINS+"_counter").html(t),ISCHandler.updateModuleUnreadCount(LHSConstants.ChatsCategory.PINNED,t),t=Contacts.getPendingContactsList(!0).length||"",$("#"+LHSConstants.ModuleIds.MYDMS+"_counter").html(t),ISCHandler.updateModuleUnreadCount(LHSConstants.ChatsCategory.CONTACTS,t),t=c("chats").chats||"",$("#"+LHSConstants.ModuleIds.MYCHATS+"_counter").html(t),ISCHandler.updateModuleUnreadCount(LHSConstants.ChatsCategory.CHATS,t),t=c("channels").channels||"",$("#"+LHSConstants.ModuleIds.MYTEAMS+"_counter").html(t),ISCHandler.updateModuleUnreadCount(LHSConstants.ChatsCategory.CHANNELS,t)}if(ChatUI.isThreadAsSeparateTab()){let t=c("threadchats").threads||"";$("#"+LHSConstants.ModuleIds.MYTHREADS+"_counter").html(t),ISCHandler.updateModuleUnreadCount(LHSConstants.ChatsCategory.THREADS,t)}ISCHandler.handleTotalUnreadCount()},updateUnreadNotifier:()=>{let t=$("#leftpannel [modules_scoller]"),e=$("#unreadnotifier"),s=$(e).find("#counter");if(0===t.length)return $(s).html(""),void $(e).addClass("hidden").removeAttr("title");(t=>{LhsModules.bindedNotifierScroll||(LhsModules.bindedNotifierScroll=!0,t.on("scroll",$Util.debounce((function(){LeftPannel.hidePopups(),ConversationsUI.updateUnreadNotifier()}),"",100)))})(t);let i=t.find("[unread]"),a=t[0],n=ConversationsList.getUnreadChats();$Util.loadfavicon(n.length>=1);let l=[],o=[],r=i.length;for(let t=0;t<r;t++){var d="contact"==i[t].getAttribute("type"),c=d?i[t].getAttribute("uid"):i[t].getAttribute("chid");if(d||!ChatUI.isMuted(c)){var p=d?$("#contactinvitationsheader")[0]:$("#tab"+c)[0];if(p||(p=$("#tab"+i[t].getAttribute("uid"))[0]),p&&!$(p).isScrolledToView(a,.5,.5)){var h=$Util.getScrollpositiontoView(p,a);"top"==h?l.push(p):"bottom"==h&&o.push(p)}}}ConversationsUI.unreadelements.top=$Util.cloneArray($Util.removeDuplicateEntries(l)),ConversationsUI.unreadelements.bottom=$Util.cloneArray($Util.removeDuplicateEntries(o));var m=0,u=0;ConversationsList.getUnreadChats("threadchats").length>0&&(u=+$("#threadchatsshowmore #unreadcount").text())>0&&(m=ConversationsUI.unreadelements.bottom.filter((function(t){return"threadchats"==t.getAttribute("catagory")})).length);let v=ConversationsUI.getunreadcount(ConversationsUI.unreadelements.top),g=ConversationsUI.getunreadcount(ConversationsUI.unreadelements.bottom);if(g>0&&u>0&&m>0&&u>=g&&(g=0),v>0||g>0){let t=v>0,i=t?v:g,a=Resource.getRealValue("chat.unread.scroll",[i>1?Resource.getRealValue("common.shortcut.notifications"):Resource.getRealValue("common.shortcut.notification")]);$(e).removeClass("hidden").attr("title",a),t?$(e).removeClass("zcunrdcrbtmdwn"):$(e).addClass("zcunrdcrbtmdwn"),$(s).html(i)}else $(s).html(""),$(e).addClass("hidden").removeAttr("title")},bindedNotifierScroll:!1,isSegmentedView:a,isConsolidatedView:n,threadViews:p,showBotsAsSeparateModule:()=>OrgFeatures.isIntranetRequest()?e()?o()&&LhsModuleReorderImpl.showBotAsSeperateModule():o()&&1==Settings.getBotsModuleOrderInLhs():o(),showThreadsAsSeparateModule:()=>e()?Config.isThreadFeatureEnabled()&&LhsModuleReorderImpl.showThreadsAsSeperateModule():Config.isThreadFeatureEnabled()&&1==Settings.getThreadsModuleOrderInLhs(),isHiddenModule:t=>{var e=LhsModuleOrder.getLhsOrder().filter((function(e){return e.module_id===t}));return!!e.length&&"disabled"===e[0].state},isChatOrMyPinSelected:function(){return[LHSConstants.ModuleIds.MYCONVOS,LHSConstants.ModuleIds.MYPINS,LHSConstants.ModuleIds.MYCHATS].includes(LhsModules.activeTabId)},fetchAndUpdateLHSOrder:()=>{var t=function(t){LhsModuleOrder.updateLhsOrder(t),LhsNavigation.updateModuleOrder(!0),AppletTabs.isMoreAppsOverlayView()&&WidgetsOverlay.updateWidgetHeaderBtnsHtml()};if(UserStates.isTabsFetchNeeded())Config.isLhsCustomizationForUserEnabled()?LhsModuleReorderImpl.getLhsCoreTabsLhsOrder((function(e){t(e),LhsModuleOrder.updateSessionStorageWithLmtime()})):$ZCAjx.ajax({url:"/api/v2/tabs",data:{oldflow:!0},success:e=>{e.data&&(t(e.data),LhsModuleOrder.updateSessionStorageWithLmtime())},error:()=>{LhsNavigation.updateModuleOrder()}});else{var e=$DB.get("tabs"),s=e.data;if(Config.isLhsCustomizationForUserEnabled()){var i=LhsModuleReorderImpl.getTabsListParams(LhsModuleReorderImpl.currentClientViewType());for(var a in s)i.updateTabsStorage(s[a]);i.storeFetchedCoreTabs(e.data),i.setAllCoreTabsPopulated(),s=i.getAllCurrentCoreTabsObjs()}t(s)}},isAdminLhsReorderEnabled:e,isLhsAdminOrgLocked:i,isThreadViewTypeOrgLocked:function(){return"true"===SecurityManager.getModuleConfig(Modules.TabsWebPreferences).tabs_thread_viewtype_locked},isBotViewTypeOrgLocked:function(){return"true"===s().tabs_bots_viewtype_locked},getThreadsOrgViewType:function(){var t=s();return Object.keys(LhsTabsConfigConstants.VIEW_TYPEKEY_THREAD_VIEW).find(e=>LhsTabsConfigConstants.VIEW_TYPEKEY_THREAD_VIEW[e]===t.tabs_thread_viewtype)},getBotsOrgViewType:function(){var t=s();return Object.keys(LhsTabsConfigConstants.VIEW_TYPEKEY_THREAD_VIEW).find(e=>LhsTabsConfigConstants.VIEW_TYPEKEY_THREAD_VIEW[e]===t.tabs_bots_viewtype)},setTabsForceFetchRequired:e=>{t=e},isTabsForceFetchRequired:()=>t}}();var LhsModuleOrder=function(){let t=[],e=t=>LhsModuleOrder.getLhsOrder().filter(e=>e.module_id===t&&"widget"===e.module),s=t=>{var e=$DB.get("tabs");void 0===e&&(e={}),e.data=t,$DB.update("tabs",e)};return{getLhsOrder:()=>window.Config.isLhsReorderNewModelEnabled()?t:PersonalizeUI.getNewLhsModuleOrder(),updateSessionStorageWithData:s,updateSessionStorageWithLmtime:()=>{var t=$DB.get("tabs");void 0===t&&(t={});var e=UserStates.getTabsLMTime(),s=UserStates.getTabsOrgLMTime();void 0!==e&&(t.lm_time=e,$DB.update("tabs",t)),void 0!==s&&(t.org_lm_time=s,$DB.update("tabs",t))},updateLhsOrder:e=>{if("add_tab"==e.action)delete e.action,t.push(e);else if("remove_tab"===e.action){let s=e.tab_id;t=t.filter(t=>t.id!==s)}else if("state_update"===e.action){let s=e.tab_id;t.forEach(t=>{t.id===s&&(t.state=e.state)})}else if("reorder_tab"===e.action){let s=e.tab_id,i=e.set_above_id,a=t.map((function(t){return t.id})).indexOf(s);if(void 0===i){let e=t.splice(a,1)[0];e.state="enabled",t.push(e)}else{let e=t[a];e.state="enabled";let s=t.map((function(t){return t.id})).indexOf(i);t.splice(a,1),t.insert(s,e)}}else t=e;!$ZCAjx.isAdminPanelRequest()&&s(t)},isWidgetPinned:t=>{return e(t).length},isActiveTabWidget:t=>t?!isNaN(t):!isNaN(LhsModules.activeTabId),updateLhsWidgetPin:t=>{if(t.fromMoreAppsOverlay?WidgetsOverlay.updateAddRemoveTabBtnHtml(t.id):$("#tabapplet-"+t.id).append('<div id="widget_pin_loader" class="zcl-rloader xs posrel" style="display: block;"></div>'),"add_widget"===t.action){if((()=>LhsModuleOrder.getLhsOrder().filter(t=>"widget"===t.module))().length>$zcg._WIDGET_AS_SECTION_LIMIT)return $("#app_tablist #widget_pin_loader").remove(),t.fromMoreAppsOverlay&&WidgetsOverlay.updateAddRemoveTabBtnHtml(t.id),void UI.updateBanner(Resource.getRealValue("wid.sect.add.limit"),2e3,!0);WidgetsLHS.pinWidgetToLhs(t.id,(function(e,s){if(e){if($("#app_tablist #widget_pin_loader").remove(),UI.updateBanner(I18N("wid.sect.add.succs")),Config.isLhsCustomizationForUserEnabled()){var i=LhsModuleReorderImpl.getTabsListParams(LhsModuleReorderImpl.currentClientViewType());s.data&&(i.updateTabsStorage(s.data),i.addTabCoreTabs(s.data.module_id)),i.updateBulkUpdateCoreApps(),LhsModuleOrder.updateLhsOrder(i.getSessionStorageTabObjects())}LhsNavigation.updateModuleOrder(!0),t.fromMoreAppsOverlay&&WidgetsOverlay.updateAddRemoveTabBtnHtml(t.id)}else t.fromMoreAppsOverlay?WidgetsOverlay.updateAddRemoveTabBtnHtml(t.id):$("#app_tablist #widget_pin_loader").remove()}))}else"remove_widget"===t.action&&WidgetsLHS.unpinWidgetToLhs(t.id,(function(e,s){if(e){if($("#app_tablist #widget_pin_loader").remove(),UI.updateBanner(I18N("wid.sect.remove.succs")),Config.isLhsCustomizationForUserEnabled()){var i=LhsModuleReorderImpl.getTabsListParams(LhsModuleReorderImpl.currentClientViewType());i.addTabToOtherTabs(s),i.updateBulkUpdateCoreApps(),LhsModuleOrder.updateLhsOrder(i.getSessionStorageTabObjects())}LhsNavigation.updateModuleOrder(!0),t.fromMoreAppsOverlay&&WidgetsOverlay.updateAddRemoveTabBtnHtml(s)}else t.fromMoreAppsOverlay?WidgetsOverlay.updateAddRemoveTabBtnHtml(t.id):$("#app_tablist #widget_pin_loader").remove()}))},getPinnedWidgetTabId:t=>{let s=e(t);return s.length?s[0].id:void 0},addTabtoLhs:({data:t,successCallBack:e,errorCallBack:s})=>{$ZCAjx.ajax({url:"/api/v2/tabs",type:"POST",data:t,contentType:"application/json",success:s=>{let i=s.data;i.action="add_tab",LhsModuleOrder.updateLhsOrder(i),"function"==typeof e&&e(t,s)},error:t=>{let e=t&&t.code&&t.message?t.message:Resource.getRealValue("common.failure.message");UI.updateBanner(e,2e3,!0),"function"==typeof s&&s()}})},removeTabFromLhs:({tab_id:t,successCallBack:e,widget_id:s,errorCallBack:i})=>{$ZCAjx.ajax({url:"/api/v2/tabs/"+t,type:"DELETE",success:()=>{LhsModuleOrder.updateLhsOrder({tab_id:t,action:"remove_tab"}),"function"==typeof e&&e(t,s)},error:t=>{let e=t&&t.code&&t.message?t.message:Resource.getRealValue("common.failure.message");UI.updateBanner(e,2e3,!0),"function"==typeof i&&i()}})},hideTabInLhs:({data:t,successCallBack:e,errorCallBack:s})=>{let i=t.tab_id,a=t.state;$ZCAjx.ajax({url:"/api/v2/tabs/"+i,type:"PUT",data:{state:a},contentType:"application/json",success:()=>{"function"==typeof e&&e(t)},error:t=>{let e=t&&t.code&&t.message?t.message:Resource.getRealValue("common.failure.message");UI.updateBanner(e,2e3,!0),"function"==typeof s&&s()}})},reorderTabInLhs:({data:t,successCallBack:e,errorCallBack:s})=>{let i={};t.set_above_id&&(i.set_above=t.set_above_id),$ZCAjx.ajax({url:"/api/v2/tabs/"+t.tab_id+"/reorder",type:"PUT",data:i,contentType:"application/json",success:()=>{"function"==typeof e&&e(t)},error:t=>{let e=t&&t.code&&t.message?t.message:Resource.getRealValue("common.failure.message");UI.updateBanner(e,2e3,!0),"function"==typeof s&&s()}})},getTabIdByModuleId:t=>{return LhsModuleOrder.getLhsOrder().filter(e=>"lhs_"+e.module_id===t)[0].id},isTabLockedByAdmin:t=>{var e=LhsModuleOrder.getLhsOrder().filter(e=>e.module_id===t);return!(!e[0]||!e[0].isSystemLocked()&&!e[0].isLocked())},isTabInLhsNavigation:t=>{return LhsModuleOrder.getLhsOrder().filter(e=>e.module_id===t||"lhs_"+e.module_id===t).length}}}();let LHSHandler=function(){let t={showPinsTab:function(t){MainUI.resetSelectedLhsTab(),LHSHandler.showChatWindowView(),LhsModules.highlightModule(t.attr("id")),LhsNavigation.updateSubModuleCategory(),LhsModules.updateCounter("pinnedchats"),LhsModules.updateUnreadNotifier()},showDMsTab:function(t){MainUI.resetSelectedLhsTab(),LHSHandler.showChatWindowView(),LhsModules.highlightModule(t.attr("id")),MyDMsLHS.populate()},showChatsTab:function(t){MainUI.resetSelectedLhsTab(),LHSHandler.showChatWindowView(),LHSHandler.openChatsModule()},showConvosTab:function(t){MainUI.resetSelectedLhsTab(),LHSHandler.showChatWindowView(),LHSHandler.openConvosModule()},showTeamsTab:function(t){MainUI.resetSelectedLhsTab(),LHSHandler.showChatWindowView(),LHSHandler.openTeamsModule(),MyTeamsLHS.retainLastRecentState()},showFilesTab:function(t){LHSHandler.showFilesTab(t)},showSentMsgHistory:function(t){MainUI.resetSelectedLhsTab(),HistoryModule.defaultActiveTab=t.attr("type"),HistoryModule.openHistoryRhs()},showTazFiles:function(t){MainUI.resetSelectedLhsTab(),MyFiles.showSelectedSourceData(t.attr("type"))},showCliqFiles:function(t){MyFiles.showSelectedSourceData(t.attr("type"))},showRecordings:function(t){MyFiles.showSelectedSourceData(t.attr("type"))},showCalendarsTab:function(t,e){LhsModules.activeTabId!==LHSConstants.ModuleIds.MYCALENDAR&&(MainUI.resetSelectedLhsTab(),LhsModules.highlightModule(t.attr("id")),LhsNavigation.updateSubModuleCategory(),CalendarLHS.showCalendar(),CalendarLHS.trackAction("OPEN_CALENDAR","LHS"))},showTasksTab:function(t){MainUI.resetSelectedLhsTab(),LhsModules.highlightModule(t.attr("id")),LhsNavigation.updateSubModuleCategory(),ZProjectsTabUI.bindPortalsDropDown()},showNotebooksTab:function(t,e){if(NoteBookUtil.isIntegrationEnabled()&&LhsModules.activeTabId!==LHSConstants.ModuleIds.MYNOTEBOOK){MainUI.resetSelectedLhsTab(),LhsModules.highlightModule(t.attr("id")),LhsNavigation.updateSubModuleCategory();var s=t.attr("selected_note");NoteBookLHS.showNotebooks(s),NoteBookLHS.trackAction("OPEN_NOTE","LHS")}},reloadNotes:function(t,e){t.parents("#lhs_mynotebook_list").empty(),NoteBookLHS.reloadNotes()},reloadCalendars:function(t,e){CalendarLHS.reloadCalendars()},showWidgetsTab:function(t,e){LhsModules.activeTabId!==t.attr("id")&&(UI.isCrmPlusUI()?(e.stopImmediatePropagation(),LhsModules.highlightModule(t.attr("id")),WidgetsOverlay.showMoreAppsOverlay(),ZCPermalink.updateUrl(routingPaths.widgets),LhsModules.updateCounter()):(MainUI.resetSelectedLhsTab(),LhsModules.highlightModule(t.attr("id")),LhsNavigation.updateSubModuleCategory(),WidgetsLHS.populateRHSView()))},showWidgetFromSection:function(t){let e=t.attr("id");LhsModules.activeTabId!==e&&(LhsModules.highlightModule(e),LhsNavigation.updateSubModuleCategory(),WidgetsLHS.populateRHSView(e))},showMyBotsTab:function(t){MainUI.resetSelectedLhsTab(),LhsModules.highlightModule(t.attr("id")),LhsNavigation.updateSubModuleCategory(),MyBotsLHS.populate()},showMyThreadsTab:function(t){MainUI.resetSelectedLhsTab(),LHSHandler.showChatWindowView(),LHSHandler.openThreadsModule()},showHistorysTab:function(t){MainUI.resetSelectedLhsTab(),LhsModules.highlightModule(t.attr("id")),LhsNavigation.updateSubModuleCategory(),HistoryModule.openHistoryRhs()},showConvoHistory:function(t){MainUI.resetSelectedLhsTab(),HistoryModule.defaultActiveTab=t.attr("type"),HistoryModule.openHistoryRhs()},showPhoneTab:function(t){MainUI.resetSelectedLhsTab(),LhsModules.highlightModule(t.attr("id")),LhsNavigation.updateSubModuleCategory(),PhoneModule.openPhoneRhs()},showDMCalls:function(t){e(t)},showMeetingHistory:function(t){e(t)},showBroadcastHistory:function(t){e(t)},showLiveEventsHistory:function(t){e(t)},showPhoneModule:function(t){MainUI.resetSelectedLhsTab(),PhoneModule.defaultActiveTab=t.attr("type"),PhoneModule.openPhoneRhs()},showTasksForProject:function(t,e){MainUI.resetSelectedLhsTab(),TasksLHS.showTasksForProjectFromElem(t,e)},showMyPeopleTab:(t,e)=>{MainUI.resetSelectedLhsTab(),LhsModules.highlightModule(t.attr("id")),LhsNavigation.updateSubModuleCategory();let s=PeopleModule.getLastViewedSubModule();PeopleModule.populate(s),PeopleModule.highlightSubmodule($("[data-view="+s+"]"))},showPeopleSubModule:t=>{MainUI.resetSelectedLhsTab();let e=t[0].getAttribute("data-view");MyOrgModule.lastSelectedOrgSubModule={isTeamsModuleSelected:!1},PeopleModule.populate(e),PeopleModule.highlightSubmodule(t)},switchDarkMode:t=>{$('[for="darkmode_switch_btn"]').addClass("loading_progress"),ProfileMenu.handleDarkModeSwitch(t),HamburgerMenu.handleDarkmode(),"undefined"!=typeof ZCVoiceIntegration&&ZCVoiceIntegration.handleUserSettings()},showMyOrgTab:t=>{MainUI.resetSelectedLhsTab(),LhsModules.highlightModule(t.attr("id")),LhsNavigation.updateSubModuleCategory(),MyOrgModule.handleInitView(),OrgFeatures.isPublicTeamsEnabled()&&PublicTeamsUIHandler.updatePendingTeamsCntLhs()},showMyTeamsTab:t=>{MainUI.resetSelectedLhsTab(),LhsModules.highlightModule(t.attr("id")),LhsNavigation.updateSubModuleCategory(),Teams_LHS.init()},showTeamsView:t=>{Teams_LHS.initialTeamId="";let e=t.attr("team_id");TeamInfo.populateUI(e)},close_sync_darkmode:(t,e)=>{ProfileMenu.closeSyncDarkmodePopup(),Clickoutside.handleClickOnChild(e)},toggle_syncdarkmode:(t,e)=>{_isDesktopApp()&&DesktopApp.toggleSyncDarkMode(t),ProfileMenu.closeSyncDarkmodePopup(),Clickoutside.handleClickOnChild(e)},openDefaultChannel:t=>{let e=t.attr("chid");MyOrgModule.defaultSection.openChannel(e),t.addClass("chatsel")},approve_PublicTeams:t=>{var e=t.attr("team_id");PublicTeamsUIHandler.showApproveEditPreviewInRhs(e)},reject_PublicTeam:t=>{var e=t.attr("team_id");PublicTeamsUIHandler.rejectPendingTeam(e,t)},showMoreAppsOverlay:(t,e)=>{e.stopImmediatePropagation(),WidgetsOverlay.showMoreAppsOverlay(),ZCPermalink.updateUrl(routingPaths.widgets),LhsModules.updateCounter()},configure_Sidebar:(t,e)=>{PersonalizeUI.createWindow(),Clickoutside.handleClickOnChild(e),PersonalizeUI.personalize_win_submenu.find("#lhslayout").click()},showUnseenWidgetInMoreAppsOverlay:(t,e)=>{e.stopImmediatePropagation();var s=t.attr("id");WidgetsOverlay.showMoreAppsOverlay(s)}},e=t=>{MainUI.resetSelectedLhsTab(),HistoryModule.defaultActiveTab=t.attr("type"),HistoryModule.openHistoryRhs()};return{handleClick:e=>{let s=$(e.currentTarget),i=s.attr("purpose"),a=s.attr("id");Clickoutside.handleClick(e),"function"==typeof t[i]&&(LhsModules.activeTabId===LHSConstants.ModuleIds.MYTEAMS?MyTeamsLHS.updateLastRecentState():LhsModules.activeTabId===LHSConstants.ModuleIds.MYORG?Teams_LHS.updateLastRecentState():LhsModules.activeTabId===LHSConstants.ModuleIds.MYCALENDAR&&a!==LHSConstants.ModuleIds.MYCALENDAR&&a!==LHSConstants.DarkModeToggle?CalendarLHS.hideCalendar():LhsModules.activeTabId===LHSConstants.ModuleIds.MYNOTEBOOK&&a!==LHSConstants.ModuleIds.MYNOTEBOOK&&a!==LHSConstants.DarkModeToggle?NoteBookLHS.hideNotebooks():LhsModules.activeTabId===LHSConstants.ModuleIds.MYPHONE&&a!==LHSConstants.ModuleIds.MYPHONE&&a!==LHSConstants.DarkModeToggle&&void 0!==PhoneModule&&PhoneModule.removeFromViewPort(),LhsModules.isTabsForceFetchRequired()&&(LhsModuleReorderImpl.tabsForceFetchRequired(),LhsModules.fetchAndUpdateLHSOrder()),Clickoutside.handleClickOnChild(e),HistoryModule.clearCallCounter(),t[i](s,e),e.stopImmediatePropagation())},handleKeyUp:t=>{$(this)},handleScroll:t=>{},showChatWindowView:()=>{LhsNavigation.removeRHSView();let t=MainUI.getVisibleChats()[0];void 0!==t?MainUI.getMefront(t,!0):MainUIManager.openPrevious()},showFilesTab:t=>{MainUI.resetSelectedLhsTab(),LhsModules.highlightModule(t?t.attr("id"):"lhs_files"),LhsNavigation.updateSubModuleCategory(),MyFiles.showSelectedSourceData()},openTeamsModule:t=>{LhsModules.highlightModule(LHSConstants.ModuleIds.MYTEAMS),t&&LeftPannel.container.find("#lhs-chats-search-field").focus(),MyTeamsLHS.populate(),LhsModules.updateCounter("channels"),LhsModules.updateUnreadNotifier()},openChatsModule:()=>{var t=LhsModules.isSegmentedView()&&LhsModules.activeTabId==LHSConstants.ModuleIds.MYCHATS,e=t?LhsDomCache.getLHSModuleParent().find("#my_chats_list").scrollTop():0;LhsModules.highlightModule(LHSConstants.ModuleIds.MYCHATS),MyChatsLHS.populate(),t&&e&&LhsDomCache.getLHSModuleParent().find("#my_chats_list").scrollTop(e),LhsModules.updateCounter("chats"),LhsModules.updateUnreadNotifier()},openConvosModule:()=>{LhsModules.highlightModule(LHSConstants.ModuleIds.MYCONVOS),MyConvosLHS.populate(),LhsModules.updateCounter(),LhsModules.updateUnreadNotifier()},openThreadsModule:()=>{LhsModules.highlightModule(LHSConstants.ModuleIds.MYTHREADS),MyThreadsLHS.populate(),LhsModules.updateCounter(),LhsModules.updateUnreadNotifier()},openChatsLHSListing:t=>{if(LhsModules.activeTabId!==LHSConstants.ModuleIds.MYCONVOS&&LhsModules.activeTabId!==LHSConstants.ModuleIds.MYTEAMS&&LhsModules.activeTabId!==LHSConstants.ModuleIds.MYCHATS&&LhsModules.activeTabId!==LHSConstants.ModuleIds.MYPINS&&LhsModules.activeTabId!==LHSConstants.ModuleIds.MYTHREADS)if(LhsModules.isConsolidatedView())LHSHandler.openConvosModule();else{var e=!1;t&&(e=new $CliqChatId(t).isChannel()),e?LHSHandler.openTeamsModule():LHSHandler.openChatsModule()}}}}(),TemplateUtil=function(){let t={loader_ui:'<div id="applet-center-loader" class="h100 w100 flexM fdirC">\n\t\t\t\t\t<div class="zcl-rloader posrel"></div>\n\t\t\t\t\t<div class="mT30 clr-S">{{loading_txt}}</div>\n\t\t\t\t</div>',inline_loader:'<div id="loadmore" class="hstrset">\n\t\t\t\t\t<div class="hst-lodngmn">\n                \t\t<div class="hst-lodngsb">{{loading_txt}}<span class="hst-loadng"></span></div>\n                \t</div>\n                </div>',api_failure_ui:`<div class="h100 w100 flexM fdirC flexG">\n\t\t\t\t\t<div style="height: 35px; width: 37px;"><img src="${$zcg._IMGDEFAULTSTATICURL}/cliqconsole/api_error_state.svg"></div>\n\t\t\t\t\t<div class="mT15 font18">{{error_txt}}</div>\n\t\t\t\t</div>`,category_noresults:'<div class="flexG wh100 flexM fdirC">\n\t\t\t\t\t<div class="font50 clr-icon">{{img_url}}</div>\n\t\t\t\t\t<div class="{{font_size_cls}} clr-lp1 line22 textC mT28">{{nodata_txt}}</div>\n\t\t\t\t\t<div class="clr-lp1 line22 textC {{desc_cls}} mT10">{{message_desc}}</div>\n\t\t\t\t\t<div class="mT20 {{btn_cls}}">{{btn_txt}}</div>\n\t\t\t\t</div>',lhs_list_loader:'<div class="flex fdirC p20">\n\t\t\t\t\t{{loader_html}}\n\t\t\t\t</div>',main_container_area:'<div id="main_container_dom" class="wh100 flex fdirC" tab-id="{{tab_id}}">\n\t\t\t\t</div>',lhs_long_btn:'<div class="ellips zcl-btn-xs zcl-btn--primary" purpose={{purpose}} data-action="{{action}}" style="line-height: 1;">{{content}}</div>',searchBtn:`<div class="ellips zcl-btn-xs zcl-btn--primary sentmsghistory-searchbtn search p20" purpose="newsearch">${Resource.getRealValue("globalsearch.trynew")}</div>`},e=()=>{let t=["loading.quote0","loading.quote1","loading.quote2","loading.quote3","loading.quote4","loading.quote5"],e=Math.floor(Math.random()*t.length);return I18N(t[e])};return{getLoaderHtml:(s,i)=>$WC.template.replace(t.loader_ui,{loading_txt:s||e(),txt_cls:i?"hide":""},"InSecureHTML"),getListMoreLoader:(e=Resource.getRealValue("common.loading"))=>$WC.template.replace(t.inline_loader,{loading_txt:e}),getApiFailureHtml:e=>$WC.template.replace(t.api_failure_ui,{error_txt:e||I18N("videoplayer.error")},"InSecureHTML"),noCategoryResult:(e,s="",i,a="font17",n)=>$WC.template.replace(t.category_noresults,{img_url:s,$nodata_txt:e||"common.noresult",font_size_cls:a,btn_cls:""==i?"dN":"",btn_txt:i||"",$message_desc:$WC.Util.isEmpty(n)?"":n,desc_cls:$WC.Util.isEmpty(n)?"dN":""},"InSecureHTML"),getMainContainer:()=>t.main_container_area,getLhsLongBtn:()=>t.lhs_long_btn,getRandomQuotes:e,getSubListLoader:e=>{e=e||8;return $WC.template.replace(t.lhs_list_loader,{loader_html:'<div class="lhs-list-load-itm-sm skelton-loader"></div>'.repeat(e)},"InSecureHTML")},getSearchBtn:()=>t.searchBtn}}(),CliqTemplates=function(){let t={imgViewerLayout:'<div id="imgviewer" style="display:none" class="litebxhdr" zoomout="false"></div>',imgViewerBaseLayout:`<div id=imgviewerOuterWrapper class="flexC wh100">\n\t\t\t\t<div id="imgviewerArea" class="flexM posrel wh100 imgviewer-main-bg clrW">\n\t\t\t\t\t<div id="imgviewer-blur-bg" class="imgviewer-blur-bg"></div>\n\t\t\t\t\t<div id="imgloading" class="zcl-rloader alignM zindex3"></div>\n\t\t\t\t\t<div id="imgviewerheader" class="imgviewer-hdr" clickoutside>\n\t\t\t\t\t\t<div class="floatl flex imgvwlft">\n\t\t\t\t\t\t\t<div class="floatl fshrink cht-imgbdr usrimgsts">\n\t\t\t\t\t\t\t\t<img id="imgviewer-fsender" class="objFitCover" src="" height="44" width="46">\n\t\t\t\t\t\t\t\t<span id="usrstatusbg" class="usrstatusbg"><span id="user-current-status"></span></span>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<div class="litebxltr">\n\t\t\t\t\t\t\t\t<div class="imginftit ellips">\n\t\t\t\t\t\t\t\t\t<div id="imgviewer-fsendername"></div>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t<div id="imgviewer-fcomment" class="ellips imgvwdt mrgT15"></div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<span id="closeimgviewer" class="msi-close bdrR5 imgviewer-close"></span>\n\t\t\t\t\t<div id="imgviewer-mainarea" class="litebximgvvr imgviewer-mainarea" clickoutside>\n\t\t\t\t\t\t<span id="right-navigation-wrapper" class="navigation-wrapper flexC rightarr"><span id="nav-right-ripple" class="nav-ripple flexM"></span><span id="imgnext" class="imgviewer-nav-button-bg rightarr flexM font14 zcf-rightArrow"></span></span>\n\t\t\t\t\t\t<span id="left-navigation-wrapper" class="navigation-wrapper flexC leftarr"><span id="nav-left-ripple" class="nav-ripple flexM"></span><span id="imgprev" class="imgviewer-nav-button-bg flexM font14 zcf-leftArrow"></span></span>\n\t\t\t\t\t\t<div id="imgholder" class="imgholder" tabindex="-1">\n\t\t\t\t\t\t\t<div id="imgpreviewlist" class="imgpreviewlist" clickoutside></div>\n\t\t\t\t\t\t\t<div id="imageViewerErrorTemplate" class="download-error flexM fdirC wh100 dN">\n\t\t\t\t\t\t\t\t<span class="download-error-image"></span>\n\t\t\t\t\t\t\t\t<div id="downloadErrorText" class="font20 textC clrW mT10">${Resource.getRealValue("common.filepreview.downloadfailed")}</div>\n\t\t\t\t\t\t\t\t<div id="retryImageLoad" class="buttn_pos trans-retry" purpose="retryImageDownload">${Resource.getRealValue("message.option.retry")}</div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div id="imgviewerdetails" class="litebxhdrsb flexM imgviewer-ftr">\n\t\t\t\t\t\t<div id="zoom-controls-wrapper" class="zoom-controls-wrapper">\n\t\t\t\t\t\t\t<span id="zoomvalue-tooltip" class="zoomvalue-tooltip flexM dN"></span>\n\t\t\t\t\t\t\t<div id="zoomoption" class="flexM curP">\n\t\t\t\t\t\t\t\t<div id="zoom-range-wrapper" class="zoom-range-wrapper flexM">\n\t\t\t\t\t\t\t\t\t<em class="zcf-minusB mR8" zoom="true" purpose="zoom-out" title="${Resource.getRealValue("common.zoomout")}"></em>\n\t\t\t\t\t\t\t\t\t<input id="zoom-slider" class="mR8 curP img-zoom-slider" type="range" min="0" max="1" step="0.01" value="0">\n\t\t\t\t\t\t\t\t\t<em class="zcf-plusB mR8" zoom="true" purpose="zoom-in" title="${Resource.getRealValue("common.zoomin")}"></em>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t<span id="zoom-reset" class="dN">\n\t\t\t\t\t\t\t\t\t<em class="zcl-btn-separator cht-btn-separator mR8"></em>\n\t\t\t\t\t\t\t\t\t<span purpose="originalimg" title="${Resource.getRealValue("common.resetzoom")}">${Resource.getRealValue("common.reset")}</span>\n\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div id="imgdetails" class="posabs">\n\t\t\t\t\t\t\t<div id="imgviewer-fname" class="zcimgtit clrW flexM"></div>\n\t\t\t\t\t\t\t<div id="imgviewer-fdetails" class="zcimgsbtit clrW flexM"></div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div id="imgviewerFooterButtons" class="imgvwrht mLA z-index2">\n\t\t\t\t\t\t\t{{imgviewer_chat_option}}\n\t\t\t\t\t\t\t<div id="imgviewer-openoriginal" documentclick="attdownload" class="imgviewer-icon zcf-popout tooltip-up flexM" tooltip-title="${Resource.getRealValue("common.open.original")}"></div>\n\t\t\t\t\t\t\t<div id="imgviewer-fforward" documentclick="attforward" class="imgviewer-icon zcf-forward tooltip-up flexM" tooltip-title="${Resource.getRealValue("common.forward")}"></div>\n\t\t\t\t\t\t\t<div id="imgviewer-fdownload" documentclick="attdownload" class="imgviewer-icon zcf-download tooltip-up flexM" tooltip-title="${Resource.getRealValue("common.download")}"></div>\n\t\t\t\t\t\t\t<div id="imgviewer-annotate" documentclick="annotateimage" class="imgviewer-icon zcf-edit2 tooltip-up flexM" tooltip-title="{{EDIT_TOOLTIP}}"></div>\n\t\t\t\t\t\t\t<div id="imgviewer-rotate" purpose="rotateimage" class="imgviewer-icon zcf-rotate-image tooltip-up font24 flexM" tooltip-title="{{ROTATE_TOOLTIP}}"></div>\n\t\t\t\t\t\t\t<div id="imgviewer-snippetcopy" documentclick="copy_snippet" purpose="frompreview" class="imgviewer-icon zcf-copy tooltip-up flexM" tooltip-title="${Resource.getRealValue("code.snippet.copy")}"></div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div id="profileinfo" class="zcflinfo flexC">\n\t\t\t\t\t\t<div id="userinfo" class="zcflcnt flexG"></div>\n\t\t\t\t\t\t<div id="imgvieweruseroption" class="fshrink">\n\t\t\t\t\t\t\t<span id="imgdownload" class="imgviewer-icon posrel zcf-download tooltip-up" documentclick="userimgdownload" tooltip-title="${Resource.getRealValue("common.download")}"></span>\n\t\t\t\t\t\t\t<span id="startchat" class="imgviewer-icon posrel zcf-chat tooltip-up tooltip-right0" documentclick="startchat" tooltip-title="${Resource.getRealValue("common.startchat")}"></span>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div id="imgviewerRhsChatContainer" class="posrel zcsmallchat fshrink imgviewer-rhs-chat-container dN"></div>\n\t\t\t</div>`,imgViewerChatOption:"<div id='imgviewer-chatoption' class='imgviewer-icon zcf-chat tooltip-up flexM imgviewer-chatoption' tooltip-title='"+Resource.getRealValue("mediacall.chat.open")+"'></div>",topBarHtml:'<div id="topbar" class="app-top-header"><div class="ztb-topband top-hdr-band '+($WC.Util.isEmpty($zcg._CUSTOMDOMAINURL)&&!SecurityManager.hasPermission(Modules.Zoho_apps)?"zc-hide-hambrgr":"")+'" id="ztb-topband">'+Topbar.getHtml()+"</div></div>",cliqLayout:`<div id="maskbg" class="zcmask"></div>\n\t\t\t\t<div id="zcwindows" class="zcoverlay"></div>\n\t\t\t\t<div id="imgmaskbg" class="imgmaskbg"></div>\n\t\t\t\t {{img_viewer_dom}}\n\t\t\t\t<div id="videobroadcast" class="dN posa zclsmbdcnt"></div>\n\t\t\t \t<div id="videochat" class="posa zcvidmain zcvcdrgcnt" component="floatingcontainer" style="display: none;" ></div>\n\t\t\t\t<div id="vcincommingcall" class="zcvidincm" style="display: none;" ></div>\n\t\t\t\t<div id="hover" class="contactshover"></div>\n\t\t\t\t\n\t\t\t\t<div style="display:none;" id="ajaxstatus" class="ajaxstatus"></div>\n\t\t\t\t<div style="display:none;" id="ajaxstatus-v2" class="banner-v2 flexM success"></div>\n\t\t\t\t<div style="display:none;" id="servicebanner" class="zcupdanc">\n\t\t\t\t\t<span class="msi-announce"></span>\n\t\t\t\t\t<span id="servicebannermsg" class="zcancetxt p10"></span>\n\t\t\t\t\t<span id="hideservicebanner" class="msi-upaw"></span>\n\t\t\t\t</div>\n\t\t\t\t<div id="loadingline" class="zcloadlin posa"></div>\n\t\t\t\t<div style="display:none;" id="networkstatus" class="ajaxstatus networkstatus ellips">\n\t\t\t\t\t<span id="statusmsg" class="statusmsg ellips">${Resource.getRealValue("common.network.error")}</span>\n\t\t\t\t\t<span id="trynow" class="trynow zchidcnt cp bold grclr">${I18N("common.network.trynow")}</span>\n\t\t\t\t</div>\n\t\t\t\t\t\n\t\t\t\t<div id="officechat" class="outer-shell {{TopbarTweakClass}}">\n\t\t\t\t\t{{topbar_html}}\n\t\t\t\t\t<div id="outercontainer" class="zccontent flexG app-main-container">\n\t\t\t\t   \t\t<article>\n\t\t\t\t\t\t   \t<section id="leftpannel" class="zcleftsidebar">\n\t\t\t\t\t\t\t   \t{{network_switcher_html}}\n\t\t\t\t\t\t   \t\t{{lhs_modules_with_wrapper}}\n\t\t\t\t\t\t\t</section>\n\t\t\t\t\t\t\t<section id="midcontainer" class="chatsection">\n\t\t\t\t\t\t\t\t<div id="chatsection" class="zcchatwindow zconechat" style="width: 100%;">\n\t\t\t\t\t\t\t\t\t<div id="main_container_dom" class="wh100" tab-id="{{tab_id}}" style="display: none;"></div>\n\t\t\t\t\t\t\t\t\t<div id="home" class="zcdashbrdui">\n\t\t\t\t\t\t\t\t\t\t<div class="zcdashbdmain"><div id="zcdashbdmain" class="posrel">\n\t\t\t\t\t\t\t\t\t\t\t<div class="zcdashnotify" id="zcdashnotify">\n\t\t\t\t\t\t\t\t\t\t\t\t<div id="zcbotsnotify" style="display:none;" data-notify><div class="zchdl zcbthdr posl mrgB10">${I18N("home.bots.heading")}</div></div>\n\t\t\t\t\t\t\t\t\t\t\t\t<div id="zccommandsnotify" style="display:none;" data-notify><div class="zchdl zcbthdr posl mrgB10">${I18N("home.commands.heading")}</div></div>\n\t\t\t\t\t\t\t\t\t\t\t\t<div id="zcmessageactionsnotify" style="display:none;" data-notify><div class="zchdl zcbthdr posl mrgB10">${I18N("home.messageaction.heading")}</div></div>\n\t\t\t\t\t\t\t\t\t\t\t\t<div id="zcappletsnotify" style="display:none;" data-notify><div class="zchdl zcbthdr posl mrgB10">${I18N("home.applets.heading")}</div></div>\n\t\t\t\t\t\t\t\t\t\t\t\t<div id="zcoffmsgnotify" style="display:none;" data-notify><div class="zchdl posl mrgB10">${I18N("home.offline.heading")}</div></div>\n\t\t\t\t\t\t\t\t\t\t\t\t<div id="zcmentionnotify" style="display:none;" data-notify><div class="zchdl posl mrgB10">${I18N("home.mention.heading")}</div></div>\n\t\t\t\t\t\t\t\t\t\t\t\t<div id="zceventsnotify" style="display:none;" data-notify><div class="zchdl posl mrgB10">${I18N("home.events.heading")}</div></div>\n\t\t\t\t\t\t\t\t\t\t\t</div></div>\n\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t<div id="chatwindows" class="chtwndws" style="display:none">\n\t\t\t\t\t\t\t\t\t\t<div id="nested-chat-windows" class="nested-chat-windows"></div>\n\t\t\t\t\t\t\t\t\t\t<div id="chatwindowsviewport" class="chtwndws" style="display:flex"></div>\n\t\t\t\t\t\t\t\t\t\t<div id="chatwindowshideport" style="display:none"></div>\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t<div id="profileview" profileid="" profile="" class="wdhinht" style="display:none"></div>\n\t\t\t\t\t\t\t\t\t<div id="transcriptview" opener="" class="prftranscpt" style="display:none">\n\t\t\t\t\t\t\t\t\t\t<div id="transcriptviewheader" class="transtit"> '+\n\t\t\t\t\t\t\t\t\t\t\t<span holder="transcriptviewtitle" class="prftitle floatl ellips"></span>\n\t\t\t\t\t\t\t\t\t\t\t<div id="transcritpviewoperation"></div>\n\t\t\t\t\t\t\t\t\t\t\t<span operation="transcriptviewclose" class="msi-close cclose" ></span>\n\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t<div id="transcriptviewholder" purpose="transcriptholder" class="currchatpanel "></div>\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t<div id="apptabs-container" class="wh100 flex-col zapptab" style="display:none">\n\t\t\t\t\t\t\t\t\t\t<div id="apptabs-main" class="wh100 flx1"></div>\n\t\t\t\t\t\t\t\t\t\t<div id="apptabs-iframe-con" class="wh100 dN"></div>\n\t\t\t\t\t\t\t\t\t\t<div id="apptabs-map-con" class="wh100 zwc-web-view dN"></div>\n\t\t\t\t\t\t\t\t\t\t<div id="apptabs-cwin" class="zappchatwin dN"></div>\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t<div id="projectstab-main" class="wh100 flexC zptab" activetab="tasks" style="display:none; padding: 3px;">\n\t\t\t\t\t\t\t\t\t\t<div class="wh100 flex fdirC ovrflwH">\n\t\t\t\t\t\t\t\t\t\t\t<div class="zcl-btn--primary chat-btn dN" projects-btn purpose="openMappedChannel"><div class="zcf-chat"></div></div>\n\t\t\t\t\t\t\t\t\t\t\t<div id="projectstab-headerband" class="main-container-header ovrflwH fshrink" style="display: none;">\n\t\t\t\t\t\t\t\t\t\t\t   <div class="w100 flexC justifySB">\n\t\t\t\t\t\t\t\t\t\t\t      <div class="flexG flexC w100">\n\t\t\t\t\t\t\t\t\t\t\t         <div class="flexC fshrink ellips flx1" style="line-height: 1;">\n\t\t\t\t\t\t\t\t\t\t\t         \t<div class="zcf-zohoprojects module-icn clr-icon"></div>\n\t\t\t\t\t\t\t\t\t\t\t            <div id="project_title" class="font16 clr-H fontB" style="margin-bottom: 2px;" title="${Resource.getRealValue("projects.title")}">${Resource.getRealValue("projects.title")}</div>\n\t\t\t\t\t\t\t\t\t\t\t         </div>\n\t\t\t\t\t\t\t\t\t\t\t         <div class="flexG flexM flx1">\n\t\t\t\t\t\t\t\t\t\t\t            <div id="module_header" class="flexM zcl-tab">\n\t\t\t\t\t\t\t\t\t\t\t               <div data-type="tasks" projects-btn purpose="switchProjectModule" class="zcl-tab-item font14 fontB curP">${Resource.getRealValue("projects.tasks")}</div>\n\t\t\t\t\t\t\t\t\t\t\t               <div data-type="issues" projects-btn purpose="switchProjectModule" class=" zcl-tab-item  font14 fontB curP">${Resource.getRealValue("projects.issues")}</div>\n\t\t\t\t\t\t\t\t\t\t\t               <div data-type="notification" projects-btn purpose="switchProjectModule" class="zcl-tab-item  font14 fontB curP">${Resource.getRealValue("setting.notifications")}</div>\n\t\t\t\t\t\t\t\t\t\t\t            </div>\n\t\t\t\t\t\t\t\t\t\t\t         </div>\n\t\t\t\t\t\t\t\t\t\t\t         <div class="fshrink flx1 textR"></div>\n\t\t\t\t\t\t\t\t\t\t\t      </div>\n\t\t\t\t\t\t\t\t\t\t\t   </div>\n\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t\t<div id="projectstab-iframe" class="wh100 zptab-iframe"></div>\n\t\t\t\t\t\t\t\t\t\t\t<div id="projectstab-notification" class="wh100 zptab-notification"></div>\n\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t<div id="projects-cwin" class="zpchatwin dN"></div>\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t<div id="voicetab-main" class="zc-lhs-phonetab wh100 flex-col" style="display:none"></div>\n\t\t\t\t\t\t\t\t\t<div id="calendarstab-main" class="lhs-mycalendar-tab" style="display:none"></div>\n\t\t\t\t\t\t\t\t\t<div id="notebooktab-main" class="wh100" style="display:none"></div>\n\t\t\t\t\t\t\t</section>\n\t\t\t\t\t\t\t<section id="feedcontainer" style="display:none">\n\t\t\t\t\t\t\t\t<div class="zcfdwrap">\n\t\t\t\t\t\t\t\t\t<div class="zcfdhead">\n\t\t\t\t\t\t\t\t\t\t<div class="zcfdhdtit floatl">${I18N("feed.feed")}</div>\n\t\t\t\t\t\t\t\t\t\t<div class="floatr">\n\t\t\t\t\t\t\t\t\t\t\t<span id="feedclearbtn" purpose="clear" class="zcfdlnk floatr" style="display:none">${I18N("common.clear")}</span>\n\t\t\t\t\t\t\t\t\t\t\t<div class="tooltip"></div>\n\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t<div id="feedlist" class="zcfdcontent clboth">\n\t\t\t\t\t\t\t\t\t\t<div id="feedempty" class="nomail-info">${I18N("feed.fetching")}</div>\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</section>\n\t\t\t\t\t    </article>\n\t\t\t\t\t    <div id="eventreminder" class="dN zcrmnoticnt"></div>\n\t\t\t\t\t\t<div id="rhssection" class="zc-profilemenu  zc-rhssection"></div>\n\t\t\t\t\t\t<div id="thread-search-popup-container" class="dN zcl-popup thread-popup posabs textL"></div>\n\t\t\t\t\t\t<div id="menu-popup-container" class="dN posabs font11 menu-container-wrapper"></div>\n\t\t\t\t\t\t<div id="schedule-msg-popup-container" class="dN zcl-popup zcsched-msg-popup"></div>\n\t\t\t\t\t\t<div id="nested-chat-window-container" class="nested-chat-windows"></div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div id="whiteboardRhsChatContainer" class="posabs fshrink whiteboard-chat-container imgviewer-rhs-chat-container dN"></div>`,NewSearchHTML:'<div class="zctop-cht"><div id="GSContainer" class="smsrchwin zcmultsrch"><div  class="spotlight"><div id="GSinputcontainer" class="zcgsincnt"><div id="filter-container" class="zcgs-category"></div><div class="zcgs-input-con">'+(Config.isOneSearchEnabled()?'<div id="zcsearchacross" class="zc-saz dN ellips" purpose="searchacross">'+I18N("onesearch.header")+'<span class="msi-searchacross font12"></span></div>':"")+'<div id="GS-mockdiv" class="zcssauto"></div><input id="GS-search-field"  class="ellips zcsstinfo" autocomplete="off" placeholder=""></input></div></div><div id="GS-results" class="hdrglobsrc" data_content=""></div></div></div><div id="createchatcontainer" quickaction purpose="showQuickActions" class="zcf-plusB flexM font13 zctop-crtcht" title = "'+I18N("globalsearch.create.chats")+'"></div></div>'},e=()=>{if(_isOrgSwitcherApplicable()&&(!_isDesktopApp()||_isNetworkAvailableDesktopApp())){if(UI.isWorkPlaceBundle())return`\n\t\t\t\t\t<div class="flexM zoho-one-netwrk-band">\n\t\t\t\t\t\t<div class="fshrink wp-netwrk-btn curP">\n\t\t\t\t\t\t\t<div id="network-switcher-dom" class="flexM fshrink wh100 active zcf-pointer fontB pL20 pR30" documentclick="showNetWorkSwitchMenu">\n\t\t\t\t\t\t\t\t<div class="ellips">${$WC.$CUtil.processXSS($zcg._APPACCOUNTNAME)}</div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>`;if(UI.isZohoOneUnifiedUI())return`\n\t\t\t\t\t<div class="flexC zoho-one-netwrk-band">\n\t\t\t\t\t\t<div class="fshrink" style="width: var(--lhs-modules-wid);">\n\t\t\t\t\t\t\t<div id="network-switcher-dom" class="network-switcher-icn flexM fshrink curP" documentclick="showNetWorkSwitchMenu">\n\t\t\t\t\t\t\t\t<div class="posl">\n\t\t\t\t\t\t\t\t\t<span class="zcf-allchats"></span>\n\t\t\t\t\t\t\t\t\t<div id="network_unread_counter" class="msgnotify"></div>\n\t\t\t\t\t\t\t\t\t<div id="new_network_cntr" class="new-ntwrk-highlight"></div>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class="flexG pR20 zoho-one-netwrk-band-txt ellips">${$WC.$CUtil.processXSS($zcg._APPACCOUNTNAME)}</div>\n\t\t\t\t\t</div>`}return""};return{get:e=>t[e],getBodyLayout:()=>{let s="mac"===$Util.getOS()?"Cmd":"Ctrl";$WC.template.replace(t.imgViewerLayout,{imgviewer_chat_option:Config.isImgviewerChatEnabled()?t.imgViewerChatOption:"",EDIT_TOOLTIP:Resource.getRealValue("common.edit")+" ["+s+" + E]",ROTATE_TOOLTIP:Resource.getRealValue("common.rotate")+" [R]"},"InSecureHTML");var i=UI.isWorkPlaceBundle()||UI.isCrmPlusUI()?"topbarTweak integUI":"topbarTweak";return $WC.template.replace(t.cliqLayout,{img_viewer_dom:t.imgViewerLayout,topbar_html:t.topBarHtml,network_switcher_html:e(),lhs_modules_with_wrapper:LhsNavigation.getLHSHtml(),TopbarTweakClass:Config.isTopbarTweakEnabled()?i:""},"InSecureHTML")},getNetworkSwitcherHtml:e}}();var Teams_LHS=function(){let t,e,s={lastSearchVal:void 0};let i={lhs_main_html:`<div id="myorglhs" class="flexG ovrflwH flex-col">\n\t\t\t\t<div id="{{category_name}}header" class="LHS-title lhs-sub-hdr curD "  elemtype="header">\n\t\t\t\t\t<div class="LHS-name flexC">\n\t\t\t\t\t\t<span class="ellips font17 fontb">{{header_name}}</span>\t\n\t\t\t\t\t\t<div class="fshrink {{hide_appacount}}">\n\t\t\t\t\t\t\t<span class="dot-sprtr mLR10"></span>\n\t\t\t\t\t\t\t<span  class="LHS-join cur" documentclick="explorePublicTeams"><span class="LHS-join-txt line22">${I18N("common.explore")}</span></span>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t\n\t\t\t\t\t<div id="createTeamLhs" class="fshrink {{hide_createOpt}}" onclick="PublicTeamsUIHandler.showCreateTeamWindowInUI()">\n\t\t\t\t\t\t<span class="LHS-btn zcf-plusB font10" title = "${I18N("team.create.tooltip")}"></span>\n\t\t\t\t\t</div>\n\n\t\t\t\t\t<div class = " teamsearch curP {{hide_search}}">\n\t\t\t\t\t\t<span id = "teamsearchicon"  class ="zcf-search2 text-nosel LHS-btn tooltip-right0 font11 curP " title= "${I18N("teams.search")}"></span>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div id = "teamsLhsSublist" class= "flex-col ovr_hiden posrel">{{teams_sublistHtml}}</div>\n\t\t\t</div>`,teamLhsSublistHtml:`<div>{{search_html}}</div>\n\t\t\t<div class= "flex-col ovr_hiden posrel">\n\t\t\t\t<div id="teamslist" class = "flexG ovrflwA" pgno="1">{{_subModulesItemsHtml}}</div>\n\t\t\t\t<div class="flexM pT20 pB10  {{hide_appacount}}">\n\t\t\t\t\t<div class=" zcl-btn-sm zcl-btn--primary exploreAllteams " documentclick="explorePublicTeams" ><span class="zcf-teamsicon font18"></span><span class ="pL5">${I18N("team.explore")}</span></div>\n\t\t\t\t</div>\n\t\t\t</div>`,teamsListItemHtml:`<div id="team{{TEAMID}}" catagory="teams" team_id="{{ID}}" data-action ="showTeamsView" purpose="showTeamsView" class="LHS-item" profile="teams" >\n\t\t\t\t<div id="tabscode{{TEAMID}}" class="zcf-teamsicon font14 LHS-info-icon mR10"></div>\n\t\t\t\t<div id="teamdetail" class="LHS-name flexC" elemname>\n\t\t\t\t\t<span id="teamName" class="ellips">{{NAME}}</span>\n\t\t\t\t\t<span id="team_lckIcon_{{TEAMID}}" class="usrdtl-icns fshrink {{hide_lock_icon}}"><em title="${I18N("common.private.team")}" class="zcf-lock chnl-info-icon"></em></span>\n\t\t\t\t</div>\n\t\t\t\t{{sub_contentHtml}}\n\t\t\t\t<div id ="pendingUsersCnt_{{TEAMID}}" class="LHS-count">{{pendingUsersCnt}}</div>\n\t\t\t</div>`,teamListItemInnerContentHtml:`<div id="tabscode{{TEAMID}}" class="zcf-teamsicon font14 LHS-info-icon mR10"></div>\n\t\t\t<div id="teamdetail" class="LHS-name flexC" elemname>\n\t\t\t\t<span id="teamName" class="ellips">{{NAME}}</span>\n\t\t\t\t<span id="team_lckIcon_{{TEAMID}}" class="usrdtl-icns fshrink {{hide_lock_icon}}"><em title="${I18N("common.private.team")}" class="zcf-lock chnl-info-icon"></em></span>\n\t\t\t</div>\n\t\t\t{{sub_contentHtml}}\n\t\t\t<div id ="pendingUsersCnt_{{TEAMID}}" class="LHS-count"></div>`,searchDomHtml:`<div id="lhsutilityopts" class="lhs-search-cont {{hide_searchBar}}">\n\t\t\t\t<div id="lhsteamssearch" class="flexC">\n\t\t\t\t\t<div class="lhs-chats-search flexC">\n\t\t\t\t\t\t<div class="zcf-search2 mR5"></div>\n\t\t\t\t\t\t<div class="zcl-search-input lhssrchfield flexC">\n\t\t\t\t\t\t\t<input id="teams-suggest-searchfield" class="font14 curP w100 ovrflwH mR5" type="text" data-val ="" placeholder="${I18N("teams.search")}">\n\t\t\t\t\t\t\t<span id="lhssearchclear" class="msi-chtclose" ></span>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>`,noTeamResultsHtml:'<div id="lhssearchemptystate" class="lhssearchnores nite-mode mT60">\n\t\t\t\t<div class="{{imageclass}}"></div>\n\t\t\t\t<div class="mT5 font13 textC lhsemptysearch">{{title}}</div>\n\t\t\t</div>',approve_reject_btnHtml:'<span class="zcf-closeB font8 LHS-box-24" data-action ="reject_PublicTeam" purpose="reject_PublicTeam" team_id="{{team_id}}" data-action = "reject_Team"></span>\n\t\t\t<span class="zcf-tick fontB font11 LHS-box-24" data-action ="approve_PublicTeams" purpose="approve_PublicTeams" team_id="{{team_id}}" ></span>',waitingForApprovalHtml:'<div class = " mL5 font12 zcf-frequse  clr-lp1">{{waiting_txt}}</div>'};var a=function(t,e,s){var i=t.val();$WC.Util.isEmpty(i)?n("*",e,s):n(i,e,s)},n=function(t,e,s){var i=$("#teams-suggest-searchfield"),a={searchin:SearchAgent.TEAMS,val:t,listid:s?"teamslist":"teamsLhsSublist",user_id:$zcg._ZUID,scrlcontainer:i,populateSuccessCallback:e,isFromSearch:s},n=a,l=Teams.getTeamsParams($zcg._ZUID);l.reset(),l.setSearchValue(n.val),SearchAgent.search(a)?ZCScroll.scrollTop(i,0):i.html(d(n.val))},l=t=>{t[0].value="",t.focus(),o(),r("")},o=(e,s)=>{var i=s||$("#teams-suggest-searchfield"),n=e?e.currentTarget:i[0],l=$.trim(n.value);e&&e.keyCode==$zcg.ESCAPE_KEYCODE&&(e.stopPropagation(),l="",n.value=""),t=l,r(l);var o=n.getAttribute("data-val");n.setAttribute("data-val",l),l!=o&&a(i,void 0,!0)},r=t=>{var e=$("#lhssearchclear");t.length&&!e.is(":visible")?e.removeClass("dN"):t.length||e.addClass("dN")},d=function(t){var e=!$WC.Util.isEmpty(t)&&"*"!=t;return $WC.template.replace(i.noTeamResultsHtml,{imageclass:e?"search_empty mL30":"zcempty-img network_teams_empty",$title:e?"common.search.empty":"team.joined.empty"})},c=t=>h(t),p=(t,e)=>{var s=t.getTeamName(),i=t.team_id,a=e.searchValue.toLowerCase(),n=!1;"*"!==a&&(s=m(s,a),n=!0);let l=$WC.template.replace(e.listhtml,{TEAMID:i,ID:i,hide_lock_icon:OrgFeatures.isPublicTeamsEnabled()&&!t.isOpenToAll()?"":"hide",sub_contentHtml:e.isPendingTeams||t.isStatusPending()?_isAdmin()?f(i):C():"",pendingUsersCnt:!$WC.Util.isEmpty(t.getRequestedUsersCnt())&&t.getRequestedUsersCnt()>0?t.getRequestedUsersCnt():""},"InSecureHTML");return n?$WC.template.replace(l,{NAME:s},"InSecureHTML"):$WC.template.replace(l,{NAME:s})},h=t=>{var e="",s=Teams.getListFromStorage(),i=Teams.getAllPendingTeamsFromStorage();if(i.length>0){var a={listhtml:t.listhtml,searchValue:t.searchValue,isPendingTeams:!0};e=g(i,a)}if(s.length>0){let i="",a="",o=[],r=[],d=[],c=[],h=!t.showAll&&s.length>10?10:s.length;for(var n=0;n<s.length;n++){(l=Teams.getTeamsObj(s[n])).isStatusPending()?c.push(s[n]):l.has_channel?l.isModerator?o.push(s[n]):r.push(s[n]):d.push(s[n])}let m=c.concat(o);m=(m=m.concat(r)).concat(d);for(n=0;n<h;n++){var l=Teams.getTeamsObj(m[n]);i+=p(l,t)}if(s.length>10){let e=I18N("common.showall"),s="teamShowMore";t.showAll&&(e=I18N("app.show.less"),s="teamsShowLess"),a+=`<div id="teamslistmore" class="LHS-showmore"  documentclick="${s}">\n\t\t\t\t\t\t\t\t\t<span class="showmore">${e}</span>\n\t\t\t\t\t\t\t\t</div>`}return`<div id="teamssublist" class="LHS-list-main mT10" >${e}${i}${a}</div>`}return i.length>0?`<div id="teamssublist" class="LHS-list-main mT10" >${e}</div>`:""},m=function(t,e){if(void 0===e||0===e.length)return $WC.$CUtil.processXSS(t);var s=t.toLowerCase().indexOf(e),i=new RegExp($WC.Matcher.replace("escaperegexp",e),"i"),a=$WC.$CUtil.processXSS(t);return-1!==s&&(a=t.replace(i,"<b>$&</b>")),a};let u=(t,e)=>{$WC.Util.isEmpty(t)||$WC.Util.isEmpty(e)||ZCPermalink.updateUrl(routingPaths.teams+"/"+t+"/"+e)},v=()=>{if($WC.Util.isEmpty(Teams_LHS.initialTeamId)){if(e){let t=$("#teamslist").find('[catagory="teams"][purpose="showTeamsView"]');if(t.length){let e=t[0].getAttribute("team_id");TeamInfo.populateUI(e)}}}else TeamInfo.populateUI(Teams_LHS.initialTeamId);e=!1};var g=function(t,e){var s="";if(t.length>0){let l="";var i=PendingForApprovalTeamsHandler.getPendingTeamsParam($zcg._ZUID);let o=t.length>5?5:t.length;for(var a=0;a<o;a++){var n=i.getPendingTeamObj(t[a]);e.pendingTeamsExist=!0,s+=p(n,e)}if(t.length>5){l+=`<div id="teamslistmore" class="font14 flexC mTB5 pR10 pending_teams_viewAll curP"  onclick="PublicTeamsUIHandler.pendingTeamsRhsCreateUi()">\n\t\t\t\t\t\t\t\t\t<span class="LHS-name ">${I18N("team.viewAllRequests")}</span>\n\t\t\t\t\t\t\t\t\t<span class ="zcf-rightArrow LHS-info-icon  "></span> \n\t\t\t\t\t\t\t\t</div>`}return`${s}${l}`}return teams_list_html},f=function(t){return $WC.template.replace(i.approve_reject_btnHtml,{team_id:t})},C=function(t){return $WC.template.replace(i.waitingForApprovalHtml,{team_id:t,$waiting_txt:"videochat.message.waiting"})};return{initialTeamId:void 0,init:(t,s)=>{e=s,Teams_LHS.initialTeamId=t||"",u(void 0),Teams_LHS.populateLhsTeamsList({callbackfn:function(){Teams_LHS.handleDefaultTeamView(),Teams_LHS.bindLhsEvents($("lhsutilityopts"))},fromNetworksTab:!0}),Teams_LHS.retainLastRecentState()},_isEnabled:function(){return $zcg._PLANDETAILS.isTeamChannelAllowed&&SecurityManager.hasPermission(Modules.teams)},populateLhsTeamsList:function(t){var{callbackfn:e=$.noop,searchInputDom:s,fromNetworksTab:i}=t||{};i&&(Teams.getTeamsParams($zcg._ZUID).clearTeamsStorage(),PendingForApprovalTeamsHandler.getPendingTeamsParam($zcg._ZUID).clearPendingTeamsStorage());var n=s||$("#teams-suggest-searchfield");a(n,e)},handleDefaultTeamView:v,updatePermalinkUrl:u,getSubModuleHtml:function(){var t=$WC.template.replace(i.searchDomHtml,{hide_searchBar:OrgFeatures.isPublicTeamsEnabled()?"":"hide"});return $WC.template.replace(i.lhs_main_html,{category_name:"teams",$header_name:"module.teams",teams_sublistHtml:TemplateUtil.getSubListLoader(),search_html:t,hide_appacount:OrgFeatures.isPublicTeamsEnabled()?"":"hide",hide_search:OrgFeatures.isPublicTeamsEnabled()?"hide":"",hide_createOpt:OrgFeatures.isPublicTeamsEnabled()&&SecurityManager.hasPermission(Modules.Teams,MActions.Create)?"":"hide"},"InSecureHTML")},populate:(t,e)=>{var s=(t=>c({limit:100,sort:!0,listhtml:i.teamsListItemHtml,searchValue:$WC.Util.isEmpty(t)?"*":t,showAll:"*"!=t}))(t);if(PublicTeamsUIHandler.updatePublicTeamsRhsHeaderHtml(),!e){var a=Teams.getListFromStorage(),n=$WC.template.replace(i.searchDomHtml,{hide_searchBar:OrgFeatures.isPublicTeamsEnabled()&&a.length>5?"":"hide"});s=$WC.template.replace(i.teamLhsSublistHtml,{hide_searchBar:OrgFeatures.isPublicTeamsEnabled()?"":"hide",search_html:n,_subModulesItemsHtml:s,hide_appacount:OrgFeatures.isPublicTeamsEnabled()?"":"hide"},"InSecureHTML")}return $WC.Util.isEmpty(s)?d(t):s},bindLhsEvents:t=>{var e=$("#myorglhs"),s=e.find("#teams-suggest-searchfield"),i=e.find("#lhssearchclear"),a=e.find("#teamsearchicon"),n=e.find("#lhsutilityopts"),d=!0;a.on("click",(function(t){d?(n.removeClass("hide"),s.focus(),a.attr("title",I18N("teams.search.close.tooltip")),d=!1):(n.addClass("hide"),a.attr("title",I18N("teams.search")),d=!0)})),s.on("keyup",(function(t){o(t,s)})),i.on("click",(function(){l(s)})),r("")},updateLastRecentState:function(){s.lastSearchVal=t||""},retainLastRecentState:function(){if(s.lastSearchVal){var t=$("#teams-suggest-searchfield");t.val(s.lastSearchVal),t.focus(),o()}},showMoreTeamsInList:function(t){var e=h({listhtml:i.teamsListItemHtml,searchValue:"*",showAll:!t},!0);$("#teamslist").html(e)},populatePendingTeamsList:function({teams:t,val:e}){var s=g(t,e);return $WC.Util.isEmpty(s)?"":s},populateFirstTeamInRhs:()=>{e=!0,Teams_LHS.initialTeamId="",v()},updateTeamLhsRow:function(t,e){var s=$("#teams-suggest-searchfield")[0],a=$.trim(s.value),n=$('[purpose="showTeamsView"][team_id="'+t.getTeamId()+'"]'),l={listhtml:i.teamListItemInnerContentHtml,searchValue:$WC.Util.isEmpty(a)?"*":a},o=p(t,l);n.html(o)}}}();let FoldersConstants={DEFAULT_CATEGORY_ID:1,SMILEYCONT_BOTTOM_POSITINING_PX:5,CATEGORY_LIST_LEFT_POSITINING_PX:30,CATEGORY_LIST_NON_SEARCH_BAR_LIMIT:5,PIN_CATEGORY_SAVE:"pincategorysave",FOLDERS_CHANGES_CANCEL:"folderchangesdiscord",CATEGORY_OPTIONS:"foldercategoryoptions",CLEAR_RENAME_UI:"clearRenameUI",RENAME_CATEGORY:"renameCategory",COLLAPSE_CATEGORY_HEADER:"collapsecategoryheader",DELETE_FOLDER_DIALOG_ID:"deletefoldercategory",FOLDER_TITLE_LIMIT:50,FOLDER_TITLE_ERROR_LIMIT:10,MAXIMUM_ALLOWED_PINS:Config.isV2MsgResponseHandlingEnabled()?200:100,MAXIMUM_ALLOWED_PINS_IN_FOLDER:100,ADD_CHATS_NEW_FOLDER:"addChatsForNewFolder",REMOVE_FOLDERS_DROPPED_CHAT:"removefolderstempchat",COLLAPSE_STATE:"collapsed",EXPAND_STATE:"expanded",DEFAULT:"default"},FoldersTemplates={smileyWrapper:'<div class="smileydivmn smilywidth" id="foldersmileycont" data-trigger="destination" data-target="1" ignore_customemoji="true" ignore_sticker="true" ignore_giphy="true" data-livezomoji="false"></div>',folderDragDropWrapper:`<div class="flexC mB10">\n\t\t\t\t\t\t\t\t\t<div id="categorydragndropemojicont" class="folder-emoji-wrap">{{EMOJI_CONT}}</div><div class="folder-title-wrap mL5 ellips" >{{CATEGORY_TITLE}}</div>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t<div id="folderdragndropcont" class="folder-dnd-wrapper flexM flex-col"> <div>${Resource.getRealValue("folders.dragndrop.chats")} ${Resource.getRealValue("common.or")}</div>\n\t\t\t\t\t\t\t\t\t<div id="addchatsfromdialog" class="clr-theme mT5 folders-addchats" elemtype="${FoldersConstants.ADD_CHATS_NEW_FOLDER}">+ ${Resource.getRealValue("folders.addchats")}</div>\n\t\t\t\t\t\t\t\t</div>`,unicodeEmojiFolderSymbol:'<span class="emoji" elemtype="emoji" nodetype=":" code={{UNICODE}} title="{{TITLE}}">{{UNICODE}}</span>',newlyAddedFolderCont:`<div id="newcategorycontwrapper">\n\t\t\t\t\t\t\t\t\t<div id="newcategorycont" class="folder-dnd-cont"></div>\n\t\t\t\t\t\t\t\t\t<div class="folders-category-cont-addchats">\n\t\t\t\t\t\t\t\t\t\t<span class="folder-add-chats-bottom" elemtype="${FoldersConstants.ADD_CHATS_NEW_FOLDER}">+ ${Resource.getRealValue("folders.addchats.more")}</span>\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t</div>`,folderDiscardBtn:`<span id="folderdiscord" class="zcf-closeB LHS-box-24 lhs-reorder-save lhs-folder-discard dN" elemtype="folderchangesdiscord" title="${Resource.getRealValue("common.cancel")}"></span>`,folderSaveBtn:`<span id='saveOrderbtn' class='zcf-tick LHS-box-24 lhs-reorder-save' elemtype='pincategorysave' title='${Resource.getRealValue("common.done")}' data-action={{ACTION}}></span>`,folderCategoryWrapper:'<div id="categorywrapper{{CATEGORY_ID}}" class="folder-category-lhs-wrapper mT10 {{COLLAPSE_CLASS}}" >\n\t\t\t\t\t\t\t\t\t<div class="flexC folder-category-lhs-header folder-hdr-sticky mB5 {{REORDERING_CLASS}}" id="categoryheader{{CATEGORY_ID}}" data-categoryid={{CATEGORY_ID}} elemtype="collapsecategoryheader" folder-category-header>\n\t\t\t\t\t\t\t\t\t\t<div id="categoryemojicont" class="folder-emoji-wrap">{{EMOJI_CONT}}</div>\n\t\t\t\t\t\t\t\t\t\t<div id="categorytitlecont" class="folder-title-wrap mL5 ellips" >{{CATEGORY_TITLE}}</div>\n\t\t\t\t\t\t\t\t\t\t<span id="folderheaderunreadcount" class="LHS-count lhs-folder-header-count mR4"></span>\n\t\t\t\t\t\t\t\t\t\t<span id="lhscategoryoptions{{CATEGORY_ID}}" class="zcf-moreS LHS-btn category-more mLA" elemtype="foldercategoryoptions" data-categoryid={{CATEGORY_ID}}></span>\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t<div class="folder-category-chat" id="foldercategorychats{{CATEGORY_ID}}" style="{{CHATS_VISIBLITY_CSS}}">',categoryHeaderUnicodeEmoji:'<span class="emoji" elemtype="emoji" code="{{UNICODE}}" title="{{TITLE}}">{{EMOJI}}</span>',folderCategoryCreationInput:`<div class="folder-category-input-wrap" id="foldercreationcont">\n\t\t\t\t\t\t\t\t\t\t<div class="mB10 font14 folder-category-input-title flex">{{FOLDER_ACTION_NAME}}\n\t\t\t\t\t\t\t\t\t\t\t<span id="foldertitlelimit" class="folder-title-limit-count dN"></span>\n\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t<div class="zcl-search2" id="folderinputcont">\n\t\t\t\t\t\t\t\t\t\t\t<div id="foldercategorysmileyicn" class="folder-category-smiley {{EMOJI_CLASS}}" >{{EMOJI_CONTENT}}<span id="removecategoryemoji" class="zcf-closeB folder-creation-emoji-revert {{REVERT_EMOJI_CLASS}}" title="${Resource.getRealValue("common.remove")}"></span></div>\n\t\t\t\t\t\t\t\t\t\t\t<div class="zcl-search-input flexC pL5">\n\t\t\t\t\t\t\t\t\t\t\t\t<input id="foldercategoryinput" type="text" placeholder="${Resource.getRealValue("folders.foldername")}" autocomplete="off" maxlength="50">\n\t\t\t\t\t\t\t\t\t\t\t\t<span id="foldercategoryinputclear" purpose="user_search_input_clear" class="zcl-search-clear folder-category-input-clear zcf-closeB" title="${Resource.getRealValue("common.clear")}"></span>\n\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t<div id="foldercreationbtns" class="mT10 font14 textR">\n\t\t\t\t\t\t\t\t\t\t\t<span class="mR10 curP clr-icon2 folder-btn-hover" elemtype="{{CANCEL_ACTION}}">${Resource.getRealValue("common.cancel")}</span>\n\t\t\t\t\t\t\t\t\t\t\t<span class="curP zcl-theme-color fontB folder-btn-hover" id="newfoldercreate" elemtype="{{SAVE_ACTION}}">{{SAVE_ACTION_NAME}}</span>\n\t\t\t\t\t\t\t\t\t  </div>`,deleteCategoryDialogBody:`<div>\n\t\t\t\t\t\t\t\t\t\t <span class="fontB mR5">Info:</span>\n\t\t\t\t\t\t\t\t\t\t   ${Resource.getRealValue("folders.delete.info")}\n\t\t\t\t\t\t\t\t\t </div>`,defaultCategoryCont:'<div id="categorywrapper{{CATEGORY_ID}}" class="folder-category-lhs-wrapper"><div id="categoryheader{{CATEGORY_ID}}" data-categoryid={{CATEGORY_ID}}></div><div id="foldercategorychats{{CATEGORY_ID}}" class="mT5 folder-category-chat">',defaultCategoryHeader:`<div id="categoryheader{{CATEGORY_ID}}" class="LHS-title lhs-sub-hdr default-category-header" workfor="chat">\n\t\t\t\t\t\t\t\t\t<div class="LHS-name flexC">\n\t\t\t\t\t\t\t\t\t\t<span class="ellips font17 fontb">${Resource.getRealValue("common.pinnedchats")}</span>\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t</div>`,categorySuggestionsOptionCont:'<div class="zcl-menu-item posrel" isMoveToFolder={{IS_MOVE_TO}} data-id="{{CATEGORY_ID}}" data-category-option>\n\t\t\t\t\t\t\t\t\t\t\t<div class="flexC ellips">\n\t\t\t\t\t\t\t\t\t\t\t\t<div class="folder-emoji-wrap {{ICON_CLASS}}">{{EMOJI_CONT}}</div>\n\t\t\t\t\t\t\t\t\t\t\t\t<div class="folder-title-wrap mL5 ellips clr-M fontN">{{TITLE}}</div>\n\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t</div>',categorySuggestionSearchCont:'<div id="categorysearchlistcont" class="lhs-folder-category-list RW-searchlist-container flex fdirC {{SEARCH_CLASS}}" closeonscroll>\n\t\t\t\t\t\t\t\t\t\t\t<div class="ellips drsrchholder fshrink">\n\t\t\t\t\t\t\t\t\t\t\t\t<div class="srchin lhs-folder-category-list-search">\n\t\t\t\t\t\t\t\t\t\t\t\t\t<div class="zcl-seach-icon zcf-search2"></div>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<input id="categorysearchlistinput" type="text" class="bornone" placeholder="Search" value="">\n\t\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t\t<div class="flexG ovrflwA flex fdirC" id="categorysearchlistparent">\n\t\t\t\t\t\t\t\t\t\t\t\t<div id="categorysearchlist"></div>\n\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t</div>',emptySearchListCont:`<div class="clr-lp1 p10 font14 textC">${Resource.getRealValue("folders.empty.search")}</div>`,emptyPinSectionMsg:`<div emptymsg="true" class="{{EMPTYMSG_CLASS}}" >${Resource.getRealValue("pinnedchat.none")}</div>`,foldersChatSelectionDialog:`<div id="forwardmessages-usersuggest" class="mcontent zcrchmcnt">\n\t\t\t\t\t\t\t\t\t\t<div class="zcl-win-modal1-hdr fshrink {{draggable}}">\n\t\t\t\t\t\t\t\t\t\t\t<div class="w100 justifySB flexC pTB10">\n\t\t\t\t\t\t\t\t\t\t\t\t<div class="font17 fontB ellips flexC">\n\t\t\t\t\t\t\t\t\t\t\t\t\t<div class="zcl-clr-secondary  ellips flexC">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<div class="folder-emoji-wrap mR3">{{EMOJI_HTML}}</div>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t{{FOLDER_TITLE}}\n\t\t\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<span class="mLR5 font17 clr-S__dark"> > </span><div>${Resource.getRealValue("folders.addchats")}</div>\n\t\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t\t\t<span id="winclose" class="zchat-close zcl-icon-lg zcl-icon--filled2"></span>\n\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t<div class="zcl-win-modal1-srch fshrink">\n\t\t\t\t\t\t\t\t\t\t\t<div class="zcl-search2">\n\t\t\t\t\t\t\t\t\t\t\t\t<span class="zcf-search2 zcl-seach-icon"></span>\n\t\t\t\t\t\t\t\t\t\t\t\t<div class="zcl-search-input">\n\t\t\t\t\t\t\t\t\t\t\t\t\t<input id="forwardmessages-usersuggest-search-field" type="text" placeholder="Search conversations">\n\t\t\t\t\t\t\t\t\t\t\t\t\t<span purpose="clearSearchText" class="zcl-search-clear">${Resource.getRealValue("common.clear")}</span>\n\t\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t</div>\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t<div class="zcrchtlt">\n\t\t\t\t\t\t\t\t\t\t\t<div id="forwardmessages-usersuggest-list" class="posl zcht100"></div>\n\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t<div class="zcl-win-modal1-footr fshrink mT5">\n\t\t\t\t\t\t\t\t\t\t\t<div class="w100 justifySB flexC footr-padding">\n\t\t\t\t\t\t\t\t\t\t\t\t<div id="usernodecnt" class="zcrchicnt flexG">\n\t\t\t\t\t\t\t\t\t\t\t\t\t<div id="forwardmessages-usersuggest-select-field" contenteditable="false" class="flexC"></div>\n\t\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t\t\t<div id="addchatsbtn" class="fshrink mL15 zcl-btn-sm zcl-btn--primary">${Resource.getRealValue("common.add")}</div>\n\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t</div>`,foldersTempChatAdditionRemove:`<div class="folders-dnd-chats-remove zcf-close" title="${Resource.getRealValue("common.remove")}" elemtype="removefolderstempchat"></div>`},FoldersDomSelectors={pinChatsHeader:"#pinnedchatsheader",categoryCreationInput:"#foldercategoryinput",folderCreationCont:"#foldercreationcont",smileyIcon:"#foldercategorysmileyicn",folderInputClearIcon:"#foldercategoryinputclear",bodyDom:"body",folderCreationSmileyCont:"#foldersmileycont",folderCreationInputCont:"#folderinputcont",folderDiscordBtn:"#folderdiscord",pinnedChatsParentCont:"#pinnedchats",pinnedChatsList:"#pinnedchatslist",folderDragnDropCont:"#folderdragndropcont",newlyCreatedCategoryCont:"#newcategorycont",newlyCreatedCategoryContWrapper:"#newcategorycontwrapper",categoryHeader:"#categoryheader",categoryWrapper:"#categorywrapper",categoryChatsCont:"#foldercategorychats",categoryTitleCont:"#categorytitlecont",categoryEmojiCont:"#categoryemojicont",lhsListParentCont:"#list",categoryListSearchCont:"#categorysearchlistcont",categorySearchResultsCont:"#categorysearchlist",removeCategoryEmojiOptn:"#removecategoryemoji",pinnedChatsWrapper:"#pinnedchatwrapper"},Folders=function(){let t,e,s,i,a,n,l,o=!1,r=[],d={},c=!1,p=!1,h=t=>{o=!1,s="";let e=$(FoldersDomSelectors.folderCreationCont),i=e.find(FoldersDomSelectors.smileyIcon),a=e.find(FoldersDomSelectors.categoryCreationInput),n=e.find(FoldersDomSelectors.folderInputClearIcon),l=e.find("#foldertitlelimit");i.on("click",t=>{m(t)}),a.on("keyup",e=>{y(e,t,l)}),n.on("click",()=>{a[0].value="",a.focus()})},m=s=>{if("removecategoryemoji"==s.target.id)return C(s.target),void $(FoldersDomSelectors.categoryCreationInput).focus();if(t)return void u();$(FoldersDomSelectors.bodyDom).append(FoldersTemplates.smileyWrapper),e=$(FoldersDomSelectors.folderCreationSmileyCont),t=!0,Smiley.showSmileyUI("foldercategorysmileyicn","foldersmileycont",s,u),v(s),g(),$(FoldersDomSelectors.folderCreationInputCont).addClass("focus")},u=()=>{e.remove(),t=!1,$(FoldersDomSelectors.folderCreationInputCont).removeClass("focus")},v=t=>{let s=$(FoldersDomSelectors.smileyIcon),i=s.offset(),a=$Util.positionTargetElemFixed(e,t,{clickedX:i.left,clickedY:i.top+s.outerHeight()});"auto"!==a.bottom?a.bottom=a.bottom+s.outerHeight():a.top=a.top+FoldersConstants.SMILEYCONT_BOTTOM_POSITINING_PX,e.css(a)},g=t=>{e.on("click","[code]",t=>{f(t)})},f=t=>{let e=t.target;s=e.getAttribute("code");let i=Composer.createSmileyNode(e),a=$(FoldersDomSelectors.smileyIcon);a.removeClass("zcf-def_emoji"),a.find("[code]").remove(),a.prepend(i),a.find(FoldersDomSelectors.removeCategoryEmojiOptn).removeClass("dN"),u(),Clickoutside.handleClickOnChild(t),$(FoldersDomSelectors.categoryCreationInput).focus()},C=t=>{let e=(t=$(t)).parent();e.find("[code]").remove(),e.addClass("zcf-def_emoji"),t.addClass("dN"),s=""},y=(t,e,s)=>{if(t.keyCode==$zcg.ENTER_KEYCODE)e?R(t.target):_(t.target);else if(t.keyCode==$zcg.ESCAPE_KEYCODE)e?O():t.target.value.length||I();else{let e=FoldersConstants.FOLDER_TITLE_LIMIT-t.currentTarget.value.length;e<=FoldersConstants.FOLDER_TITLE_ERROR_LIMIT?(s.removeClass("dN"),s.html(e)):s.addClass("dN")}},_=t=>{let e=t.value.trim();e.length?(S(),q({title:e,symbol:s,successCallback:T})):U()},S=t=>{let e=Resource.getRealValue("folders.create.loading"),s=LeftPannel.container.find("#foldercreationbtns");s.addClass("zcdisabled"),s.find("#newfoldercreate").text(e)},T=t=>{L(t),FoldersDragnDropHandler.bindDragNDropEvent(),o=!0,MyPinsCustomizer.appendReorderingSaveBtn()},L=t=>{let e=$(FoldersDomSelectors.folderCreationCont),s=t.symbol?M(t.symbol):"",i=$WC.template.replace(FoldersTemplates.folderDragDropWrapper,{CATEGORY_TITLE:t.title});i=$WC.template.replace(i,{EMOJI_CONT:s},"InSecureHTML"),e.addClass("folder-drag-drop-cont"),e.html(i);let a=$(FoldersDomSelectors.pinnedChatsParentCont);LhsModules.isSegmentedView()?a.find("#pinnedchatwrapper").removeClass("lhs-folders-creation"):a.removeClass("lhs-folders-creation"),a.addClass("lhs-drag-drop-active")},M=t=>{if(!(t=$WC.$CUtil.processXSS(t)))return"";let e,s=t.split("/"),i=s.length>1,a=i?Resource.getRealValue("smiley.emoji"):Resource.getRealValue("smiley.cliq"),n=i?s[0]:t;return!Smiley.isVaildEmoji(n,a)||i&&!Smiley.isVaildUnicodeEmojiHexCode(s[1])?"":(i?(n=n.split(":")[1],e=$WC.template.replace(FoldersTemplates.categoryHeaderUnicodeEmoji,{UNICODE:t,TITLE:n,EMOJI:s[1].replace(/#/g,"&#")},"InSecureHTML")):e=Smiley.replace(t,!0,!0),e)},I=()=>{let t=$(FoldersDomSelectors.lhsListParentCont);t.hasClass("lhs-pinreorder-active lhs-category-pinorder")&&(t.removeClass("lhs-pinreorder-active lhs-category-pinorder"),t.removeClass("lhs-whole-section-reorder")),LhsModules.isSegmentedView()?LhsNavigation.updateSubModuleCategory():MyConvosLHS.populate()},w=function(t,e,s){let a=e||FoldersDragnDropHandler.getDroppedChatIds(),n=s||i;if(n=n==FoldersConstants.DEFAULT_CATEGORY_ID?"default":n,!a.length)return void I();let l={categoryId:n,chatIds:a,lastSyncTime:MyPinsCustomizer.getLastSyncTime()};$Util.Button.addLoadIconForAjax($(t)),K(l),c=!0},H=t=>{let e=[],s=(t=t||[]).length;for(let i=0;i<s;i++)e.push(t[i].id);return e},b=t=>{if(t.id==FoldersConstants.DEFAULT_CATEGORY_ID)return $WC.template.replace(FoldersTemplates.defaultCategoryCont,{CATEGORY_ID:t.id});let e=M(t.symbol),s=t.headerState,i="display: block;",a="",n=Z()?"zcf-pinreordering":"";s==FoldersConstants.COLLAPSE_STATE&&(i="display: none;",a="lhs-category-header-collapse");let l=$WC.template.replace(FoldersTemplates.folderCategoryWrapper,{EMOJI_CONT:e},"InSecureHTML");return l=$WC.template.replace(l,{CATEGORY_TITLE:t.title,CATEGORY_ID:t.id,CHATS_VISIBLITY_CSS:i,COLLAPSE_CLASS:a,REORDERING_CLASS:n})},A=t=>{let e=t.length;for(let s=0;s<e;s++){let e=t[s],i=E(e);if(d[i]){let t=d[i].chats.indexOf(e);d[i].chats.splice(t,1)}}},E=t=>{let e=r.length;for(let s=0;s<e;s++){let e=r[s];if(d[e].chats.includes(t))return e}return 0},O=t=>{let e=t||a;if(!a)return;let s=$(FoldersDomSelectors.categoryWrapper+e);s.find(FoldersDomSelectors.categoryHeader+e).show(),s.find(FoldersDomSelectors.folderCreationCont).remove()},R=t=>{let e=t.value.trim(),i=d[a];if(!e.length||e==i.title&&s==i.symbol)U();else{let t=r.indexOf(a),i="";t+1<r.length&&(i=r[t+1]);let l={data:{title:e,symbol:s,last_sync_time:MyPinsCustomizer.getLastSyncTime(),pin_above:i},categoryId:a};n=!0,S(!0),J(l)}},D=t=>{O(t),N(t)},U=()=>{let t=$(FoldersDomSelectors.folderCreationInputCont);t.addClass("shakeAnim"),setTimeout((function(){t.removeClass("shakeAnim")}),500)},N=t=>{let e=$(FoldersDomSelectors.categoryWrapper+t),s=d[t],i=s.symbol?M(s.symbol):"",a=s.title;e.find(FoldersDomSelectors.categoryEmojiCont).html(i),e.find(FoldersDomSelectors.categoryTitleCont).text(a)},P=(t,e)=>{let s=[{text:Resource.getRealValue("common.cancel"),colour:$zcg._cssClasses.SECONDARY_BTN,action:function(){$WC.$Win.destroy(FoldersConstants.DELETE_FOLDER_DIALOG_ID)}}];if(t){let i={text:Resource.getRealValue("common.delete"),colour:$zcg._cssClasses.NEG_PRIMARY_BTN,action:function(){return $Util.Button.addLoadIconForAjax(this.find("[button='2']")),x(e,t,!1),!0}};s.push(i)}else{let i={text:Resource.getRealValue("folders.delete.pin"),colour:$zcg._cssClasses.NEG_PRIMARY_BTN,action:function(){return $Util.Button.addLoadIconForAjax(this.find("[button='2']")),x(e,t,!1),!0}},a={text:Resource.getRealValue("common.delete"),colour:$zcg._cssClasses.NEG_PRIMARY_BTN,action:function(){return $Util.Button.addLoadIconForAjax(this.find("[button='3']")),x(e,t,!0),!0}};s.push(i),s.push(a)}return s},k=t=>{return!!d[t].chats.length},x=(t,e,s)=>{let i=!1;!e&&s&&(i=!0),X({categoryId:t,unpinAll:i})},z=()=>{let t=LhsModules.isSegmentedView()?$(FoldersDomSelectors.pinnedChatsWrapper):$(FoldersDomSelectors.pinnedChatsParentCont);F(t),FoldersDragnDropHandler.handleWholePinSectionDragnDrop(t)},F=t=>{let e=t.find(FoldersDomSelectors.pinChatsHeader),s=e.find("#pincategoryoptions"),i=t.find("[catagory]"),a=t.find("[folder-category-header]"),n=$(FoldersDomSelectors.lhsListParentCont);t.addClass("lhs-pins-reorder lhs-drag-drop-active"),e.attr("data-pinreorderactive",""),s.remove(),i.removeClass("chatsel").attr("data-draggable","").attr("draggable","true"),Z()&&t.find("[folder-category-header]").attr("draggable","true"),a.attr("data-draggable",""),n.addClass("lhs-pinreorder-active lhs-category-pinorder lhs-whole-section-reorder"),MyPinsCustomizer.appendReorderingSaveBtn()},V=t=>{t.event.preventDefault();let e=t.categoryCont.find(FoldersDomSelectors.categoryChatsCont+t.categoryId),s=MyPinsCustomizer.getDragContPositionValues(e);l&&(s=MyPinsCustomizer.getDragContPositionValues(e),l=!1),dragAndDropHandler.initDragAndDrop({event:t.event,pinsAreaPositionVals:s,parentDom:e,isCatergoryReordering:!0,categoryId:t.categoryId})},W=t=>{t.on("scroll",(function(){l=!0}))},B=t=>{let e={categoryId:t,data:{state:d[t].headerState},errorCallback:function(t){j(t)}};tt(e)},j=t=>{t.data.state==FoldersConstants.COLLAPSE_STATE?d[t.categoryId].headerState=FoldersConstants.EXPAND_STATE:d[t.categoryId].headerState=FoldersConstants.COLLAPSE_STATE},G=()=>{let t=LhsModules.isSegmentedView()?"lhs-sub-item-empty":"cntemptymsg";return $WC.template.replace(FoldersTemplates.emptyPinSectionMsg,{EMPTYMSG_CLASS:t})},Y=(t,e)=>{e?t=r:t.length>1&&(t=$Util.removeDuplicateEntries(t));let s=t.length;for(let e=0;e<s;e++){let s=t[e],i=d[s];if(!i||i&&i.headerState==FoldersConstants.EXPAND_STATE)continue;let a=d[s].chats,n=a.length,l=0;for(let t=0;t<n;t++){let e=a[t];ConversationsList.hasUnread(e)&&!ConversationsList.isMuted(e)&&l++}l=0==l?"":l,LeftPannel.container.find("#categoryheader"+s).find("#folderheaderunreadcount").html(l)}},Z=()=>r.length>2,q=t=>{i=void 0,$ZCAjx.ajax({url:"/v2/pincategories",type:"POST",data:{title:t.title,symbol:t.symbol},contentType:"application/json",success:e=>{"function"==typeof t.successCallback&&t.successCallback(t),UI.updateBanner(Resource.getRealValue("folders.creation.success"),2e3)},error:()=>{UI.updateBanner(Resource.getRealValue("apierror.message.two"),2e3,!0)}})},K=function(t){$ZCAjx.ajax({url:"/v2/pincategories/"+t.categoryId,type:"PUT",data:{chat_ids:t.chatIds,last_sync_time:t.lastSyncTime},contentType:"application/json",success:function(e){let s=t.categoryId==FoldersConstants.DEFAULT?I18N("profileview.status.default"):d[t.categoryId].title;UI.updateBanner(Resource.getRealValue("folders.chatsadded.success",[$WC.$CUtil.processXSS(s)]),2e3),"function"==typeof t.successCallback&&t.successCallback(),FoldersUtilities.isFoldersAddChatsDialogOpened&&$WC.$Win.destroy("forwardmessageswin")},error:function(){c=!1,UI.updateBanner(Resource.getRealValue("apierror.message.two"),2e3,!0)}})},J=function(t,e){$ZCAjx.ajax({url:"/v2/pincategories/"+t.categoryId,type:"PUT",data:t.data,contentType:"application/json",success:function(s){!e&&UI.updateBanner(Resource.getRealValue("folders.rename.success"),2e3),"function"==typeof t.successCallback&&t.successCallback()},error:function(){n=!1,UI.updateBanner(Resource.getRealValue("apierror.message.two"),2e3,!0)}})},X=function(t){$ZCAjx.ajax({url:"/v2/pincategories/"+t.categoryId+"?unpin_all="+t.unpinAll,type:"DELETE",success:function(e){$WC.$Win.destroy(FoldersConstants.DELETE_FOLDER_DIALOG_ID),UI.updateBanner(Resource.getRealValue("folders.delete.success"),2e3),"function"==typeof t.successCallback&&t.successCallback()},error:function(){$WC.$Win.destroy(FoldersConstants.DELETE_FOLDER_DIALOG_ID),UI.updateBanner(Resource.getRealValue("apierror.message.two"),2e3,!0)}})},Q=function(t){$ZCAjx.ajax({url:"/v2/pincategories/"+t.categoryId,type:"PUT",data:t.data,contentType:"application/json",success:function(e){"function"==typeof t.successCallback&&t.successCallback()},error:function(){UI.updateBanner(Resource.getRealValue("apierror.message.two"),2e3,!0)}})},tt=function(t){p=!0,$ZCAjx.ajax({url:"/v2/pincategories/"+t.categoryId,type:"PUT",data:t.data,contentType:"application/json",success:function(e){"function"==typeof t.successCallback&&t.successCallback()},error:function(){p=!1,UI.updateBanner(Resource.getRealValue("apierror.message.two"),2e3,!0),"function"==typeof t.errorCallback&&t.errorCallback(t)}})};return{addCatergoryCrationUI:()=>{O(),MyPinsCustomizer.addReorderingStyles(!0);let t=$WC.template.replace(FoldersTemplates.folderCategoryCreationInput,{FOLDER_ACTION_NAME:Resource.getRealValue("folders.createfolder"),EMOJI_CLASS:"zcf-def_emoji",EMOJI_CONTENT:"",CANCEL_ACTION:"folderchangesdiscord",SAVE_ACTION:"pincategorysave",REVERT_EMOJI_CLASS:"dN",SAVE_ACTION_NAME:Resource.getRealValue("common.create")});$(t).insertAfter(FoldersDomSelectors.pinChatsHeader).find(FoldersDomSelectors.categoryCreationInput).focus(),Folders.isFolderCreationSelected=!0,h()},isFolderCreationSelected:void 0,closeTheEditView:I,createFolderCategory:_,handleSaveAction:t=>{o?w(t):_($(FoldersDomSelectors.categoryCreationInput)[0])},modifyAndHandleFoldersInfo:t=>{r=[],d={};let e=$Util.cloneObject(t,!0).data,s=e.length,i=[];for(let t=0;t<s;t++){let s=e[t],a="default"==s.id?FoldersConstants.DEFAULT_CATEGORY_ID:s.id,n=s.symbol?s.symbol:"";r.push(a),s.id=a,s.symbol=n,s.chats&&(i=i.concat(s.chats)),s.chats=H(s.chats),s.headerState=s.state,d[a]=s}return t.data[0].chats=i,t},updateNewCategoryInfo:t=>{let e=t.symbol?t.symbol:"";r.push(t.id),d[t.id]={title:t.title,symbol:e,id:t.id,chats:[],headerState:t.state},i=t.id},updateCategoryBulkChats:t=>{t.id==FoldersConstants.DEFAULT&&(t.id=FoldersConstants.DEFAULT_CATEGORY_ID);let e=t.chat_ids||[];if(c&&(c=!1,e.length&&A(e)),e=e.length?e:d[t.id].chats,d[t.id]={title:t.title,symbol:t.symbol,id:t.id,chats:e,headerState:t.state},n)return D(t.id),void(n=!1);p?p=!1:(MyPinsCustomizer.addPinChatInfoForNonPinnedChats(e),I())},renameCategory:t=>{O();let e=d[t],i=e.symbol?M(e.symbol):"",n="zcf-def_emoji",l="dN";i.length&&(l="",n="");let o=$WC.template.replace(FoldersTemplates.folderCategoryCreationInput,{FOLDER_ACTION_NAME:Resource.getRealValue("folders.renamefolder"),EMOJI_CLASS:n,EMOJI_CONTENT:i,CANCEL_ACTION:"clearRenameUI",SAVE_ACTION:"renameCategory",REVERT_EMOJI_CLASS:l,SAVE_ACTION_NAME:Resource.getRealValue("common.rename")},"InSecureHTML"),r=$(FoldersDomSelectors.categoryWrapper+t);r.find(FoldersDomSelectors.categoryHeader+t).hide(),r.prepend(o);let c=r.find(FoldersDomSelectors.categoryCreationInput);c.val(e.title),c.focus(),h(!0),a=t,s=e.symbol},createDeleteCategoryDialog:t=>{let e=!k(t),s=e?"":" folders-category-delete-dialog",i=e?"":FoldersTemplates.deleteCategoryDialogBody,a=$WC.$Dlg.create({id:FoldersConstants.DELETE_FOLDER_DIALOG_ID,version:3,class:"zcl-alert-dialog-2 zcldel-dialog-box"+s,headerhtml:$WC.$Dlg.frameHeaderHTML({imagehtml:'<div class="zcl-img xl flexM mAuto zcf-folder  zcl-img--neg"></div>',header:Resource.getRealValue("folders.delete.warning")}),bodyhtml:$WC.$Dlg.frameBodyInfoHTML({info:[i]}),buttons:P(e,t)});e&&$(a).find('[button="2"]').focus()},handleFolderCategoryDeletion:t=>{let e=t.id;r.splice(r.indexOf(e),1);let s=d[e].chats;if(s.length){let i=MyPinsCustomizer.getPinsChatids(),a=i.indexOf(s[0]);if(t.unpin_all)i.splice(a,s.length),MyPinsCustomizer.updatePinChatIdsOrder(i),MyPinsCustomizer.removePinChatInfoFromClient(s);else{let t=d[FoldersConstants.DEFAULT_CATEGORY_ID].chats;d[FoldersConstants.DEFAULT_CATEGORY_ID].chats=t.concat(s)}delete d[e],I()}else $(FoldersDomSelectors.categoryWrapper+e).remove()},getFolderSectionHtml:(t,e)=>{let s="",i=r.length,a=0;for(let n=0;n<i;n++){let i=r[n],l=d[i];s+=b(l);let o=l.chats||[],c=o.length;for(let i=0;i<c;i++){a++;let n=o[i],l=$Util.cloneObject(t[n]);if(l.chid=n,l.deleted||l.removed){ConversationsList.delete(l.chid);continue}let r=ConversationsList.parseDetails(l);r&&("channel"!==(r=MyPinsCustomizer.checkParseDetails(r,n)).profile||Channels.getObject(r.profileid)||l?(!e&&LeftPannel.LHSList.removeDuplicatesFromOtherCategory(n,"pinnedchats"),s+=ConversationsUI.getHtml("pinnedchats",n,l,r)):ConversationsList.delete(l.chid))}s+="</div></div>"}return i<=1&&0==a&&(s+=G()),s},reorderCategory:t=>{if(MyPinsCustomizer.isPinOrderStateActive=!0,t==FoldersConstants.DEFAULT_CATEGORY_ID)return void z();let e=$(FoldersDomSelectors.categoryWrapper+t),s=d[t].headerState;e.addClass("lhs-pins-reorder lhs-drag-drop-active"),s==FoldersConstants.COLLAPSE_STATE&&(d[t].headerState=FoldersConstants.EXPAND_STATE,e.removeClass("lhs-category-header-collapse"),e.find(FoldersDomSelectors.categoryChatsCont+t).slideDown());let i=e.find("[catagory]");i.removeClass("chatsel").attr("data-draggable","");let a=$(FoldersDomSelectors.lhsListParentCont);a.removeClass("lhs-whole-section-reorder"),a.addClass("lhs-pinreorder-active lhs-category-pinorder");let n=$WC.template.replace(FoldersTemplates.folderSaveBtn,{ACTION:""}),l=e.find(FoldersDomSelectors.categoryHeader+t);l.append(n);let o=e.find(FoldersDomSelectors.categoryChatsCont+t),r=(MyPinsCustomizer.getDragContPositionValues(o),LhsModules.isSegmentedView()?$(FoldersDomSelectors.pinChatsHeader):$("#allchats_listing"));W(r),e.on("mousedown","[chid]",(function(s){V({event:s,categoryCont:e,categoryId:t})})),e.find("#saveOrderbtn").on("click",(function(){e.removeClass("lhs-pins-reorder lhs-drag-drop-active"),i.removeAttr("data-draggable"),a.removeClass("lhs-pinreorder-active lhs-category-pinorder"),a.removeClass("lhs-whole-section-reorder"),t==FoldersConstants.DEFAULT_CATEGORY_ID&&((void 0).show(),l.remove()),this.remove(),e.off("mousedown"),r.off("scroll"),MyPinsCustomizer.isPinOrderStateActive=!1}))},getCategoryInfo:t=>d[t],handleCategoryChatsReordering:t=>{let e=t.categoryId==FoldersConstants.DEFAULT_CATEGORY_ID?"default":t.categoryId,s={data:{last_sync_time:MyPinsCustomizer.getLastSyncTime(),chat_id:t.changedChid,pin_above:t.aboveChid},categoryId:e};J(s,!0)},handleChatsReorderingResponse:t=>{let e="default"==t.category_id?FoldersConstants.DEFAULT_CATEGORY_ID:t.category_id,s=d[e].chats;s.includes(t.chat_id)?s.splice(s.indexOf(t.chat_id),1):A([t.chat_id]),t.pin_above?s.splice(s.indexOf(t.pin_above),0,t.chat_id):s.push(t.chat_id)},getCategoryList:()=>r,getEmojiHtml:M,addNewChatInCaetgory:t=>{let e="default"==t.category_id?FoldersConstants.DEFAULT_CATEGORY_ID:t.category_id;d[e].chats.push(t.chat_id)},removeOldChatInCaetgory:t=>{A([t.chat_id])},clearLastOpenedRenameInput:O,updateFolderCategoryDetails:R,showCollapseHeader:t=>{let e=(t=$(t)).attr("data-categoryid"),s=d[e].headerState;t=t.parent(FoldersDomSelectors.categoryWrapper+e),d[e].chats.length&&(s==FoldersConstants.COLLAPSE_STATE?(t.find(FoldersDomSelectors.categoryChatsCont+e).slideDown(),d[e].headerState=FoldersConstants.EXPAND_STATE,t.removeClass("lhs-category-header-collapse")):(t.find(FoldersDomSelectors.categoryChatsCont+e).slideUp(),d[e].headerState=FoldersConstants.COLLAPSE_STATE,Y([e]),t.addClass("lhs-category-header-collapse")),B(e))},handleEmptyPinSectionState:()=>{r.length<=1&&0==MyPinsCustomizer.getPinsChatids().length&&$(FoldersDomSelectors.pinnedChatsList).append(G())},getCategoryIdOfChat:E,updateHeaderUnreadCount:Y,handleFolderReordering:(t,e)=>{let s={categoryId:t,data:{last_sync_time:MyPinsCustomizer.getLastSyncTime()}};e&&(s.data.pin_above=e),Q(s)},handleFolderReorderingSuccessCallback:t=>{let e=t.category_id;if(r.splice(r.indexOf(e),1),t.pin_above){var s=r.indexOf(t.pin_above);r.splice(s,0,e)}else r.push(e)},addChatsInFolder:t=>{FoldersUtilities.showConversationsDialog(t)},addChatsInCategory:w,handleNewFolderChatsAddition:()=>{FoldersUtilities.showConversationsDialog(i)},getChatsOfaFolder:(t,e)=>{t=t==FoldersConstants.DEFAULT?FoldersConstants.DEFAULT_CATEGORY_ID:t;let s=d[t]?d[t].chats:[];return e?s.length:s}}}(),FoldersDragnDropHandler=function(){let t,e,s,i,a,n,l=0,o=[],r=(t,e)=>{t.stopPropagation(),FoldersDragnDropHandler.isDraggingElemisFolderHeader?e.classList.add("folder-header-dragdrop-state"):e.classList.add("folder-drag-wrapper"),t.originalEvent.dataTransfer.setDragImage(e,0,0)},d=()=>{if(e&&e.classList.remove("folder-drag-wrapper"),s.find(FoldersDomSelectors.newlyCreatedCategoryCont).children().removeClass("curN"),a){a=!1,l--;let e=i.getAttribute("chid");t.find("#tab"+e).show(),i.remove(),o.splice(o.indexOf(e),1),0==l&&(h(),s.off("dragenter dragend dragover"))}},c=(t,e)=>{t.stopPropagation(),e.classList.add("folder-drag-wrapper"),t.originalEvent.dataTransfer.setDragImage(e,0,0),a=!0,i=e,n=e.nextSibling?e.nextSibling.getAttribute("chid"):"",i.setAttribute("data-currentdraggigelem","")},p=()=>{if(a){i.classList.remove("folder-drag-wrapper"),a=!1,i.removeAttribute("data-currentdraggigelem");let t=$("[data-lastused]"),e=t.length?t.attr("chid"):"",l=i.getAttribute("chid");return t==n?t.css("margin-top","0px").removeAttr("data-lastused"):(t.css("margin-top","0px").removeAttr("data-lastused"),t.length?($(i).insertBefore(t),o.splice(o.indexOf(l),1),o.splice(o.indexOf(e),0,l)):(i.parentNode.appendChild(i),o.splice(o.indexOf(l),1),o.push(l))),void s.find(FoldersDomSelectors.newlyCreatedCategoryCont).children().removeClass("curN")}l++;let t,r=e.outerHTML;$(e).hide();let d=e.getAttribute("chid");if(1==l)s.find(FoldersDomSelectors.folderDragnDropCont).hide(),s.append(FoldersTemplates.newlyAddedFolderCont),$(FoldersDomSelectors.folderDiscordBtn)[0].classList.toggle("dN"),t=s.find(FoldersDomSelectors.newlyCreatedCategoryCont),$Util.addAndHandleDragnDropEvents({parent:s,callFromLhsChatArea:!0,dragAreaDom:t}),t.append(r).children().removeClass("curN"),o.push(d);else{let e=s.find("[data-lastused]");if(t=s.find(FoldersDomSelectors.newlyCreatedCategoryCont),e.length){e.css("margin-top","0px").removeAttr("data-lastused"),e[0].insertAdjacentHTML("beforebegin",r);let t=e[0].getAttribute("chid");o.splice(o.indexOf(t),0,d)}else t.append(r),o.push(d)}t.children().removeClass("curN")},h=()=>{s.find(FoldersDomSelectors.folderDragnDropCont).show(),s.find(FoldersDomSelectors.newlyCreatedCategoryContWrapper).remove(),$(FoldersDomSelectors.folderDiscordBtn)[0].classList.toggle("dN")},m=(t,e)=>!(!Config.isV2MsgResponseHandlingEnabled()||t==e||!FoldersUtilities.isPinnedChatsLimitReachedInaFolder(e))&&(UI.updateBanner(Resource.getRealValue("folders.pinchats.onefolder.limit.info",[FoldersConstants.MAXIMUM_ALLOWED_PINS_IN_FOLDER]),2e3,!0),!0),u=()=>{if(FoldersDragnDropHandler.isDraggingElemisFolderHeader){let t=e.parentElement.nextElementSibling;return t?$(t).find("[folder-category-header]")[0].id:void 0}let t=e.nextElementSibling;if(t)return t.id;let s=e.parentElement.parentElement,i=$(s.nextElementSibling).find("[folder-category-header]")[0];return i?i.id:void 0},v=t=>{if(t.removeClass("curN"),FoldersDragnDropHandler.isDraggingElemisFolderHeader?e.classList.remove("folder-header-dragdrop-state"):e.classList.remove("folder-drag-wrapper"),e.removeAttribute("data-current-dragging-elem"),e.setAttribute("data-draggable",""),FoldersDragnDropHandler.isDraggingElemisFolderHeader){(LhsModules.isSegmentedView()?t.parents(FoldersDomSelectors.pinnedChatsWrapper):t.parents(FoldersDomSelectors.pinnedChatsParentCont)).removeClass("lhs-folder-header-dragdrop"),e.setAttribute("folder-category-header","")}$(e).show()},g=(t,s)=>{let i=e.parentElement,a=i.outerHTML,n=e.getAttribute("data-categoryid"),l=void 0;s?t.parentElement.insertAdjacentHTML("afterend",a):(t.parentElement.insertAdjacentHTML("beforebegin",a),l=t.getAttribute("data-categoryid")),i.remove(),Folders.handleFolderReordering(n,l),FoldersDragnDropHandler.isDraggingElemisFolderHeader=!1};return{bindDragNDropEvent:()=>{l=0,o=[],t=$(FoldersDomSelectors.pinnedChatsList),s=$(FoldersDomSelectors.folderCreationCont),i=void 0,t.find("[catagory]").attr("draggable","true"),t.on("dragstart","[data-draggable]",(function(t){a=!1,r(t,e=this)})),t.on("dragover",t=>{e&&e.classList.remove("folder-drag-wrapper")}),t.on("drop",t=>{d()}),t.on("dragleave",t=>{e&&e.classList.remove("folder-drag-wrapper")}),s.on("dragstart","[data-draggable]",(function(t){c(t,this)})),s.on("drop",(function(t){p(t)})),s.on("dragleave",(function(t){i&&i.classList.remove("folder-drag-wrapper")})),s.on("dragend",(function(t){a=!1,s.find(FoldersDomSelectors.newlyCreatedCategoryCont).children().removeClass("curN")}))},getDroppedChatIds:()=>o,handleWholePinSectionDragnDrop:t=>{let s,i=t.find(FoldersDomSelectors.pinnedChatsList);t.on("dragstart","[data-draggable]",(function(t){e=this,FoldersDragnDropHandler.isDraggingElemisFolderHeader=e.hasAttribute("folder-category-header"),r(t,e),s=u(),e.setAttribute("data-current-dragging-elem","")})),t.on("dragover",(function(){FoldersDragnDropHandler.isDraggingElemisFolderHeader?e.classList.remove("folder-header-dragdrop-state"):e.classList.remove("folder-drag-wrapper"),i.addClass("curN")})),t.on("dragend",(function(){v(i),FoldersDragnDropHandler.isDraggingElemisFolderHeader=!1})),t.on("drop",(function(){v(i);let a=t.find("[data-lastused]")[0],n=a.classList,l=a.id;a.removeAttribute("data-lastused"),n.remove("lhs-folder-drag-shadow"),a.style.marginTop=0,i.removeClass("pB30");let o,r,d=e.getAttribute("chid"),c=n.contains("lhs-folder-drag-shadow-bottom");if(n.remove("lhs-folder-drag-shadow-bottom"),!(s==l&&!c||c&&null==s)){if(FoldersDragnDropHandler.isDraggingElemisFolderHeader)return void g(a,c);let s=e.outerHTML,i=Folders.getCategoryIdOfChat(d);if(c)if(r="",l.includes("category")){if(o=a.getAttribute("data-categoryid"),m(i,o))return;a.nextElementSibling.insertAdjacentHTML("afterbegin",s)}else{if(o=a.parentElement.previousElementSibling.getAttribute("data-categoryid"),m(i,o))return;a.insertAdjacentHTML("afterend",s)}else if(l.includes("category")){let e=Folders.getCategoryList(),n=e.indexOf(a.getAttribute("data-categoryid")),l=e[n-1],d=t.find(FoldersDomSelectors.categoryChatsCont+l);if(m(i,o=l))return;d[0].insertAdjacentHTML("beforeend",s),r=""}else{if(o=a.parentElement.previousElementSibling.getAttribute("data-categoryid"),m(i,o))return;a.insertAdjacentHTML("beforebegin",s),r=a.getAttribute("chid")}e.remove(),Folders.handleCategoryChatsReordering({changedChid:d,aboveChid:r,categoryId:o})}})),$Util.addAndHandleDragnDropEvents({parent:t,dragAreaDom:i,isWholeSectionReordering:!0,dragStyleClass:"lhs-folder-drag-shadow",dragStyleBottomClass:"lhs-folder-drag-shadow-bottom",callFromLhsChatArea:!0})},isDraggingElemisFolderHeader:void 0,addSelectedChatsFromDialogUnderNewFolder:e=>{let i=s.find(FoldersDomSelectors.newlyCreatedCategoryCont);0==l&&(s.find(FoldersDomSelectors.folderDragnDropCont).hide(),s.append(FoldersTemplates.newlyAddedFolderCont),$(FoldersDomSelectors.folderDiscordBtn)[0].classList.toggle("dN"),i=s.find(FoldersDomSelectors.newlyCreatedCategoryCont),$Util.addAndHandleDragnDropEvents({parent:s,callFromLhsChatArea:!0,dragAreaDom:i}));let a=e.length,n=ConversationsList.getAll(),r="",d=MyPinsCustomizer.getPinsChatids();for(let s=0;s<a;s++){l++;let i=e[s];if(o.push(i),d.includes(i)){let e=t.find("[chid="+i+"]");r+=e?e[0].outerHTML:"",e.hide();continue}let a=$Util.cloneObject(n[i]);if(a.chid=i,a.deleted||a.removed){ConversationsList.delete(a.chid);continue}let c=ConversationsList.parseDetails(a);c&&("channel"!==c.profile||Channels.getObject(c.profileid)||a?r+=ConversationsUI.getHtml("pinnedchats",i,a,c).replace("chid","data-draggable='true' draggable='true' chid"):ConversationsList.delete(a.chid))}i.append(r),$WC.$Win.destroy("forwardmessageswin")},removeDroppedChat:t=>{a=!0,i=$(t).parents("[draggable]")[0],d()}}}(),FoldersCategoryOptionsMenu=function(){let t,e=t=>{let e=$("#foldercategoryoptns"+t),s=e.attr("id");return!!e.length&&(e.remove(),Clickoutside.clear(s),!0)},s=function(t,e){let s=$Util.positionTargetElemFixed(t,e);"auto"===s.bottom?s.top=s.top+15:s.bottom=s.bottom+15,t.css(s)},i=function(t,e){let s=t.getAttribute("id"),i=e[0].getAttribute("id");Clickoutside.bind({srcid:s,destid:i,customHide:function(){e.remove()}}),e.on("click","[data-action]",(function(t){a(t)}))},a=function(e){let s={reorderCategory:Folders.reorderCategory,renameCategory:Folders.renameCategory,deleteCategory:Folders.createDeleteCategoryDialog,addChatsInCategory:Folders.addChatsInFolder};Clickoutside.handleClickOnChild(e),s[e.currentTarget.getAttribute("data-action")](t)};return{show:function(a,n){a.stopPropagation();let l=n.getAttribute("data-categoryid");if(!e(l)){!function(t){let e=Folders.getCategoryInfo(t).chats.length>1?"":"dN",s={parentId:"foldercategoryoptns"+t,parentClass:"no-pointer foldercategoryoptns font14",parentCustomAttr:"closeonscroll style='z-index: 999';",options:[{content:"<em class='zcl-menu-item-icn zcf-plusB font12 mT3 mR8'></em><span class='ellips'>"+Resource.getRealValue("folders.addchats")+"</span>",customAtt:"data-action='addChatsInCategory'"},{className:e,content:"<em class='zcl-menu-item-icn zcf-pinreorder font13 mT3 mR8'></em><span class='ellips'>"+Resource.getRealValue("common.reorder")+"</span>",customAtt:"data-action='reorderCategory'"},{content:"<em class='zcl-menu-item-icn zcf-edit2 font13 mT3 mR8'></em><span class='ellips'>"+Resource.getRealValue("common.rename")+"</span>",customAtt:"data-action='renameCategory'"},{className:"zcl-neg-menu-item",content:"<em class='zcl-menu-item-icn zcf-delete2 mT2 font13 mR9'></em><span class='ellips'>"+Resource.getRealValue("common.delete")+"</span>",customAtt:"data-action='deleteCategory'"}]},i=DROP_DOWN.getHtml(s);$("body").append(i)}(l);var o=$("#foldercategoryoptns"+l);s(o,a),i(n,o),t=l}}}}(),FoldersCategoryList=function(){let t,e,s,i,a,n=!1,l=void 0,o=a=>{let o=t.find("#categorysearchlistinput"),c=$(FoldersDomSelectors.categorySearchResultsCont);Clickoutside.bind({destid:"categorysearchlistcont",event:event,closeOnClickSrc:!0,customShow:function(){n=!0,o.focus(),i?a.addClass("more-optn-sel"):e.parent()[0].style.display="block"},customHide:function(){n=!1,l=void 0,t.remove(),i?a.removeClass("more-optn-sel"):e.parent()[0].style.display="none"}}),o.on("keyup",(function(t){d($.trim(this.value))})),c.on("click","[data-category-option]",(function(t){let e=t.currentTarget.getAttribute("data-id");if("true"==t.currentTarget.getAttribute("ismovetofolder"))return r(e,t);e=e==FoldersConstants.DEFAULT_CATEGORY_ID?FoldersConstants.DEFAULT:e,Chat.markUnmarkPinnedChat(s,!0,e),Clickoutside.handleClickOnChild(t)}))},r=(t,e)=>{if(Config.isV2MsgResponseHandlingEnabled()&&FoldersUtilities.isPinnedChatsLimitReachedInaFolder(t))return Clickoutside.handleClickOnChild(e),void UI.updateBanner(Resource.getRealValue("folders.pinchats.onefolder.limit.info",[FoldersConstants.MAXIMUM_ALLOWED_PINS_IN_FOLDER]),2e3,!0);var i=$("#pinnedchats"),a=i.find("#tab"+s);a.removeClass("more-optn-sel");let n=a[0].outerHTML;a.remove();var l="1"==t?"#foldercategorychats1":"#foldercategorychats"+t;i.find(l)[0].insertAdjacentHTML("beforeend",n),Folders.handleCategoryChatsReordering({changedChid:s,aboveChid:"",categoryId:t}),Clickoutside.handleClickOnChild(e),UI.updateBanner(Resource.getRealValue("folders.moved.banner",[$WC.$CUtil.processXSS($(e.currentTarget).find(".folder-title-wrap")[0].textContent)]),2e3,!1)},d=(e,s)=>{if(e==l)return;l=e;let i=c(e,s),a=t.find("#categorysearchlistparent"),n=t.find("#categorysearchlist");i?(a.removeClass("flexM"),n.html(i)):(a.addClass("flexM"),n.html(FoldersTemplates.emptySearchListCont))},c=(t,e)=>{let i="";t=t.toLowerCase();var n=[...a];if(e){var l=n.indexOf(Folders.getCategoryIdOfChat(s));n.splice(l,1)}let o=n.length,r="",d="";for(let s=0;s<o;s++){let i=n[s],a=Folders.getCategoryInfo(i);a.isMoveToFolder=e,i==FoldersConstants.DEFAULT_CATEGORY_ID&&(a.title=Resource.getRealValue("common.pinnedchats")+" ( "+Resource.getRealValue("profileview.status.default")+" )");let l=a.title.toLowerCase();l.startsWith(t)?r+=p(a,t):l.includes(t)&&(d+=p(a,t))}return i=r+d},p=(t,e)=>{let s=t.symbol?Folders.getEmojiHtml(t.symbol):"",i="";s||(i="zcf-pinB mR6 mT2");let a=e?$Util.getHighlightedString(e,[$WC.$CUtil.processXSS(t.title)]):$WC.$CUtil.processXSS(t.title);return $WC.template.replace(FoldersTemplates.categorySuggestionsOptionCont,{TITLE:a,CATEGORY_ID:t.id,EMOJI_CONT:s,ICON_CLASS:i,IS_MOVE_TO:t.isMoveToFolder},"InSecureHTML")};return{createList:(r,c,p,h,m)=>{let u=(a=Folders.getCategoryList()).length;if(u<2)return Chat.markUnmarkPinnedChat(p,!0,FoldersConstants.DEFAULT),void(m&&Clickoutside.handleClickOnChild(m));n&&(Clickoutside.data.categorysearchlistcont?(Clickoutside.data.categorysearchlistcont.customHide(),Clickoutside.clear("categorysearchlistcont")):l=void 0),i=c,s=p,r=$(r);let v=u>FoldersConstants.CATEGORY_LIST_NON_SEARCH_BAR_LIMIT?"":"lhs-folders-list-search-hide",g=$WC.template.replace(FoldersTemplates.categorySuggestionSearchCont,{SEARCH_CLASS:v});if($(FoldersDomSelectors.bodyDom).append(g),t=$(FoldersDomSelectors.categoryListSearchCont),d("",h),i){let e=r.offset(),s=(t.outerHeight(),$Util.positionTargetElemFixed(t,m,{clickedX:e.left+r.outerWidth(),clickedY:e.top}));"auto"!==s.bottom&&(s.bottom=s.bottom-r.outerHeight()),s.left=s.left-FoldersConstants.SMILEYCONT_BOTTOM_POSITINING_PX,t.css(s)}else{let s=(e=r.parents("#chatactionlist")).parent()[0];"none"==s.style.display&&(s.style.display="block");let i=e.offset(),a=$Util.positionTargetElemFixed(t,m,{clickedX:i.left,clickedY:i.top}),n=t.outerWidth();a.left=a.left-n,t.css(a)}o(r)}}}(),FoldersUtilities=function(){let t=[],e=e=>{let s=e.find("#forwardmessages-usersuggest-select-field"),i=e.find("#forwardmessages-usersuggest-search-field"),a=e.find("#forwardmessages-usersuggest");e.find("#addchatsbtn").on("click",(function(){let e=$Util.removeDuplicateEntries(t.concat(SearchField.getSelectedList("forwardmessages-usersuggest-select-field")));Folders.isFolderCreationSelected?FoldersDragnDropHandler.addSelectedChatsFromDialogUnderNewFolder(e):Folders.addChatsInCategory(this,e,FoldersUtilities.lastUsedFolderId)})),e.find("#forwardmessages-usersuggest-select-field").on("click","[purpose='deleteimgnode'], [purpose='deleterecipant']",(function(){let t=$(this).parents("[elemtype]");t.length||(t=$(this).parents("[nodetype]")),t.remove(),i.select().focus(),MessageOperations.forward.populateDefaultResult(),$WC.Util.isEmpty(s.html())&&a.addClass("zcrchmcnt")})),e.on("click","[purpose='clearSearchText']",(function(){$("#forwardmessages-usersuggest-search-field").val("").select().focus(),MessageOperations.forward.populateDefaultResult()}))};return{showConversationsDialog:s=>{let i=Folders.getCategoryInfo(s),a=i.symbol?Folders.getEmojiHtml(i.symbol):"",n=$WC.template.replace(FoldersTemplates.foldersChatSelectionDialog,{EMOJI_HTML:a,draggable:"drag"},"InSecureHTML"),l=i.title||I18N("common.pinnedchats")+" ( "+I18N("profileview.status.default")+" )";n=$WC.template.replace(n,{FOLDER_TITLE:l}),FoldersUtilities.isFoldersAddChatsDialogOpened=!0,t=i.chats,FoldersUtilities.lastUsedFolderId=s;let o=$WC.$Win.create({id:"forwardmessageswin",class:"zcl-win-modal1",closeoutside:!0,html:n,draggable:!0,closefn:function(){FoldersUtilities.isFoldersAddChatsDialogOpened=!1,t=[],FoldersUtilities.lastUsedFolderId=void 0}});SearchField.init("forwardmessages-usersuggest"),MessageOperations.forward.populateDefaultResult(),e(o)},isFoldersAddChatsDialogOpened:void 0,getIgnoreListChats:()=>Folders.isFolderCreationSelected?FoldersDragnDropHandler.getDroppedChatIds():t,isPinnedChatsLimitReached:()=>{let t=MyPinsCustomizer.getPinsChatids(),e=SearchField.getSelectedList("forwardmessages-usersuggest-select-field");Folders.isFolderCreationSelected&&(e=e.concat(FoldersDragnDropHandler.getDroppedChatIds()));let s=e.length,i=0;for(let a=0;a<s;a++)t.includes(e[a])||i++;return t.length+i>=FoldersConstants.MAXIMUM_ALLOWED_PINS},isPinnedChatsLimitReachedInaFolder:t=>{t=t==FoldersConstants.DEFAULT?FoldersConstants.DEFAULT_CATEGORY_ID:t;let e=Folders.getChatsOfaFolder(t,!0);if(FoldersUtilities.isFoldersAddChatsDialogOpened){let t=SearchField.getSelectedList("forwardmessages-usersuggest-select-field");Folders.isFolderCreationSelected&&(t=t.concat(FoldersDragnDropHandler.getDroppedChatIds())),e+=t.length}return e>=FoldersConstants.MAXIMUM_ALLOWED_PINS_IN_FOLDER},lastUsedFolderId:void 0}}();