var MinimizedWindows=function(){let e,i,t,n=0,a={},s={},o="personalizewin",l="integrationwin",m="create_guestchat",r="invitecontactwin",d="media_listing_view_modal",c="applyleave",p="snippetEditor",w="filepickerwin",u="fileuploadwin",C="moreAppsOverlayWin",h="minimise-anim1",g="minimise-anim2",b="minimise-anim3",f="minimise-anim4",W="minimise-anim5",v="minimise-anim6",N={applyleave:{id:c,icon:"zcf-applyleave",name:I18N("rw.reminder.appplyleave")},invitecontactwin:{id:r,icon:"zcf-plusB",name:I18N("contact.add.header")},personalizewin:{id:o,icon:"zcf-personalise-settng",name:I18N("minimise.profile&settings"),tabNameCallback:PersonalizeUI.getTabName},create_guestchat:{id:m,icon:"zcf-guestconnect",name:I18N("guestchat.invite.guests")},moreAppsOverlayWin:{id:C,icon:"zcf-applet",name:I18N("tabs.more.apps"),show:WidgetsOverlay.showOnMaximise,tabNameCallback:WidgetsOverlay.getMinimisedTabName}};s={media_listing_view_modal:{id:"chid",icon:"zcf-mediagallery",name:I18N("minimise.mediagallery"),tabNameCallback:ConversationsList.get,property:"title",show:MediaListingUI.showPopup,metaData:MediaListingUI.getMetaData},snippetEditor:{id:"chid",icon:"zcf-code-snippet",name:I18N("common.code.snippet"),tabNameCallback:ConversationsList.get,property:"title",show:CodeSnippet.showOnMaximise,metaData:CodeSnippet.getMetaData},fileuploadwin:{id:"chid",icon:"zcf-computer",name:I18N("common.paste.fileshare"),tabNameCallback:ConversationsList.get,property:"title",show:FileUploadUI.showOnMaximise,metaData:FileUploadUI.getMetaData},filepickerwin:{id:"chid",icon:"zcf-cloud",name:I18N("minimise.cloudattachments"),tabNameCallback:ConversationsList.get,property:"title",show:CloudPickerUI.showOnMaximise,metaData:CloudPickerUI.getMetaData},integrationwin:{id:"chid",icon:"zcf-bot-thin",name:I18N("profileview.mycliq.internal_tools"),tabNameCallback:Integration.getCurrentEntity,referenceObject:IntegrationsCwin,show:IntegrationsCwin.onMaximise,metaData:IntegrationsCwin.onMinimise}};let y={minimisedWindowsListContainer:'<div id="minWindowsListContainer" maxIcon title class="zcl-menu-wrap no-pointer posabs with-line-separator min-win-list hide"></div>',minimisedWindowcountContainer:'<div id="noOfWindowsMinimised" class="min-windows-count"></div>',menuItemHtml:'<div id="{{key}}" class="zcl-menu-item ellips justifySB" purpose="maxWin" chid="{{chid}}">\n\t\t\t\t<span class="ellips flexC mR10">\n\t\t\t\t\t<em class="zcl-menu-item-icn {{icon_cls}}"></em>\n\t\t\t\t\t<span class="font14 ellips">{{name}}</span>\n\t\t\t\t\t<span class="minWindowTabName">{{tabName}}</span>\n\t\t\t\t</span>\n\t\t\t\t<span id="minListClose" class="min-win-closebtn dN" purpose="closeMinWindow">\n\t\t\t\t\t<em class="zcf-closeB font10 zcl-icon zcl-icon--filled2 zcl-round close_min_windows"></em>\n\t\t\t\t</span>\n\t\t\t</div>',btnSeparator:'<span class="posabs topbar-separator"></span>'},I=()=>{var e="";return Object.keys(a).forEach(i=>{let t=a[i];if($('[maxid="'+i+'"]').length||s[t.id]){var n=D(i);e+=$WC.template.replace(y.menuItemHtml,{key:i,name:t.name,tabName:n,icon_cls:t.icon,chid:t.chid})}else delete a[key],_print("minimise_window",key+"- Deleted -"+Date.now())}),e},D=e=>{var i=a[e],t=i.urlPath;let n=i.tabName;var s="";if(n)s=" - "+n;else if(t){var o=t.split("/");s=" - "+o[o.length-1]}return s},z=()=>{e.removeClass("hide"),i.addClass("tpbricon-selected"),Clickoutside.bind({srcid:"ztb-windowMinimise",event:event,destid:"minWindowsListContainer",customHide:function(){e.addClass("hide"),i.removeClass("tpbricon-selected"),i.attr("title",I18N("minimise.windows"))}})},_=e=>$("#"+e).attr(s[e].id)||"",M=e=>{let i=e+_(e);return obj=N[i],obj||(k(e),obj=N[i]),obj},k=e=>{let i=s[e],t=_(e),n={};if(n=i.referenceObject?i.metaData.call(i.referenceObject):i.metaData(),N[e+t]={id:e,uniqueId:t,icon:i.icon,name:i.name,metaData:n},n){let a=n.id||n.chid||t,s=i.tabNameCallback(a);i.property?N[e+t].tabName=s[i.property]:N[e+t].tabName=s}},O=(e,i)=>{var t=$("#"+e),n=e+"minimised";let o=j(t,e);t.on("transitionend",(function(l){"opacity"==l.originalEvent.propertyName&&($(l.target).removeClass("minimise-anim "+o),t.off("transitionend"),x(),s[e]&&(n=e+_(e)+"minimised"),a[n]||(a[n]=i,_print("minimise_window",n+"- Minimised -"+Date.now())),t.attr("maxId",n),t.hide(),$WC.$Win.current=$WC.$Win.current==i.id?null:$WC.$Win.current,F(e),s[e]?$WC.$Win.destroy(e):(e=>{e&&e.tabNameCallback&&(e.tabName=e.tabNameCallback(e.urlPath))})(a[n]))}))},x=()=>{i.removeClass("dN minimise-ripple-anim"),i.width(),t||(i.append(y.minimisedWindowcountContainer),t=i.find("#noOfWindowsMinimised")),t.text(n),i.addClass("minimise-ripple-anim")},j=(e,i)=>{let t=P(i);return L(e,t),e.addClass("minimise-anim "+t),t},P=e=>e===o||e===l||e==C?h:e===m?g:e===r?b:e===d?f:e===c||e===w||e===u?W:e===p?v:void 0,L=(e,i)=>{i===h&&(e[0].style.transform="translate(0,0) scale(1)"),e[0].style.opacity="1"},U=()=>{let e=$WC.$Win.current+"minimised";a.hasOwnProperty(e)&&($WC.$Win.current=null)},T=e=>{n-=1;var i=$('[maxid="'+e+'"]');let t=e.replace("minimised",""),o=N[t],l={},m=a[e]&&a[e].urlPath;_print("minimise_window",e+"- Maximised -"+Date.now()),o&&o.uniqueId&&(t=t.replace(o.uniqueId,"")),(l=s[t])&&(delete a[e],delete N[t+o.uniqueId],_print("minimise_window",e+"- Deleted -"+Date.now())),q(m),l&&!i.length?A(l,o):(B(i,t),i.show(),"function"==typeof o.show&&o.show()),$WC.$Win.current=t,E(),R()},B=(e,i)=>{let t=P(i);e.removeClass("minimise-anim "+t)},A=(e,i)=>{e.referenceObject?e.show.call(e.referenceObject,i.metaData):e.show(i.metaData)},E=()=>{t&&t.text(n)},R=()=>{0==n&&i.addClass("dN")},S=e=>{let s=e.replace("minimised","");delete a[e],_print("minimise_window",e+"- Deleted -"+Date.now()),$WC.$Win.destroy(s),U(),n-=1,t.text(n),0==n&&i.addClass("dN")},H=()=>{var e=Object.keys(a)[0];S(e)},q=e=>{if(e){let i=ZCPermalink.getPrefixForUrl(),t=e.replace(i,"");ZCPermalink.updateUrl(t)}else;},F=e=>{if(e==o||e==l||e==C){var i=a[e+"minimised"],t=new URL(window.location.href).pathname;i.urlPath=t,ZCPermalink.resetURLPath()}},Y=()=>{e.on("click","[purpose]",(function(e){Z(e),e.stopPropagation()}))},Z=e=>{let i=e.currentTarget,t=$(i).attr("purpose"),n=$(i).attr("id");if("maxWin"==t)z(),T(n);else if("closeMinWindow"==t){e.stopImmediatePropagation();var a=$(i).parent();S(a.attr("id")),a.remove()}},G=()=>n;return{getCountOfMinimisedWin:G,getMinimisedWindows:()=>a,updateCurrentWindowObject:U,constructWindowMenu:()=>{e||(i.append(y.minimisedWindowsListContainer),e=i.find("#minWindowsListContainer"),i.attr("title",""),Y()),e.html(I()),z()},maximiseWindow:T,handleWindowMinimise:e=>{let i=N[e];!i&&s[e]&&(i=M(e)),n>=6?((e,i)=>{var t=Object.keys(a)[0];let s=a[t].tabName;var o=a[t].name+(s?" - "+s:"");$WC.$Dlg.create({id:"alertWindow",version:3,class:"zcl-alert-dialog-2 zclmin-dialog-box w50",headerhtml:$WC.$Dlg.frameHeaderHTML({imagehtml:'<div class="zcl-img xl flexM mAuto zcf-alert2 zcl-img--warning"></div>',header:I18N("minimise.closefirstwindow",[6]),subheader:I18N("minimise.closefirstwindowdesc",[6,o])}),bodyhtml:"",buttons:[$WC.$Dlg.getButtonObj("common.cancel",$zcg._cssClasses.SECONDARY_BTN,(function(){$WC.$Dlg.destroy("invaliduseralert")})),$WC.$Dlg.getButtonObj("common.minimize",$zcg._cssClasses.PRIMARY_BTN,(function(){H(),n+=1,O(e,i)}))]})})(e,i):(n+=1,O(e,i))},handleWindowDestroy:e=>{a[e]&&(delete a[e],_print("minimise_window",e+"- Deleted -"+Date.now()))},isMinimisedWindow:e=>!!a[e],handlePageUnload:()=>!_isDesktopApp()&&(setTimeout((function(){setTimeout((function(){n&&$WC.$Dlg.create({id:"alertWindow",version:3,class:"zcl-alert-dialog-2 w40 zclmin-dialog-box",headerhtml:$WC.$Dlg.frameHeaderHTML({imagehtml:'<div class="zcl-img xl flexM mAuto zcf-alert2 zcl-img--warning"></div>',header:n>1?I18N("minimise.reloadheader",[n]):I18N("minimise.one.reloadheader"),subheader:n>1?I18N("minimise.reloaddesc"):I18N("minimise.one.reloaddesc")}),bodyhtml:"",buttons:[$WC.$Dlg.getButtonObj("common.cancel",$zcg._cssClasses.SECONDARY_BTN,(function(){$WC.$Dlg.destroy("alertWindow")})),$WC.$Dlg.getButtonObj("common.close",$zcg._cssClasses.WARNING_BTN,(function(){Object.keys(a).forEach(e=>{S(e)})}))]})}),600)}),1),G()),openCwinOnMaximise:(e,i)=>{if(!ChatUI.getWin(e)&&!Chat.openChatWindowFromCachedDetails(e,!1))return void Chat.makeAttachSession(e,!0,i)},init:()=>{(i=$("#ztb-windowMinimise")).prepend(y.btnSeparator),i.addClass("dN")}}}();